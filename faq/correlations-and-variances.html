 
<!DOCTYPE html PUBLIC "-//W3C//DTD HTML+RDFa 1.1//EN">
<html lang="en" dir="ltr" version="HTML+RDFa 1.1"
xmlns:content="http://purl.org/rss/1.0/modules/content/"
xmlns:dc="http://purl.org/dc/terms/"
xmlns:foaf="http://xmlns.com/foaf/0.1/"
xmlns:og="http://ogp.me/ns#"
xmlns:rdfs="http://www.w3.org/2000/01/rdf-schema#"
xmlns:sioc="http://rdfs.org/sioc/ns#"
xmlns:sioct="http://rdfs.org/sioc/types#"
xmlns:skos="http://www.w3.org/2004/02/skos/core#"
xmlns:xsd="http://www.w3.org/2001/XMLSchema#"
xmlns:schema="http://schema.org/">
<head profile="http://www.w3.org/1999/xhtml/vocab">
<title>Correlations and Variances - Ferret/PyFerret FAQs</title>

<link rel="stylesheet" href="../modules/system/system.base.css">
<link rel="stylesheet" href="../modules/system/system.menus.css">
<link rel="stylesheet" href="../modules/system/system.messages.css">
<link rel="stylesheet" href="../modules/system/system.theme.css">

<link rel="stylesheet" href="../sites/all/modules/jquery_update/replace/ui/themes/base/minified/jquery.ui.core.min.css">
<link rel="stylesheet" href="../sites/all/modules/jquery_update/replace/ui/themes/base/minified/jquery.ui.theme.min.css">
<link rel="stylesheet" href="../sites/all/modules/jquery_update/replace/ui/themes/base/minified/jquery.ui.menu.min.css">
<link rel="stylesheet" href="../sites/all/modules/jquery_update/replace/ui/themes/base/minified/jquery.ui.autocomplete.min.css">

<link rel="stylesheet" href="../sites/all/modules/calendar/css/calendar_multiday.css">
<link rel="stylesheet" href="../modules/field/theme/field.css">
<link rel="stylesheet" href="../sites/all/modules/scald/modules/fields/mee/css/editor-global.css">
<link rel="stylesheet" href="../modules/node/node.css">
<link rel="stylesheet" href="../sites/all/modules/scald_file/scald_file.css">
<link rel="stylesheet" href="../modules/search/search.css">
<link rel="stylesheet" href="../modules/user/user.css">
<link rel="stylesheet" href="../sites/all/modules/views/css/views.css">
<link rel="stylesheet" href="../sites/all/modules/ckeditor/css/ckeditor.css">

<link rel="stylesheet" href="../sites/all/modules/ctools/css/ctools.css">
<link rel="stylesheet" href="../sites/all/modules/custom_search/custom_search.css">
<link rel="stylesheet" href="../sites/all/modules/search_autocomplete/css/themes/minimal.css">
<link rel="stylesheet" href="../sites/all/libraries/superfish/css/superfish.css">
<link rel="stylesheet" href="../sites/all/libraries/superfish/css/superfish-smallscreen.css">
<link rel="stylesheet" href="../sites/all/libraries/superfish/css/superfish-vertical.css">

<link rel="stylesheet" href="../sites/all/themes/pacific_marine/css/ckeditor_custom.css">

<link rel="stylesheet" href="../sites/all/themes/omega/alpha/css/alpha-reset.css">
<link rel="stylesheet" href="../sites/all/themes/omega/alpha/css/alpha-mobile.css">
<link rel="stylesheet" href="../sites/all/themes/omega/alpha/css/alpha-alpha.css">
<link rel="stylesheet" href="../sites/all/themes/omega/omega/css/formalize.css">
<link rel="stylesheet" href="../sites/all/themes/omega/omega/css/omega-text.css">
<link rel="stylesheet" href="../sites/all/themes/omega/omega/css/omega-branding.css">
<link rel="stylesheet" href="../sites/all/themes/omega/omega/css/omega-menu.css">
<link rel="stylesheet" href="../sites/all/themes/omega/omega/css/omega-forms.css">
<link rel="stylesheet" href="../sites/all/themes/omega/omega/css/omega-visuals.css">
<link rel="stylesheet" href="../sites/all/themes/pacific_marine/css/global.css">



<link rel="stylesheet" href="../sites/all/themes/pacific_marine/css/pacific-marine-alpha-default.css">
<link rel="stylesheet" href="../sites/all/themes/pacific_marine/css/pacific-marine-alpha-default-wide.css">
<link rel="stylesheet" href="../sites/all/themes/omega/alpha/css/grid/alpha_default/wide/alpha-default-wide-12.css">


</head>
<body class="html not-front not-logged-in page-node page-node- page-node-555 node-type-documentation-page context-documentation">
  <div id="body-bg-top"></div>
  <div id="skip-link">
    <a href="#main-content" class="element-invisible element-focusable">Skip to main content</a>
  </div>
    <div class="page clearfix" id="page">
      <header id="section-header" class="section section-header">
  <div id="zone-header-wrapper" class="zone-wrapper zone-header-wrapper clearfix">  
  <div id="zone-header" class="zone zone-header clearfix container-12">
    <div class="grid-7 region region-branding" id="region-branding">
  <div class="region-inner region-branding-inner">
        <div class="branding-data clearfix">
            <div class="logo-img">
        <a href="../index.html" rel="home" title=""><img src="../sites/all/themes/pacific_marine/images/ferret-banner.png" alt="" id="logo" /></a>
		</div>
                </div>
          </div>
</div><div class="grid-5 region region-header-first" id="region-header-first">
  <div class="region-inner region-header-first-inner">
    <div class="block block-block block-4 block-block-4 odd block-without-title" id="block-block-4">
  <div class="block-inner clearfix">

  </div>
</div>
  </div>
</div>  </div>
</div>  </div>
</div><div id="zone-menu-wrapper" class="zone-wrapper zone-menu-wrapper clearfix">  
  <div id="zone-menu" class="zone zone-menu clearfix container-12">
    <div class="grid-12 region region-menu" id="region-menu">
  <div class="region-inner region-menu-inner">
        <div class="block block-system block-menu block-main-menu block-system-main-menu odd block-without-title" id="block-system-main-menu">
  <div class="block-inner clearfix">
                
    <div class="content clearfix">
      <ul class="menu">
	  <li class="first expanded"><a href="../index.html">Home</a>
	  <ul class="menu">
	  </li>
<li class="leaf"><a href="../index.html">Ferret/PyFerret Home</a></li>
</ul></li>
<li class="leaf"><a href="../documentation/ferret-documentation.html">Documentation</a></li>
<li class="leaf"><a href="ferret-faqs.html">FAQ</a></li>
<li class="collapsed"><a href="../documentation/pyferret/downloads.html">Downloads</a></li>
<li class="collapsed"><a href="../documentation/pyferret-support.html">Support</a></li>
</ul>    </div>
  </div>
</div>  </div>
</div>
  </div>
</div></header> 


      <section id="section-content" class="section section-content">
  <div id="zone-preface-wrapper" class="zone-wrapper zone-preface-wrapper clearfix">  
  <div id="zone-preface" class="zone zone-preface clearfix equal-height-container container-12">
    <div class="grid-3 region region-preface-first equal-height-element" id="region-preface-first">
  <div class="region-inner region-preface-first-inner">
      </div>
</div><div class="grid-9 region region-preface-second equal-height-element" id="region-preface-second">
  <div class="region-inner region-preface-second-inner">
      </div>
</div>  </div>
</div><div id="zone-content-wrapper" class="zone-wrapper zone-content-wrapper clearfix no-sidebar">  
  <div id="zone-content" class="zone zone-content clearfix equal-height-container container-12">    
        
        <div class="grid-12 region region-content equal-height-element" id="region-content">
  <div class="region-inner region-content-inner">
    <a id="main-content"></a>
            <div class="element-invisible">   
    </div>                    <div class="block block-system block-main block-system-main odd block-without-title" id="block-system-main">
  <div class="block-inner clearfix">
                
    <div class="content clearfix">
      <article about="/Ferret/index.html" typeof="foaf:Document" class="node node-page node-published node-not-promoted node-not-sticky author-burger odd clearfix" id="node-page-771">

<h2 class="block-title"><a href="ferret-faqs.html" class="active-trail">FAQ</a></h2>
<a id="main-content"></a>
<div class="element-invisible">    <h1 class="title" id="page-title">Correlations and Variances</h1>
</div>                    <div class="block block-system block-main block-system-main odd block-without-title" id="block-system-main">
<div class="block-inner clearfix">
 
<div class="content clearfix">
<article about="/Ferret/faq/correlations-and-variances" typeof="foaf:Document" class="node node-page node-published node-not-promoted node-not-sticky author-ansley odd clearfix" id="node-page-645">

<h1 id="page title"  class="node-title">Correlations and Variances</h1>  <div class="content clearfix">
 
<div class="field field-name-body field-type-text-with-summary field-label-hidden">
<div class="field-items">
<div class="field-item even" property="content:encoded"><h2>Question:</h2>
<p>I need to compute correlations. How do I do that?</p>
<p>The script <b>variance.jnl</b>, included in the Ferret distribution, defines variables variance, correlation, and covariance based on the input variables. The variances are computed for each time series so if the input variables are defined in, say, X, Y, and time then the variance and correlations are functions of X and Y representing the correlation for each time series.</p>
<p>The variance script offers the following coaching lines about how to run it:</p>
<pre>
yes? go variance
... Variance and Covariance: Instructions:
Use the LET/QUIET command to define the variable(s) P (and Q) as
your variable(s) of interest (e.g. yes? LET/QUIET P = u[x=180,y=0])
The variance of P will be variable P_VAR (Q --&gt; Q_VAR)
The covariance will be COVAR The correlation will be CORREL.
Type GO VAR_N to obtain n/n+1 statistical correction factor
...</pre><p>Define variables P and Q as the inputs to the script (or to get a variance of only one variable, define P.) Both variables should have the same time axis. If they are on different grids, use a regridding transformation to regrid one variable in the time dimension to the grid of the other.</p>
<pre>
<b> yes? SET DATA coads_climatology
yes? LET p = sst[X=180,Y=10]
yes? LET q = airt[X=180,Y=10]
yes? GO variance
</b></pre><p> </p>
<p>Here are our definitions of P and Q, and some of the variables that the script defines:</p>
<pre>
<b> yes? SHOW VAR</b>
Created by DEFINE VARIABLE:
&gt;&gt;&gt; Definitions that replace any file variable of same name:
P = SST[X=180,Y=10]
Q = AIRT[X=180,Y=10]
...
P_VAR = P_DSQ[L=@AVE]
VARIANCE OF P
Q_VAR = Q_DSQ[L=@AVE]
VARIANCE OF Q
 
P_VAR_MASK = P_DSQ_MASK[L=@AVE]
VARIANCE OF P WHEN Q PRESENT
Q_VAR_MASK = Q_DSQ_MASK[L=@AVE]
VARIANCE OF Q WHEN P PRESENT
 
COVAR = PQ_DSQ[L=@AVE]
COVARIANCE OF P AND Q
CORREL = COVAR / (P_VAR_MASK*Q_VAR_MASK)^.5
"CORRELATION OF P AND Q"</pre><p>Listing the variances, correlation, and covariance,</p>
<pre>
<b> yes? list p_var, q_var</b>
DATA SET: /home/ja9/tmap/fer_dsets/data/coads_climatology.cdf
LONGITUDE: 179E
LATITUDE: 9N
TIME: 01-JAN 00:45 to 31-DEC 06:34
Column 1: P_VAR is VARIANCE OF P
Column 2: Q_VAR is VARIANCE OF Q
P_VAR Q_VAR 
I / *: 0.2455 0.1085
<b> yes? LIST correl, covar</b>
DATA SET: /home/ja9/tmap/fer_dsets/data/coads_climatology.cdf
LONGITUDE: 179E
LATITUDE: 9N
TIME: 01-JAN 00:45 to 31-DEC 06:34
Column 1: CORREL is CORRELATION OF P AND Q
Column 2: COVAR is COVARIANCE OF P AND Q
CORREL COVAR 
I / *: 0.6347 0.1036
</pre><p>The comments in variance.jnl suggest running <b>var_n.jnl</b> to make the n/n+1 correction. It is to be run after variance.jnl, and it redefines the variances to make that correction. So correlation and covariance are also redefined, as correl and covar are defined in terms of p_var and q_var.</p>
<p>Show the definitions of p_var and correl; see how p_var has a new definition after running the script var_n.jnl</p>
<pre>
<b> yes? SHOW VAR p_var</b>
P_VAR = P_DSQ[L=@AVE]
VARIANCE OF P
 
<b>yes? SHOW VAR correl</b>
CORREL = COVAR / (P_VAR_MASK*Q_VAR_MASK)^.5
CORRELATION OF P AND Q
 
<b>yes? GO var_n</b>
 
<b>yes? SHOW VAR p_var</b>
P_VAR = P_DSQ[L=@AVE] * NDNM1
VARIANCE OF P
 
 
</pre><p>Note how correl has changed:</p>
<pre>
<b> yes? LIST correl</b>
VARIABLE : CORRELATION OF P AND Q
FILENAME : coads_climatology.cdf
FILEPATH : /home/ja9/tmap/fer_dsets/data/
LONGITUDE: 179E
LATITUDE : 9N
TIME : 01-JAN 00:45 to 31-DEC 06:34
0.6347</pre><p>Now, if we want to define P and Q to be variables in X, Y, and time, we can see how the correlation varies in space, with higher correlations between sea and air temperature at latitudes where there is a stronger seasonal signal.</p>
<p> </p>
<pre>
<b> yes? SET DATA coads_climatology
yes? LET p = sst[x=150:220,y=0:40]
yes? LET q = airt[x=150:220,y=0:40]
yes? go variance
 
yes? go var_n</b></pre><p>Note how correl is a function of X and Y</p>
<pre>
<b> yes? STAT correl</b>
 
CORRELATION OF P AND Q
LONGITUDE: 150E to 140W
LATITUDE: 0 to 40N
Z: N/A
TIME: 01-JAN 00:45 to 31-DEC 06:34
DATA SET: /home/ja9/tmap/fer_dsets/data/coads_climatology.cdf
 
Total # of data points: 700 (35*20*1*1)
# flagged as bad data: 0
Minimum value: -0.18597
Maximum value: 0.9938
Mean value: 0.87395 (unweighted average)
Standard deviation: 0.20548
 
<b>yes? shade correl</b></pre><p> </p>
<p><img class="image-inline" src="../sites/default/files/images/faq/correlate.gif" /></p>
<p> </p>
<p>See also the script <em><strong>correlation_with_students_t_test.jnl</strong></em>, new with Ferret v7.45.   It calls the STUDENT_T_CUTOFF function and  defines these additional variables :</p>
<p> </p>
<ul><li>DEGREES_FREEDOM = degrees of freedom used available in calculating correlation, r.  </li>
<li>COVAR = covariance between input variables P and Q provided to variance.jnl</li>
<li>CORREL = correlation, r.</li>
<li>CORREL_SIGNIFICANT = correlation, r, for confidence level GE the specified percent probability cutoff.</li>
<li>A variable named in the call to the script, defined to be = 1 or missing to denote that the correlation, r, is signficant (1) or not (missing). </li>
</ul><pre>
yes? go/help correlation_with_students_t_test
 
...</pre></div>
</div>
</div>

</div>

<div class="clearfix">
<nav class="links node-links clearfix"></nav>

</div>
</article>    </div>
</div>
</div>      </div>
</div>  </div>
</div></section>    
 
<footer id="section-footer" class="section section-footer">

  <div id="zone-footer-wrapper" class="zone-wrapper zone-footer-wrapper clearfix">  
  <div id="zone-footer" class="zone zone-footer clearfix container-12">
    <div class="grid-8 region region-footer-first" id="region-footer-first">
  <div class="region-inner region-footer-first-inner">
    <div class="block block-block block-1 block-block-1 odd block-without-title" id="block-block-1">
  <div class="block-inner clearfix">
                
  </div>
</div><div class="block block-block block-2 block-block-2 even block-without-title" id="block-block-2">
  <div class="block-inner clearfix">
                
  </div>
</div><div class="block block-menu block-menu-footer-first-menu block-menu-menu-footer-first-menu odd block-without-title" id="block-menu-menu-footer-first-menu">

  </div>
</div>  </div>
</div><div class="grid-4 region region-footer-second" id="region-footer-second">
  <div class="region-inner region-footer-second-inner">
    <div class="block block-menu block-menu-footer-second-menu block-menu-menu-footer-second-menu odd block-without-title" id="block-menu-menu-footer-second-menu">
  <div class="block-inner clearfix">
                
  </div>
</div>  </div>
</div>  </div>
</div></footer>  </div>  <div class="region region-page-bottom" id="region-page-bottom">
  <div class="region-inner region-page-bottom-inner">
      </div>
</div>  <div id="body-bg-bottom"></div>
</body>
</html>

