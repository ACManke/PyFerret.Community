 
<!DOCTYPE html PUBLIC "-//W3C//DTD HTML+RDFa 1.1//EN">
<html lang="en" dir="ltr" version="HTML+RDFa 1.1"
xmlns:content="http://purl.org/rss/1.0/modules/content/"
xmlns:dc="http://purl.org/dc/terms/"
xmlns:foaf="http://xmlns.com/foaf/0.1/"
xmlns:og="http://ogp.me/ns#"
xmlns:rdfs="http://www.w3.org/2000/01/rdf-schema#"
xmlns:sioc="http://rdfs.org/sioc/ns#"
xmlns:sioct="http://rdfs.org/sioc/types#"
xmlns:skos="http://www.w3.org/2004/02/skos/core#"
xmlns:xsd="http://www.w3.org/2001/XMLSchema#"
xmlns:schema="http://schema.org/">
<head profile="http://www.w3.org/1999/xhtml/vocab">
<title>How can I work with ARGO float profile data? - Ferret/PyFerret FAQs</title>

<link rel="stylesheet" href="../modules/system/system.base.css">
<link rel="stylesheet" href="../modules/system/system.menus.css">
<link rel="stylesheet" href="../modules/system/system.messages.css">
<link rel="stylesheet" href="../modules/system/system.theme.css">

<link rel="stylesheet" href="../sites/all/modules/jquery_update/replace/ui/themes/base/minified/jquery.ui.core.min.css">
<link rel="stylesheet" href="../sites/all/modules/jquery_update/replace/ui/themes/base/minified/jquery.ui.theme.min.css">
<link rel="stylesheet" href="../sites/all/modules/jquery_update/replace/ui/themes/base/minified/jquery.ui.menu.min.css">
<link rel="stylesheet" href="../sites/all/modules/jquery_update/replace/ui/themes/base/minified/jquery.ui.autocomplete.min.css">

<link rel="stylesheet" href="../sites/all/modules/calendar/css/calendar_multiday.css">
<link rel="stylesheet" href="../modules/field/theme/field.css">
<link rel="stylesheet" href="../sites/all/modules/scald/modules/fields/mee/css/editor-global.css">
<link rel="stylesheet" href="../modules/node/node.css">
<link rel="stylesheet" href="../sites/all/modules/scald_file/scald_file.css">
<link rel="stylesheet" href="../modules/search/search.css">
<link rel="stylesheet" href="../modules/user/user.css">
<link rel="stylesheet" href="../sites/all/modules/views/css/views.css">
<link rel="stylesheet" href="../sites/all/modules/ckeditor/css/ckeditor.css">

<link rel="stylesheet" href="../sites/all/modules/ctools/css/ctools.css">
<link rel="stylesheet" href="../sites/all/modules/custom_search/custom_search.css">
<link rel="stylesheet" href="../sites/all/modules/search_autocomplete/css/themes/minimal.css">
<link rel="stylesheet" href="../sites/all/libraries/superfish/css/superfish.css">
<link rel="stylesheet" href="../sites/all/libraries/superfish/css/superfish-smallscreen.css">
<link rel="stylesheet" href="../sites/all/libraries/superfish/css/superfish-vertical.css">

<link rel="stylesheet" href="../sites/all/themes/pacific_marine/css/ckeditor_custom.css">

<link rel="stylesheet" href="../sites/all/themes/omega/alpha/css/alpha-reset.css">
<link rel="stylesheet" href="../sites/all/themes/omega/alpha/css/alpha-mobile.css">
<link rel="stylesheet" href="../sites/all/themes/omega/alpha/css/alpha-alpha.css">
<link rel="stylesheet" href="../sites/all/themes/omega/omega/css/formalize.css">
<link rel="stylesheet" href="../sites/all/themes/omega/omega/css/omega-text.css">
<link rel="stylesheet" href="../sites/all/themes/omega/omega/css/omega-branding.css">
<link rel="stylesheet" href="../sites/all/themes/omega/omega/css/omega-menu.css">
<link rel="stylesheet" href="../sites/all/themes/omega/omega/css/omega-forms.css">
<link rel="stylesheet" href="../sites/all/themes/omega/omega/css/omega-visuals.css">
<link rel="stylesheet" href="../sites/all/themes/pacific_marine/css/global.css">



<link rel="stylesheet" href="../sites/all/themes/pacific_marine/css/pacific-marine-alpha-default.css">
<link rel="stylesheet" href="../sites/all/themes/pacific_marine/css/pacific-marine-alpha-default-wide.css">
<link rel="stylesheet" href="../sites/all/themes/omega/alpha/css/grid/alpha_default/wide/alpha-default-wide-12.css">


</head>
<body class="html not-front not-logged-in page-node page-node- page-node-555 node-type-documentation-page context-documentation">
  <div id="body-bg-top"></div>
  <div id="skip-link">
    <a href="#main-content" class="element-invisible element-focusable">Skip to main content</a>
  </div>
    <div class="page clearfix" id="page">
      <header id="section-header" class="section section-header">
  <div id="zone-header-wrapper" class="zone-wrapper zone-header-wrapper clearfix">  
  <div id="zone-header" class="zone zone-header clearfix container-12">
    <div class="grid-7 region region-branding" id="region-branding">
  <div class="region-inner region-branding-inner">
        <div class="branding-data clearfix">
            <div class="logo-img">
        <a href="../index.html" rel="home" title=""><img src="../sites/all/themes/pacific_marine/images/ferret-banner.png" alt="" id="logo" /></a>
		</div>
                </div>
          </div>
</div><div class="grid-5 region region-header-first" id="region-header-first">
  <div class="region-inner region-header-first-inner">
    <div class="block block-block block-4 block-block-4 odd block-without-title" id="block-block-4">
  <div class="block-inner clearfix">

  </div>
</div>
  </div>
</div>  </div>
</div>  </div>
</div><div id="zone-menu-wrapper" class="zone-wrapper zone-menu-wrapper clearfix">  
  <div id="zone-menu" class="zone zone-menu clearfix container-12">
    <div class="grid-12 region region-menu" id="region-menu">
  <div class="region-inner region-menu-inner">
        <div class="block block-system block-menu block-main-menu block-system-main-menu odd block-without-title" id="block-system-main-menu">
  <div class="block-inner clearfix">
                
    <div class="content clearfix">
      <ul class="menu">
	  <li class="first expanded"><a href="../index.html">Home</a>
	  <ul class="menu">
	  </li>
<li class="leaf"><a href="../index.html">Ferret/PyFerret Home</a></li>
</ul></li>
<li class="leaf"><a href="../documentation/ferret-documentation.html">Documentation</a></li>
<li class="leaf"><a href="ferret-faqs.html">FAQ</a></li>
<li class="collapsed"><a href="../documentation/pyferret/downloads.html">Downloads</a></li>
<li class="collapsed"><a href="../documentation/pyferret-support.html">Support</a></li>
</ul>    </div>
  </div>
</div>  </div>
</div>
  </div>
</div></header> 


<!-- ----- this from main index.html, after </div></header>-->

      <section id="section-content" class="section section-content">
  <div id="zone-preface-wrapper" class="zone-wrapper zone-preface-wrapper clearfix">  
  <div id="zone-preface" class="zone zone-preface clearfix equal-height-container container-12">
    <div class="grid-3 region region-preface-first equal-height-element" id="region-preface-first">
  <div class="region-inner region-preface-first-inner">
      </div>
</div><div class="grid-9 region region-preface-second equal-height-element" id="region-preface-second">
  <div class="region-inner region-preface-second-inner">
      </div>
</div>  </div>
</div><div id="zone-content-wrapper" class="zone-wrapper zone-content-wrapper clearfix no-sidebar">  
  <div id="zone-content" class="zone zone-content clearfix equal-height-container container-12">    
        
        <div class="grid-12 region region-content equal-height-element" id="region-content">
  <div class="region-inner region-content-inner">
    <a id="main-content"></a>
            <div class="element-invisible">   
    </div>                    <div class="block block-system block-main block-system-main odd block-without-title" id="block-system-main">
  <div class="block-inner clearfix">
                
    <div class="content clearfix">
      <article about="/Ferret/index.html" typeof="foaf:Document" class="node node-page node-published node-not-promoted node-not-sticky author-burger odd clearfix" id="node-page-771">


<!--   ... from main index.html, -->
<h2 class="block-title"><a href="ferret-faqs.html" class="active-trail">FAQ</a></h2>
<a id="main-content"></a>
<div class="element-invisible">    <h1 class="title" id="page-title">How can I work with ARGO float profile data?</h1>
</div>                    <div class="block block-system block-main block-system-main odd block-without-title" id="block-system-main">
<div class="block-inner clearfix">
 
<div class="content clearfix">
<article about="/Ferret/faq/how-can-i-work-with-argo-float-profile-data" typeof="foaf:Document" class="node node-page node-published node-not-promoted node-not-sticky author-ansley odd clearfix" id="node-page-766">

<h1 id="page title"  class="node-title">How can I work with ARGO float profile data?</h1>  <div class="content clearfix">
 
<div class="field field-name-body field-type-text-with-summary field-label-hidden">
<div class="field-items">
<div class="field-item even" property="content:encoded"><h2>Working with ARGO float data</h2>
<h3>Question:</h3>
<p>How can I work with data from the USGODAE Argo GDAC Data Browser (obtained from usgodae.org)</p>
<h3>Example:</h3>
<p>Upon opening a file from this source, the data which should be on axes of Z(levels) and T(days) instead appears to be on an XY axis. For instance, looking at a temperature variable:</p>
<pre>
yes? USE argo2900623_prof.nc
yes? SHOW GRID temp
GRID GAI4
name     axis      # pts  start       end
N_LEVELS  X         48 r   1           48
N_PROF    Y         35 r   1           35
normal    Z
normal    T</pre><p>The files contain a variable JULD, giving the time steps in days, and also a variable PRES. We would like to create a pressure axis and replace Z levels with pressure in decibars.</p>
<h3>Explanation:</h3>
<p>The file opens with N_LEVELS as an X axis and N_PROF as Y axes because the attributes in the file don't tell Ferret what direction the axes are, so it just takes them in the order they appear. We can use Ferret commands define new axes with the correct direction and units. We can also make use of ZAXREPLACE function to convert from levels to pressure units in the Z direction.</p>
<h3>Solution:</h3>
<p>Tell Ferret the order of axes to use via the /ORDER qualifier on the USE command:</p>
<pre>
yes? USE/ORDER=ZT argo2900623_prof.nc</pre><p>To change from N_PROF to a time axis based on the data, let's look at the variable JULD, in particular its units attribute. Define an axis based on the values in JULD. (Note that sometimes in-situ data such as this may be disordered in time. If that were the case, we could use SORT and SAMPLE functions to reorder theJULD data, applying the same SAMPLE call to the data fields as well.)</p>
<pre>
yes? SHOW ATTRIBUTE/ALL juld
attributes for dataset: /home/porter/ansley/ans_ferret/users/ansley/2900622_prof.nc
JULD.long_name = Julian day (UTC) of the station relative to REFERENCE_DATE_TIME 
JULD.units = days since 1950-01-01 00:00:00 UTC 
JULD.conventions = Relative julian days with decimal part (as parts of day) 
JULD._FillValue = 999999
 
yes? DEFINE AXIS/T/T0="1-JAN-1950:00:00"/UNITS=days tday=juld
 
</pre><p>Now define a Z axis with units of levels. Make sure it's a DEPTH axis (increasing downwards).</p>
<pre>
yes? LET zz=Z[GZ=temp]
yes? DEFINE AXIS/Z/UNITS=levels/DEPTH zlev=zz
</pre><p>Define new TEMPERATURE and PRESSURE variables, on the new ZT grid. (The syntax `temp,R=units` is short for `temp, RETURN=units`. These definitions keep the units, title, and missing-value flag from the originalvariable.)</p>
<pre>
! Put the temperature and pressure on this corrected ZT grid
 
yes? CANCEL MODE depth_label ! changes label on vertical axis from DEPTH to just Z
 
yes? LET/UNITS="`temp,R=units`"/TITLE="`temp,R=title`"/BAD=`temp,R=bad` \
temperature=temp[GZ=zlev@ASN,GT=tday@ASN]
yes? shade temperature
 
yes? LET/UNITS="`pres,R=units`"/TITLE="`pres,R=title`"/BAD=`pres,R=bad` \
pressure=pres[GZ=zlev@@ASN,GT=tday@ASN]
yes? SHADE pressure
</pre><p><img alt="ARGO FAQ: temperature on levels/time grid" class="image-left" src="../sites/default/files/images/faq/ARGO_1_temperature.gif" /></p>
<p>Now the temperature data has the right time axis, but notice how the missing data for a given profile is always at shifted to the end (deepest levels) of each profile (z), and for one time, the topmost (red) values are missing. Here is the equivalent plot for pressure, showing the same kind of behavior with missing data:</p>
<p>
<img alt="ARGO FAQ: pressure on levels/time grid" class="image-left" src="../sites/default/files/images/faq/ARGO_2_pressure.gif" /></p>
<p>Now we want to put temperature on a pressure axis. The ZAXREPLACE function in Ferret is designed to do exactly this, and it will deal with the missing data we see in the above plots.</p>
<pre>
yes? SHOW FUNCTION zaxreplace
ZAXREPLACE(V,ZVALS,ZAX)
regrid V onto Z axis of ZAX based upon Z values in ZVALS using linear interpolation
V: variable on native Z axis
ZVALS: Z-value field corresponding to data points of V
ZAX: variable with desired Z (depth) axis points
 
</pre><p>For our purposes, the first argument is temperature, the second is pressure, and we need to define an axis for the third argument which will be the pressure axis of the result. This can be any axis you want - perhaps you wish to compare this data with other data on a pressure axis. If so, use the pressure axis from that other data:</p>
<pre>
yes? USE my_other_data
yes? SHOW GRID variable
GRID GOJ1
name axis # pts start end
normal Z
normal Z
ZPRESSURE DEPTH (decibars) 29 i- 0 1000
normal Z
 
yes? CANCEL DATA my_other_data 
 
</pre><p>After the CANCEL DATA, the axis ZPRESSURE will still be defined, and you can use it in the call to ZAXREPLACE.</p>
<p>Or, to get an idea of the pressures in this data, list some pressure data, and use its general pattern to define our own pressure axis,</p>
<pre>
yes? LIST/L=1 pressure
VARIABLE : SEA PRESSURE (decibar)
FILENAME : 2900622_prof.nc
FILEPATH : /home/porter/ansley/ans_ferret/users/ansley/
SUBSET : 48 points (Z)
T : 1
1 / 1: 5.
2 / 2: 10.
3 / 3: 15.
4 / 4: 19.
5 / 5: 25.
6 / 6: 30.
7 / 7: 34.
8 / 8: 40.
9 / 9: 45.
10 / 10: 50.
11 / 11: 55.
12 / 12: 59.
13 / 13: 64.
14 / 14: 69.
15 / 15: 74.
16 / 16: 80.
17 / 17: 84.
18 / 18: 90.
19 / 19: 94.
20 / 20: 100.
21 / 21: 104.
22 / 22: 110.
23 / 23: 120.
24 / 24: 129.
25 / 25: 140.
26 / 26: 159.
27 / 27: 179.
28 / 28: 200.
29 / 29: 224.
30 / 30: 249.
31 / 31: 274.
32 / 32: 299.
33 / 33: 324.
34 / 34: 350.
35 / 35: 374.
36 / 36: 399.
37 / 37: 450.
38 / 38: 499.
39 / 39: 549.
40 / 40: 599.
41 / 41: 674.
42 / 42: 750.
43 / 43: 824.
44 / 44: 899.
45 / 45: 999.
46 / 46: 1099.
47 / 47: 1196.
 
! Define an axis from a list of data that we just type in:
 
yes? DEFINE AXIS/Z/UNITS=decibars/DEPTH zpres= {5.,10.,15.,20.,25.,30.,34.,40.,\
45.,50.,55.,60.,65.,70.,75.,80.,85.,90.,95.,100.,105.,110.,120.,130.,\
140.,160.,180.,200.,225.,250.,275.,300.,325.,350.,375.,400.,450.,500.,\
550.,600.,675.,750.,825.,900.,1000.,1100.,1200.}
 
</pre><p>Now, with one or the other of these kinds of axis definitions, define the temperature variable on the pressure axis, and plot the regridded variable.</p>
<pre>
yes? LET/UNITS="`temperature,R=units`"/TITLE="`temperature,R=title`" \
temp_on_pres=ZAXREPLACE(temperature,pressure,Z[GZ=zpres])
 
yes? SHADE temp_on_pres
</pre><p><img alt="ARGO FAQ: temperature on pressure/time grid" class="image-left" src="../sites/default/files/images/faq/ARGO_3_temp_on_press.gif" /></p>
<p>Now the temperature data is on the pressure-time grid. Save it to a netCDF file, and the axes we defined and the regridded variable are saved for another session.</p>
<p>Here is the entire script used here, generalized to open a specified dataset and apply the transformation to some specified variable in place of temperature. This script will be made available in the next release of Ferret.</p>
<pre>
! argo_zt.jnl
!
! Description: 
! For an ARGO float data file from http://www.usgodae.org/cgi-bin/argo_select.pl .
! open the data, change the order of the axes, and define a time axis and levels
! axis; regrid pressure and temp or other fields of interest to this ZT grid.
! Call ZAXREPLACE to put the temperature or other field onto a pressure axis in Z
!
! arg 1 arg 2 arg 3 
! usage: GO argo_zt filename variable[temp] [pressure-axis]
! 
! If argument 3 is not given then a pressure-axis is defined in this script
! 
! Examples:
! yes? go argo_zt 2900622_prof.nc temp
! 
! yes? define axis/z/units=decibars/depth z7 = {5,100,200,300,400,800,1200}
! yes? go argo_zt 900622_prof.nc psal z7
!
!
CANCEL DATA/ALL
CAN MODE logo
CANCEL MODE depth_label ! changes label on vertical axis from DEPTH to just Z
SET WINDOW/SIZ=0.6
 
USE/ORDER=ZT $1
 
DEFINE SYMBOL data_var = ($2"temp")
 
! Define a time axis based on JULD
SHOW ATT/ALL juld
 
DEF AXIS/T/T0="1-JAN-1950:00:00"/UNITS=days tday=juld
 
LET zz=Z[GZ=($data_var)]
DEF AXIS/Z/UNITS=levels/DEPTH zlev=zz
 
! Put the variable and pressure on this corrected time-layer grid
LET/UNITS="`pres,R=units`"/TITLE="`pres,R=title`"/BAD=`pres,R=bad` \
pressure=pres[gz=zlev@asn,gt=tday@asn]
 
LET/UNITS="`($data_var),R=units`"/TITLE="`($data_var),R=title`"/BAD=`($data_var),R=bad` \
($data_var)_zt=($data_var)[gz=zlev@asn,gt=tday@asn]
 
SET VIEW ul
SHADE pressure
SET VIEW ll
SHADE ($data_var)_zt
 
! Define an output Z axis with units of pressure
 
IF ($3"0|*&gt;1") THEN
DEFINE SYMBOL press_ax = ($3)
ELSE
DEFINE SYMBOL press_ax = zpres
DEFINE AXIS/Z/UNITS=decibars/DEPTH zpres= {5.,10.,15.,20.,25.,30.,34.,40.\
,45.,50.,55.,60.,65.,70.,75.,80.,85.,90.,95.,100.,105.,110.,120.,130.,\
140.,160.,180.,200.,225.,250.,275.,300.,325.,350.,375.,400.,450.,500.,\
550.,600.,675.,750.,825.,900.,1000.,1100.,1200.}
ENDIF
 
! Call zaxreplace to put the variable on this new pressure axis
 
LET/UNITS="`($data_var)_zt,R=units`"/TITLE="`($data_var)_zt,R=title`" \
var_on_pres = ZAXREPLACE(($data_var)_zt,pressure,Z[GZ=($press_ax)])
 
SET VIEW ur
SHADE var_on_pres
 
 
</pre></div>
</div>
</div>

</div>

<div class="clearfix">
<nav class="links node-links clearfix"></nav>

</div>
</article>    </div>
</div>
</div>      </div>
</div>  </div>
</div></section>    
 
<footer id="section-footer" class="section section-footer">

  <div id="zone-footer-wrapper" class="zone-wrapper zone-footer-wrapper clearfix">  
  <div id="zone-footer" class="zone zone-footer clearfix container-12">
    <div class="grid-8 region region-footer-first" id="region-footer-first">
  <div class="region-inner region-footer-first-inner">
    <div class="block block-block block-1 block-block-1 odd block-without-title" id="block-block-1">
  <div class="block-inner clearfix">
                
  </div>
</div><div class="block block-block block-2 block-block-2 even block-without-title" id="block-block-2">
  <div class="block-inner clearfix">
                
  </div>
</div><div class="block block-menu block-menu-footer-first-menu block-menu-menu-footer-first-menu odd block-without-title" id="block-menu-menu-footer-first-menu">

  </div>
</div>  </div>
</div><div class="grid-4 region region-footer-second" id="region-footer-second">
  <div class="region-inner region-footer-second-inner">
    <div class="block block-menu block-menu-footer-second-menu block-menu-menu-footer-second-menu odd block-without-title" id="block-menu-menu-footer-second-menu">
  <div class="block-inner clearfix">
                
  </div>
</div>  </div>
</div>  </div>
</div></footer>  </div>  <div class="region region-page-bottom" id="region-page-bottom">
  <div class="region-inner region-page-bottom-inner">
      </div>
</div>  <div id="body-bg-bottom"></div>
</body>
</html>
