<!-- MHonArc v2.5.4 -->
<!--X-Subject: Problem with calculating derivatives -->
<!--X-From-R13: Uyraa Qneire <Uyraa.QneireNngz.pu.pnz.np.hx> -->
<!--X-Date: Fri, 10 Dec 1999 17:26:34 &#45;0800 -->
<!--X-Message-Id: l0313030cb477547f09ef@[131.111.112.149] -->
<!--X-Content-Type: text/plain -->
<!--X-Head-End-->
<!doctype html public "-//W3C//DTD HTML//EN">
<html>
<head>
<title>Problem with calculating derivatives</title>
</head>
<body>
<!--X-Body-Begin-->
<!--X-User-Header-->
<!--X-User-Header-End-->
<!--X-TopPNI-->
<HR>
<center>[<a href="msg00429.html">Thread Prev</a>][<a href="msg00431.html">Thread Next</a>][<A HREF="threads.html#00430">Index</A>]</center>

<!--X-TopPNI-End-->
<!--X-MsgBody-->
<!--X-Subject-Header-Begin-->
<h1>Problem with calculating derivatives</h1>
<hr>
<!--X-Subject-Header-End-->
<!--X-Head-of-Message-->
<ul>
<li><strong>To</strong>: <strong><A HREF="mailto:ferret_users@DOMAIN.HIDDEN">ferret_users@xxxxxxxxxxxxxxxxxxx</A></strong></li>
<li><strong>Subject</strong>: <strong>Problem with calculating derivatives</strong></li>
<li><strong>From</strong>: <strong>Glenn Carver &lt;<A HREF="mailto:Glenn.Carver@DOMAIN.HIDDEN">Glenn.Carver@xxxxxxxxxxxxxxxx</A>&gt;</strong></li>
<li>Date: Sat, 11 Dec 1999 01:26:15 +0000</li>
<li>Sender: owner-ferret_users</li>
</ul>
<!--X-Head-of-Message-End-->
<!--X-Head-Body-Sep-Begin-->
<hr>
<!--X-Head-Body-Sep-End-->
<!--X-Body-of-Message-->
<pre>

Regarding my last message, I've got a bit further in trying to figure out
what's going on. It appears as though the problem is arising because of the
units I use for the vertical axis, in this case 'kelvin' as the axis is
potential temperature, which Ferret must be translating in some way.

Although I've isolated the problem, I still don't understand what Ferret's
doing. As kelvin is not a length unit, it ought to leave it alone?

Here's a snippet of Ferret commands that appears to give the correct
result, followed by a subtle change that makes it go awry.

yes? define axis/z/from_data/name=zx z[g=pv]     # PV is coming from a ext.
file
yes? define grid/like=pv/z=zx gg
yes? let p=z[g=gg]
yes? list/k=1:4 p, p[z=@ddf]
             Z: 329.4 to 457.8
 Column  1: P is Z[G=GG]
 Column  2: P[Z=@DDF] is Z[G=GG] (forward derivative on Z)
                  P         P
  344   / 1:  343.9950  1.000000
  373.2 / 2:  373.1750  1.000000
  404.8 / 3:  404.8350  1.000000
  439.2 / 4:  439.1750  1.000000

All ok there.  Now suppose I make a subtle change to the axis definition as
it is actually specified in the netcdf file by declaring what units the
axis is in.

yes? define axis/z/from_data/name=zx/units=kelvin z[g=pv]
Replacing definition of axis ZX
 *** NOTE:     31 words of axis coordinate storage lost
yes? list/k=1:4 p, p[z=@ddf]
             Z (KELVIN): 329.4 to 457.8
 Column  1: P is Z[G=GG]
 Column  2: P[Z=@DDF] is Z[G=GG] (forward derivative on Z)
                  P         P
344   / 1:  343.9950  39.37008
373.2 / 2:  373.1750  39.37008
404.8 / 3:  404.8350  39.37008
439.2 / 4:  439.1750  39.37008


And back comes the problem. So what's Ferret got against kelvin as a unit
for vertical coordinates??  Or am I missing something?

One of the things I find disconcerting about Ferret is that so much happens
behind the scenes without much feedback for the user. If Ferret is doing
some kind of conversion to metres here for kelvin (though god knows how
because I've not given it a temperature profile), it would be nice to be
told; set mode diagnostic doesn't really help.

Regards,
           Glenn




----
Dr. Glenn Carver, Senior Research Associate,
Centre for Atmospheric Science, Chemistry Dept., Cambridge University, UK
<A  HREF="mailto:Glenn.Carver@atm.ch.cam.ac.uk">mailto:Glenn.Carver@atm.ch.cam.ac.uk</A>   <A  HREF="http://www.atm.ch.cam.ac.uk/~glenn/">http://www.atm.ch.cam.ac.uk/~glenn/</A>

              &quot;I never think of the future, it comes soon enough&quot;
                   - Albert Einstein



</pre>

<!--X-Body-of-Message-End-->
<!--X-MsgBody-End-->
<!--X-Follow-Ups-->
<hr>
<ul><li><strong>Follow-Ups</strong>:
<ul>
<li><strong><a name="00431" href="msg00431.html">Re: Problem with calculating derivatives</a></strong>
<ul><li><em>From:</em> Steve Hankin</li></ul></li>
</ul></li></ul>
<!--X-Follow-Ups-End-->
<!--X-References-->
<!--X-References-End-->
<!--X-BotPNI-->
<UL>
<li>Previous by thread:
<strong><a href="msg00429.html">Problem with calculating derivatives</a></strong>
</li>
<li>Next by thread:
<strong><a href="msg00431.html">Re: Problem with calculating derivatives</a></strong>
</li>

</UL>
<center>[<a href="msg00429.html">Thread Prev</a>][<a href="msg00431.html">Thread Next</a>][<A HREF="threads.html#00430">Index</A>]</center>

<!--X-BotPNI-End-->
<!--X-User-Footer-->
<hr>
<font size=-1>
<address>
<a href="http://www.doc.gov">Dept of Commerce</a> / 
<a href="http://www.noaa.gov">NOAA</a> /
<a href="http://www.oar.noaa.gov">OAR</a> /
<a href="http://www.pmel.noaa.gov">PMEL</a> /
<a href="http://tmap.pmel.noaa.gov">TMAP</a>
</address> <br> <a href="http://ferret.pmel.noaa.gov/Ferret/ferret_contact_us.html">Contact Us</a> | <a href="http://www.noaa.gov/privacy.html">Privacy Policy</a> | <a href="http://www.noaa.gov/disclaimer.html">Disclaimer</a> | <a href="accessibility.html">Accessibility Statement</a> 
</font>
<!--X-User-Footer-End-->
</body>
</html>
