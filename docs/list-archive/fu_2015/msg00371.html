<!-- MHonArc v2.6.18 -->
<!--X-Subject: RE: [ferret_users] Re: Ferret &#45; masking based on altitude -->
<!--X-From-R13: "Ynqhx, Xbet R. (Re.)" <wx61Nyrvprfgre.np.hx> -->
<!--X-Date: Sat, 17 Oct 2015 07:11:39 &#45;0700 -->
<!--X-Message-Id: C40C765C4F6AAF4481A1BF210B1A725D1F4F99F1@exp&#45;dag1&#45;n2.uol.le.ac.uk -->
<!--X-Content-Type: multipart/alternative -->
<!--X-Reference: CAOzkrhEza0pU76NxOYOx0=Nyx_tU=NSjmNF6PMLoiscmsiTtDQ@mail.gmail.com -->
<!--X-Reference: CAGfCSpuA9k+dXvirD3mP5dkju7_c3BSo3bwj16+oN809g33Rdg@mail.gmail.com -->
<!--X-Reference: CAOzkrhHCATHTcKw5DXiuqSp4miz0SnNiBCK6_suQcFfP0A4=7g@mail.gmail.com -->
<!--X-Reference: CAOzkrhGxcyQFEVJyoqcsPHY&#45;9AQ_302YDSMbtXNk0TvkYJTqmg@mail.gmail.com -->
<!--X-Head-End-->
<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN"
        "http://www.w3.org/TR/html4/loose.dtd">
<html>
<head>
<title>RE: [ferret_users] Re: Ferret - masking based on altitude</title>
</head>
<body>
<!--X-Body-Begin-->
<!--X-User-Header-->
<!--X-User-Header-End-->
<!--X-TopPNI-->
<HR>
<center>[<a href="msg00370.html">Thread Prev</a>][<a href="msg00372.html">Thread Next</a>][<A HREF="threads.html#00371">Index</A>]</center>

<!--X-TopPNI-End-->
<!--X-MsgBody-->
<!--X-Subject-Header-Begin-->
<h1>RE: [ferret_users] Re: Ferret - masking based on altitude</h1>
<hr>
<!--X-Subject-Header-End-->
<!--X-Head-of-Message-->
<ul>
<li><strong>To</strong>: <strong>&quot;'simon EK'&quot; &lt;<a href="mailto:simonambat@DOMAIN.HIDDEN">simonambat@xxxxxxxxx</a>&gt;, Andre Paim &lt;<a href="mailto:paim.oceano@DOMAIN.HIDDEN">paim.oceano@xxxxxxxxx</a>&gt;,        &quot;<a href="mailto:ferret-majordomo@DOMAIN.HIDDEN">ferret-majordomo@xxxxxxxx</a>&quot; &lt;<a href="mailto:ferret-majordomo@DOMAIN.HIDDEN">ferret-majordomo@xxxxxxxx</a>&gt;,        &quot;Ferret users mailing list&quot; &lt;<a href="mailto:ferret_users@DOMAIN.HIDDEN">ferret_users@xxxxxxxx</a>&gt;</strong></li>
<li><strong>Subject</strong>: <strong>RE: [ferret_users] Re: Ferret - masking based on altitude</strong></li>
<li><strong>From</strong>: <strong>&quot;Kaduk, Jorg D. (Dr.)&quot; &lt;<a href="mailto:jk61@DOMAIN.HIDDEN">jk61@xxxxxxxxxxxxxxx</a>&gt;</strong></li>
<li>Date: Sat, 17 Oct 2015 14:11:35 +0000</li>
<li>Accept-language: en-GB, en-US</li>
<li>In-reply-to: &lt;<a href="msg00369.html">CAOzkrhGxcyQFEVJyoqcsPHY-9AQ_302YDSMbtXNk0TvkYJTqmg@mail.gmail.com</a>&gt;</li>
<li>List-archive: &lt;<a href="http://groups.google.com/a/noaa.gov/group/ferret_users/">http://groups.google.com/a/noaa.gov/group/ferret_users/</a>&gt;</li>
<li>List-help: &lt;<a href="http://support.google.com/a/noaa.gov/bin/topic.py?topic=25838">http://support.google.com/a/noaa.gov/bin/topic.py?topic=25838</a>&gt;, &lt;<a href="mailto:ferret_users+help@noaa.gov">mailto:ferret_users+help@noaa.gov</a>&gt;</li>
<li>List-id: &lt;ferret_users.noaa.gov&gt;</li>
<li>List-post: &lt;<a href="http://groups.google.com/a/noaa.gov/group/ferret_users/post">http://groups.google.com/a/noaa.gov/group/ferret_users/post</a>&gt;, &lt;<a href="mailto:ferret_users@noaa.gov">mailto:ferret_users@noaa.gov</a>&gt;</li>
<li>List-unsubscribe: &lt;<a href="mailto:googlegroups-manage+809428289204+unsubscribe@googlegroups.com">mailto:googlegroups-manage+809428289204+unsubscribe@googlegroups.com</a>&gt;, &lt;<a href="http://groups.google.com/a/noaa.gov/group/ferret_users/subscribe">http://groups.google.com/a/noaa.gov/group/ferret_users/subscribe</a>&gt;</li>
<li>Mailing-list: list <a href="mailto:ferret_users@DOMAIN.HIDDEN">ferret_users@xxxxxxxx</a>; contact <a href="mailto:ferret_users%2Bowners@DOMAIN.HIDDEN">ferret_users+owners@xxxxxxxx</a></li>
<li>References: &lt;CAOzkrhEza0pU76NxOYOx0=Nyx_tU=NSjmNF6PMLoiscmsiTtDQ@mail.gmail.com&gt;	&lt;<a href="msg00365.html">CAGfCSpuA9k+dXvirD3mP5dkju7_c3BSo3bwj16+oN809g33Rdg@mail.gmail.com</a>&gt;	&lt;CAOzkrhHCATHTcKw5DXiuqSp4miz0SnNiBCK6_suQcFfP0A4=7g@mail.gmail.com&gt; &lt;<a href="msg00369.html">CAOzkrhGxcyQFEVJyoqcsPHY-9AQ_302YDSMbtXNk0TvkYJTqmg@mail.gmail.com</a>&gt;</li>
<li>Sender: <a href="mailto:owner-ferret_users@DOMAIN.HIDDEN">owner-ferret_users@xxxxxxxx</a></li>
<li>Thread-index: AQHRCNCfA+Q9YFLCG0m65aApzJzXdJ5vt3Dg</li>
<li>Thread-topic: [ferret_users] Re: Ferret - masking based on altitude</li>
</ul>
<!--X-Head-of-Message-End-->
<!--X-Head-Body-Sep-Begin-->
<hr>
<!--X-Head-Body-Sep-End-->
<!--X-Body-of-Message-->
<table width="100%"><tr><td style="a:link { color: blue } a:visited { color: purple } ">


<div class="WordSection1">
<p class="MsoNormal"><span style="font-size:11.0pt;font-family:&quot;Calibri&quot;,&quot;sans-serif&quot;;color:#1F497D">Dear Simon,<o:p></o:p></span></p>
<p class="MsoNormal"><span style="font-size:11.0pt;font-family:&quot;Calibri&quot;,&quot;sans-serif&quot;;color:#1F497D">This seems to tell you that you have a different number of longitudes in your rainfall region and topography region (</span><span style="color:red;background:white">MASK1
 has 28 points (I=297:324) &nbsp;_expression_ has 29 points (I=31:59) </span><span style="font-size:11.0pt;font-family:&quot;Calibri&quot;,&quot;sans-serif&quot;;color:#1F497D">) This could happen if one variable has the coordinates on the corner of 1/4 degree boxes and the other in
 the centre of the 1/4 degree grid boxes. Have a look at your coordinates &#x2013; either in ferret (list command) or using ncdump &nbsp;(e.g. ncdump &#x2013;h elev.0.25-deg.nc to see the netcdf header and definitions and then ncdump &#x2013;v &lt;longitude variable&gt;, where &lt; longitude
 variable&gt; stands for the variable name of the longitudes, to see the data for the longitude variable). You might have to know how your grid cells are referred to by the coordinates (lower left corner, centre,&#x2026;).<o:p></o:p></span></p>
<p class="MsoNormal"><span style="font-size:11.0pt;font-family:&quot;Calibri&quot;,&quot;sans-serif&quot;;color:#1F497D">&#x2018;hope this help,<o:p></o:p></span></p>
<p class="MsoNormal"><span style="font-size:11.0pt;font-family:&quot;Calibri&quot;,&quot;sans-serif&quot;;color:#1F497D">Best wishes,<o:p></o:p></span></p>
<p class="MsoNormal"><span style="font-size:11.0pt;font-family:&quot;Calibri&quot;,&quot;sans-serif&quot;;color:#1F497D">Joerg<o:p></o:p></span></p>
<p class="MsoNormal"><span style="font-size:11.0pt;font-family:&quot;Calibri&quot;,&quot;sans-serif&quot;;color:#1F497D"><o:p>&nbsp;</o:p></span></p>
<p class="MsoNormal"><b><span lang="EN-US" style="font-size:10.0pt;font-family:&quot;Tahoma&quot;,&quot;sans-serif&quot;">From:</span></b><span lang="EN-US" style="font-size:10.0pt;font-family:&quot;Tahoma&quot;,&quot;sans-serif&quot;"> owner-ferret_users@xxxxxxxx [mailto:owner-ferret_users@xxxxxxxx]
<b>On Behalf Of </b>simon EK<br>
<b>Sent:</b> 17 October 2015 12:11<br>
<b>To:</b> Andre Paim; ferret-majordomo@xxxxxxxx; Ferret users mailing list<br>
<b>Subject:</b> [ferret_users] Re: Ferret - masking based on altitude<o:p></o:p></span></p>
<p class="MsoNormal"><o:p>&nbsp;</o:p></p>
<div>
<div>
<div>
<div>
<div>
<div>
<div>
<p class="MsoNormal" style="margin-bottom:12.0pt">Dear Andre/ ferret users,<o:p></o:p></p>
</div>
<p class="MsoNormal">I downloaded .25x.25 grid topography dataset and tried with one mask as adviced by you::<o:p></o:p></p>
</div>
<p class="MsoNormal">(the journal file and the errors &amp; warnings are listed below:<o:p></o:p></p>
</div>
<p class="MsoNormal">I could not much understand the errors.<o:p></o:p></p>
</div>
<p class="MsoNormal" style="margin-bottom:12.0pt">kindly help.<o:p></o:p></p>
</div>
<p class="MsoNormal">Regards<o:p></o:p></p>
</div>
<p class="MsoNormal">Simon<o:p></o:p></p>
<div>
<div>
<div>
<div>
<div>
<p class="MsoNormal"><br>
!====================================================================<br>
!topo-rf.jnl<br>
!====================================================================<br>
<b><span style="color:#38761D">use <a rel="nofollow" href="http://spi-rf.nc">spi-rf.nc</a> &nbsp;&nbsp;&nbsp; ! Rainfall data on .25x.25 grid - variable name 'rainfall'<br>
set region/x=74E:81E/y=8N:15N/l=1:365 &nbsp;&nbsp;&nbsp; ! selected 365 days data from ~ 100 years data<br>
<br>
use <a rel="nofollow" href="http://elev.0.25-deg.nc">elev.0.25-deg.nc</a>&nbsp; &nbsp;&nbsp;&nbsp; ! elevation on .25x.25 grid - variable name 'data'<br>
set region/x=74E:81E/y=8N:15N/l=1<br>
<br>
let mask1 = IF (data GE 0 AND data LT 100) THEN 1 else 1/0<br>
<br>
let rf_100 = rainfall[D=1] * mask1<br>
<br>
plot rf_100[x=@ave,y=@ave,l=1:365]&nbsp;&nbsp;&nbsp; ! plotting 365 days xy spacially averaged data</span></b><br>
!====================================================================<br>
<b><span style="color:red"><br>
Error</span></b><br>
<br>
<span style="color:blue">yes? go topo-rf.jnl<br>
use <a rel="nofollow" href="http://spi-rf.nc">spi-rf.nc</a> &nbsp;&nbsp;&nbsp; ! Rainfall data on .25x.25 grid<br>
set region/x=74E:81E/y=8N:15N/l=1:365 &nbsp;&nbsp;&nbsp; ! selected 365 days data from ~ 100 years data<br>
&nbsp;<br>
use <a rel="nofollow" href="http://elev.0.25-deg.nc">elev.0.25-deg.nc</a>&nbsp; &nbsp;&nbsp;&nbsp; ! elevation on .25x.25 grid - variable name 'data' - got dataset from site.</span><br>
<b><span style="color:red;background:white">&nbsp;*** NOTE: Axis coordinates are decreasing-ordered. Reversing ordering for axis lat</span></b><br>
<span style="color:blue">set region/x=74E:81E/y=8N:15N/l=1<br>
&nbsp;<br>
let mask1 = IF (data GE 0 AND data LT 100) THEN 1 else 1/0<br>
!let mask2 = IF (data GE 100 AND data LT 500) THEN 1 else 1/0<br>
&nbsp;<br>
&nbsp;<br>
let rf_100 = rainfall[D=1] * mask1<br>
!let rain_500 = rainfall * mask2<br>
&nbsp;<br>
plot rf_100[x=@ave,y=@ave,l=1:365]</span><br>
<span style="background:white">&nbsp;<span style="color:red">*** NOTE: Ambiguous coordinates on X axis: RAINFALL[D=1] * MASK1<br>
&nbsp;*** NOTE: Ambiguous coordinates on Y axis: RAINFALL[D=1] * MASK1<br>
&nbsp;*** NOTE: Ambiguous coordinates on T axis: RAINFALL[D=1] * MASK1<br>
&nbsp;**ERROR: inconsistent sizes of data regions: X axis<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; MASK1 has 28 points (I=297:324)<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; _expression_ has 29 points (I=31:59)</span></span><br>
<span style="color:blue">plot rf_100[x=@ave,y=@ave,l=1:365]</span><br>
<span style="color:blue">Command file, command group, or REPEAT execution aborted</span><br>
<span style="color:blue">yes? </span><br>
=================================================================<o:p></o:p></p>
</div>
</div>
</div>
</div>
</div>
</div>
<div>
<p class="MsoNormal"><o:p>&nbsp;</o:p></p>
<div>
<p class="MsoNormal">On Sat, Oct 17, 2015 at 9:58 AM, simon EK &lt;<a rel="nofollow" href="mailto:simonambat@xxxxxxxxx" target="_blank">simonambat@xxxxxxxxx</a>&gt; wrote:<o:p></o:p></p>
<div>
<div>
<div>
<div>
<div>
<div>
<div>
<p class="MsoNormal">Dear Andre,<o:p></o:p></p>
</div>
<p class="MsoNormal" style="margin-bottom:12.0pt">I saw the mail of Jorg and got the background information. Now I have to regrid the topo data to 1/4deg as in the rain data and proceed with the masking as clearly given in your mail.<o:p></o:p></p>
</div>
<p class="MsoNormal">Can you please help me in regridding 1 minute grid to 1/4 (0.25) deg as in rainfall data.<o:p></o:p></p>
</div>
<p class="MsoNormal" style="margin-bottom:12.0pt">(The rainfall data is on 1/4 deg xy grid with daily data for about 100 years).<o:p></o:p></p>
</div>
<p class="MsoNormal">Thanking you so much,<o:p></o:p></p>
</div>
<p class="MsoNormal">Regards<o:p></o:p></p>
</div>
<p class="MsoNormal"><span class="hoenzb"><span style="color:#888888">Simon</span></span><o:p></o:p></p>
</div>
<div>
<div>
<div>
<p class="MsoNormal"><o:p>&nbsp;</o:p></p>
<div>
<p class="MsoNormal">On Fri, Oct 16, 2015 at 10:04 PM, Andre Paim &lt;<a rel="nofollow" href="mailto:paim.oceano@xxxxxxxxx" target="_blank">paim.oceano@xxxxxxxxx</a>&gt; wrote:<o:p></o:p></p>
<div>
<p class="MsoNormal">Did you see Joerg's answer in you other e-mail? If you manage to have both data sets on the same grid, this should be easy enough to go from there.<o:p></o:p></p>
<div>
<p class="MsoNormal"><o:p>&nbsp;</o:p></p>
</div>
<div>
<p class="MsoNormal">About the masking, you would need to do something like:<o:p></o:p></p>
</div>
<div>
<p class="MsoNormal">(assuming you have topography variable called &quot;topo&quot;)<o:p></o:p></p>
</div>
<div>
<p class="MsoNormal"><o:p>&nbsp;</o:p></p>
</div>
<blockquote style="margin-left:30.0pt;margin-right:0cm">
<div>
<p class="MsoNormal">let mask1 = IF (topo GE 0 AND topo LT 100) THEN 1 else 1/0<o:p></o:p></p>
</div>
<div>
<p class="MsoNormal">let mask2 = IF (topo GE 100 AND topo LT 500) THEN 1 else 1/0<o:p></o:p></p>
</div>
</blockquote>
<div>
<p class="MsoNormal"><o:p>&nbsp;</o:p></p>
</div>
<div>
<p class="MsoNormal">Then you need to create a new variable containing only the data in the level you want:<o:p></o:p></p>
</div>
<div>
<p class="MsoNormal">(assuming a variable called &quot;rain&quot;)<o:p></o:p></p>
</div>
<div>
<p class="MsoNormal"><o:p>&nbsp;</o:p></p>
</div>
<blockquote style="margin-left:30.0pt;margin-right:0cm">
<div>
<p class="MsoNormal">let rain_100 = rain * mask1<o:p></o:p></p>
</div>
<div>
<p class="MsoNormal">let rain_500 = rain * mask2<o:p></o:p></p>
</div>
</blockquote>
<div>
<p class="MsoNormal"><o:p>&nbsp;</o:p></p>
</div>
<div>
<p class="MsoNormal">Now all you need to do is compute your average anyway you want.<o:p></o:p></p>
</div>
<div>
<p class="MsoNormal"><o:p>&nbsp;</o:p></p>
</div>
<div>
<p class="MsoNormal">Let me know if you have more questions.<o:p></o:p></p>
</div>
<div>
<p class="MsoNormal"><o:p>&nbsp;</o:p></p>
</div>
<div>
<p class="MsoNormal">Best regards,<o:p></o:p></p>
</div>
<div>
<p class="MsoNormal">Andre<o:p></o:p></p>
</div>
<div>
<p class="MsoNormal"><o:p>&nbsp;</o:p></p>
</div>
</div>
<div>
<div>
<div>
<p class="MsoNormal"><o:p>&nbsp;</o:p></p>
<div>
<p class="MsoNormal">On 16 October 2015 at 05:38, simon EK &lt;<a rel="nofollow" href="mailto:simonambat@xxxxxxxxx" target="_blank">simonambat@xxxxxxxxx</a>&gt; wrote:<o:p></o:p></p>
<div>
<div>
<div>
<div>
<div>
<div>
<div>
<div>
<div>
<div>
<div>
<div>
<p class="MsoNormal" style="margin-bottom:12.0pt">Dear Ferret users,<o:p></o:p></p>
</div>
<p class="MsoNormal">I have a daily rainfall dataset on .25x.25 grid and <o:p></o:p></p>
</div>
<p class="MsoNormal" style="margin-bottom:12.0pt">I have a topography dataset with 1 minute resolution.
<o:p></o:p></p>
</div>
<p class="MsoNormal">I would like to study the impact of altitude on rainfall.&nbsp; Hence I would like to get spacial averages of rainfall over different altitude regions, say<o:p></o:p></p>
</div>
<p class="MsoNormal">0 to 100 meters<o:p></o:p></p>
</div>
<p class="MsoNormal">100 to 500 meters<o:p></o:p></p>
</div>
<p class="MsoNormal">500 to 1000 meters<o:p></o:p></p>
</div>
<p class="MsoNormal">and above 1000 meters.<o:p></o:p></p>
</div>
<p class="MsoNormal" style="margin-bottom:12.0pt">I have seen certain ferret scripts&nbsp; using masking, etc.
<o:p></o:p></p>
</div>
<p class="MsoNormal" style="margin-bottom:12.0pt">Can you pl. help me?<o:p></o:p></p>
</div>
<p class="MsoNormal">Regards<o:p></o:p></p>
</div>
<p class="MsoNormal"><span style="color:#888888">Simon <o:p></o:p></span></p>
<div>
<p class="MsoNormal"><span style="color:#888888"><o:p>&nbsp;</o:p></span></p>
</div>
</div>
</div>
<p class="MsoNormal"><o:p>&nbsp;</o:p></p>
</div>
</div>
</div>
</div>
<p class="MsoNormal"><o:p>&nbsp;</o:p></p>
</div>
</div>
</div>
</div>
<p class="MsoNormal"><o:p>&nbsp;</o:p></p>
</div>
</div>


</td></tr></table>
<!--X-Body-of-Message-End-->
<!--X-MsgBody-End-->
<!--X-Follow-Ups-->
<hr>
<!--X-Follow-Ups-End-->
<!--X-References-->
<ul><li><strong>References</strong>:
<ul>
<li><strong><a name="00363" href="msg00363.html">[ferret_users] Ferret - masking based on altitude</a></strong>
<ul><li><em>From:</em> simon EK</li></ul></li>
<li><strong><a name="00365" href="msg00365.html">[ferret_users] Re: Ferret - masking based on altitude</a></strong>
<ul><li><em>From:</em> Andre Paim</li></ul></li>
<li><strong><a name="00369" href="msg00369.html">[ferret_users] Re: Ferret - masking based on altitude</a></strong>
<ul><li><em>From:</em> simon EK</li></ul></li>
</ul></li></ul>
<!--X-References-End-->
<!--X-BotPNI-->
<UL>
<li>Previous by thread:
<strong><a href="msg00370.html">RE: [ferret_users] Re: Ferret - masking based on altitude</a></strong>
</li>
<li>Next by thread:
<strong><a href="msg00372.html">Re: [ferret_users] Re: Ferret - masking based on altitude</a></strong>
</li>

</UL>
<center>[<a href="msg00370.html">Thread Prev</a>][<a href="msg00372.html">Thread Next</a>][<A HREF="threads.html#00371">Index</A>]</center>

<!--X-BotPNI-End-->
<!--X-User-Footer-->
<A HREF="http://ferret.pmel.noaa.gov/Ferret/contact-us">Contact Us</A>
<br>
<font size=-1>
<address>
<a href="http://www.doc.gov">Dept of Commerce</a> /
<a href="http://www.noaa.gov">NOAA</a> /
<a href="http://www.oar.noaa.gov">OAR</a> /
<a href="http://www.pmel.noaa.gov">PMEL</a> /
<a href="http://ferret.pmel.noaa.gov">Ferret</a>
</address>

<br>
 <a href="http://www.noaa.gov/privacy.html">Privacy Policy</a> | <a href="http://www.noaa.gov/disclaimer.html">Disclaimer</a> | <a href="accessibility.html">Accessibility Statement</a> 

</font>
<!--X-User-Footer-End-->
</body>
</html>
