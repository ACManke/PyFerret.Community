<!-- MHonArc v2.6.18 -->
<!--X-Subject: Re: [ExternalEmail] [ferret_users] Creating a multi&#45;file netcdf data set -->
<!--X-From-R13: Dhff Tvrqyre <ehffryy.svrqyreNpfveb.nh> -->
<!--X-Date: Mon, 23 Nov 2015 23:07:50 &#45;0800 -->
<!--X-Message-Id: 56540CBF.7040407@csiro.au -->
<!--X-Content-Type: multipart/alternative -->
<!--X-Reference: 1E74FF5406085D4BAD1F284CAF259FD34B34B84D@ExMBX01&#45;CDC.nexus.csiro.au -->
<!--X-Head-End-->
<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN"
        "http://www.w3.org/TR/html4/loose.dtd">
<html>
<head>
<title>Re: [ExternalEmail] [ferret_users] Creating a multi-file netcdf data set</title>
</head>
<body>
<!--X-Body-Begin-->
<!--X-User-Header-->
<!--X-User-Header-End-->
<!--X-TopPNI-->
<HR>
<center>[<a href="msg00447.html">Thread Prev</a>][<a href="msg00449.html">Thread Next</a>][<A HREF="threads.html#00448">Index</A>]</center>

<!--X-TopPNI-End-->
<!--X-MsgBody-->
<!--X-Subject-Header-Begin-->
<h1>Re: [ExternalEmail] [ferret_users] Creating a multi-file netcdf data set</h1>
<hr>
<!--X-Subject-Header-End-->
<!--X-Head-of-Message-->
<ul>
<li><strong>To</strong>: <strong><a href="mailto:ferret_users@DOMAIN.HIDDEN">ferret_users@xxxxxxxx</a></strong></li>
<li><strong>Subject</strong>: <strong>Re: [ExternalEmail] [ferret_users] Creating a multi-file netcdf data set</strong></li>
<li><strong>From</strong>: <strong>Russ Fiedler &lt;<a href="mailto:russell.fiedler@DOMAIN.HIDDEN">russell.fiedler@xxxxxxxx</a>&gt;</strong></li>
<li>Date: Tue, 24 Nov 2015 18:07:43 +1100</li>
<li>Dkim-signature: v=1; a=rsa-sha256; c=relaxed/relaxed;        d=noaa-gov.20150623.gappssmtp.com; s=20150623;        h=subject:to:references:from:message-id:date:user-agent:mime-version         :in-reply-to:content-type:x-original-sender         :x-original-authentication-results:precedence:mailing-list:list-id         :list-post:list-help:list-archive:list-unsubscribe;        bh=x9ynfz67UTHoSyCpq7z73/THiiv5GpQSdYKsHcNcH20=;        b=1eMPiVXOJw/7n3/yXXaqBF5X+Q0X5tsdGpzbAYzS44HkET1ZvbsOAHyh7oNDQGtqWz         Wl8v8BAOWkufpOvA0Ux3HL+y1x/C3lZBjzGDrxzFePF9ZUvGkyBYMPgJeH63WTDj7/Vr         l+1CSkZT0TnnsdkiitbfyZeAUj8nhtheLwEcs2w2sQqGsG+yLL1PKlUzlfCnTIyQDDsS         c5CYIgha8LkxdtyG+Dj9eCKJF2WZqSz+U8th7DVj+Rs+jq1c1CwpHwidqOALRt+6UNfc         WG8OP2514R1LnVrWaVQWAMzPzJVgFtcPTmB/CPTm5iNpXrTROKRk+jj4XuSAmIQI40Ry         pN2Q==</li>
<li>In-reply-to: &lt;<a href="msg00447.html">1E74FF5406085D4BAD1F284CAF259FD34B34B84D@ExMBX01-CDC.nexus.csiro.au</a>&gt;</li>
<li>List-archive: &lt;<a href="http://groups.google.com/a/noaa.gov/group/ferret_users/">http://groups.google.com/a/noaa.gov/group/ferret_users/</a>&gt;</li>
<li>List-help: &lt;<a href="http://support.google.com/a/noaa.gov/bin/topic.py?topic=25838">http://support.google.com/a/noaa.gov/bin/topic.py?topic=25838</a>&gt;, &lt;<a href="mailto:ferret_users+help@noaa.gov">mailto:ferret_users+help@noaa.gov</a>&gt;</li>
<li>List-id: &lt;ferret_users.noaa.gov&gt;</li>
<li>List-post: &lt;<a href="http://groups.google.com/a/noaa.gov/group/ferret_users/post">http://groups.google.com/a/noaa.gov/group/ferret_users/post</a>&gt;, &lt;<a href="mailto:ferret_users@noaa.gov">mailto:ferret_users@noaa.gov</a>&gt;</li>
<li>List-unsubscribe: &lt;<a href="mailto:googlegroups-manage+809428289204+unsubscribe@googlegroups.com">mailto:googlegroups-manage+809428289204+unsubscribe@googlegroups.com</a>&gt;, &lt;<a href="http://groups.google.com/a/noaa.gov/group/ferret_users/subscribe">http://groups.google.com/a/noaa.gov/group/ferret_users/subscribe</a>&gt;</li>
<li>Mailing-list: list <a href="mailto:ferret_users@DOMAIN.HIDDEN">ferret_users@xxxxxxxx</a>; contact <a href="mailto:ferret_users%2Bowners@DOMAIN.HIDDEN">ferret_users+owners@xxxxxxxx</a></li>
<li>References: &lt;<a href="msg00447.html">1E74FF5406085D4BAD1F284CAF259FD34B34B84D@ExMBX01-CDC.nexus.csiro.au</a>&gt;</li>
<li>Sender: <a href="mailto:owner-ferret_users@DOMAIN.HIDDEN">owner-ferret_users@xxxxxxxx</a></li>
<li>User-agent: Mozilla/5.0 (X11; Linux x86_64; rv:38.0) Gecko/20100101 Thunderbird/38.3.0</li>
</ul>
<!--X-Head-of-Message-End-->
<!--X-Head-Body-Sep-Begin-->
<hr>
<!--X-Head-Body-Sep-End-->
<!--X-Body-of-Message-->
<table width="100%"><tr><td bgcolor="#FFFFFF" style="background-color: #FFFFFF; color: #000000; "><font color="#000000">
  
  
    <div class="moz-cite-prefix"><br>
      Hi all,<br>
      <br>
      Just to clarify, Arnold is talking about the case where the date
      offset ("days since ....XXXX which gets translated to T0 in ferret
      speak) changes in each file that needs to be chained together. The
      existing tools (make_des and nc2mc)&#xA0; don't handle this case at the
      moment and in his case having<br>
      duplicate copies of the files isn't an option (terabyte and
      terabytes!). I think other peoples software relies on the original
      format so overwriting the units string and time values also isn't
      an option.<br>
      <br>
      There is obviously a fair bit hardwired here but it does serve as
      a template.<br>
      <br>
      <br>
      Another option would be to create a dummy axis t=1,2,3... if you
      know the number of timesteps per file and the ordering of files is
      straight forward then you can create a dummy descriptor files
      readily. The real time axis can be formed using ncrcat from NCO as
      it understands shifting baselines. @ASN maps things to the correct
      time axis.<br>
      <br>
      Cheers,<br>
      Russ<br>
      <br>
      <br>
      <br>
      On 24/11/15 16:14, <a rel="nofollow" class="moz-txt-link-abbreviated" href="mailto:Arnold.Sullivan@xxxxxxxx">Arnold.Sullivan@xxxxxxxx</a> wrote:<br>
    </div>
    <blockquote
cite=""
      type="cite">
      
      
      
      <div class="WordSection1">
        <p class="MsoNormal"><span style="color:#1F497D">Hi there,<o:p></o:p></span></p>
        <p class="MsoNormal"><span style="color:#1F497D"><o:p>&#xA0;</o:p></span></p>
        <p class="MsoNormal"><span style="color:#1F497D">I have problem
            to generate descriptor file.<o:p></o:p></span></p>
        <p class="MsoNormal"><span style="color:#1F497D">Since the old
            Perl file (</span><span
style="font-size:10.5pt;font-family:&quot;Arial&quot;,&quot;sans-serif&quot;;color:#006621;background:white">gfdl.noaa.gov/~atw/<b>ferret</b>/<b>make_des</b></span><span
            style="color:#1F497D">) which has been used to create ferret
            descriptor file has problem to handle the different based
            date of netCDF files, so I use NCL to do such job, hope it&#x2019;s
            useful.
            <o:p></o:p></span></p>
        <p class="MsoNormal"><span style="color:#1F497D"><o:p>&#xA0;</o:p></span></p>
        <p class="MsoNormal"><span style="color:#1F497D">Any concern
            please email me. (NCL is based on version 6.3.0). However if
            there is better way please email me as well.<o:p></o:p></span></p>
        <p class="MsoNormal"><span style="color:#1F497D"><o:p>&#xA0;</o:p></span></p>
        <p class="MsoNormal"><span style="color:#1F497D"><o:p>&#xA0;</o:p></span></p>
        <p class="MsoNormal"><span style="color:#1F497D">#####################################<o:p></o:p></span></p>
        <p class="MsoNormal"><span style="color:#1F497D"># controlling
            bash file</span><o:p></o:p></p>
        <p class="MsoNormal"><span style="color:#1F497D">#
            make_ferret_des_hxy599.sh</span><o:p></o:p></p>
        <p class="MsoNormal"><span style="color:#1F497D">#####################################<o:p></o:p></span></p>
        <p class="MsoNormal"><span style="color:#1F497D"><o:p>&#xA0;</o:p></span></p>
        <p class="MsoNormal"><span style="color:#1F497D">#!/bin/bash<o:p></o:p></span></p>
        <p class="MsoNormal"><span style="color:#1F497D">#PBS -P p66<o:p></o:p></span></p>
        <p class="MsoNormal"><span style="color:#1F497D">#PBS -q express<o:p></o:p></span></p>
        <p class="MsoNormal"><span style="color:#1F497D">#PBS -l
            walltime=00:05:00,ncpus=1,mem=4GB<o:p></o:p></span></p>
        <p class="MsoNormal"><span style="color:#1F497D">#PBS -N eof<o:p></o:p></span></p>
        <p class="MsoNormal"><span style="color:#1F497D">#PBS -l wd<o:p></o:p></span></p>
        <p class="MsoNormal"><span style="color:#1F497D">#<o:p></o:p></span></p>
        <p class="MsoNormal"><span style="color:#1F497D"><o:p>&#xA0;</o:p></span></p>
        <p class="MsoNormal"><span style="color:#1F497D">user=`whoami`<o:p></o:p></span></p>
        <p class="MsoNormal"><span style="color:#1F497D">owner="hxy599"<o:p></o:p></span></p>
        <p class="MsoNormal"><span style="color:#1F497D">expName="b96pi1"<o:p></o:p></span></p>
        <p class="MsoNormal"><span style="color:#1F497D"><o:p>&#xA0;</o:p></span></p>
        <p class="MsoNormal"><span style="color:#1F497D">#desc_dir="/g/data1/p66/ACCESSDIR/$owner/ACCESS/output/"$expName"/history/ocn"<o:p></o:p></span></p>
        <p class="MsoNormal"><span style="color:#1F497D">desc_dir="/short/p66/$owner/archive/$expName/history/ocn/"<o:p></o:p></span></p>
        <p class="MsoNormal"><span style="color:#1F497D">file_type="ocean_month"<o:p></o:p></span></p>
        <p class="MsoNormal"><span style="color:#1F497D">nfiles="$desc_dir/$file_type.nc*"<o:p></o:p></span></p>
        <p class="MsoNormal"><span style="color:#1F497D">ofile="$expName.$file_type.des"<o:p></o:p></span></p>
        <p class="MsoNormal"><span style="color:#1F497D">rm $ofile<o:p></o:p></span></p>
        <p class="MsoNormal"><span style="color:#1F497D"><o:p>&#xA0;</o:p></span></p>
        <p class="MsoNormal"><span style="color:#1F497D">##################<o:p></o:p></span></p>
        <p class="MsoNormal"><span style="color:#1F497D"># Output Header<o:p></o:p></span></p>
        <p class="MsoNormal"><span style="color:#1F497D">##################<o:p></o:p></span></p>
        <p class="MsoNormal"><span style="color:#1F497D">yyyy=0001 ##
            1850 ## 301<o:p></o:p></span></p>
        <p class="MsoNormal"><span style="color:#1F497D">mm=01<o:p></o:p></span></p>
        <p class="MsoNormal"><span style="color:#1F497D">dd=01<o:p></o:p></span></p>
        <p class="MsoNormal"><span style="color:#1F497D"><o:p>&#xA0;</o:p></span></p>
        <p class="MsoNormal"><span style="color:#1F497D"># Syntax
            //DELIMITER//. We use \/ because we need to escape the
            delimiter.<o:p></o:p></span></p>
        <p class="MsoNormal"><span style="color:#1F497D">DICT=(${nfiles//
            / })<o:p></o:p></span></p>
        <p class="MsoNormal"><span style="color:#1F497D">FIRST_PART=${DICT[${1}]}<o:p></o:p></span></p>
        <p class="MsoNormal"><span style="color:#1F497D"><o:p>&#xA0;</o:p></span></p>
        <p class="MsoNormal"><span style="color:#1F497D">header=1<o:p></o:p></span></p>
        <p class="MsoNormal"><span style="color:#1F497D">env \<o:p></o:p></span></p>
        <p class="MsoNormal"><span style="color:#1F497D">fName=${FIRST_PART}
            \<o:p></o:p></span></p>
        <p class="MsoNormal"><span style="color:#1F497D">yName=${yyyy} \<o:p></o:p></span></p>
        <p class="MsoNormal"><span style="color:#1F497D">mName=${mm} \<o:p></o:p></span></p>
        <p class="MsoNormal"><span style="color:#1F497D">dName=${dd} \<o:p></o:p></span></p>
        <p class="MsoNormal"><span style="color:#1F497D">desName=${ofile}
            \<o:p></o:p></span></p>
        <p class="MsoNormal"><span style="color:#1F497D">todoNum=${header}
            \<o:p></o:p></span></p>
        <p class="MsoNormal"><span style="color:#1F497D">ncl
            make_ferret_des_v1.0.0.ncl<o:p></o:p></span></p>
        <p class="MsoNormal"><span style="color:#1F497D"><o:p>&#xA0;</o:p></span></p>
        <p class="MsoNormal"><span style="color:#1F497D">##################<o:p></o:p></span></p>
        <p class="MsoNormal"><span style="color:#1F497D"># Output Start,
            End, and Delta Time<o:p></o:p></span></p>
        <p class="MsoNormal"><span style="color:#1F497D">##################<o:p></o:p></span></p>
        <p class="MsoNormal"><span style="color:#1F497D">header=2<o:p></o:p></span></p>
        <p class="MsoNormal"><span style="color:#1F497D">for fin in
            $nfiles<o:p></o:p></span></p>
        <p class="MsoNormal"><span style="color:#1F497D">do<o:p></o:p></span></p>
        <p class="MsoNormal"><span style="color:#1F497D"><o:p>&#xA0;</o:p></span></p>
        <p class="MsoNormal"><span style="color:#1F497D">env \<o:p></o:p></span></p>
        <p class="MsoNormal"><span style="color:#1F497D">fName=${fin} \<o:p></o:p></span></p>
        <p class="MsoNormal"><span style="color:#1F497D">yName=${yyyy} \<o:p></o:p></span></p>
        <p class="MsoNormal"><span style="color:#1F497D">mName=${mm} \<o:p></o:p></span></p>
        <p class="MsoNormal"><span style="color:#1F497D">dName=${dd} \<o:p></o:p></span></p>
        <p class="MsoNormal"><span style="color:#1F497D">desName=${ofile}
            \<o:p></o:p></span></p>
        <p class="MsoNormal"><span style="color:#1F497D">todoNum=${header}
            \<o:p></o:p></span></p>
        <p class="MsoNormal"><span style="color:#1F497D">ncl
            make_ferret_des_v1.0.0.ncl<o:p></o:p></span></p>
        <p class="MsoNormal"><span style="color:#1F497D"><o:p>&#xA0;</o:p></span></p>
        <p class="MsoNormal"><span style="color:#1F497D">done<o:p></o:p></span></p>
        <p class="MsoNormal"><span style="color:#1F497D"><o:p>&#xA0;</o:p></span></p>
        <p class="MsoNormal"><span style="color:#1F497D">##################<o:p></o:p></span></p>
        <p class="MsoNormal"><span style="color:#1F497D"># Output the
            ending parts<o:p></o:p></span></p>
        <p class="MsoNormal"><span style="color:#1F497D">##################<o:p></o:p></span></p>
        <p class="MsoNormal"><span style="color:#1F497D">header=3<o:p></o:p></span></p>
        <p class="MsoNormal"><span style="color:#1F497D">env \<o:p></o:p></span></p>
        <p class="MsoNormal"><span style="color:#1F497D">desName=${ofile}
            \<o:p></o:p></span></p>
        <p class="MsoNormal"><span style="color:#1F497D">todoNum=${header}
            \<o:p></o:p></span></p>
        <p class="MsoNormal"><span style="color:#1F497D">ncl
            make_ferret_des_v1.0.0.ncl<o:p></o:p></span></p>
        <p class="MsoNormal"><span style="color:#1F497D"><o:p>&#xA0;</o:p></span></p>
        <p class="MsoNormal"><span style="color:#1F497D"><o:p>&#xA0;</o:p></span></p>
        <p class="MsoNormal"><span style="color:#1F497D"><o:p>&#xA0;</o:p></span></p>
        <p class="MsoNormal"><span style="color:#1F497D"><o:p>&#xA0;</o:p></span></p>
        <p class="MsoNormal"><span style="color:#1F497D">#####################################<o:p></o:p></span></p>
        <p class="MsoNormal"><span style="color:#1F497D"># main ncl file</span><o:p></o:p></p>
        <p class="MsoNormal"><span style="color:#1F497D">#
            make_ferret_des_v1.0.0.ncl</span><o:p></o:p></p>
        <p class="MsoNormal"><span style="color:#1F497D">#####################################<o:p></o:p></span></p>
        <p class="MsoNormal"><span style="color:#1F497D"><o:p>&#xA0;</o:p></span></p>
        <p class="MsoNormal">;; make_ferret_des - create descriptor file
          for ferret<o:p></o:p></p>
        <p class="MsoNormal">;;<o:p></o:p></p>
        <p class="MsoNormal">;; history : 16-11-2015 Created&#xA0; by Arnold
          Sullivan<o:p></o:p></p>
        <p class="MsoNormal">;;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0; Hailin
          Yan<o:p></o:p></p>
        <p class="MsoNormal">;; E-Mail: <a rel="nofollow" class="moz-txt-link-abbreviated" href="mailto:arnold.sullivan@xxxxxxxx">arnold.sullivan@xxxxxxxx</a><o:p></o:p></p>
        <p class="MsoNormal">;;<o:p></o:p></p>
        <p class="MsoNormal">;;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0; Remove yyyy, mm, dd<o:p></o:p></p>
        <p class="MsoNormal">;;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0; time units get from
          first netCDF file<o:p></o:p></p>
        <p class="MsoNormal">;; package : make_ferret_des_vx.x.x.ncl<o:p></o:p></p>
        <p class="MsoNormal">;; version : 1.0.1<o:p></o:p></p>
        <p class="MsoNormal">;; how to use:<o:p></o:p></p>
        <p class="MsoNormal">;;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0; use bash script to run this
          script<o:p></o:p></p>
        <p class="MsoNormal">;;<o:p></o:p></p>
        <p class="MsoNormal">;; input : iFile&#xA0;&#xA0; : string, input netCDF
          file name<o:p></o:p></p>
        <p class="MsoNormal">;;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0; desName : string, des file name<o:p></o:p></p>
        <p class="MsoNormal">;;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0; todoNum : string, (1: heading),
          (2: delta time), (3: ending),
          <o:p></o:p></p>
        <p class="MsoNormal">;; output: directly write into desName as
          text<o:p></o:p></p>
        <p class="MsoNormal">;;<o:p></o:p></p>
        <p class="MsoNormal"><o:p>&#xA0;</o:p></p>
        <p class="MsoNormal">;; Procedures<o:p></o:p></p>
        <p class="MsoNormal">;;<o:p></o:p></p>
        <p class="MsoNormal">;; get_header - output the header to the
          descriptor file for ferret<o:p></o:p></p>
        <p class="MsoNormal">;;<o:p></o:p></p>
        <p class="MsoNormal">;; input : iFile&#xA0;&#xA0; : string, input netCDF
          file name<o:p></o:p></p>
        <p class="MsoNormal">;;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0; desName : string, des file name<o:p></o:p></p>
        <p class="MsoNormal">;;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0; todoNum : string, (1: heading),
          (2: delta time), (3: ending),
          <o:p></o:p></p>
        <p class="MsoNormal">;; output: directly write into desName as
          text<o:p></o:p></p>
        <p class="MsoNormal">;;<o:p></o:p></p>
        <p class="MsoNormal">undef ("get_header")<o:p></o:p></p>
        <p class="MsoNormal">function get_header(&#xA0; iFile:string,
          desName:string )<o:p></o:p></p>
        <p class="MsoNormal">begin<o:p></o:p></p>
        <p class="MsoNormal"><o:p>&#xA0;</o:p></p>
        <p class="MsoNormal">&#xA0; ofile = desName<o:p></o:p></p>
        <p class="MsoNormal">&#xA0; fName&#xA0; = iFile<o:p></o:p></p>
        <p class="MsoNormal">&#xA0; fin&#xA0;&#xA0;&#xA0; = addfile(fName,"r")<o:p></o:p></p>
        <p class="MsoNormal">&#xA0; ftitle = fin@title<o:p></o:p></p>
        <p class="MsoNormal">&#xA0; TIME&#xA0;&#xA0; = fin-&gt;time<o:p></o:p></p>
        <p class="MsoNormal">&#xA0; tunits&#xA0; = TIME@units<o:p></o:p></p>
        <p class="MsoNormal">&#xA0; tctype&#xA0; = TIME@calendar<o:p></o:p></p>
        <p class="MsoNormal">&#xA0; new_time_units = tunits<o:p></o:p></p>
        <p class="MsoNormal"><o:p>&#xA0;</o:p></p>
        <p class="MsoNormal">header = (/"&amp;FORMAT_RECORD", \<o:p></o:p></p>
        <p class="MsoNormal">&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0; "&#xA0;&#xA0; D_TYPE&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0; = '&#xA0;
          MC'", \<o:p></o:p></p>
        <p class="MsoNormal">&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0; "&#xA0;&#xA0; D_FORMAT&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0; = '&#xA0;
          1A'", \<o:p></o:p></p>
        <p class="MsoNormal">&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0; &#xA0;&#xA0;&#xA0; "/"/)<o:p></o:p></p>
        <p class="MsoNormal">tmhead&#xA0; = (/"", \<o:p></o:p></p>
        <p class="MsoNormal">&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0; "&amp;BACKGROUND_RECORD", \<o:p></o:p></p>
        <p class="MsoNormal">&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0; "&#xA0;&#xA0; D_TITLE&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0; =
          '"+ftitle+"'", \<o:p></o:p></p>
        <p class="MsoNormal">&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0; "&#xA0;&#xA0; D_T0TIME&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0; =
          '"+tunits+"'", \<o:p></o:p></p>
        <p class="MsoNormal">&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0; "&#xA0;&#xA0; D_TIME_UNIT&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0; &#xA0;=
          86400", \<o:p></o:p></p>
        <p class="MsoNormal">&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0; "&#xA0;&#xA0; D_TIME_MODULO&#xA0;&#xA0;&#xA0;&#xA0;&#xA0; =
          .FALSE.", \<o:p></o:p></p>
        <p class="MsoNormal">&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0; "&#xA0;&#xA0; D_CALTYPE&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0; =
          '"+tctype+"'", \<o:p></o:p></p>
        <p class="MsoNormal">&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0; "/"/)<o:p></o:p></p>
        <p class="MsoNormal"><o:p>&#xA0;</o:p></p>
        <p class="MsoNormal">msghead = (/"", \<o:p></o:p></p>
        <p class="MsoNormal">&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0; "&amp;MESSAGE_RECORD", \<o:p></o:p></p>
        <p class="MsoNormal">&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0; "&#xA0;&#xA0; D_MESSAGE&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0; = ' '",
          \<o:p></o:p></p>
        <p class="MsoNormal">&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0; "&#xA0;&#xA0; D_ALERT_ON_OPEN&#xA0;&#xA0;&#xA0; =
          .FALSE.", \<o:p></o:p></p>
        <p class="MsoNormal">&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0; "&#xA0;&#xA0; D_ALERT_ON_OUTPUT&#xA0; =
          .FALSE.", \<o:p></o:p></p>
        <p class="MsoNormal">&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0; "/"/)<o:p></o:p></p>
        <p class="MsoNormal"><o:p>&#xA0;</o:p></p>
        <p class="MsoNormal">exthead = (/"", \<o:p></o:p></p>
        <p class="MsoNormal">&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0; "&amp;EXTRA_RECORD",\<o:p></o:p></p>
        <p class="MsoNormal">&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0; "/"/)<o:p></o:p></p>
        <p class="MsoNormal"><o:p>&#xA0;</o:p></p>
        <p class="MsoNormal">hlist = [/header/]<o:p></o:p></p>
        <p class="MsoNormal">tlist = [/tmhead/]<o:p></o:p></p>
        <p class="MsoNormal">mlist = [/msghead/]<o:p></o:p></p>
        <p class="MsoNormal">elist = [/exthead/]<o:p></o:p></p>
        <p class="MsoNormal"><o:p>&#xA0;</o:p></p>
        <p class="MsoNormal">write_table(ofile, "w", hlist, "%s")<o:p></o:p></p>
        <p class="MsoNormal">write_table(ofile, "a", tlist, "%s")<o:p></o:p></p>
        <p class="MsoNormal">write_table(ofile, "a", mlist, "%s")<o:p></o:p></p>
        <p class="MsoNormal">write_table(ofile, "a", elist, "%s")<o:p></o:p></p>
        <p class="MsoNormal"><o:p>&#xA0;</o:p></p>
        <p class="MsoNormal">return(new_time_units)<o:p></o:p></p>
        <p class="MsoNormal"><o:p>&#xA0;</o:p></p>
        <p class="MsoNormal">end<o:p></o:p></p>
        <p class="MsoNormal"><o:p>&#xA0;</o:p></p>
        <p class="MsoNormal"><o:p>&#xA0;</o:p></p>
        <p class="MsoNormal">;; get_deltatime - output start, end, and
          delta time for each netCDF file<o:p></o:p></p>
        <p class="MsoNormal">;;<o:p></o:p></p>
        <p class="MsoNormal">;; input : iFile&#xA0;&#xA0; : string, input netCDF
          file name<o:p></o:p></p>
        <p class="MsoNormal">;;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0; yName&#xA0;&#xA0; : integer, year num<o:p></o:p></p>
        <p class="MsoNormal">;;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0; mName&#xA0;&#xA0; : integer, month num<o:p></o:p></p>
        <p class="MsoNormal">;;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0; dName&#xA0;&#xA0; : integer, day num<o:p></o:p></p>
        <p class="MsoNormal">;;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0; desName : string, des file name<o:p></o:p></p>
        <p class="MsoNormal">;;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0; todoNum : string, (1: heading),
          (2: delta time), (3: ending),
          <o:p></o:p></p>
        <p class="MsoNormal">;; output: directly write into desName as
          text<o:p></o:p></p>
        <p class="MsoNormal">;;<o:p></o:p></p>
        <p class="MsoNormal">undef ("get_deltatime")<o:p></o:p></p>
        <p class="MsoNormal">procedure get_deltatime( iFile:string,&#xA0;
          desName:string,new_time_units:string )<o:p></o:p></p>
        <p class="MsoNormal">begin<o:p></o:p></p>
        <p class="MsoNormal"><o:p>&#xA0;</o:p></p>
        <p class="MsoNormal">ofile = desName<o:p></o:p></p>
        <p class="MsoNormal">&#xA0; fName&#xA0; = iFile<o:p></o:p></p>
        <p class="MsoNormal">&#xA0; fin&#xA0;&#xA0;&#xA0; = addfile(fName,"r")<o:p></o:p></p>
        <p class="MsoNormal">&#xA0; ftitle = fin@title<o:p></o:p></p>
        <p class="MsoNormal">&#xA0; TIME&#xA0;&#xA0; = fin-&gt;time<o:p></o:p></p>
        <p class="MsoNormal">&#xA0; tunits&#xA0; = TIME@units<o:p></o:p></p>
        <p class="MsoNormal">&#xA0; tctype&#xA0; = TIME@calendar<o:p></o:p></p>
        <p class="MsoNormal">&#xA0; tsize&#xA0;&#xA0; = dimsizes(time)<o:p></o:p></p>
        <p class="MsoNormal">&#xA0; time&#xA0;&#xA0;&#xA0; = time_to_newtime(TIME,
          new_time_units)<o:p></o:p></p>
        <p class="MsoNormal"><o:p>&#xA0;</o:p></p>
        <p class="MsoNormal">&#xA0; if tsize.lt.2 then<o:p></o:p></p>
        <p class="MsoNormal">&#xA0;&#xA0;&#xA0; tdelta = 1<o:p></o:p></p>
        <p class="MsoNormal">&#xA0; else<o:p></o:p></p>
        <p class="MsoNormal">&#xA0;&#xA0;&#xA0; tdelta&#xA0; = (time(tsize-1) -
          time(0))/(tsize-1)<o:p></o:p></p>
        <p class="MsoNormal">&#xA0; end if<o:p></o:p></p>
        <p class="MsoNormal"><o:p>&#xA0;</o:p></p>
        <p class="MsoNormal">endhead = (/"", \<o:p></o:p></p>
        <p class="MsoNormal">&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0; "&amp;STEPFILE_RECORD",\", \<o:p></o:p></p>
        <p class="MsoNormal">&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0; "&#xA0;&#xA0; S_FILENAME&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0; =
          '"+fName+"'", \<o:p></o:p></p>
        <p class="MsoNormal">&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0; "&#xA0;&#xA0; S_AUX_SET_NUM&#xA0;&#xA0;&#xA0;&#xA0;&#xA0; = 0", \<o:p></o:p></p>
        <p class="MsoNormal">&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0; "&#xA0;&#xA0; S_START&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0; =
          "+time(0), \<o:p></o:p></p>
        <p class="MsoNormal">&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0; &#xA0;&#xA0;&#xA0;&#xA0;"&#xA0;&#xA0; S_END&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0; =
          "+time(tsize-1), \<o:p></o:p></p>
        <p class="MsoNormal">&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0; "&#xA0;&#xA0; S_DELTA&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0; =
          "+tdelta, \<o:p></o:p></p>
        <p class="MsoNormal">&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0; "&#xA0;&#xA0; S_NUM_OF_FILES&#xA0;&#xA0;&#xA0;&#xA0; = 1", \<o:p></o:p></p>
        <p class="MsoNormal">&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0; "&#xA0;&#xA0; S_REGVARFLAG&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0; = ' '",
          \<o:p></o:p></p>
        <p class="MsoNormal">&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0; "/"/)<o:p></o:p></p>
        <p class="MsoNormal"><o:p>&#xA0;</o:p></p>
        <p class="MsoNormal">elist = [/endhead/]<o:p></o:p></p>
        <p class="MsoNormal"><o:p>&#xA0;</o:p></p>
        <p class="MsoNormal"><o:p>&#xA0;</o:p></p>
        <p class="MsoNormal">write_table(ofile, "a", elist, "%s")<o:p></o:p></p>
        <p class="MsoNormal"><o:p>&#xA0;</o:p></p>
        <p class="MsoNormal">end<o:p></o:p></p>
        <p class="MsoNormal"><o:p>&#xA0;</o:p></p>
        <p class="MsoNormal"><o:p>&#xA0;</o:p></p>
        <p class="MsoNormal">;; get_ending - output the ending part of
          the descriptor file for ferret<o:p></o:p></p>
        <p class="MsoNormal">;;<o:p></o:p></p>
        <p class="MsoNormal">;; input : desName : string, des file name<o:p></o:p></p>
        <p class="MsoNormal">;; output: directly write into desName as
          text<o:p></o:p></p>
        <p class="MsoNormal">;;<o:p></o:p></p>
        <p class="MsoNormal">undef ("get_ending")<o:p></o:p></p>
        <p class="MsoNormal">procedure get_ending( desName:string )<o:p></o:p></p>
        <p class="MsoNormal">begin<o:p></o:p></p>
        <p class="MsoNormal"><o:p>&#xA0;</o:p></p>
        <p class="MsoNormal">ofile = desName<o:p></o:p></p>
        <p class="MsoNormal">endhead = (/"", \<o:p></o:p></p>
        <p class="MsoNormal">&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0; "&amp;STEPFILE_RECORD",\", \<o:p></o:p></p>
        <p class="MsoNormal">&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0; "&#xA0; S_FILENAME&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0; = '**END
          OF STEPFILES**'", \<o:p></o:p></p>
        <p class="MsoNormal">&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0; "/"/)<o:p></o:p></p>
        <p class="MsoNormal"><o:p>&#xA0;</o:p></p>
        <p class="MsoNormal">elist = [/endhead/]<o:p></o:p></p>
        <p class="MsoNormal"><o:p>&#xA0;</o:p></p>
        <p class="MsoNormal">write_table(ofile, "a", elist, "%s")<o:p></o:p></p>
        <p class="MsoNormal">end<o:p></o:p></p>
        <p class="MsoNormal"><o:p>&#xA0;</o:p></p>
        <p class="MsoNormal">;*************************************************<o:p></o:p></p>
        <p class="MsoNormal">load
          "$NCARG_ROOT/lib/ncarg/nclscripts/csm/gsn_code.ncl"<o:p></o:p></p>
        <p class="MsoNormal">load
          "$NCARG_ROOT/lib/ncarg/nclscripts/csm/gsn_csm.ncl"<o:p></o:p></p>
        <p class="MsoNormal">load
          "$NCARG_ROOT/lib/ncarg/nclscripts/csm/contributed.ncl"<o:p></o:p></p>
        <p class="MsoNormal">;************************************************<o:p></o:p></p>
        <p class="MsoNormal">begin<o:p></o:p></p>
        <p class="MsoNormal">;************************************************<o:p></o:p></p>
        <p class="MsoNormal">; variable and file handling<o:p></o:p></p>
        <p class="MsoNormal">;************************************************<o:p></o:p></p>
        <p class="MsoNormal">&#xA0; fName&#xA0; = getenv("fName") ;;
          "ocean_month.nc-00970331"<o:p></o:p></p>
        <p class="MsoNormal">&#xA0; desName= getenv("desName") ;; "list.des"<o:p></o:p></p>
        <p class="MsoNormal">&#xA0; todoNum=getenv("todoNum")<o:p></o:p></p>
        <p class="MsoNormal"><o:p>&#xA0;</o:p></p>
        <p class="MsoNormal">&#xA0; if todoNum.eq.1 then<o:p></o:p></p>
        <p class="MsoNormal">&#xA0;&#xA0;&#xA0; ntUnits = get_header(fName,desName)<o:p></o:p></p>
        <p class="MsoNormal">&#xA0; else if todoNum.eq.2 then<o:p></o:p></p>
        <p class="MsoNormal">&#xA0;&#xA0;&#xA0; get_deltatime(fName,desName,ntUnits)<o:p></o:p></p>
        <p class="MsoNormal">&#xA0; else if todoNum.eq.3 then<o:p></o:p></p>
        <p class="MsoNormal">&#xA0;&#xA0;&#xA0; get_ending(desName)<o:p></o:p></p>
        <p class="MsoNormal">&#xA0; end if<o:p></o:p></p>
        <p class="MsoNormal">&#xA0; end if<o:p></o:p></p>
        <p class="MsoNormal">&#xA0; end if<o:p></o:p></p>
        <p class="MsoNormal"><o:p>&#xA0;</o:p></p>
        <p class="MsoNormal"><o:p>&#xA0;</o:p></p>
        <p class="MsoNormal"><o:p>&#xA0;</o:p></p>
        <p class="MsoNormal"><o:p>&#xA0;</o:p></p>
        <p class="MsoNormal">end<o:p></o:p></p>
        <p class="MsoNormal"><o:p>&#xA0;</o:p></p>
        <p class="MsoNormal"><o:p>&#xA0;</o:p></p>
      </div>
    </blockquote>
    <br>
  

</font></td></tr></table>
<!--X-Body-of-Message-End-->
<!--X-MsgBody-End-->
<!--X-Follow-Ups-->
<hr>
<!--X-Follow-Ups-End-->
<!--X-References-->
<ul><li><strong>References</strong>:
<ul>
<li><strong><a name="00447" href="msg00447.html">[ferret_users] Creating a multi-file netcdf data set</a></strong>
<ul><li><em>From:</em> Arnold.Sullivan</li></ul></li>
</ul></li></ul>
<!--X-References-End-->
<!--X-BotPNI-->
<UL>
<li>Previous by thread:
<strong><a href="msg00447.html">[ferret_users] Creating a multi-file netcdf data set</a></strong>
</li>
<li>Next by thread:
<strong><a href="msg00449.html">[ferret_users] normalised coordinates for colour bar</a></strong>
</li>

</UL>
<center>[<a href="msg00447.html">Thread Prev</a>][<a href="msg00449.html">Thread Next</a>][<A HREF="threads.html#00448">Index</A>]</center>

<!--X-BotPNI-End-->
<!--X-User-Footer-->
<A HREF="http://ferret.pmel.noaa.gov/Ferret/contact-us">Contact Us</A>
<br>
<font size=-1>
<address>
<a href="http://www.doc.gov">Dept of Commerce</a> /
<a href="http://www.noaa.gov">NOAA</a> /
<a href="http://www.oar.noaa.gov">OAR</a> /
<a href="http://www.pmel.noaa.gov">PMEL</a> /
<a href="http://ferret.pmel.noaa.gov">Ferret</a>
</address>

<br>
 <a href="http://www.noaa.gov/privacy.html">Privacy Policy</a> | <a href="http://www.noaa.gov/disclaimer.html">Disclaimer</a> | <a href="accessibility.html">Accessibility Statement</a> 

</font>
<!--X-User-Footer-End-->
</body>
</html>
