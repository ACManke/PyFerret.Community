<!-- MHonArc v2.6.18 -->
<!--X-Subject: Re: [ferret_users] Extrapolate over land. -->
<!--X-From-R13: Enatrrgu [ <xizxxebzfNtznvy.pbz> -->
<!--X-Date: Tue, 16 Feb 2016 21:44:42 &#45;0800 -->
<!--X-Message-Id: CALhc18waR3DQtWzzR8Vd_e&#45;FGMwtAO4ER5fP4LUUsvvaeXs9Ng@mail.gmail.com -->
<!--X-Content-Type: multipart/alternative -->
<!--X-Reference: CALhc18w73EbTY5Ldtx5XDGwZLxW+D3Wk+UpFU5vitH9rxGfx2g@mail.gmail.com -->
<!--X-Reference: 56C38E3A.4080803@io&#45;warnemuende.de -->
<!--X-Reference: 56C39103.1050402@io&#45;warnemuende.de -->
<!--X-Head-End-->
<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN"
        "http://www.w3.org/TR/html4/loose.dtd">
<html>
<head>
<title>Re: [ferret_users] Extrapolate over land.</title>
</head>
<body>
<!--X-Body-Begin-->
<!--X-User-Header-->
<!--X-User-Header-End-->
<!--X-TopPNI-->
<HR>
<center>[<a href="msg00128.html">Thread Prev</a>][<a href="msg00138.html">Thread Next</a>][<A HREF="threads.html#00129">Index</A>]</center>

<!--X-TopPNI-End-->
<!--X-MsgBody-->
<!--X-Subject-Header-Begin-->
<h1>Re: [ferret_users] Extrapolate over land.</h1>
<hr>
<!--X-Subject-Header-End-->
<!--X-Head-of-Message-->
<ul>
<li><strong>To</strong>: <strong><a href="mailto:martin.schmidt@DOMAIN.HIDDEN">martin.schmidt@xxxxxxxxxxxxxxxxx</a></strong></li>
<li><strong>Subject</strong>: <strong>Re: [ferret_users] Extrapolate over land.</strong></li>
<li><strong>From</strong>: <strong>Sangeeth M &lt;<a href="mailto:kvmkkroms@DOMAIN.HIDDEN">kvmkkroms@xxxxxxxxx</a>&gt;</strong></li>
<li>Date: Wed, 17 Feb 2016 11:14:40 +0530</li>
<li>Cc: ferret &lt;<a href="mailto:ferret_users@DOMAIN.HIDDEN">ferret_users@xxxxxxxx</a>&gt;</li>
<li>Dkim-signature: v=1; a=rsa-sha256; c=relaxed/relaxed;        d=noaa-gov.20150623.gappssmtp.com; s=20150623;        h=mime-version:in-reply-to:references:date:message-id:subject:from:to         :cc:content-type:x-original-sender:x-original-authentication-results         :precedence:mailing-list:list-id:list-post:list-help:list-archive         :list-unsubscribe;        bh=XJQKaDchp/30je8kyoR/KZdkdbMJmYnmJESreTGPK5w=;        b=1vogE7IkLOQTOKl6XSfzn9nkPLPV64mriTgLmKxYIXyXTQRcshy0wOzhyvhQ2KZmJv         fNBt/C1fmqo6I+8+AhUpYdBRXnggGJ3AMbMIOzGPhjoXOIYX5YDIbtowgG2B9yb0H8ce         F2YUH8qNVJeMqGrd4CsnR/nD2qWLolhpWROr1285O/p75ibzuXY5ySfqKdcADKBF9eoV         eueaPb3QbCE7tyJR+a+p2chhFTgKu742dHW0vpEzUPo0U3+blzSzMeiCzmky8D/dqLcX         snQEL4YPeX9NyoIN40NTk6A1rtGAHBQQVSmjG8R26RDisnCbAVsRrWhcLyeFPPXEw6AP         fvhg==</li>
<li>In-reply-to: &lt;<a href="msg00128.html">56C39103.1050402@io-warnemuende.de</a>&gt;</li>
<li>List-archive: &lt;<a href="https://groups.google.com/a/noaa.gov/group/ferret_users/">https://groups.google.com/a/noaa.gov/group/ferret_users/</a>&gt;</li>
<li>List-help: &lt;<a href="https://support.google.com/a/noaa.gov/bin/topic.py?topic=25838">https://support.google.com/a/noaa.gov/bin/topic.py?topic=25838</a>&gt;, &lt;<a href="mailto:ferret_users+help@noaa.gov">mailto:ferret_users+help@noaa.gov</a>&gt;</li>
<li>List-id: &lt;ferret_users.noaa.gov&gt;</li>
<li>List-post: &lt;<a href="https://groups.google.com/a/noaa.gov/group/ferret_users/post">https://groups.google.com/a/noaa.gov/group/ferret_users/post</a>&gt;, &lt;<a href="mailto:ferret_users@noaa.gov">mailto:ferret_users@noaa.gov</a>&gt;</li>
<li>List-unsubscribe: &lt;<a href="mailto:googlegroups-manage+809428289204+unsubscribe@googlegroups.com">mailto:googlegroups-manage+809428289204+unsubscribe@googlegroups.com</a>&gt;, &lt;<a href="https://groups.google.com/a/noaa.gov/group/ferret_users/subscribe">https://groups.google.com/a/noaa.gov/group/ferret_users/subscribe</a>&gt;</li>
<li>Mailing-list: list <a href="mailto:ferret_users@DOMAIN.HIDDEN">ferret_users@xxxxxxxx</a>; contact <a href="mailto:ferret_users%2Bowners@DOMAIN.HIDDEN">ferret_users+owners@xxxxxxxx</a></li>
<li>References: &lt;<a href="msg00124.html">CALhc18w73EbTY5Ldtx5XDGwZLxW+D3Wk+UpFU5vitH9rxGfx2g@mail.gmail.com</a>&gt;	&lt;56C38E3A.4080803@io-warnemuende.de&gt;	&lt;<a href="msg00128.html">56C39103.1050402@io-warnemuende.de</a>&gt;</li>
<li>Sender: <a href="mailto:owner-ferret_users@DOMAIN.HIDDEN">owner-ferret_users@xxxxxxxx</a></li>
</ul>
<!--X-Head-of-Message-End-->
<!--X-Head-Body-Sep-Begin-->
<hr>
<!--X-Head-Body-Sep-End-->
<!--X-Body-of-Message-->
<div dir="ltr"><div>Hi Martin,<br></div>Thanks for your detailed reply. I am trying to use the COADS monthly climatology data for forcing my model and you are absolutely right that model needs reasonable values over the land preferably the values extrapolated from ocean. I will try with your tips and inform you. I have one more doubt that, the third argument of the fill_xy function, how can I decide the proper value for it? <br></div><div class="gmail_extra"><br><div class="gmail_quote">On Wed, Feb 17, 2016 at 2:43 AM, Martin Schmidt <span dir="ltr">&lt;<a rel="nofollow" href="mailto:martin.schmidt@xxxxxxxxxxxxxxxxx" target="_blank">martin.schmidt@xxxxxxxxxxxxxxxxx</a>&gt;</span> wrote:<br><blockquote class="gmail_quote" style="margin:0 0 0 .8ex;border-left:1px #ccc solid;padding-left:1ex"><div class="HOEnZb"><div class="h5">Sangeeth,<br>
which data are you using? If they are defined on a regular grid there are also grid points over land. I guess, the data are set to &quot;missing&quot; there. This may confuse your ocean model, since the &quot;missing&quot; may be interpreted as some valid number, say some really high wind speed. This could crash the model. If you interpolate such data onto your model grid the missing values have to be considered carefully.<br>
<br>
So you may want to replace the missing values by some reaonable number, say 0, before you interpolate or read the data into your model. This is simple.<br>
<br>
use <a rel="nofollow" href="http://your_file.nc" rel="noreferrer" target="_blank">your_file.nc</a><br>
<br>
let wx = missing(windx,0)<br>
let wy = missing(windy,0)<br>
<br>
save/file=<a rel="nofollow" href="http://your_new_file.nc/clobber" rel="noreferrer" target="_blank">your_new_file.nc/clobber</a> wx, wy<br>
<br>
I expect the data set is large.&#xA0; So you may want to save time step by time step or allocate more memory:<br>
sp rm <a rel="nofollow" href="http://your_new_file.nc" rel="noreferrer" target="_blank">your_new_file.nc</a><br>
repeat/l=1:some_large_number&#xA0; save/append/file=<a rel="nofollow" href="http://your_new_file.nc" rel="noreferrer" target="_blank">your_new_file.nc</a> wx, wy<br>
<br>
This shows the principle. Getting the number of time steps is easy, just issue &quot;show data&quot;. You may also read the maximum number of time steps from the data set, but I recommend to read through the manual and the tutorial anyway.<br>
<br>
Recent versions of ferret write real*8 output. To save disk space you may specify<br>
<br>
save/file=<a rel="nofollow" href="http://your_new_file.nc/clobber/outtype=float" rel="noreferrer" target="_blank">your_new_file.nc/clobber/outtype=float</a> wx, wy<br>
<br>
This may solve your problem. But I guess, your input data need interpolation to the model grid. Having zeros there, leads to reduced winds near the coast with a lot of consequences for near-shore currents.<br>
<br>
So you need to make a decision what to do with coastal points:<br>
- set the winds to some reasonable value for land points. How to, just described...<br>
- extrapolate the ocean values into land, before you interpolate onto the model grid. ferret has nearest neighbour fillers @fnr but these are working only in one direction. See the manual. An alternative is fill_xy, which extrapolates into land by replacing land with averages over all valid neighbour points. Doing this repeatedly may give very smoothed extrapolation. Especially, value may never run away. This sounds difficult, but is simple. Use the coads winds as example<br>
<br>
yes? use coads_climatology<br>
! the function needs a mask, that is 1, where filling is allowed. Below we generate a field on the wind grid that is 1 everywhere.<br>
yes? let mask = 0*missing(uwnd,0)+1<br>
yes? let wx = fill_xy(uwnd,mask,1)&#xA0; &#xA0; &#xA0; &#xA0; &#xA0; &#xA0; &#xA0; &#xA0; &#xA0; &#xA0; &#xA0;! fill in one cycle only<br>
<br>
yes? shade /l=1 wx<br>
<br>
shows the wind field, where one coastal point is filled. Now you may play around with the number of cycles:<br>
yes? let wx = fill_xy(uwnd,mask,5)&#xA0; &#xA0; &#xA0; &#xA0; &#xA0; &#xA0; &#xA0; &#xA0; &#xA0; &#xA0; &#xA0;! fill now in five cycles<br>
yes? shade /l=1 wx<br>
<br>
I think this shows the ideas and I hope this helps to get you started.<br>
<br>
Greetings,<br>
Martin<br>
</div></div></blockquote></div><br></div>

<!--X-Body-of-Message-End-->
<!--X-MsgBody-End-->
<!--X-Follow-Ups-->
<hr>
<ul><li><strong>Follow-Ups</strong>:
<ul>
<li><strong><a name="00138" href="msg00138.html">Re: [ferret_users] Extrapolate over land.</a></strong>
<ul><li><em>From:</em> Ansley C. Manke</li></ul></li>
</ul></li></ul>
<!--X-Follow-Ups-End-->
<!--X-References-->
<ul><li><strong>References</strong>:
<ul>
<li><strong><a name="00124" href="msg00124.html">[ferret_users] Extrapolate over land.</a></strong>
<ul><li><em>From:</em> Sangeeth M</li></ul></li>
<li><strong><a name="00128" href="msg00128.html">Re: [ferret_users] Extrapolate over land.</a></strong>
<ul><li><em>From:</em> Martin Schmidt</li></ul></li>
</ul></li></ul>
<!--X-References-End-->
<!--X-BotPNI-->
<UL>
<li>Previous by thread:
<strong><a href="msg00128.html">Re: [ferret_users] Extrapolate over land.</a></strong>
</li>
<li>Next by thread:
<strong><a href="msg00138.html">Re: [ferret_users] Extrapolate over land.</a></strong>
</li>

</UL>
<center>[<a href="msg00128.html">Thread Prev</a>][<a href="msg00138.html">Thread Next</a>][<A HREF="threads.html#00129">Index</A>]</center>

<!--X-BotPNI-End-->
<!--X-User-Footer-->
<A HREF="http://ferret.pmel.noaa.gov/Ferret/contact-us">Contact Us</A>
<br>
<font size=-1>
<address>
<a href="http://www.doc.gov">Dept of Commerce</a> /
<a href="http://www.noaa.gov">NOAA</a> /
<a href="http://www.oar.noaa.gov">OAR</a> /
<a href="http://www.pmel.noaa.gov">PMEL</a> /
<a href="http://ferret.pmel.noaa.gov">Ferret</a>
</address>

<br>
 <a href="http://www.noaa.gov/privacy.html">Privacy Policy</a> | <a href="http://www.noaa.gov/disclaimer.html">Disclaimer</a> | <a href="accessibility.html">Accessibility Statement</a> 

</font>
<!--X-User-Footer-End-->
</body>
</html>
