<!-- MHonArc v2.6.18 -->
<!--X-Subject: Re: [ferret_users] modulo longitude standards? -->
<!--X-From-R13: [negva Epuzvqg <znegva.fpuzvqgNvb&#45;jnearzhraqr.qr> -->
<!--X-Date: Wed, 10 Feb 2016 03:06:41 &#45;0800 -->
<!--X-Message-Id: 56BB19AB.5080106@io&#45;warnemuende.de -->
<!--X-Content-Type: text/plain -->
<!--X-Reference: CAEwQpaKPdZnm9Q_WLqV9_uYi_RVyBN8ULF4NuLqDcswEhk+riA@mail.gmail.com -->
<!--X-Reference: 56BA8160.20803@noaa.gov -->
<!--X-Reference: CAEwQpaKR9cT0z0wJsdk7_3T3LsOv_EDp+Erc=Efgw7QJSOuZUA@mail.gmail.com -->
<!--X-Reference: 56BA8F53.7020005@noaa.gov -->
<!--X-Reference: 49C7E54C&#45;D485&#45;4E6D&#45;8E63&#45;2523B21B9222@noaa.gov -->
<!--X-Head-End-->
<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN"
        "http://www.w3.org/TR/html4/loose.dtd">
<html>
<head>
<title>Re: [ferret_users] modulo longitude standards?</title>
</head>
<body>
<!--X-Body-Begin-->
<!--X-User-Header-->
<!--X-User-Header-End-->
<!--X-TopPNI-->
<HR>
<center>[<a href="msg00088.html">Thread Prev</a>][<a href="msg00094.html">Thread Next</a>][<A HREF="threads.html#00089">Index</A>]</center>

<!--X-TopPNI-End-->
<!--X-MsgBody-->
<!--X-Subject-Header-Begin-->
<h1>Re: [ferret_users] modulo longitude standards?</h1>
<hr>
<!--X-Subject-Header-End-->
<!--X-Head-of-Message-->
<ul>
<li><strong>To</strong>: <strong><a href="mailto:ferret_users@DOMAIN.HIDDEN">ferret_users@xxxxxxxx</a></strong></li>
<li><strong>Subject</strong>: <strong>Re: [ferret_users] modulo longitude standards?</strong></li>
<li><strong>From</strong>: <strong>Martin Schmidt &lt;<a href="mailto:martin.schmidt@DOMAIN.HIDDEN">martin.schmidt@xxxxxxxxxxxxxxxxx</a>&gt;</strong></li>
<li>Date: Wed, 10 Feb 2016 12:06:19 +0100</li>
<li>Dkim-signature: v=1; a=rsa-sha256; c=relaxed/relaxed;        d=noaa-gov.20150623.gappssmtp.com; s=20150623;        h=message-id:date:from:user-agent:mime-version:to:subject:references         :in-reply-to:content-type:content-transfer-encoding         :x-original-sender:x-original-authentication-results:precedence         :mailing-list:list-id:list-post:list-help:list-archive         :list-unsubscribe;        bh=Cv34r962xQoAZx1kbjU30kP0VXHg8E+QEsD8Tkwf6Rk=;        b=C3snvtKo7+80z1JnOS6nrIG+cAsYQlv1+j/M9z9FoPjJrloVkBp41uAogYkPODBeam         2aLEVxRX4J3SUI5cBXH2zR+iedipNoSVtgI+9nNnKGZVZ/QJLvmrhc4QGrp+boKUrXTN         d5AuNEZM2FkLqvVM2/SzhwbiovCZ5h/eEZhoAqyrVAdBz3C1kTO1FWhWdHlVmXDgY+6b         pr/h+sAlrA9UPX9lyQbXooyY+pgh1Sfev4hj8SGcJqe8Womcwozi90zUQxbqS7EAVRuS         FQ1bLCbyTTH4AbEJIMk03Pag3CEuHuOJPLil/GokinEym9pLlD/6RZxbqwvRcBcUapt+         yoog==</li>
<li>In-reply-to: &lt;<a href="msg00088.html">49C7E54C-D485-4E6D-8E63-2523B21B9222@noaa.gov</a>&gt;</li>
<li>List-archive: &lt;<a href="https://groups.google.com/a/noaa.gov/group/ferret_users/">https://groups.google.com/a/noaa.gov/group/ferret_users/</a>&gt;</li>
<li>List-help: &lt;<a href="https://support.google.com/a/noaa.gov/bin/topic.py?topic=25838">https://support.google.com/a/noaa.gov/bin/topic.py?topic=25838</a>&gt;, &lt;<a href="mailto:ferret_users+help@noaa.gov">mailto:ferret_users+help@noaa.gov</a>&gt;</li>
<li>List-id: &lt;ferret_users.noaa.gov&gt;</li>
<li>List-post: &lt;<a href="https://groups.google.com/a/noaa.gov/group/ferret_users/post">https://groups.google.com/a/noaa.gov/group/ferret_users/post</a>&gt;, &lt;<a href="mailto:ferret_users@noaa.gov">mailto:ferret_users@noaa.gov</a>&gt;</li>
<li>List-unsubscribe: &lt;<a href="mailto:googlegroups-manage+809428289204+unsubscribe@googlegroups.com">mailto:googlegroups-manage+809428289204+unsubscribe@googlegroups.com</a>&gt;, &lt;<a href="https://groups.google.com/a/noaa.gov/group/ferret_users/subscribe">https://groups.google.com/a/noaa.gov/group/ferret_users/subscribe</a>&gt;</li>
<li>Mailing-list: list <a href="mailto:ferret_users@DOMAIN.HIDDEN">ferret_users@xxxxxxxx</a>; contact <a href="mailto:ferret_users%2Bowners@DOMAIN.HIDDEN">ferret_users+owners@xxxxxxxx</a></li>
<li>References: &lt;<a href="msg00084.html">CAEwQpaKPdZnm9Q_WLqV9_uYi_RVyBN8ULF4NuLqDcswEhk+riA@mail.gmail.com</a>&gt; &lt;<a href="msg00085.html">56BA8160.20803@noaa.gov</a>&gt; &lt;CAEwQpaKR9cT0z0wJsdk7_3T3LsOv_EDp+Erc=Efgw7QJSOuZUA@mail.gmail.com&gt; &lt;<a href="msg00087.html">56BA8F53.7020005@noaa.gov</a>&gt; &lt;<a href="msg00088.html">49C7E54C-D485-4E6D-8E63-2523B21B9222@noaa.gov</a>&gt;</li>
<li>Sender: <a href="mailto:owner-ferret_users@DOMAIN.HIDDEN">owner-ferret_users@xxxxxxxx</a></li>
<li>User-agent: Mozilla/5.0 (X11; Linux x86_64; rv:31.0) Gecko/20100101 Thunderbird/31.3.0</li>
</ul>
<!--X-Head-of-Message-End-->
<!--X-Head-Body-Sep-Begin-->
<hr>
<!--X-Head-Body-Sep-End-->
<!--X-Body-of-Message-->
<pre style="margin: 0em;">
Dear all,
</pre><tt>I would also support the idea to change the default behaviour for 
</tt><tt>subspan axis - for the following reason:
</tt><tt>For unexperienced users it seems that ferret &quot;knows&quot; a lot of things, 
</tt><tt>like a little miracle. We know, the secret behind this is, ferret uses 
</tt><tt>all information in the input files as best as possible, but cannot add 
</tt><tt>missing information. The CF-standard defines the meaning of the 
</tt><tt>attributes. It is the strength of ferret, to keep data, axis and 
</tt><tt>metadata together. There is no need to control the relation between them 
</tt><tt>all the time, unlike in matlab for example. This avoids a lot of 
</tt><tt>programming and prevents users from making errors.
</tt><pre style="margin: 0em;">

</pre><tt>But changing the axis- and meta-information silently is a little bit 
</tt><tt>against this &quot;basic ferret philosophy&quot;. To see what I mean, assume,
</tt><tt>you want to use the output of a regional model. There is a variable 
</tt><tt>eta_t in the data set.
</tt><pre style="margin: 0em;">

yes? use &quot;<a  rel="nofollow" href="http://phy-50:8080/thredds/dodsC/genus/genus_run_88_5day_ocean.nc&quot">http://phy-50:8080/thredds/dodsC/genus/genus_run_88_5day_ocean.nc&quot</a>;
yes? say `eta_t,return=xaxis`
 !-&gt; MESSAGE/CONTINUE XT_OCEAN
XT_OCEAN
yes? show axis XT_OCEAN
 name       axis              # pts   start                end
 XT_OCEAN  LONGITUDE          273mi   10.075W(-10.075) 18.048E(18.048)
   Axis span (to cell edges) = 28.24585 (modulo length = 360)

</pre><tt>Ferret tells me the variable eta_t has a modula axis. But it has not. 
</tt><tt>With ncdump I get:
</tt><pre style="margin: 0em;">
        double xt_ocean(xt_ocean) ;
                xt_ocean:long_name = &quot;tcell longitude&quot; ;
                xt_ocean:units = &quot;degrees_E&quot; ;
                xt_ocean:cartesian_axis = &quot;X&quot; ;
                xt_ocean:_ChunkSize = 273 ;
</pre><tt>The original axis definition may be read correctly, but it is changed 
</tt><tt>later to modulo by ferret. Writing some data to a file they are branded 
</tt><tt>with the modulo-axis.
</tt><tt>In most cases this is not a big deal, but ferret changes the information 
</tt><tt>delivered from the netcdf-file, so it changes something silently, which 
</tt><tt>my have been defined by the creator of the dataset with some intension. 
</tt><tt>It is not possible to check with ferret, if axis in a data set are 
</tt><tt>modulo or not. They are allways modulo.
</tt><pre style="margin: 0em;">

</pre><tt>Another argument is that the pair of operations &quot;use&quot; and &quot; save&quot; is not 
</tt><tt>pass-through like but changes information inbetween.
</tt><pre style="margin: 0em;">

</pre><tt>Anyway, I am using ferret a lot and could be happy with any default. 
</tt><tt>But, in the case if I could have a free wish ... axis should be used 
</tt><tt>exactly as defined either
</tt><tt>from the command line or from file information. Specifying the modulo 
</tt><tt>attribute means &quot;modulo&quot; otherwise &quot;not modulo&quot;.
</tt><pre style="margin: 0em;">

Best,
Martin




Am 10.02.2016 um 06:17 schrieb William S. Kessler:
</pre><blockquote style="border-left: #5555EE solid 0.2em; margin: 0em; padding-left: 0.85em"><pre style="margin: 0em;">
Count me as another user who thinks the subspan modulo behavior should not be the default.

I recall your explanation of this feature (28 Oct 2011):

</pre><blockquote style="border-left: #5555EE solid 0.2em; margin: 0em; padding-left: 0.85em"><pre style="margin: 0em;">
The importance of the subspan modulo axes is to take the first of two steps that will make it possible for users largely to ignore differences in encodings of longitude and climatological time -- e.g. the blending of data in plots and analyses where the data come from data sets that are encoded variously as -180:180, 0:360, etc.  Thus, for example, in V5.5 you can refer to my_subspan_var[g=another_var] and get a meaningful answer as long as the grids occupy the same region on the globe, regardless of longitude encoding. (The second step, for V5.6, will address the longitude encoding of scattered data.)
</pre></blockquote><pre style="margin: 0em;">
I can see how that might be useful in particular situations, but the cost is the mistaken plots and analyses by other users - working with grids covering subregions of the globe - who forget to declare the axis non-modulo, and unwittingly smooth or fill in x (or take a derivative, etc). Then Ferret will wrap the operation across the edges of the region inappropriately. As someone who frequently works with Pacific fields, I can't tell you how many times I've slapped my forehead and gotten a different result after remembering to CAN AXIS/MODULO. But those who are less-acquainted with this might make the mistake and not realize that their plot is wrong.

My sense of the balance is that this feature should be available, but not the default, because I'll bet most Ferret users don't realize that this will happen. They haven't fully read the documentation and assume - very reasonably - that the default for a subregion is non-modulo.And even for those who do know this, like me, it's a very easy feature to forget in the heat of calculation.

I think the default should be non-modulo for axes where x is given in degrees east, unless the axis is fully global, since the user who wants this feature can always turn it on (SET AXIS/MODULO), right?

Billy K

</pre><blockquote style="border-left: #5555EE solid 0.2em; margin: 0em; padding-left: 0.85em"><pre style="margin: 0em;">
On Feb 9, 2016, at 5:16 PM, Steve Hankin &lt;steven.c.hankin@xxxxxxxx&gt; wrote:

On 2/9/2016 4:47 PM, Ryo Furue wrote:
</pre><blockquote style="border-left: #5555EE solid 0.2em; margin: 0em; padding-left: 0.85em"><pre style="margin: 0em;">
Hi Steve,

Thanks for your detailed explanation.

</pre><blockquote style="border-left: #5555EE solid 0.2em; margin: 0em; padding-left: 0.85em"><pre style="margin: 0em;">
An axis may be less than global (e.g. axis &quot;x30&quot;) and still be understood to
have modulo 360 behavior.  This is inferred automatically from its units of
degrees_east.   To reliably regard a variable defined on an X axis of more
than 360 degrees, Ferret would have to check that the overlapping points at
each end all had identical values.
</pre></blockquote><pre style="margin: 0em;">
Or you COULD just issue a warning and disregard the values on one of
the overlapping &quot;layers&quot;.  I'm not saying you SHOULD.

</pre><blockquote style="border-left: #5555EE solid 0.2em; margin: 0em; padding-left: 0.85em"><pre style="margin: 0em;">
  Ferret has no internal logic to do this.
</pre></blockquote><pre style="margin: 0em;">
Yes, I guessed that that is the reason why Ferret currently rejects
such an overlapping axis.
</pre></blockquote><pre style="margin: 0em;">
There are cases where people deliberately create variables on longitude ranges of (say) 720 degrees (double worlds).  All other things being equal it seems best not to second guess what people are doing.
</pre><blockquote style="border-left: #5555EE solid 0.2em; margin: 0em; padding-left: 0.85em"><blockquote style="border-left: #5555EE solid 0.2em; margin: 0em; padding-left: 0.85em"><pre style="margin: 0em;">
P.S.  The attribute &quot;modulo&quot; is from older Ferret versions.
</pre></blockquote><pre style="margin: 0em;">
So, what's the latest alternative?  Is it a Ferret-specific attribute?
  Or is it part of a well-recognized convention like CF?
</pre></blockquote><pre style="margin: 0em;">
The &quot;modulo&quot; attribute was a Ferret creation -- not CF.  Somewhere along the way, Ferret was enhanced to support the notion of a &quot;subspan modulo axis&quot; -- modulo behavior, even though the axis isn't globe-encircling.  The axis X30 in the previous message was an example.  With the advent of subspan modulo axes, all longitude axes 360 degrees or less became implicitly &quot;modulo&quot;.  So the older modulo attribute is essentially irrelevant. (But no harm from having it in a file AFAIK.)

    - Steve
</pre><blockquote style="border-left: #5555EE solid 0.2em; margin: 0em; padding-left: 0.85em"><pre style="margin: 0em;">
The dataset I was given actually includes the &quot;modulo&quot; attribute.  I'm
not sure if the creators of the dataset use Ferret.

Basically, I'd like to know if I should ask the creators to fix it.
They are a data center and so they do care about these things.

Ryo
</pre></blockquote></blockquote><pre style="margin: 0em;">

</pre></blockquote><pre style="margin: 0em;">

</pre>
<!--X-Body-of-Message-End-->
<!--X-MsgBody-End-->
<!--X-Follow-Ups-->
<hr>
<ul><li><strong>Follow-Ups</strong>:
<ul>
<li><strong><a name="00096" href="msg00096.html">Re: [ferret_users] modulo longitude standards?</a></strong>
<ul><li><em>From:</em> Andrew Wittenberg - NOAA Federal</li></ul></li>
<li><strong><a name="00094" href="msg00094.html">Re: [ferret_users] modulo longitude standards?</a></strong>
<ul><li><em>From:</em> Steve Hankin</li></ul></li>
</ul></li></ul>
<!--X-Follow-Ups-End-->
<!--X-References-->
<ul><li><strong>References</strong>:
<ul>
<li><strong><a name="00084" href="msg00084.html">[ferret_users] modulo longitude standards?</a></strong>
<ul><li><em>From:</em> Ryo Furue</li></ul></li>
<li><strong><a name="00085" href="msg00085.html">Re: [ferret_users] modulo longitude standards?</a></strong>
<ul><li><em>From:</em> Steve Hankin</li></ul></li>
<li><strong><a name="00086" href="msg00086.html">Re: [ferret_users] modulo longitude standards?</a></strong>
<ul><li><em>From:</em> Ryo Furue</li></ul></li>
<li><strong><a name="00087" href="msg00087.html">Re: [ferret_users] modulo longitude standards?</a></strong>
<ul><li><em>From:</em> Steve Hankin</li></ul></li>
<li><strong><a name="00088" href="msg00088.html">Re: [ferret_users] modulo longitude standards?</a></strong>
<ul><li><em>From:</em> William S. Kessler</li></ul></li>
</ul></li></ul>
<!--X-References-End-->
<!--X-BotPNI-->
<UL>
<li>Previous by thread:
<strong><a href="msg00088.html">Re: [ferret_users] modulo longitude standards?</a></strong>
</li>
<li>Next by thread:
<strong><a href="msg00094.html">Re: [ferret_users] modulo longitude standards?</a></strong>
</li>

</UL>
<center>[<a href="msg00088.html">Thread Prev</a>][<a href="msg00094.html">Thread Next</a>][<A HREF="threads.html#00089">Index</A>]</center>

<!--X-BotPNI-End-->
<!--X-User-Footer-->
<A HREF="http://ferret.pmel.noaa.gov/Ferret/contact-us">Contact Us</A>
<br>
<font size=-1>
<address>
<a href="http://www.doc.gov">Dept of Commerce</a> /
<a href="http://www.noaa.gov">NOAA</a> /
<a href="http://www.oar.noaa.gov">OAR</a> /
<a href="http://www.pmel.noaa.gov">PMEL</a> /
<a href="http://ferret.pmel.noaa.gov">Ferret</a>
</address>

<br>
 <a href="http://www.noaa.gov/privacy.html">Privacy Policy</a> | <a href="http://www.noaa.gov/disclaimer.html">Disclaimer</a> | <a href="accessibility.html">Accessibility Statement</a> 

</font>
<!--X-User-Footer-End-->
</body>
</html>
