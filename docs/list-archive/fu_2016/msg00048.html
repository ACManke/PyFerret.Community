<!-- MHonArc v2.6.18 -->
<!--X-Subject: Re: [ExternalEmail] RE: [ferret_users] Compressed ferret output incompatibe with netcdf java apps -->
<!--X-From-R13: Dhff Tvrqyre <ehffryy.svrqyreNpfveb.nh> -->
<!--X-Date: Mon, 1 Feb 2016 18:52:47 &#45;0800 -->
<!--X-Message-Id: 56B019FA.8010707@csiro.au -->
<!--X-Content-Type: text/plain -->
<!--X-Reference: alpine.LFD.2.10.1601191052420.1594@kelvin -->
<!--X-Reference: alpine.LFD.2.10.1601191158010.1594@kelvin -->
<!--X-Reference: 569E782B.709@noaa.gov -->
<!--X-Reference: alpine.LFD.2.10.1601191444300.1594@kelvin -->
<!--X-Reference: 56A2C344.7090007@io&#45;warnemuende.de -->
<!--X-Reference: CAELLC7U_0XJ=L&#45;N6jMrpk&#45;2nQ&#45;3+0pQAj_sbkD8ydrfJ+3RY4g@mail.gmail.com -->
<!--X-Reference: 56AB0C1F.5070702@csiro.au -->
<!--X-Reference: 56ABA9AB.7050401@noaa.gov -->
<!--X-Reference: B24A961A1429FC4F8E6E89CF1032137C286DBDED@exmbx02&#45;cdc.nexus.csiro.au -->
<!--X-Head-End-->
<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN"
        "http://www.w3.org/TR/html4/loose.dtd">
<html>
<head>
<title>Re: [ExternalEmail] RE: [ferret_users] Compressed ferret output incompatibe with netcdf java apps</title>
</head>
<body>
<!--X-Body-Begin-->
<!--X-User-Header-->
<!--X-User-Header-End-->
<!--X-TopPNI-->
<HR>
<center>[<a href="msg00047.html">Thread Prev</a>][<a href="msg00063.html">Thread Next</a>][<A HREF="threads.html#00048">Index</A>]</center>

<!--X-TopPNI-End-->
<!--X-MsgBody-->
<!--X-Subject-Header-Begin-->
<h1>Re: [ExternalEmail] RE: [ferret_users] Compressed ferret output incompatibe with netcdf java apps</h1>
<hr>
<!--X-Subject-Header-End-->
<!--X-Head-of-Message-->
<ul>
<li><strong>To</strong>: <strong><a href="mailto:ferret_users@DOMAIN.HIDDEN">ferret_users@xxxxxxxx</a></strong></li>
<li><strong>Subject</strong>: <strong>Re: [ExternalEmail] RE: [ferret_users] Compressed ferret output incompatibe with netcdf java apps</strong></li>
<li><strong>From</strong>: <strong>Russ Fiedler &lt;<a href="mailto:russell.fiedler@DOMAIN.HIDDEN">russell.fiedler@xxxxxxxx</a>&gt;</strong></li>
<li>Date: Tue, 2 Feb 2016 13:52:42 +1100</li>
<li>Dkim-signature: v=1; a=rsa-sha256; c=relaxed/relaxed;        d=noaa-gov.20150623.gappssmtp.com; s=20150623;        h=subject:to:references:from:message-id:date:user-agent:mime-version         :in-reply-to:content-type:content-transfer-encoding         :x-original-sender:x-original-authentication-results:precedence         :mailing-list:list-id:list-post:list-help:list-archive         :list-unsubscribe;        bh=oqjOyZWCvIPwpugZujemF93yrlRlO0k1nPfPfYYjwpA=;        b=FwEu9qsYq8jVGGC6K6idPMi3vpv/oyVcavzimjTAzWESW638sAL2IMh6g8qkQELUZt         dtZqysS9Mj8rwJrXK6b+vViHM3Z9jQRfBH4bN8X+DVIMK8GEj0puR7SbUJGLF6Haayo8         EUQtItyqCXvsuGnLERl5shgFszHvDTU+ctzRPB6FegxYqBqYMSs5RonLYo2z2ul11yVl         lEMFHpOUJnqzoOtjkYDVjkPnBSEQap1BqABjIKQzQ8+nTVhWSykogObkGBcGJsFNmQp6         nuTFNXm/XGb1sm0Jjrjw82W1B8C2U8/14kVNhpYoVHxYcY6ZtE2l8f/i6hjbDkyK9KRR         QZwQ==</li>
<li>In-reply-to: &lt;<a href="msg00047.html">B24A961A1429FC4F8E6E89CF1032137C286DBDED@exmbx02-cdc.nexus.csiro.au</a>&gt;</li>
<li>List-archive: &lt;<a href="https://groups.google.com/a/noaa.gov/group/ferret_users/">https://groups.google.com/a/noaa.gov/group/ferret_users/</a>&gt;</li>
<li>List-help: &lt;<a href="https://support.google.com/a/noaa.gov/bin/topic.py?topic=25838">https://support.google.com/a/noaa.gov/bin/topic.py?topic=25838</a>&gt;, &lt;<a href="mailto:ferret_users+help@noaa.gov">mailto:ferret_users+help@noaa.gov</a>&gt;</li>
<li>List-id: &lt;ferret_users.noaa.gov&gt;</li>
<li>List-post: &lt;<a href="https://groups.google.com/a/noaa.gov/group/ferret_users/post">https://groups.google.com/a/noaa.gov/group/ferret_users/post</a>&gt;, &lt;<a href="mailto:ferret_users@noaa.gov">mailto:ferret_users@noaa.gov</a>&gt;</li>
<li>List-unsubscribe: &lt;<a href="mailto:googlegroups-manage+809428289204+unsubscribe@googlegroups.com">mailto:googlegroups-manage+809428289204+unsubscribe@googlegroups.com</a>&gt;, &lt;<a href="https://groups.google.com/a/noaa.gov/group/ferret_users/subscribe">https://groups.google.com/a/noaa.gov/group/ferret_users/subscribe</a>&gt;</li>
<li>Mailing-list: list <a href="mailto:ferret_users@DOMAIN.HIDDEN">ferret_users@xxxxxxxx</a>; contact <a href="mailto:ferret_users%2Bowners@DOMAIN.HIDDEN">ferret_users+owners@xxxxxxxx</a></li>
<li>References: &lt;alpine.LFD.2.10.1601191052420.1594@kelvin&gt; &lt;alpine.LFD.2.10.1601191158010.1594@kelvin&gt; &lt;<a href="msg00018.html">569E782B.709@noaa.gov</a>&gt; &lt;alpine.LFD.2.10.1601191444300.1594@kelvin&gt; &lt;<a href="msg00029.html">56A2C344.7090007@io-warnemuende.de</a>&gt; &lt;CAELLC7U_0XJ=L-N6jMrpk-2nQ-3+0pQAj_sbkD8ydrfJ+3RY4g@mail.gmail.com&gt; &lt;<a href="msg00045.html">56AB0C1F.5070702@csiro.au</a>&gt; &lt;<a href="msg00046.html">56ABA9AB.7050401@noaa.gov</a>&gt; &lt;<a href="msg00047.html">B24A961A1429FC4F8E6E89CF1032137C286DBDED@exmbx02-cdc.nexus.csiro.au</a>&gt;</li>
<li>Sender: <a href="mailto:owner-ferret_users@DOMAIN.HIDDEN">owner-ferret_users@xxxxxxxx</a></li>
<li>User-agent: Mozilla/5.0 (X11; Linux x86_64; rv:38.0) Gecko/20100101 Thunderbird/38.4.0</li>
</ul>
<!--X-Head-of-Message-End-->
<!--X-Head-Body-Sep-Begin-->
<hr>
<!--X-Head-Body-Sep-End-->
<!--X-Body-of-Message-->
<pre style="margin: 0em;">

Hi,

</pre><tt>Further to this, I found that it also fails with versions 6.8.4.2 (RH6) 
</tt><tt>and V6.82 Mac
</tt><pre style="margin: 0em;">

[raf599@vdi-n2 ~]$ ferret -nojnl
     NOAA/PMEL TMAP
     FERRET v6.842
     Linux 2.6.32-279.19.1.el6.x86_64 64-bit - 02/01/13

yes? sho sym netcdf_version
NETCDF_VERSION = &quot;4.2.1.1 of Jan 31 2013 16:14:40 $&quot;


So it looks like it's unrelated to the netcdf library version.

Russ


On 31/01/16 15:26, Russell.Fiedler@xxxxxxxx wrote:
</pre><blockquote style="border-left: #5555EE solid 0.2em; margin: 0em; padding-left: 0.85em"><pre style="margin: 0em;">
Hi Ansley,

I mention that it's V6.95 and V6.96 down at the bottom of the post.  I think it might be a problem for at least one earlier version. That will have to wait till I get back to work...

Cheers,
Russ


________________________________________
From: owner-ferret_users@xxxxxxxx [owner-ferret_users@xxxxxxxx] on behalf of Ansley C. Manke [ansley.b.manke@xxxxxxxx]
Sent: Saturday, 30 January 2016 5:04 AM
To: ferret_users@xxxxxxxx
Subject: Re: [ferret_users] Compressed ferret output incompatibe with netcdf java apps

Hi Russ,
No, this is not a known issue.  What version of Ferret are you running?
If it's an older one, it might be worth updating. Ferret currently links
with netCDF 4.3.3.1.  (Upon starting Ferret, SHOW SYMBOL netcdf_version
lists the version number).

Ansley

On 1/28/2016 10:52 PM, Russ Fiedler wrote:
</pre><blockquote style="border-left: #5555EE solid 0.2em; margin: 0em; padding-left: 0.85em"><pre style="margin: 0em;">

Hi,

This is possibly a problem with netcdf java rather than ferret but
anyway...

If we make a variable and save it in compressed netcdf4 format it
appears that java based netcdf software han't handle it.

e.g.

yes? let v=i[i=1:20]+j[j=1:20]
yes? save/file=cmp.nc/ncformat=netcdf4/def v    ! compressed (actually
it's larger but just an example)
yes? save/file=uncmp.nc/ncformat=netcdf4 v      ! uncompressed

Now loading up in Panopoly (and another of our in house apps which is
where we spotted the problem).When we try to operate on v
we get a message about an an unknown filter type being zero for the
compressed version

java.lang.RuntimeException: Unknown filter type=0
     at
ucar.nc2.iosp.hdf5.H5tiledLayoutBB$DataChunk.getByteBuffer(H5tiledLayoutBB.java:198)
etc

The uncompressed version is fine since there are no filters being
applied.

Now, here's where it gets weird. If nccopy is used to convert the two
files to compressed netcdf4 style the originally compressed file is
still giving Panopoly grief but the newly compress file is handled
just fine!


xwing-hf% nccopy -k 3 -d 1 cmp.nc cmp_ncopy.nc          ! Still no good
xwing-hf% nccopy -k 3 -d 1 uncmp.nc uncmp_ncopy.nc  ! compressed file
is fine!!!

Any clues? A known issue?

Occurs for V6.95, V6.96 and earlier by the looks.

Cheers,
Russ









</pre></blockquote><pre style="margin: 0em;">

</pre></blockquote><pre style="margin: 0em;">

</pre>
<!--X-Body-of-Message-End-->
<!--X-MsgBody-End-->
<!--X-Follow-Ups-->
<hr>
<!--X-Follow-Ups-End-->
<!--X-References-->
<ul><li><strong>References</strong>:
<ul>
<li><strong><a name="00016" href="msg00016.html">[ferret_users] question about binary file writing in ferret: doubling of size with repeat</a></strong>
<ul><li><em>From:</em> Lev Tarasov</li></ul></li>
<li><strong><a name="00017" href="msg00017.html">[ferret_users] binary file output is garbled Re: question about binary file writing in ferret: doubling of size with repeat</a></strong>
<ul><li><em>From:</em> Lev Tarasov</li></ul></li>
<li><strong><a name="00018" href="msg00018.html">Re: [ferret_users] binary file output is garbled Re: question about binary file writing in ferret: doubling of size with repeat</a></strong>
<ul><li><em>From:</em> Ansley C. Manke</li></ul></li>
<li><strong><a name="00019" href="msg00019.html">Re: [ferret_users] binary file output is garbled Re: question about binary file writing in ferret: doubling of size with repeat</a></strong>
<ul><li><em>From:</em> Lev Tarasov</li></ul></li>
<li><strong><a name="00029" href="msg00029.html">[ferret_users] ferret_users: eps-figures produced with pyferret become rotated</a></strong>
<ul><li><em>From:</em> Martin Schmidt</li></ul></li>
<li><strong><a name="00031" href="msg00031.html">Re: [ferret_users] ferret_users: eps-figures produced with pyferret become rotated</a></strong>
<ul><li><em>From:</em> Karl Smith - NOAA Affiliate</li></ul></li>
<li><strong><a name="00045" href="msg00045.html">[ferret_users] Compressed ferret output incompatibe with netcdf java apps</a></strong>
<ul><li><em>From:</em> Russ Fiedler</li></ul></li>
<li><strong><a name="00046" href="msg00046.html">Re: [ferret_users] Compressed ferret output incompatibe with netcdf java apps</a></strong>
<ul><li><em>From:</em> Ansley C. Manke</li></ul></li>
<li><strong><a name="00047" href="msg00047.html">RE: [ferret_users] Compressed ferret output incompatibe with netcdf java apps</a></strong>
<ul><li><em>From:</em> Russell.Fiedler</li></ul></li>
</ul></li></ul>
<!--X-References-End-->
<!--X-BotPNI-->
<UL>
<li>Previous by thread:
<strong><a href="msg00047.html">RE: [ferret_users] Compressed ferret output incompatibe with netcdf java apps</a></strong>
</li>
<li>Next by thread:
<strong><a href="msg00063.html">Re: [ferret_users] Compressed ferret output incompatibe with netcdf java apps</a></strong>
</li>

</UL>
<center>[<a href="msg00047.html">Thread Prev</a>][<a href="msg00063.html">Thread Next</a>][<A HREF="threads.html#00048">Index</A>]</center>

<!--X-BotPNI-End-->
<!--X-User-Footer-->
<A HREF="http://ferret.pmel.noaa.gov/Ferret/contact-us">Contact Us</A>
<br>
<font size=-1>
<address>
<a href="http://www.doc.gov">Dept of Commerce</a> /
<a href="http://www.noaa.gov">NOAA</a> /
<a href="http://www.oar.noaa.gov">OAR</a> /
<a href="http://www.pmel.noaa.gov">PMEL</a> /
<a href="http://ferret.pmel.noaa.gov">Ferret</a>
</address>

<br>
 <a href="http://www.noaa.gov/privacy.html">Privacy Policy</a> | <a href="http://www.noaa.gov/disclaimer.html">Disclaimer</a> | <a href="accessibility.html">Accessibility Statement</a> 

</font>
<!--X-User-Footer-End-->
</body>
</html>
