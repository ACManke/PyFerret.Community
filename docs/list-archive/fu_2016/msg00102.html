<!-- MHonArc v2.6.18 -->
<!--X-Subject: Re: [ferret_users] modulo longitude standards? -->
<!--X-From-R13: Pvyyl Yrffyre <jvyyvnz.f.xrffyreNabnn.tbi> -->
<!--X-Date: Wed, 10 Feb 2016 13:52:57 &#45;0800 -->
<!--X-Message-Id: 2EC25A10&#45;9F00&#45;4B90&#45;9787&#45;6D4319D7ACB7@noaa.gov -->
<!--X-Content-Type: multipart/alternative -->
<!--X-Reference: CAEwQpaKPdZnm9Q_WLqV9_uYi_RVyBN8ULF4NuLqDcswEhk+riA@mail.gmail.com -->
<!--X-Reference: 56BA8160.20803@noaa.gov -->
<!--X-Reference: CAEwQpaKR9cT0z0wJsdk7_3T3LsOv_EDp+Erc=Efgw7QJSOuZUA@mail.gmail.com -->
<!--X-Reference: 56BA8F53.7020005@noaa.gov -->
<!--X-Reference: 49C7E54C&#45;D485&#45;4E6D&#45;8E63&#45;2523B21B9222@noaa.gov -->
<!--X-Reference: 56BB19AB.5080106@io&#45;warnemuende.de -->
<!--X-Reference: CAKoe08Q832yC1Aksbmk3GaenvRE+Ar8Y=sXBYU9YggnoR93CyQ@mail.gmail.com -->
<!--X-Reference: 9BC388D1&#45;6544&#45;401B&#45;AE4D&#45;6BDD2638C71E@noaa.gov -->
<!--X-Derived: gif32kmqnvaws.gif -->
<!--X-Derived: gifi72kOUjmpe.gif -->
<!--X-Head-End-->
<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN"
        "http://www.w3.org/TR/html4/loose.dtd">
<html>
<head>
<title>Re: [ferret_users] modulo longitude standards?</title>
</head>
<body>
<!--X-Body-Begin-->
<!--X-User-Header-->
<!--X-User-Header-End-->
<!--X-TopPNI-->
<HR>
<center>[<a href="msg00101.html">Thread Prev</a>][<a href="msg00092.html">Thread Next</a>][<A HREF="threads.html#00102">Index</A>]</center>

<!--X-TopPNI-End-->
<!--X-MsgBody-->
<!--X-Subject-Header-Begin-->
<h1>Re: [ferret_users] modulo longitude standards?</h1>
<hr>
<!--X-Subject-Header-End-->
<!--X-Head-of-Message-->
<ul>
<li><strong>To</strong>: <strong>Andrew Wittenberg &lt;<a href="mailto:andrew.wittenberg@DOMAIN.HIDDEN">andrew.wittenberg@xxxxxxxx</a>&gt;</strong></li>
<li><strong>Subject</strong>: <strong>Re: [ferret_users] modulo longitude standards?</strong></li>
<li><strong>From</strong>: <strong>Billy Kessler &lt;<a href="mailto:william.s.kessler@DOMAIN.HIDDEN">william.s.kessler@xxxxxxxx</a>&gt;</strong></li>
<li>Date: Wed, 10 Feb 2016 13:52:54 -0800</li>
<li>Cc: &quot;William S. Kessler&quot; &lt;<a href="mailto:william.s.kessler@DOMAIN.HIDDEN">william.s.kessler@xxxxxxxx</a>&gt;,        Martin Schmidt &lt;<a href="mailto:martin.schmidt@DOMAIN.HIDDEN">martin.schmidt@xxxxxxxxxxxxxxxxx</a>&gt;,        Ferret Users &lt;<a href="mailto:ferret_users@DOMAIN.HIDDEN">ferret_users@xxxxxxxx</a>&gt;,        Ansley Manke &lt;<a href="mailto:Ansley.B.Manke@DOMAIN.HIDDEN">Ansley.B.Manke@xxxxxxxx</a>&gt;</li>
<li>Dkim-signature: v=1; a=rsa-sha256; c=relaxed/relaxed;        d=noaa-gov.20150623.gappssmtp.com; s=20150623;        h=content-type:mime-version:subject:from:in-reply-to:date:cc         :message-id:references:to:x-original-sender         :x-original-authentication-results:precedence:mailing-list:list-id         :list-post:list-help:list-archive:list-unsubscribe;        bh=cRSvsDwaJ4uZ6KLgcgVucIyfn9025CNQXB/2fwlkf1Q=;        b=XgmysMt4d7bk/YKuwVFpmvLWZ3vGxL48JyIxMuCAOlO7zKN+6tOz5SsTJDIrnn3uwi         YuBHXR1sMWz1MyqCU/zL4lxikobNu6c9foO7bGBxKXJcMHyLlnztd+8jd4t25C7h3bEQ         svPJHmf1Omm+4AdkhR3eAhmm8q++bcO+/IqrywWNNy3Pop+u/Wz2MI5SuO6y5hxivaBt         oAFXXmCyXspjoh1vXM2+bBJST1EZ73sujREgzbqH+8G3XeFNKMVfihwjv+1FWm8gEHlw         K+5o7t6/kV5Jqb25Tgb4CR/gZnKJBXgnCQpSRoyYDneaeJTsBNCV3yUDyBRGelF3SecF         Tj0w==</li>
<li>In-reply-to: &lt;<a href="msg00101.html">9BC388D1-6544-401B-AE4D-6BDD2638C71E@noaa.gov</a>&gt;</li>
<li>List-archive: &lt;<a href="https://groups.google.com/a/noaa.gov/group/ferret_users/">https://groups.google.com/a/noaa.gov/group/ferret_users/</a>&gt;</li>
<li>List-help: &lt;<a href="https://support.google.com/a/noaa.gov/bin/topic.py?topic=25838">https://support.google.com/a/noaa.gov/bin/topic.py?topic=25838</a>&gt;, &lt;<a href="mailto:ferret_users+help@noaa.gov">mailto:ferret_users+help@noaa.gov</a>&gt;</li>
<li>List-id: &lt;ferret_users.noaa.gov&gt;</li>
<li>List-post: &lt;<a href="https://groups.google.com/a/noaa.gov/group/ferret_users/post">https://groups.google.com/a/noaa.gov/group/ferret_users/post</a>&gt;, &lt;<a href="mailto:ferret_users@noaa.gov">mailto:ferret_users@noaa.gov</a>&gt;</li>
<li>List-unsubscribe: &lt;<a href="mailto:googlegroups-manage+809428289204+unsubscribe@googlegroups.com">mailto:googlegroups-manage+809428289204+unsubscribe@googlegroups.com</a>&gt;, &lt;<a href="https://groups.google.com/a/noaa.gov/group/ferret_users/subscribe">https://groups.google.com/a/noaa.gov/group/ferret_users/subscribe</a>&gt;</li>
<li>Mailing-list: list <a href="mailto:ferret_users@DOMAIN.HIDDEN">ferret_users@xxxxxxxx</a>; contact <a href="mailto:ferret_users%2Bowners@DOMAIN.HIDDEN">ferret_users+owners@xxxxxxxx</a></li>
<li>References: &lt;<a href="msg00084.html">CAEwQpaKPdZnm9Q_WLqV9_uYi_RVyBN8ULF4NuLqDcswEhk+riA@mail.gmail.com</a>&gt; &lt;<a href="msg00085.html">56BA8160.20803@noaa.gov</a>&gt; &lt;CAEwQpaKR9cT0z0wJsdk7_3T3LsOv_EDp+Erc=Efgw7QJSOuZUA@mail.gmail.com&gt; &lt;<a href="msg00087.html">56BA8F53.7020005@noaa.gov</a>&gt; &lt;<a href="msg00088.html">49C7E54C-D485-4E6D-8E63-2523B21B9222@noaa.gov</a>&gt; &lt;<a href="msg00089.html">56BB19AB.5080106@io-warnemuende.de</a>&gt; &lt;CAKoe08Q832yC1Aksbmk3GaenvRE+Ar8Y=sXBYU9YggnoR93CyQ@mail.gmail.com&gt; &lt;<a href="msg00101.html">9BC388D1-6544-401B-AE4D-6BDD2638C71E@noaa.gov</a>&gt;</li>
<li>Sender: <a href="mailto:owner-ferret_users@DOMAIN.HIDDEN">owner-ferret_users@xxxxxxxx</a></li>
</ul>
<!--X-Head-of-Message-End-->
<!--X-Head-Body-Sep-Begin-->
<hr>
<!--X-Head-Body-Sep-End-->
<!--X-Body-of-Message-->
<table width="100%"><tr><td style="">Whoops, here's the example plots. Billy<div class=""><br class=""></div><div class=""><img apple-inline="yes" id="76EC31D6-198E-4888-84DD-C665865750D3" height="597" width="692" apple-width="yes" apple-height="yes" src="gif32kmqnvaws.gif" class=""><img apple-inline="yes" id="29B5656E-5B8C-4E47-B8D3-3F8A619F0797" height="597" width="692" apple-width="yes" apple-height="yes" src="gifi72kOUjmpe.gif" class=""><br class=""><blockquote type="cite" class="">On Feb 10, 2016, at 1:50 PM, Billy Kessler &lt;<a rel="nofollow" href="mailto:william.s.kessler@xxxxxxxx" class="">william.s.kessler@xxxxxxxx</a>&gt; wrote:<br class=""><br class="">HI Andrew -<br class=""><br class="">The answer could be Steve's earlier comment that it is a bug in the implementation rather than an expected feature.&nbsp;<br class=""><br class=""></blockquote><blockquote type="cite" class="">I've attached 2 example plots. They happen to be zonal wind stress on a particular day.<br class=""><br class="">The first is to simply SHADE the data (2-d map). The second applies X=@FLN. You can see that Ferret extended the plot to the west, but not to the east.&nbsp;That is the typical result, suggesting a bug rather than intended behavior. On other grids where a file might include a bit of Atlantic at the right edge,&nbsp;those latitudes will also be interpolated.<br class=""><br class="">The version and grid/axis are shown below.<br class=""><br class="">Billy<br class=""><br class=""><span class="Apple-tab-span" style="white-space:pre">	</span>NOAA/PMEL TMAP<br class=""><span class="Apple-tab-span" style="white-space:pre">	</span>FERRET v6.94 &nbsp;<br class=""><span class="Apple-tab-span" style="white-space:pre">	</span>Darwin 14.1.0 - 02/26/15<br class=""><span class="Apple-tab-span" style="white-space:pre">	</span>10-Feb-16 13:35 &nbsp; &nbsp;&nbsp;<br class=""><br class="">yes? sho grid taux1deghf215<br class="">&nbsp; &nbsp;GRID GMH1<br class="">name &nbsp; &nbsp; &nbsp; axis &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;# pts &nbsp; start &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;end<br class="">XHF &nbsp; &nbsp; &nbsp; LONGITUDE &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;166mr &nbsp; 124.5E &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; 70.5W<br class="">YHF &nbsp; &nbsp; &nbsp; LATITUDE &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;39 r &nbsp; 28.5S &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;9.5N<br class="">normal &nbsp; &nbsp;Z<br class="">TMON_CCMP_ASCAT TIME &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; 1 r &nbsp; 14-JUN-2012 20:15 &nbsp; &nbsp;14-JUN-2012 20:15<br class="">normal &nbsp; &nbsp;E<br class="">normal &nbsp; &nbsp;F<br class=""><br class="">yes? sho axis xhf<br class="">name &nbsp; &nbsp; &nbsp; axis &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;# pts &nbsp; start &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;end<br class="">XHF &nbsp; &nbsp; &nbsp; LONGITUDE &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;166mr &nbsp; 124.5E &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; 70.5W<br class="">&nbsp; Axis span (to cell edges) = 166 (modulo length = 360)<br class=""><br class=""><blockquote type="cite" class="">On Feb 10, 2016, at 9:20 AM, Andrew Wittenberg - NOAA Federal &lt;<a rel="nofollow" href="mailto:andrew.wittenberg@xxxxxxxx" class="">andrew.wittenberg@xxxxxxxx</a>&gt; wrote:<br class=""><br class="">Billy, Martin, Steve,<br class=""><br class="">As described in Sec. 4.3.7.1 of the User's Guide:<br class=""><br class=""><a rel="nofollow" href="http://ferret.pmel.noaa.gov/Ferret/documentation/users-guide/Grids-Regions/REGIONS#_VPINDEXENTRY_726" class="">http://ferret.pmel.noaa.gov/Ferret/documentation/users-guide/Grids-Regions/REGIONS#_VPINDEXENTRY_726</a><br class=""><br class="">The modulo attribute is *only* automatically applied *if* the axis is a longitude or climatological axis. &nbsp;If it's a longitude axis, the modulo length is set&nbsp;to 360 degrees. &nbsp;If it's a climatological axis, the modulo length is set to one year. &nbsp;Both make sense, and enable one to easily plot any modulo range of&nbsp;the axis (e.g. x=-180:180, or x=0:360, or x=0:720).<br class=""><br class="">For subspan modulo axes (e.g. the Pacific only), Ferret inserts a "void cell" that fills the longitude gap between the end of the axis and the start of the&nbsp;next modulo cycle. &nbsp;Ferret is supposed to prevent smoothers (@sbx, @spz), fillers (@fln, @fnr), and derivatives (@ddc, @ddf) from operating across this&nbsp;void point, so the output should be correct -- no need for CANCEL AXIS/MODULO.<br class=""><br class="">Early versions of Ferret had bugs in these features, but as far as I know (with one exception, see below), everything has worked fine since v6.941 (16&nbsp;April 2015). &nbsp;Here's a sample session in the latest version.<br class=""><br class="">First make a NetCDF file containing a sub-span modulo longitude axis:<br class=""><br class=""><span class="Apple-tab-span" style="white-space:pre">	</span>NOAA/PMEL TMAP<br class=""><span class="Apple-tab-span" style="white-space:pre">	</span>FERRET v6.961 (beta)<br class=""><span class="Apple-tab-span" style="white-space:pre">	</span>Linux 2.6.32-573.8.1.el6.x86_64 64-bit - 12/09/15<br class=""><span class="Apple-tab-span" style="white-space:pre">	</span>10-Feb-16 12:13 &nbsp; &nbsp;&nbsp;<br class=""><br class="">yes? def ax/x=0:180:10/unit=degrees_e xax &nbsp;<br class="">yes? let a = x[gx=xax]; save/clob/file=a.nc a<br class="">LISTing to file a.nc<br class="">yes? sp ncdump a.nc<br class="">netcdf a {<br class="">dimensions:<br class=""><span class="Apple-tab-span" style="white-space:pre">	</span>XAX = 19 ;<br class="">variables:<br class=""><span class="Apple-tab-span" style="white-space:pre">	</span>double XAX(XAX) ;<br class=""><span class="Apple-tab-span" style="white-space:pre">	</span><span class="Apple-tab-span" style="white-space:pre">	</span>XAX:units = "degrees_east" ;<br class=""><span class="Apple-tab-span" style="white-space:pre">	</span><span class="Apple-tab-span" style="white-space:pre">	</span>XAX:point_spacing = "even" ;<br class=""><span class="Apple-tab-span" style="white-space:pre">	</span><span class="Apple-tab-span" style="white-space:pre">	</span>XAX:axis = "X" ;<br class=""><span class="Apple-tab-span" style="white-space:pre">	</span><span class="Apple-tab-span" style="white-space:pre">	</span>XAX:modulo = 360. ;<br class=""><span class="Apple-tab-span" style="white-space:pre">	</span><span class="Apple-tab-span" style="white-space:pre">	</span>XAX:standard_name = "longitude" ;<br class=""><span class="Apple-tab-span" style="white-space:pre">	</span>double A(XAX) ;<br class=""><span class="Apple-tab-span" style="white-space:pre">	</span><span class="Apple-tab-span" style="white-space:pre">	</span>A:missing_value = -1.e+34 ;<br class=""><span class="Apple-tab-span" style="white-space:pre">	</span><span class="Apple-tab-span" style="white-space:pre">	</span>A:_FillValue = -1.e+34 ;<br class=""><span class="Apple-tab-span" style="white-space:pre">	</span><span class="Apple-tab-span" style="white-space:pre">	</span>A:long_name = "X[GX=XAX]" ;<br class=""><br class="">// global attributes:<br class=""><span class="Apple-tab-span" style="white-space:pre">	</span><span class="Apple-tab-span" style="white-space:pre">	</span>:history = "FERRET V6.961 (beta) 10-Feb-16" ;<br class=""><span class="Apple-tab-span" style="white-space:pre">	</span><span class="Apple-tab-span" style="white-space:pre">	</span>:Conventions = "CF-1.6" ;<br class="">data:<br class=""><br class="">XAX = 0, 10, 20, 30, 40, 50, 60, 70, 80, 90, 100, 110, 120, 130, 140, 150,&nbsp;<br class="">&nbsp; &nbsp;160, 170, 180 ;<br class=""><br class="">A = 0, 10, 20, 30, 40, 50, 60, 70, 80, 90, 100, 110, 120, 130, 140, 150,&nbsp;<br class="">&nbsp; &nbsp;160, 170, 180 ;<br class="">}<br class=""><br class=""><br class="">Now use the file, and try some transformations across the modulo cut:<br class=""><br class="">yes? can var a; can ax xax; use a.nc<br class="">yes? list/x=0:720 a, a[x=@sbx:3], a[x=@fln], a[x=@ddf]<br class="">&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; DATA SET: ./a.nc<br class="">&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; LONGITUDE: 0E to 0E(720)<br class="">Column &nbsp;1: A is X[GX=XAX]<br class="">Column &nbsp;2: A[X=@SBX:3] is X[GX=XAX] (box smoothed by 3 pts on X)<br class="">Column &nbsp;3: A[X=@FLN:1] is X[GX=XAX] (linear-filled by 1 pts on X)<br class="">Column &nbsp;4: A[X=@DDF] is X[GX=XAX] (forward derivative on X)<br class="">&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;A &nbsp; &nbsp; A &nbsp; &nbsp; &nbsp;A &nbsp; &nbsp; &nbsp; &nbsp;A<br class="">0E &nbsp; &nbsp; &nbsp;/ &nbsp;1: &nbsp; &nbsp;0.0 &nbsp; .... &nbsp; &nbsp;0.0 &nbsp;8.993E-06<br class="">10E &nbsp; &nbsp; / &nbsp;2: &nbsp; 10.0 &nbsp; 10.0 &nbsp; 10.0 &nbsp;8.993E-06<br class="">20E &nbsp; &nbsp; / &nbsp;3: &nbsp; 20.0 &nbsp; 20.0 &nbsp; 20.0 &nbsp;8.993E-06<br class="">30E &nbsp; &nbsp; / &nbsp;4: &nbsp; 30.0 &nbsp; 30.0 &nbsp; 30.0 &nbsp;8.993E-06<br class="">40E &nbsp; &nbsp; / &nbsp;5: &nbsp; 40.0 &nbsp; 40.0 &nbsp; 40.0 &nbsp;8.993E-06<br class="">50E &nbsp; &nbsp; / &nbsp;6: &nbsp; 50.0 &nbsp; 50.0 &nbsp; 50.0 &nbsp;8.993E-06<br class="">60E &nbsp; &nbsp; / &nbsp;7: &nbsp; 60.0 &nbsp; 60.0 &nbsp; 60.0 &nbsp;8.993E-06<br class="">70E &nbsp; &nbsp; / &nbsp;8: &nbsp; 70.0 &nbsp; 70.0 &nbsp; 70.0 &nbsp;8.993E-06<br class="">80E &nbsp; &nbsp; / &nbsp;9: &nbsp; 80.0 &nbsp; 80.0 &nbsp; 80.0 &nbsp;8.993E-06<br class="">90E &nbsp; &nbsp; / 10: &nbsp; 90.0 &nbsp; 90.0 &nbsp; 90.0 &nbsp;8.993E-06<br class="">100E &nbsp; &nbsp;/ 11: &nbsp;100.0 &nbsp;100.0 &nbsp;100.0 &nbsp;8.993E-06<br class="">110E &nbsp; &nbsp;/ 12: &nbsp;110.0 &nbsp;110.0 &nbsp;110.0 &nbsp;8.993E-06<br class="">120E &nbsp; &nbsp;/ 13: &nbsp;120.0 &nbsp;120.0 &nbsp;120.0 &nbsp;8.993E-06<br class="">130E &nbsp; &nbsp;/ 14: &nbsp;130.0 &nbsp;130.0 &nbsp;130.0 &nbsp;8.993E-06<br class="">140E &nbsp; &nbsp;/ 15: &nbsp;140.0 &nbsp;140.0 &nbsp;140.0 &nbsp;8.993E-06<br class="">150E &nbsp; &nbsp;/ 16: &nbsp;150.0 &nbsp;150.0 &nbsp;150.0 &nbsp;8.993E-06<br class="">160E &nbsp; &nbsp;/ 17: &nbsp;160.0 &nbsp;160.0 &nbsp;160.0 &nbsp;8.993E-06<br class="">170E &nbsp; &nbsp;/ 18: &nbsp;170.0 &nbsp;170.0 &nbsp;170.0 &nbsp;8.993E-06<br class="">180E &nbsp; &nbsp;/ 19: &nbsp;180.0 &nbsp; .... &nbsp;180.0 &nbsp; &nbsp; &nbsp; ....<br class="">90W &nbsp; &nbsp; / 20: &nbsp; .... &nbsp; .... &nbsp; .... &nbsp; &nbsp; &nbsp; ....<br class="">0E(360) / 21: &nbsp; &nbsp;0.0 &nbsp; .... &nbsp; &nbsp;0.0 &nbsp;8.993E-06<br class="">10E &nbsp; &nbsp; / 22: &nbsp; 10.0 &nbsp; 10.0 &nbsp; 10.0 &nbsp;8.993E-06<br class="">20E &nbsp; &nbsp; / 23: &nbsp; 20.0 &nbsp; 20.0 &nbsp; 20.0 &nbsp;8.993E-06<br class="">30E &nbsp; &nbsp; / 24: &nbsp; 30.0 &nbsp; 30.0 &nbsp; 30.0 &nbsp;8.993E-06<br class="">40E &nbsp; &nbsp; / 25: &nbsp; 40.0 &nbsp; 40.0 &nbsp; 40.0 &nbsp;8.993E-06<br class="">50E &nbsp; &nbsp; / 26: &nbsp; 50.0 &nbsp; 50.0 &nbsp; 50.0 &nbsp;8.993E-06<br class="">60E &nbsp; &nbsp; / 27: &nbsp; 60.0 &nbsp; 60.0 &nbsp; 60.0 &nbsp;8.993E-06<br class="">70E &nbsp; &nbsp; / 28: &nbsp; 70.0 &nbsp; 70.0 &nbsp; 70.0 &nbsp;8.993E-06<br class="">80E &nbsp; &nbsp; / 29: &nbsp; 80.0 &nbsp; 80.0 &nbsp; 80.0 &nbsp;8.993E-06<br class="">90E &nbsp; &nbsp; / 30: &nbsp; 90.0 &nbsp; 90.0 &nbsp; 90.0 &nbsp;8.993E-06<br class="">100E &nbsp; &nbsp;/ 31: &nbsp;100.0 &nbsp;100.0 &nbsp;100.0 &nbsp;8.993E-06<br class="">110E &nbsp; &nbsp;/ 32: &nbsp;110.0 &nbsp;110.0 &nbsp;110.0 &nbsp;8.993E-06<br class="">120E &nbsp; &nbsp;/ 33: &nbsp;120.0 &nbsp;120.0 &nbsp;120.0 &nbsp;8.993E-06<br class="">130E &nbsp; &nbsp;/ 34: &nbsp;130.0 &nbsp;130.0 &nbsp;130.0 &nbsp;8.993E-06<br class="">140E &nbsp; &nbsp;/ 35: &nbsp;140.0 &nbsp;140.0 &nbsp;140.0 &nbsp;8.993E-06<br class="">150E &nbsp; &nbsp;/ 36: &nbsp;150.0 &nbsp;150.0 &nbsp;150.0 &nbsp;8.993E-06<br class="">160E &nbsp; &nbsp;/ 37: &nbsp;160.0 &nbsp;160.0 &nbsp;160.0 &nbsp;8.993E-06<br class="">170E &nbsp; &nbsp;/ 38: &nbsp;170.0 &nbsp;170.0 &nbsp;170.0 &nbsp;8.993E-06<br class="">180E &nbsp; &nbsp;/ 39: &nbsp;180.0 &nbsp; .... &nbsp;180.0 &nbsp; &nbsp; &nbsp; ....<br class="">90W &nbsp; &nbsp; / 40: &nbsp; .... &nbsp; .... &nbsp; .... &nbsp; &nbsp; &nbsp; ....<br class="">0E(720) / 41: &nbsp; &nbsp;0.0 &nbsp; .... &nbsp; &nbsp;0.0 &nbsp;8.993E-06<br class=""><br class=""><br class="">Looks good. &nbsp;Now remove the modulo and longitude attributes, and try again:<br class=""><br class="">yes? sp ncatted -O -h -a modulo,XAX,d,, -a standard_name,XAX,d,, -a units,XAX,o,c,"meters" a.nc<br class="">yes? sp ncdump a.nc<br class="">netcdf a {<br class="">dimensions:<br class=""><span class="Apple-tab-span" style="white-space:pre">	</span>XAX = 19 ;<br class="">variables:<br class=""><span class="Apple-tab-span" style="white-space:pre">	</span>double XAX(XAX) ;<br class=""><span class="Apple-tab-span" style="white-space:pre">	</span><span class="Apple-tab-span" style="white-space:pre">	</span>XAX:units = "meters" ;<br class=""><span class="Apple-tab-span" style="white-space:pre">	</span><span class="Apple-tab-span" style="white-space:pre">	</span>XAX:point_spacing = "even" ;<br class=""><span class="Apple-tab-span" style="white-space:pre">	</span><span class="Apple-tab-span" style="white-space:pre">	</span>XAX:axis = "X" ;<br class=""><span class="Apple-tab-span" style="white-space:pre">	</span>double A(XAX) ;<br class=""><span class="Apple-tab-span" style="white-space:pre">	</span><span class="Apple-tab-span" style="white-space:pre">	</span>A:missing_value = -1.e+34 ;<br class=""><span class="Apple-tab-span" style="white-space:pre">	</span><span class="Apple-tab-span" style="white-space:pre">	</span>A:_FillValue = -1.e+34 ;<br class=""><span class="Apple-tab-span" style="white-space:pre">	</span><span class="Apple-tab-span" style="white-space:pre">	</span>A:long_name = "X[GX=XAX]" ;<br class=""><br class="">// global attributes:<br class=""><span class="Apple-tab-span" style="white-space:pre">	</span><span class="Apple-tab-span" style="white-space:pre">	</span>:history = "FERRET V6.961 (beta) 10-Feb-16" ;<br class=""><span class="Apple-tab-span" style="white-space:pre">	</span><span class="Apple-tab-span" style="white-space:pre">	</span>:Conventions = "CF-1.6" ;<br class="">data:<br class=""><br class="">XAX = 0, 10, 20, 30, 40, 50, 60, 70, 80, 90, 100, 110, 120, 130, 140, 150,&nbsp;<br class="">&nbsp; &nbsp;160, 170, 180 ;<br class=""><br class="">A = 0, 10, 20, 30, 40, 50, 60, 70, 80, 90, 100, 110, 120, 130, 140, 150,&nbsp;<br class="">&nbsp; &nbsp;160, 170, 180 ;<br class="">}<br class="">yes? can dat/all; use a.nc<br class="">yes? list/x=0:720 a, a[x=@sbx:3], a[x=@fln], a[x=@ddf]<br class="">&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; DATA SET: ./a.nc<br class="">&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; X (meters): 0 to 185<br class="">Column &nbsp;1: A is X[GX=XAX]<br class="">Column &nbsp;2: A[X=@SBX:3] is X[GX=XAX] (box smoothed by 3 pts on X)<br class="">Column &nbsp;3: A[X=@FLN:1] is X[GX=XAX] (linear-filled by 1 pts on X)<br class="">Column &nbsp;4: A[X=@DDF] is X[GX=XAX] (forward derivative on X)<br class="">&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;A &nbsp; &nbsp; A &nbsp; &nbsp; &nbsp;A &nbsp; &nbsp; &nbsp;A<br class="">0 &nbsp; &nbsp; / &nbsp;1: &nbsp; &nbsp;0.0 &nbsp; .... &nbsp; &nbsp;0.0 &nbsp;1.000<br class="">10 &nbsp; &nbsp;/ &nbsp;2: &nbsp; 10.0 &nbsp; 10.0 &nbsp; 10.0 &nbsp;1.000<br class="">20 &nbsp; &nbsp;/ &nbsp;3: &nbsp; 20.0 &nbsp; 20.0 &nbsp; 20.0 &nbsp;1.000<br class="">30 &nbsp; &nbsp;/ &nbsp;4: &nbsp; 30.0 &nbsp; 30.0 &nbsp; 30.0 &nbsp;1.000<br class="">40 &nbsp; &nbsp;/ &nbsp;5: &nbsp; 40.0 &nbsp; 40.0 &nbsp; 40.0 &nbsp;1.000<br class="">50 &nbsp; &nbsp;/ &nbsp;6: &nbsp; 50.0 &nbsp; 50.0 &nbsp; 50.0 &nbsp;1.000<br class="">60 &nbsp; &nbsp;/ &nbsp;7: &nbsp; 60.0 &nbsp; 60.0 &nbsp; 60.0 &nbsp;1.000<br class="">70 &nbsp; &nbsp;/ &nbsp;8: &nbsp; 70.0 &nbsp; 70.0 &nbsp; 70.0 &nbsp;1.000<br class="">80 &nbsp; &nbsp;/ &nbsp;9: &nbsp; 80.0 &nbsp; 80.0 &nbsp; 80.0 &nbsp;1.000<br class="">90 &nbsp; &nbsp;/ 10: &nbsp; 90.0 &nbsp; 90.0 &nbsp; 90.0 &nbsp;1.000<br class="">100 &nbsp; / 11: &nbsp;100.0 &nbsp;100.0 &nbsp;100.0 &nbsp;1.000<br class="">110 &nbsp; / 12: &nbsp;110.0 &nbsp;110.0 &nbsp;110.0 &nbsp;1.000<br class="">120 &nbsp; / 13: &nbsp;120.0 &nbsp;120.0 &nbsp;120.0 &nbsp;1.000<br class="">130 &nbsp; / 14: &nbsp;130.0 &nbsp;130.0 &nbsp;130.0 &nbsp;1.000<br class="">140 &nbsp; / 15: &nbsp;140.0 &nbsp;140.0 &nbsp;140.0 &nbsp;1.000<br class="">150 &nbsp; / 16: &nbsp;150.0 &nbsp;150.0 &nbsp;150.0 &nbsp;1.000<br class="">160 &nbsp; / 17: &nbsp;160.0 &nbsp;160.0 &nbsp;160.0 &nbsp;1.000<br class="">170 &nbsp; / 18: &nbsp;170.0 &nbsp;170.0 &nbsp;170.0 &nbsp;1.000<br class="">180 &nbsp; / 19: &nbsp;180.0 &nbsp; .... &nbsp;180.0 &nbsp; ....<br class=""><br class="">As desired, no subspan modulo behavior. &nbsp;So things look good.<br class=""><br class="">Note that while trying this, I *did* find one additional bug in the handling of centered differences (@ddc) at the inserted void point. &nbsp;I'll report this&nbsp;separately to the developers.<br class=""><br class="">Andrew<br class=""><br class="">On Wed, Feb 10, 2016 at 6:06 AM, Martin Schmidt &lt;martin.schmidt@xxxxxxxxxxxxxxxxx&gt; wrote:<br class="">Dear all,<br class="">I would also support the idea to change the default behaviour for subspan axis - for the following reason:<br class="">For unexperienced users it seems that ferret "knows" a lot of things, like a little miracle. We know, the secret behind this is, ferret uses all information&nbsp;in the input files as best as possible, but cannot add missing information. The CF-standard defines the meaning of the attributes. It is the strength of&nbsp;ferret, to keep data, axis and metadata together. There is no need to control the relation between them all the time, unlike in matlab for example. This&nbsp;avoids a lot of programming and prevents users from making errors.<br class=""><br class="">But changing the axis- and meta-information silently is a little bit against this "basic ferret philosophy". To see what I mean, assume,<br class="">you want to use the output of a regional model. There is a variable eta_t in the data set.<br class=""><br class="">yes? use "http://phy-50:8080/thredds/dodsC/genus/genus_run_88_5day_ocean.nc"<br class="">yes? say `eta_t,return=xaxis`<br class="">!-&gt; MESSAGE/CONTINUE XT_OCEAN<br class="">XT_OCEAN<br class="">yes? show axis XT_OCEAN<br class="">name &nbsp; &nbsp; &nbsp; axis &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;# pts &nbsp; start &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;end<br class="">XT_OCEAN &nbsp;LONGITUDE &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;273mi &nbsp; 10.075W(-10.075) 18.048E(18.048)<br class="">&nbsp; Axis span (to cell edges) = 28.24585 (modulo length = 360)<br class=""><br class="">Ferret tells me the variable eta_t has a modula axis. But it has not. With ncdump I get:<br class="">&nbsp; &nbsp; &nbsp; &nbsp;double xt_ocean(xt_ocean) ;<br class="">&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;xt_ocean:long_name = "tcell longitude" ;<br class="">&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;xt_ocean:units = "degrees_E" ;<br class="">&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;xt_ocean:cartesian_axis = "X" ;<br class="">&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;xt_ocean:_ChunkSize = 273 ;<br class="">The original axis definition may be read correctly, but it is changed later to modulo by ferret. Writing some data to a file they are branded with the&nbsp;modulo-axis.<br class="">In most cases this is not a big deal, but ferret changes the information delivered from the netcdf-file, so it changes something silently, which my have&nbsp;been defined by the creator of the dataset with some intension. It is not possible to check with ferret, if axis in a data set are modulo or not. They are&nbsp;allways modulo.<br class=""><br class="">Another argument is that the pair of operations "use" and " save" is not pass-through like but changes information inbetween.<br class=""><br class="">Anyway, I am using ferret a lot and could be happy with any default. But, in the case if I could have a free wish ... axis should be used exactly as&nbsp;defined either<br class="">from the command line or from file information. Specifying the modulo attribute means "modulo" otherwise "not modulo".<br class=""><br class="">Best,<br class="">Martin<br class=""><br class=""><br class=""><br class=""><br class="">Am 10.02.2016 um 06:17 schrieb William S. Kessler:<br class="">Count me as another user who thinks the subspan modulo behavior should not be the default.<br class=""><br class="">I recall your explanation of this feature (28 Oct 2011):<br class=""><br class="">The importance of the subspan modulo axes is to take the first of two steps that will make it possible for users largely to ignore differences in&nbsp;encodings of longitude and climatological time -- e.g. the blending of data in plots and analyses where the data come from data sets that are encoded&nbsp;variously as -180:180, 0:360, etc. &nbsp;Thus, for example, in V5.5 you can refer to my_subspan_var[g=another_var] and get a meaningful answer as long&nbsp;as the grids occupy the same region on the globe, regardless of longitude encoding. (The second step, for V5.6, will address the longitude encoding of&nbsp;scattered data.)<br class="">I can see how that might be useful in particular situations, but the cost is the mistaken plots and analyses by other users - working with grids covering&nbsp;subregions of the globe - who forget to declare the axis non-modulo, and unwittingly smooth or fill in x (or take a derivative, etc). Then Ferret will&nbsp;wrap the operation across the edges of the region inappropriately. As someone who frequently works with Pacific fields, I can't tell you how many&nbsp;times I've slapped my forehead and gotten a different result after remembering to CAN AXIS/MODULO. But those who are less-acquainted with this&nbsp;might make the mistake and not realize that their plot is wrong.<br class=""><br class="">My sense of the balance is that this feature should be available, but not the default, because I'll bet most Ferret users don't realize that this will&nbsp;happen. They haven't fully read the documentation and assume - very reasonably - that the default for a subregion is non-modulo.And even for those&nbsp;who do know this, like me, it's a very easy feature to forget in the heat of calculation.<br class=""><br class="">I think the default should be non-modulo for axes where x is given in degrees east, unless the axis is fully global, since the user who wants this&nbsp;feature can always turn it on (SET AXIS/MODULO), right?<br class=""><br class="">Billy K<br class=""><br class="">On Feb 9, 2016, at 5:16 PM, Steve Hankin &lt;steven.c.hankin@xxxxxxxx&gt; wrote:<br class=""><br class="">On 2/9/2016 4:47 PM, Ryo Furue wrote:<br class="">Hi Steve,<br class=""><br class="">Thanks for your detailed explanation.<br class=""><br class="">An axis may be less than global (e.g. axis "x30") and still be understood to<br class="">have modulo 360 behavior. &nbsp;This is inferred automatically from its units of<br class="">degrees_east. &nbsp; To reliably regard a variable defined on an X axis of more<br class="">than 360 degrees, Ferret would have to check that the overlapping points at<br class="">each end all had identical values.<br class="">Or you COULD just issue a warning and disregard the values on one of<br class="">the overlapping "layers". &nbsp;I'm not saying you SHOULD.<br class=""><br class="">&nbsp;Ferret has no internal logic to do this.<br class="">Yes, I guessed that that is the reason why Ferret currently rejects<br class="">such an overlapping axis.<br class="">There are cases where people deliberately create variables on longitude ranges of (say) 720 degrees (double worlds). &nbsp;All other things being equal it&nbsp;seems best not to second guess what people are doing.<br class="">P.S. &nbsp;The attribute "modulo" is from older Ferret versions.<br class="">So, what's the latest alternative? &nbsp;Is it a Ferret-specific attribute?<br class="">&nbsp;Or is it part of a well-recognized convention like CF?<br class="">The "modulo" attribute was a Ferret creation -- not CF. &nbsp;Somewhere along the way, Ferret was enhanced to support the notion of a "subspan modulo&nbsp;axis" -- modulo behavior, even though the axis isn't globe-encircling. &nbsp;The axis X30 in the previous message was an example. &nbsp;With the advent of&nbsp;subspan modulo axes, all longitude axes 360 degrees or less became implicitly "modulo". &nbsp;So the older modulo attribute is essentially irrelevant. (But&nbsp;no harm from having it in a file AFAIK.)<br class=""><br class="">&nbsp; &nbsp;- Steve<br class="">The dataset I was given actually includes the "modulo" attribute. &nbsp;I'm<br class="">not sure if the creators of the dataset use Ferret.<br class=""><br class="">Basically, I'd like to know if I should ask the creators to fix it.<br class="">They are a data center and so they do care about these things.<br class=""><br class="">Ryo<br class=""><br class=""><br class=""><br class=""></blockquote><br class=""></blockquote><br class=""><div class="">~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~<br class="">William S. Kessler<br class="">NOAA / Pacific Marine Environmental Laboratory<br class="">7600 Sand Point Way NE<br class="">Seattle WA 98115 USA<br class=""><br class=""><a rel="nofollow" href="mailto:william.s.kessler@xxxxxxxx" class="">william.s.kessler@xxxxxxxx</a><br class="">Tel: +1 206-526-6221<br class="">Fax: +1 206-526-6744<br class="">Web:&nbsp;http://faculty.washington.edu/kessler/<br class=""></div><br class=""></div></td></tr></table>
<!--X-Body-of-Message-End-->
<!--X-MsgBody-End-->
<!--X-Follow-Ups-->
<hr>
<!--X-Follow-Ups-End-->
<!--X-References-->
<ul><li><strong>References</strong>:
<ul>
<li><strong><a name="00084" href="msg00084.html">[ferret_users] modulo longitude standards?</a></strong>
<ul><li><em>From:</em> Ryo Furue</li></ul></li>
<li><strong><a name="00085" href="msg00085.html">Re: [ferret_users] modulo longitude standards?</a></strong>
<ul><li><em>From:</em> Steve Hankin</li></ul></li>
<li><strong><a name="00086" href="msg00086.html">Re: [ferret_users] modulo longitude standards?</a></strong>
<ul><li><em>From:</em> Ryo Furue</li></ul></li>
<li><strong><a name="00087" href="msg00087.html">Re: [ferret_users] modulo longitude standards?</a></strong>
<ul><li><em>From:</em> Steve Hankin</li></ul></li>
<li><strong><a name="00088" href="msg00088.html">Re: [ferret_users] modulo longitude standards?</a></strong>
<ul><li><em>From:</em> William S. Kessler</li></ul></li>
<li><strong><a name="00089" href="msg00089.html">Re: [ferret_users] modulo longitude standards?</a></strong>
<ul><li><em>From:</em> Martin Schmidt</li></ul></li>
<li><strong><a name="00096" href="msg00096.html">Re: [ferret_users] modulo longitude standards?</a></strong>
<ul><li><em>From:</em> Andrew Wittenberg - NOAA Federal</li></ul></li>
<li><strong><a name="00101" href="msg00101.html">Re: [ferret_users] modulo longitude standards?</a></strong>
<ul><li><em>From:</em> Billy Kessler</li></ul></li>
</ul></li></ul>
<!--X-References-End-->
<!--X-BotPNI-->
<UL>
<li>Previous by thread:
<strong><a href="msg00101.html">Re: [ferret_users] modulo longitude standards?</a></strong>
</li>
<li>Next by thread:
<strong><a href="msg00092.html">Re: [ferret_users] modulo longitude standards?</a></strong>
</li>

</UL>
<center>[<a href="msg00101.html">Thread Prev</a>][<a href="msg00092.html">Thread Next</a>][<A HREF="threads.html#00102">Index</A>]</center>

<!--X-BotPNI-End-->
<!--X-User-Footer-->
<A HREF="http://ferret.pmel.noaa.gov/Ferret/contact-us">Contact Us</A>
<br>
<font size=-1>
<address>
<a href="http://www.doc.gov">Dept of Commerce</a> /
<a href="http://www.noaa.gov">NOAA</a> /
<a href="http://www.oar.noaa.gov">OAR</a> /
<a href="http://www.pmel.noaa.gov">PMEL</a> /
<a href="http://ferret.pmel.noaa.gov">Ferret</a>
</address>

<br>
 <a href="http://www.noaa.gov/privacy.html">Privacy Policy</a> | <a href="http://www.noaa.gov/disclaimer.html">Disclaimer</a> | <a href="accessibility.html">Accessibility Statement</a> 

</font>
<!--X-User-Footer-End-->
</body>
</html>
