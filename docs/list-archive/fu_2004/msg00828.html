<!-- MHonArc v2.5.13 -->
<!--X-Subject: Re: Finding average value over desired  grids -->
<!--X-From-R13: Oafyrl [naxr <nafyrl.o.znaxrNabnn.tbi> -->
<!--X-Date: Fri, 19 Nov 2004 10:47:43 &#45;0800 -->
<!--X-Message-Id: 419E405C.4010603@noaa.gov -->
<!--X-Content-Type: multipart/alternative -->
<!--X-Reference: 20041119092021.83950.qmail@web41712.mail.yahoo.com -->
<!--X-Head-End-->
<!doctype html public "-//W3C//DTD HTML//EN">
<html>
<head>
<title>Re: Finding average value over desired  grids</title>
</head>
<body>
<!--X-Body-Begin-->
<!--X-User-Header-->
<!--X-User-Header-End-->
<!--X-TopPNI-->
<HR>
<center>[<a href="msg00826.html">Thread Prev</a>][<a href="msg00733.html">Thread Next</a>][<A HREF="threads.html#00828">Index</A>]</center>

<!--X-TopPNI-End-->
<!--X-MsgBody-->
<!--X-Subject-Header-Begin-->
<h1>Re: Finding average value over desired  grids</h1>
<hr>
<!--X-Subject-Header-End-->
<!--X-Head-of-Message-->
<ul>
<li><strong>To</strong>: <strong>jagadish karmacharya &lt;<a href="mailto:j_karmacharya@DOMAIN.HIDDEN">j_karmacharya@xxxxxxxxx</a>&gt;</strong></li>
<li><strong>Subject</strong>: <strong>Re: Finding average value over desired  grids</strong></li>
<li><strong>From</strong>: <strong>Ansley Manke &lt;<a href="mailto:ansley.b.manke@DOMAIN.HIDDEN">ansley.b.manke@xxxxxxxx</a>&gt;</strong></li>
<li>Date: Fri, 19 Nov 2004 10:50:04 -0800</li>
<li>Cc: <a href="mailto:ferret_users@DOMAIN.HIDDEN">ferret_users@xxxxxxxx</a></li>
<li>In-reply-to: &lt;<a href="msg00826.html">20041119092021.83950.qmail@web41712.mail.yahoo.com</a>&gt;</li>
<li>References: &lt;<a href="msg00826.html">20041119092021.83950.qmail@web41712.mail.yahoo.com</a>&gt;</li>
<li>Sender: <a href="mailto:owner-ferret_users@DOMAIN.HIDDEN">owner-ferret_users@xxxxxxxxxxxxx</a></li>
<li>User-agent: Mozilla/5.0 (Windows; U; Windows NT 5.1; en-US; rv:1.4) Gecko/20030624 Netscape/7.1 (ax)</li>
</ul>
<!--X-Head-of-Message-End-->
<!--X-Head-Body-Sep-Begin-->
<hr>
<!--X-Head-Body-Sep-End-->
<!--X-Body-of-Message-->
<table width="100%"><tr><td bgcolor="#ffffff" style="background-color: #ffffff; color: #000000; "><font color="#000000">



Hi jagadish<br>
I'm glad you wrote again.&nbsp;&nbsp; The idea you need is to create a mask which
defines <br>
the region you want and apply it before taking the average.&nbsp; There is
an FAQ <br>
which should help you get started,<br>
<ul>
  <li><a
 href=""><b>Averaging/integrating
over irregular regions in Ferret.</b></a> </li>
</ul>
<a class="moz-txt-link-freetext" href="">http://www.ferret.noaa.gov/Ferret/FAQ/analysis/avg_integ_irreg.html</a><br>
<br>
Ansley Manke<br>
<br>
jagadish karmacharya wrote:<br>
<blockquote type="cite"
 cite="">
  <div>Dear all,</div>
  <div>It seems my last mail went unnoticed so i am sending it again.
May be&nbsp; there were some ambiguty in my&nbsp;prevous mail. so let me rewrite
what i am looking for:</div>
  <div>I want to&nbsp;average value of a variable over a number of grid.
This is preety simple if we want to&nbsp;&nbsp;average over all the grid within a
rectangular box. but i want to find average value from a number of
grids&nbsp;that have shapes other than a rectangular box( when we consider
their outer boundry.) I have seen examples where masking is used for
such cases. Now what is the solution if its difficult to define a mask&nbsp;
just valid for the grids of my concern and false for other neighbouring
grids.</div>
  <div>Hope i made myself clear this time&nbsp; <br>
Regards</div>
  <div>jagadish<br>
  <b><i>jagadish karmacharya <a class="moz-txt-link-rfc2396E" href="">&lt;j_karmacharya@yahoo.com&gt;</a></i></b>
wrote:</div>
  <blockquote class="replbq"
 >
    <div>Dear Jaison and all,</div>
    <div>&nbsp;</div>
    <div>Regriding the variable to a regular longitude axis and then
use the new variable as the source data for sampling helps .ie it give
the average value&nbsp;(but doesn't Bail out of external function
"samplexy"). </div>
    <div>but i&nbsp;am actually looking for&nbsp;a way to&nbsp;calculate average
value&nbsp;over a number of scattered grids. I think what i got with
Regriding&nbsp; is average of &nbsp;the scattered x-y coordinates(points).or am i
getting it wrong?</div>
    <div>Please&nbsp;suggest me a way find the arial average over
non-rectangular( irregular) grids.</div>
    <div>thanking in advance&nbsp;</div>
    <div>jagadish&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<br>
&nbsp;<br>
    <br>
    <b><i>Jaison Kurian <a class="moz-txt-link-rfc2396E" href="">&lt;jaison@caos.iisc.ernet.in&gt;</a></i></b> wrote:</div>
    <blockquote class="replbq"
 >Hi
Jagadish,<br>
External function SAMPLEXY needs the "MODULO" axis of the <br>
variable (if any) to be a "regular" one (ie. uniformly spaced). For <br>
example your script will work for Levitus climatology, using "show
axis" <br>
command to know the axis properties....<br>
      <br>
yes? use levitus_climatology<br>
yes? show axis XAXLEVITR ! longitude (x) axis for variables temp &amp; <br>
salt<br>
name axis # pts start end<br>
XAXLEVITR LONGITUDE 360mr 20.5E 19.5E(379.5)<br>
Axis span (to cell edges) = 360 (modulo length = axis span)<br>
yes?<br>
      <br>
pts is given as 360mr : here m ==&gt; modulo &amp; r ==&gt; regular<br>
      <br>
For your dataset, it will be "***mi". <br>
      <br>
You can regrid the variable to a regular longitude axis and then use <br>
the new variable as the source data for sampling (see the example
below).<br>
      <br>
Hope this helps <br>
      <br>
With regards<br>
      <br>
Jaison<br>
      <br>
Example : <br>
---------<br>
      <br>
! create an "irregular" &amp; MODULO longitude axis<br>
      <br>
let xdata = XSEQUENCE({0,5,10,15,20,25,30,40,50,60,70,80,90,100})<br>
define axis/x/units=longitudes/MODULO/from_data xax=xdata <br>
show axis xax<br>
      <br>
! create some data defined over this axis<br>
      <br>
define axis/y=-30:30:1/units=latitudes yax <br>
define axis/z=0:500:25/units=meters/DEPTH zax<br>
let var = sin(x[gx=xax]/100 + y[gy=yax]/100 + z[gz=zax]/50)<br>
      <br>
! do the sampling<br>
      <br>
LET xlon = 34.5 + I[I=1:50] ! define the slant line<br>
LET dely = 24./49<br>
LET ylat = 24.5 - dely*i[i=1:50] + dely<br>
! IF we do the sampling now ..it will fail...try it out by<br>
! uncommenting the following line..<br>
! LET slantsalt = samplexy(var,xlon,ylat) ; fill slantsalt<br>
      <br>
! So let us regrid the variable to a regular axis <br>
      <br>
define axis/x=0:100:10/units=longitudes/MODULO xregular<br>
show axis xregular<br>
      <br>
let var_reg = var[gx=xregular] <br>
LET slantsalt = samplexy(var_reg[y=-10:10,x=10:40],xlon,ylat)<br>
fill slantsalt<br>
!----------------------------------<br>
      <br>
      <br>
On Sun, 17 Oct 2004, jagadish karmacharya wrote:<br>
      <br>
&gt; Dear Ansley, <br>
&gt; SAMPLEXY funtion works fine for the examples you mentioned but it
did not work with my data. I used following commands which generate the
following error: <br>
&gt; <br>
&gt; yes? LET xlon=82+I[I=1:6]<br>
&gt; yes? LET dely = 24./49<br>
&gt; yes? LET ylat = 24.5 - dely*i[i=1:6] + dely<br>
&gt; yes? PLOT/VS/LINE/SYM=27 xlon,ylat ! gives slanted line<br>
&gt; <br>
&gt; yes? LET slanttk = samplexy(tk[x=80:90,y=20:25,L=1],xlon,ylat)<br>
&gt; yes? FILL slanttk<br>
&gt; Bailing out of external function "samplexy":<br>
&gt; cannot handle MODULO axis that is not regular<br>
&gt; **ERROR: : error in external function<br>
&gt; <br>
&gt; I wonder what caused the error.<br>
&gt; <br>
&gt; thanking you in advance<br>
&gt; <br>
&gt; jagadish<br>
&gt; <br>
&gt; ps : my dataset<br>
&gt; <br>
&gt; yes? show data<br>
&gt; ; ; currently SET data sets:<br>
&gt; 1&gt; ./ATMJJAS-DAILYAVG.CDF (default)<br>
&gt; name title I J K L<br>
&gt; U Zonal Wind 1:63 1:66 1:18 1:122<br>
&gt; V Meridional Wind 1:63 1:66 1:18 1:122<br>
&gt; TK Temperature 1:63 1:66 1:18 1:122<br>
&gt; QD Mixing Ratio 1:63 1:66 1:18 1:122<br>
&gt; QC Cloud Mixing Ratio 1:63 1:66 1:18 1:122<br>
&gt; MSE Moist Static Energy 1:63 1:66 1:18 1:122<br>
&gt; RH Relative Humidity 1:63 1:66 1:18 1:122<br>
&gt; HGT Geopotential Height 1:63 1:66 1:18 1:122<br>
&gt; PS Surface Pressure 1:63 1:66 ... 1:122<br>
&gt; RT Total Precip 1:63 1:66 ... 1:122<br>
&gt; TGRND Ground Temperature 1:63 1:66 ... 1:122<br>
&gt; SMT Total Soil Water 1:63 1:66 ... 1:122<br>
&gt; RB Base Flow 1:63 1:66 ... 1:122<br>
&gt; <br>
&gt; <br>
&gt; Ansley Manke <ANSLEY .b.manke@noaa.gov="">wrote: Hello Jagadish,<br>
&gt; There is an example which does this kind of thing in the <br>
&gt; Users Guide. Look up "SAMPLEXY, function definition".<br>
&gt; The X axis of the plot that is made has just a count of points, <br>
&gt; 1 for the first point, 2 for the second point and so on. Here <br>
&gt; is the example from the Users Guide, which shows how to define<br>
&gt; a set of points along a line. You could also define them as lists
as I<br>
&gt; did in the previous email. This example has depth vs location;
time <br>
&gt; vs location would be analogous.<br>
&gt; <br>
&gt; USE ocean_atlas_annual<br>
&gt; LET xlon = 234.5 + I[I=1:50] ! define the slant line<br>
&gt; LET dely = 24./49<br>
&gt; LET ylat = 24.5 - dely*i[i=1:50] + dely<br>
&gt; <br>
&gt; LET slantsalt = samplexy(salt[x=200:300,y=0:30],xlon,ylat)<br>
&gt; FILL/LEVELS=(33.2,35.2,0.1)/VLIMITS=0:4000 slantsalt <br>
&gt; <br>
&gt; Ansley<br>
&gt; <br>
&gt; <br>
&gt; <br>
&gt; <br>
&gt; <br>
&gt; ---------------------------------<br>
&gt; Do you Yahoo!?<br>
&gt; vote.yahoo.com - Register online to vote today!<br>
      <br>
-- <br>
___________________________________________________<br>
      <br>
Jaison Kurian <br>
Centre for Atmospheric and Oceanic Sciences<br>
I ndian Institute of Science<br>
B A N G A L O R E 560 012<br>
Ph: +91-80-3942505<br>
+91-80-3600450<br>
Fax:+91-80-3600865<br>
___________________________________________________<br>
      <br>
      </ANSLEY></blockquote>
    <p>
    </p>
    <hr size="1">Do you Yahoo!?<br>
Check out the new Yahoo! Front Page. <a href="">www.yahoo.com</a></blockquote>
  <p> </p>
  <hr size="1">Do you Yahoo!?<br>
Discover all that&#8217;s new in <a href="">My Yahoo!</a>
</blockquote>


</font></td></tr></table>
<!--X-Body-of-Message-End-->
<!--X-MsgBody-End-->
<!--X-Follow-Ups-->
<hr>
<!--X-Follow-Ups-End-->
<!--X-References-->
<ul><li><strong>References</strong>:
<ul>
<li><strong><a name="00826" href="msg00826.html">Finding average value over desired  grids</a></strong>
<ul><li><em>From:</em> jagadish karmacharya</li></ul></li>
</ul></li></ul>
<!--X-References-End-->
<!--X-BotPNI-->
<UL>
<li>Previous by thread:
<strong><a href="msg00826.html">Finding average value over desired  grids</a></strong>
</li>
<li>Next by thread:
<strong><a href="msg00733.html">lon/lat format</a></strong>
</li>

</UL>
<center>[<a href="msg00826.html">Thread Prev</a>][<a href="msg00733.html">Thread Next</a>][<A HREF="threads.html#00828">Index</A>]</center>

<!--X-BotPNI-End-->
<!--X-User-Footer-->
<hr>
<font size=-1>
<address>
<a href="http://www.doc.gov">Dept of Commerce</a> / 
<a href="http://www.noaa.gov">NOAA</a> /
<a href="http://www.oar.noaa.gov">OAR</a> /
<a href="http://www.pmel.noaa.gov">PMEL</a> /
<a href="http://tmap.pmel.noaa.gov">TMAP</a>
</address> <br> <a href="http://ferret.pmel.noaa.gov/Ferret/ferret_contact_us.html">Contact Us</a> | <a href="http://www.noaa.gov/privacy.html">Privacy Policy</a> | <a href="http://www.noaa.gov/disclaimer.html">Disclaimer</a> | <a href="accessibility.html">Accessibility Statement</a> 
</font>
<!--X-User-Footer-End-->
</body>
</html>
