<!-- MHonArc v2.5.13 -->
<!--X-Subject: Re: Transform World Ocean Atlas 1/4 x 1/4 degree to NEtCDF -->
<!--X-From-R13: Xnvfba Yhevna <wnvfbaNpnbf.vvfp.rearg.va> -->
<!--X-Date: Wed, 1 Dec 2004 09:55:35 &#45;0800 -->
<!--X-Message-Id: Pine.LNX.4.44.0412012314570.13658&#45;200000@caos.iisc.ernet.in -->
<!--X-Content-Type: multipart/mixed -->
<!--X-Reference: 316B2A85&#45;4378&#45;11D9&#45;863F&#45;000D936BDBBE@soc.soton.ac.uk -->
<!--X-Head-End-->
<!doctype html public "-//W3C//DTD HTML//EN">
<html>
<head>
<title>Re: Transform World Ocean Atlas 1/4 x 1/4 degree to NEtCDF</title>
</head>
<body>
<!--X-Body-Begin-->
<!--X-User-Header-->
<!--X-User-Header-End-->
<!--X-TopPNI-->
<HR>
<center>[<a href="msg00859.html">Thread Prev</a>][<a href="msg00852.html">Thread Next</a>][<A HREF="threads.html#00861">Index</A>]</center>

<!--X-TopPNI-End-->
<!--X-MsgBody-->
<!--X-Subject-Header-Begin-->
<h1>Re: Transform World Ocean Atlas 1/4 x 1/4 degree to NEtCDF</h1>
<hr>
<!--X-Subject-Header-End-->
<!--X-Head-of-Message-->
<ul>
<li><strong>To</strong>: <strong><a href="mailto:ferret_users@DOMAIN.HIDDEN">ferret_users@xxxxxxxx</a></strong></li>
<li><strong>Subject</strong>: <strong>Re: Transform World Ocean Atlas 1/4 x 1/4 degree to NEtCDF</strong></li>
<li><strong>From</strong>: <strong>Jaison Kurian &lt;<a href="mailto:jaison@DOMAIN.HIDDEN">jaison@xxxxxxxxxxxxxxxxxx</a>&gt;</strong></li>
<li>Date: Wed, 1 Dec 2004 23:34:12 +0530 (IST)</li>
<li>Cc: James Harle &lt;<a href="mailto:jdha@DOMAIN.HIDDEN">jdha@xxxxxxxxxxxxxxx</a>&gt;,  namba takaya &lt;<a href="mailto:takayanamba11@DOMAIN.HIDDEN">takayanamba11@xxxxxxxxxxx</a>&gt;, Joe McLean &lt;<a href="mailto:joe.mclean@DOMAIN.HIDDEN">joe.mclean@xxxxxxxx</a>&gt;</li>
<li>In-reply-to: &lt;<a href="msg00859.html">316B2A85-4378-11D9-863F-000D936BDBBE@soc.soton.ac.uk</a>&gt;</li>
<li>Sender: <a href="mailto:owner-ferret_users@DOMAIN.HIDDEN">owner-ferret_users@xxxxxxxxxxxxx</a></li>
</ul>
<!--X-Head-of-Message-End-->
<!--X-Head-Body-Sep-Begin-->
<hr>
<!--X-Head-Body-Sep-End-->
<!--X-Body-of-Message-->
<pre>Hi Namba, James, Joe &amp; others,
                                What about doing the ascii to NetCDf 
conversion in Ferret itself ? I just made a script to do this (please
see the attchment ascii2nc.jnl) for the monthly climatology dataset. 
You can find the details inside the script. To use this script :

       1. Get the temperature/salinity ascii data files (t001_v2.gz..
              or s001_v2.gz) from 
             <a  href="http://www.nodc.noaa.gov/OC5/WOA01/qd_ts01.html">http://www.nodc.noaa.gov/OC5/WOA01/qd_ts01.html</a> for all
             12 months &amp; unzip it.
             If you are dealing with seasonal/annual climatology, you
             have to modify the script according to that. 
       2. In ascii2nc.jnl, under USER INPUT  choose
                a) prfx     ==&gt;  &quot;t&quot; for temp and &quot;s&quot; for salinity
                b) varname  ==&gt;  name of output variable 
                c) outfile  ==&gt;  output filename
                d) vartitle ==&gt;  a meaningfull title for the variable
                e) varunits ==&gt;  units for the variable
       3. Start Ferret with more memory cache..like
               [user@machine]$ ferret -memsize 300mb
            and run ascii2nc.jnl
            IF your Ferret version is not 5.6 or 5.7 you have to modify
            the REPEAT loop towards the end of the script. 

  Please note that currently the script takes care off data upto 1500m 
only. If you want to have the seasonal/annual fields below this depth
upto 5500m, you have to modify the script.

    Let me know if you have any questions.

 Hope this helps 

 With Regards 

 Jaison 

On Wed, 1 Dec 2004, James Harle wrote:

&gt; Dear Takaya
&gt; 
&gt; I have been recently using the WOA 1/4 degree data and have converted 
&gt; them into netdcf. The way I did it was modify the fortran code 
&gt; generated from the UNIX ncgen routine for a typical netcdf file. I will 
&gt; forward the routine to you, but if anyone else would like a copy just 
&gt; drop me an email. It combines T and S data into one netcdf file and 
&gt; fills in the deeper levels in the monthly mean files with either 
&gt; seasonal or annual means (i think - I haven't used the routine for 
&gt; ages).... if you have any questions just ask!
&gt; 
&gt; Cheers
&gt; 
&gt; James
&gt; 
&gt; On 1 Dec 2004, at 01:51, namba takaya wrote:
&gt; 
&gt; &gt; Dear Joe
&gt; &gt;
&gt; &gt; Thank you very much for your kindness.
&gt; &gt; If I can get the fortran code for 1 x 1 degree to NetCDF with the 
&gt; &gt; acceptance of Mark,  I am very pleased and will be able to modify it 
&gt; &gt; for 1/4 x 1/4 by myself.
&gt; &gt; Best Regards,
&gt; &gt;
&gt; &gt; Takaya Namba
&gt; &gt;&gt; From: Joe McLean &lt;joe.mclean@noaa.gov&gt;
&gt; &gt;&gt; To: namba takaya &lt;takayanamba11@hotmail.com&gt;
&gt; &gt;&gt; CC: ferret_users@noaa.gov,  &quot;Mark.Collier@csiro.au&quot;
&gt; &gt; &lt;Mark.Collier@csiro.au&gt;
&gt; &gt;&gt; Subject: Re: Transform World Ocean Atlas 1/4 x 1/4 degree to NEtCDF
&gt; &gt;&gt; Date: Tue, 30 Nov 2004 14:43:51 -0800
&gt; &gt;&gt;
&gt; &gt;&gt; Namba-san,
&gt; &gt;&gt;
&gt; &gt;&gt; I see what you are talking about now. In February, 2003, I put out the
&gt; &gt;&gt; word through both the Ferret users and LAS users mailing lists that I
&gt; &gt;&gt; was looking for a way to translate the NODC/OCL World Ocean Atlas data
&gt; &gt;&gt; from the native OCL format to NetCDF format. The OCL format is a 
&gt; &gt;&gt; unique
&gt; &gt;&gt; compressed ascii representation of the data, and is not conducive to
&gt; &gt;&gt; Ferret commands for reading ASCII data.
&gt; &gt;&gt;
&gt; &gt;&gt; I received an answer from, among others, Mark Collier at CSIRO. Mark
&gt; &gt;&gt; actually supplied me with the NetCDF files which he created. They hold
&gt; &gt;&gt; the 1 x 1 degree resolution of the data. I only glanced at the Fortran
&gt; &gt;&gt; code which he developed to do this, but you may be able to edit and 
&gt; &gt;&gt; use
&gt; &gt;&gt; this same code on the .25 degree OCL formatted files to create NetCDF
&gt; &gt;&gt; files. I have cc'd Mark with this email. If Mark wishes, I can supply
&gt; &gt;&gt; the code to you. Let me know if there is more I can do to help.
&gt; &gt;&gt;
&gt; &gt;&gt; Joe
&gt; &gt;&gt; ---------------------
&gt; &gt;&gt; namba takaya wrote:
&gt; &gt;&gt;
&gt; &gt;&gt; &gt; Dear Joe
&gt; &gt;&gt; &gt;
&gt; &gt;&gt; &gt; Thank you very much for your kind reply.
&gt; &gt;&gt; &gt;
&gt; &gt;&gt; &gt; I downloaded the high resolution files of 1/4 x 1/4 degree from
&gt; &gt;&gt; &gt; <a  href="http://www.nodc.noaa.gov/OC5/indprod.html">http://www.nodc.noaa.gov/OC5/indprod.html</a>
&gt; &gt;&gt; &gt;
&gt; &gt;&gt; &gt; The format is the same as 1 x 1 degree except for the 1440 x 720 in
&gt; &gt;&gt; &gt; stead of 720 x 360. of 1 x 1 degree.
&gt; &gt;&gt; &gt; The format discription is at
&gt; &gt;&gt; &gt; <a  href="http://www.nodc.noaa.gov/OC5/readqd25.html">http://www.nodc.noaa.gov/OC5/readqd25.html</a>
&gt; &gt;&gt; &gt;
&gt; &gt;&gt; &gt; I would like to calculate geostrophic current from 1/4 x 1/4 degree
&gt; &gt; WOA.
&gt; &gt;&gt; &gt;
&gt; &gt;&gt; &gt; What I thought is to use ferret by the way explained in the Chapter 
&gt; &gt;&gt; 2
&gt; &gt;&gt; &gt; of ASCII DATA/Reading ASCII files and saving by netcdf format.
&gt; &gt;&gt; &gt;
&gt; &gt;&gt; &gt; I wonder if this is best way for the large amount of data like WOA 
&gt; &gt;&gt; 1/4
&gt; &gt;&gt; &gt; x 1/4.
&gt; &gt;&gt; &gt; If there are better and easier way, I would like to know it.
&gt; &gt;&gt; &gt;
&gt; &gt;&gt; &gt; Best regards,
&gt; &gt;&gt; &gt;
&gt; &gt;&gt; &gt; Takaya Namba
&gt; &gt;&gt; &gt;
&gt; &gt;&gt; &gt;
&gt; &gt;&gt;
&gt; &gt;
&gt; 

-- 
___________________________________________________

    Jaison Kurian                           
    Centre for Atmospheric and Oceanic Sciences
    Indian Institute of Science
    B A N G A L O R E   560 012
    Ph: +91-80-3942505
        +91-80-3600450
    Fax:+91-80-3600865
___________________________________________________



</pre>
<pre>\ cancel mode verify
!
! To read the WOA2001 1/4 X 1/4 temperature/salinity data (ASCII)
!   available at <a  href="http://www.nodc.noaa.gov/OC5/WOA01/qd_ts01.html">http://www.nodc.noaa.gov/OC5/WOA01/qd_ts01.html</a> 
!   and write it to a NetCDF file.
! This script expects input file names in the default way as
!   t001_v2, t002_v2 .... or s001_v2, s002_v2.....
! 
! Please start Ferret with more memory cache....like
!   [user@machine]$ ferret -memsize 300mb
!----------------------------------------------------------

!   select fields (temp or salinity) and the output filename

      let prfx              = &quot;t&quot; ! &quot;t&quot; for temperature and
                                  ! &quot;s&quot; for salinity
      define symbol varname = temp           ! output variable name
      define symbol outfile = woa01_temp.nc  ! output file name
      define symbol vartitle= &quot;WOA Temperature - Monthly Clim&quot; ! title for var
      define symbol varunits= &quot;^oC&quot;                            ! units for var

! ----NO NEED TO CHANGE ANYTHING BELOW----------------------
!
! define X, Y &amp; Z axes according to the informations given at
!   <a  href="http://www.nodc.noaa.gov/OC5/readqd25.html">http://www.nodc.noaa.gov/OC5/readqd25.html</a>

      define axis/x=0.125:359.875:0.25/units=longitudes xlon
      define axis/y=-89.875:89.875:0.25/units=latitudes ylat
  
      let zdata = ZSEQUENCE({0, 10, 20, 30, 50, 75, 100, 125, 150,\
                 200, 250, 300, 400, 500, 600, 700, 800, 900, \
                 1000, 1100, 1200, 1300, 1400, 1500})

      define axis/z/unit=meters/DEPTH/from_data zdepth=zdata

! define an &quot;index&quot; time axis ..we will put proper one later..

      define axis/t=1:1:1 tax
  
! define a destination calendar time axis

      define axis/t=&quot;15-JAN-0001:00&quot;:&quot;15-DEC-0001:00&quot;:`365.2425/12`/\
                 units=days/t0=&quot;31-DEC-0000:00&quot; time

! define grid for the file

      define grid/x=xlon/y=ylat/z=zdepth/t=tax gfile

! construct the input ascii filename

      let mon  = XSEQUENCE({&quot;01&quot;,&quot;02&quot;,&quot;03&quot;,&quot;04&quot;,&quot;05&quot;,&quot;06&quot;,&quot;07&quot;,&quot;08&quot;,\
                           &quot;09&quot;,&quot;10&quot;,&quot;11&quot;,&quot;12&quot;})

! open and read data for JAN

      define symbol fname = `prfx`0`mon[i=1]`_v2
      FILE/grid=gfile/COLUMS=10/FORMAT=(10(f8.4))/var=te ($fname)
      set var/bad=-99.9999 te

! assign calendar axis to the variable

     let tstamp     = t[gt=time] * 0 
     let ($varname) = te[l=1] + tstamp

! write to output file

     set var/title=&quot;`($vartitle)`&quot;/units=&quot;`($varunits)`&quot;  ($varname)
     fill/x=30:120/y=-30:30/k=1/l=1 ($varname)
     sp rm -f ($outfile)   ! to remove previous versions if any
     SAVE/file=($outfile)/LLIMITS=1:12/L=1/CLOBBER ($varname)
     cancel data 1

! repeat this process for other months

     REPEAT/RANGE=2:12:1/NAME=mn (                  ;\
        define symbol mid   = mon[i=`mn`]           ;\
        define symbol fname = `prfx`0`($mid)`_v2    ;\             
        define axis/t=`mn`:`mn`:1 tax               ;\
        FILE/grid=gfile/COLUMS=10/FORMAT=(10(f8.4))/var=te ($fname)   ;\
        set var/bad=-99.9999 te                       ;\
        let ($varname)= te[t=`mn`] + tstamp           ;\
        SAVE/file=($outfile)/L=`mn`/APPEND ($varname) ;\
        cancel data 1                                 ;\
        say ; say &quot; Month `mn` Over. &quot; ; say          ;\
     )
</pre>

<!--X-Body-of-Message-End-->
<!--X-MsgBody-End-->
<!--X-Follow-Ups-->
<hr>
<!--X-Follow-Ups-End-->
<!--X-References-->
<ul><li><strong>References</strong>:
<ul>
<li><strong><a name="00859" href="msg00859.html">Re: Transform World Ocean Atlas 1/4 x 1/4 degree to NEtCDF</a></strong>
<ul><li><em>From:</em> James Harle</li></ul></li>
</ul></li></ul>
<!--X-References-End-->
<!--X-BotPNI-->
<UL>
<li>Previous by thread:
<strong><a href="msg00859.html">Re: Transform World Ocean Atlas 1/4 x 1/4 degree to NEtCDF</a></strong>
</li>
<li>Next by thread:
<strong><a href="msg00852.html">Hide outside labels</a></strong>
</li>

</UL>
<center>[<a href="msg00859.html">Thread Prev</a>][<a href="msg00852.html">Thread Next</a>][<A HREF="threads.html#00861">Index</A>]</center>

<!--X-BotPNI-End-->
<!--X-User-Footer-->
<hr>
<font size=-1>
<address>
<a href="http://www.doc.gov">Dept of Commerce</a> / 
<a href="http://www.noaa.gov">NOAA</a> /
<a href="http://www.oar.noaa.gov">OAR</a> /
<a href="http://www.pmel.noaa.gov">PMEL</a> /
<a href="http://tmap.pmel.noaa.gov">TMAP</a>
</address> <br> <a href="http://ferret.pmel.noaa.gov/Ferret/ferret_contact_us.html">Contact Us</a> | <a href="http://www.noaa.gov/privacy.html">Privacy Policy</a> | <a href="http://www.noaa.gov/disclaimer.html">Disclaimer</a> | <a href="accessibility.html">Accessibility Statement</a> 
</font>
<!--X-User-Footer-End-->
</body>
</html>
