<!-- MHonArc v2.5.13 -->
<!--X-Subject: RE: eof calculus and missing values -->
<!--X-From-R13: nagbavb ebqevthrm <neiNbab.pbz> -->
<!--X-Date: Mon, 15 Sep 2003 01:45:21 &#45;0700 -->
<!--X-Message-Id: IPEFKICOHOECENGJBAGLGECBCDAA.arv@ono.com -->
<!--X-Content-Type: text/plain -->
<!--X-Reference: 3F61EFEB.2C3C957@noaa.gov -->
<!--X-Head-End-->
<!doctype html public "-//W3C//DTD HTML//EN">
<html>
<head>
<title>RE: eof calculus and missing values</title>
</head>
<body>
<!--X-Body-Begin-->
<!--X-User-Header-->
<!--X-User-Header-End-->
<!--X-TopPNI-->
<HR>
<center>[<a href="msg00645.html">Thread Prev</a>][<a href="msg00633.html">Thread Next</a>][<A HREF="threads.html#00649">Index</A>]</center>

<!--X-TopPNI-End-->
<!--X-MsgBody-->
<!--X-Subject-Header-Begin-->
<h1>RE: eof calculus and missing values</h1>
<hr>
<!--X-Subject-Header-End-->
<!--X-Head-of-Message-->
<ul>
<li><strong>To</strong>: <strong>Ansley Manke &lt;<a href="mailto:Ansley.B.Manke@DOMAIN.HIDDEN">Ansley.B.Manke@xxxxxxxx</a>&gt;</strong></li>
<li><strong>Subject</strong>: <strong>RE: eof calculus and missing values</strong></li>
<li><strong>From</strong>: <strong>antonio rodriguez &lt;<a href="mailto:arv@DOMAIN.HIDDEN">arv@xxxxxxx</a>&gt;</strong></li>
<li>Date: Mon, 15 Sep 2003 10:48:58 +0200</li>
<li>Cc: Ferret &lt;<a href="mailto:ferret_users@DOMAIN.HIDDEN">ferret_users@xxxxxxxxxxxxxxxxxxx</a>&gt;,  Mick Spilane &lt;<a href="mailto:Mick.Spillane@DOMAIN.HIDDEN">Mick.Spillane@xxxxxxxx</a>&gt;, <a href="mailto:kessler@DOMAIN.HIDDEN">kessler@xxxxxxxxxxxxx</a></li>
<li>Importance: Normal</li>
<li>In-reply-to: &lt;3F61EFEB.2C3C957@noaa.gov&gt;</li>
<li>Sender: <a href="mailto:owner-ferret_users@DOMAIN.HIDDEN">owner-ferret_users@xxxxxxxxxxxxxxxxxxxx</a></li>
</ul>
<!--X-Head-of-Message-End-->
<!--X-Head-Body-Sep-Begin-->
<hr>
<!--X-Head-Body-Sep-End-->
<!--X-Body-of-Message-->
<pre>Dear Ansley,

Yes I will appreciate if you send to me the external code for svd
calculation. My O.S is a Linux-Debian Woody 3.0 on a AMD Duron (~ Pentium
III).

Asking for some advice on statistical lists (R project) about svd and
missing values, seems to be a very controversial issue the filling of
missing values in a time series. When few gaps are present the EM algorithm
based on: Schafer, J.L.(1997) Analysis of Incomplete Multivariate Data,
Chapman &amp; Hall, London, will perform a maximum-likelihood estimation on the
matrix of incomplete data using this algorithm. And yes, it is not possible
for svd to handle missing values because is an undefined matrix operation.

Thanks to everybody. It has been very helpful

Cheers

Antonio

&gt; -----Mensaje original-----
&gt; De: Ansley Manke [<a  href="mailto:Ansley.B.Manke@noaa.gov">mailto:Ansley.B.Manke@noaa.gov</a>]
&gt; Enviado el: viernes, 12 de septiembre de 2003 18:10
&gt; Para: antonio rodriguez
&gt; CC: Mick Spilane
&gt; Asunto: Re: eof calculus and missing values
&gt;
&gt;
&gt; Hi Antonio,
&gt; Would you like the EOF functions which use the singular value
&gt; decomposition to test?  We just have not had a chance to fully
&gt; test them.  I'm sure the code itself is fine; it's been in use by
&gt; Billy Kessler for a long time, and the Ferret implementation is
&gt; so similar to what we did with the previous set of functions that
&gt; it's probably fine as well, but we just have not had a chance to
&gt; do much testing.
&gt;
&gt; If you're interested, let me know what operating system you use
&gt; and I'll see if I can provide compiled functions, or I could send the
&gt; source code for you to work with
&gt;
&gt; antonio rodriguez wrote:
&gt;
&gt; &gt; Dear Mick,
&gt; &gt;
&gt; &gt; Yes it helps a lot and is a very good explanation. Wouldn't be more
&gt; &gt; interesting instead of using covariance matrices, the use of
&gt; the singular
&gt; &gt; value decomposition to obtain both the eigenvectors and
&gt; eigenvalues. I've
&gt; &gt; read that it is a more robust and computanionally efficent
&gt; method than the
&gt; &gt; use of huge covariance matrices. The issue is that I don't know
&gt; if the svd
&gt; &gt; method accepts missing values.
&gt; &gt;
&gt; &gt; Cheers,
&gt; &gt;
&gt; &gt; Antonio
&gt; &gt;
&gt; &gt; &gt; -----Mensaje original-----
&gt; &gt; &gt; De: Mick Spillane [<a  href="mailto:spillane@pmel.noaa.gov">mailto:spillane@pmel.noaa.gov</a>]
&gt; &gt; &gt; Enviado el: jueves, 11 de septiembre de 2003 19:15
&gt; &gt; &gt; Para: antonio rodriguez
&gt; &gt; &gt; CC: Ferret
&gt; &gt; &gt; Asunto: Re: eof calculus and missing values
&gt; &gt; &gt;
&gt; &gt; &gt;
&gt; &gt; &gt;
&gt; &gt; &gt; &gt; Is it possible to know how Ferret manages the presence of
&gt; &gt; &gt; missing values in
&gt; &gt; &gt; &gt; the calculation of the EOF.
&gt; &gt; &gt;
&gt; &gt; &gt; Hi Antonio,
&gt; &gt; &gt;       You may get a more detailed explanation of this from one of the
&gt; &gt; &gt; others in the group or by looking at the code for these external
&gt; &gt; &gt; functions.  However here is a brief statement of how it is done.
&gt; &gt; &gt;
&gt; &gt; &gt;       Basically what needs to be done is to get the eigensolution to
&gt; &gt; &gt; a covariance matrix. Such a matrix can be calculated even when some
&gt; &gt; &gt; data values are missing, provided that sufficient cross products are
&gt; &gt; &gt; available to make all elements in the matrix meaningful.  The latter
&gt; &gt; &gt; is the point of the PERCENT parameter in eof_stat, eof_space, and
&gt; &gt; &gt; eof_tfunc - if a grid point has so many missing values that its cross
&gt; &gt; &gt; products are unreliable it is dropped entirely from the analysis.
&gt; &gt; &gt;       So now there is a covariance matrix, slightly imperfect, but
&gt; &gt; &gt; for which a set of eigenvectors can be computed, using a standard
&gt; &gt; &gt; method (such as &quot;jacobi.f&quot; in Numerical Recipes, Press et al.).  The
&gt; &gt; &gt; trick comes in computing the &quot;time functions&quot;.  Some of the values
&gt; &gt; &gt; of the individual data series, needed for a normal evaluation are
&gt; &gt; &gt; missing.  The ferret eof routines use an objective method, based on
&gt; &gt; &gt; some unpublished notes of Dudley Chelton and similar to the algebra
&gt; &gt; &gt; in Davis (1976) and Chelton et al. (1982) to find the best, in a least
&gt; &gt; &gt; squares sense, value of the time function at times where there are
&gt; &gt; &gt; missing values.  Not provided in the Ferret version, though available
&gt; &gt; &gt; via the underlying algorithm, is a measure of the &quot;expected&quot; error at
&gt; &gt; &gt; those points in time where the objective estimation is necessary.
&gt; &gt; &gt;
&gt; &gt; &gt; Hope this helps.  The references below should give you the flavor
&gt; &gt; &gt; of the objective method employed.
&gt; &gt; &gt;
&gt; &gt; &gt; Mick
&gt; &gt; &gt;
&gt; &gt; &gt; Davis, R.E., 1976 Journal of Physical Oceanography, 6: 249-266.
&gt; &gt; &gt;
&gt; &gt; &gt; Chelton, D.B., P.A. Bernal, and J.A. McGowan, 1982, Journal of
&gt; &gt; &gt;       Marine Research, 40(4): 1095-1125.
&gt; &gt; &gt;
&gt; &gt; &gt;
&gt;
&gt; --
&gt; Ansley Manke  Pacific Marine Environmental Laboratory  Seattle WA
&gt;
&gt;
&gt; ---
&gt; Incoming mail is certified Virus Free.
&gt; Checked by AVG anti-virus system (<a  href="http://www.grisoft.com">http://www.grisoft.com</a>).
&gt; Version: 6.0.512 / Virus Database: 309 - Release Date: 19/08/2003
&gt;
---
Outgoing mail is certified Virus Free.
Checked by AVG anti-virus system (<a  href="http://www.grisoft.com">http://www.grisoft.com</a>).
Version: 6.0.512 / Virus Database: 309 - Release Date: 19/08/2003


</pre>

<!--X-Body-of-Message-End-->
<!--X-MsgBody-End-->
<!--X-Follow-Ups-->
<hr>
<!--X-Follow-Ups-End-->
<!--X-References-->
<!--X-References-End-->
<!--X-BotPNI-->
<UL>
<li>Previous by thread:
<strong><a href="msg00645.html">Re: more on eof calculus and missing values</a></strong>
</li>
<li>Next by thread:
<strong><a href="msg00633.html">about time dimension</a></strong>
</li>

</UL>
<center>[<a href="msg00645.html">Thread Prev</a>][<a href="msg00633.html">Thread Next</a>][<A HREF="threads.html#00649">Index</A>]</center>

<!--X-BotPNI-End-->
<!--X-User-Footer-->
<hr>
<font size=-1>
<address>
<a href="http://www.doc.gov">Dept of Commerce</a> / 
<a href="http://www.noaa.gov">NOAA</a> /
<a href="http://www.oar.noaa.gov">OAR</a> /
<a href="http://www.pmel.noaa.gov">PMEL</a> /
<a href="http://tmap.pmel.noaa.gov">TMAP</a>
</address> <br> <a href="http://ferret.pmel.noaa.gov/Ferret/ferret_contact_us.html">Contact Us</a> | <a href="http://www.noaa.gov/privacy.html">Privacy Policy</a> | <a href="http://www.noaa.gov/disclaimer.html">Disclaimer</a> | <a href="accessibility.html">Accessibility Statement</a> 
</font>
<!--X-User-Footer-End-->
</body>
</html>
