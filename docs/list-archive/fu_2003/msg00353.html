<!-- MHonArc v2.5.13 -->
<!--X-Subject: Re: hack to run ferret on RO FS. (Was Re: Ferret open .jnl file rw ?) -->
<!--X-From-R13: "Yriva A'Pevra" <Yriva.[.A'PevraNabnn.tbi> -->
<!--X-Date: Wed, 7 May 2003 11:11:29 &#45;0700 -->
<!--X-Message-Id: 3EB94C25.7010706@noaa.gov -->
<!--X-Content-Type: multipart/alternative -->
<!--X-Head-End-->
<!doctype html public "-//W3C//DTD HTML//EN">
<html>
<head>
<title>Re: hack to run ferret on RO FS. (Was Re: Ferret open .jnl file rw ?)</title>
</head>
<body>
<!--X-Body-Begin-->
<!--X-User-Header-->
<!--X-User-Header-End-->
<!--X-TopPNI-->
<HR>
<center>[<a href="msg00345.html">Thread Prev</a>][<a href="msg00371.html">Thread Next</a>][<A HREF="threads.html#00353">Index</A>]</center>

<!--X-TopPNI-End-->
<!--X-MsgBody-->
<!--X-Subject-Header-Begin-->
<h1>Re: hack to run ferret on RO FS. (Was Re: Ferret open .jnl file rw ?)</h1>
<hr>
<!--X-Subject-Header-End-->
<!--X-Head-of-Message-->
<ul>
<li><strong>To</strong>: <strong>ferret_users &lt;<a href="mailto:ferret_users@DOMAIN.HIDDEN">ferret_users@xxxxxxxxxxxxxxxxxxx</a>&gt;</strong></li>
<li><strong>Subject</strong>: <strong>Re: hack to run ferret on RO FS. (Was Re: Ferret open .jnl file rw ?)</strong></li>
<li><strong>From</strong>: <strong>&quot;Kevin O'Brien&quot; &lt;Kevin.M.O'<a href="mailto:Brien@DOMAIN.HIDDEN">Brien@xxxxxxxx</a>&gt;</strong></li>
<li>Date: Wed, 07 May 2003 11:10:45 -0700</li>
<li>Sender: <a href="mailto:owner-ferret_users@DOMAIN.HIDDEN">owner-ferret_users@xxxxxxxxxxxxxxxxxxxx</a></li>
<li>User-agent: Mozilla/5.0 (Windows; U; Windows NT 5.0; en-US; rv:1.0.2)Gecko/20030208 Netscape/7.02</li>
</ul>
<!--X-Head-of-Message-End-->
<!--X-Head-Body-Sep-Begin-->
<hr>
<!--X-Head-Body-Sep-End-->
<!--X-Body-of-Message-->




 <br>
<title></title>
 Forwarded message for the benefit of the Ferret archives.....<br>
 <br>
 <br>
 -------- Original Message -------- 
<table cellpadding="0" cellspacing="0" border="0">
   <tbody>
     <tr>
       <th valign="baseline" align="right" nowrap="nowrap">Subject: </th>
       <td>Re: hack to run ferret on RO FS. (Was Re: Ferret open .jnl file 
rw ?)</td>
     </tr>
     <tr>
       <th valign="baseline" align="right" nowrap="nowrap">Date: </th>
       <td>Wed, 07 May 2003 09:14:57 -0700</td>
     </tr>
     <tr>
       <th valign="baseline" align="right" nowrap="nowrap">From: </th>
       <td>Kevin O'Brien <a class="moz-txt-link-rfc2396E"
 href="">&lt;Kevin.M.O'Brien@noaa.gov&gt;</a></td>
     </tr>
     <tr>
       <th valign="baseline" align="right" nowrap="nowrap">To: </th>
       <td>Olivier ARCHER <a class="moz-txt-link-rfc2396E"
 href="">&lt;olivier.archer@ifremer.fr&gt;</a></td>
     </tr>
     <tr>
       <th valign="baseline" align="right" nowrap="nowrap">CC: </th>
       <td><a class="moz-txt-link-abbreviated"
 href="">contact_ferret@pmel.noaa.gov</a></td>
     </tr>
     <tr>
       <th valign="baseline" align="right" nowrap="nowrap">References: </th>
       <td><a class="moz-txt-link-rfc2396E"
 href="">&lt;<a href="msg00318.html">3EA9009C.4020902@ifremer.fr</a>&gt;</a>
      <a class="moz-txt-link-rfc2396E"
 href="">&lt;<a href="msg00323.html">3EAFE2C2.90908@ifremer.fr</a>&gt;</a>	 
      <a class="moz-txt-link-rfc2396E"
 href="">&lt;<a href="msg00333.html">3EB237FD.7090705@ifremer.fr</a>&gt;</a>
      <a class="moz-txt-link-rfc2396E"
 href="">&lt;<a href="msg00349.html">3EB92EA0.5070407@ifremer.fr</a>&gt;</a></td>
     </tr>
   
  </tbody> 
</table>
  <br>
 <br>
 
<pre>Hi Olivier -

I have also been looking a this problem.  It turns out that the problem is caused by
the NAG f95 compiler not having a "READONLY" file open specifier.  I myself am looking
into solving this problem.

However, the g77 version of Ferret for linux does not have the same problem.  Perhaps
this would solve the issue for you?  If you have built your own external functions
using f95, you'd have to recompile them with g77 in order to use them with this
version of Ferret, but I believe that is the only complication.

You can get the g77 version of Ferret at:

    <a
 class="moz-txt-link-freetext"
 href="">http://www.ferret.noaa.gov/Ferret/Downloads/beta_releases.html</a>

Although it's listed as a beta, it has passed all the testing benchmarks......

Let me know if you have any questions or problems -

Thanks -

Kevin


Olivier ARCHER wrote:

&gt; Hi,
&gt;                 I really would like to have access to ferret source code to try to
&gt; handle the EROFS error corectly. Ferret sources are not avialable at
&gt; <a
 class="moz-txt-link-freetext"
 href="">http://ferret.pmel.noaa.gov/Ferret/Downloads/linux_downloads.html</a> and I
&gt; have no more mail adresses than <a
 class="moz-txt-link-abbreviated"
 href="">contact_ferret@pmel.noaa.gov</a> and
&gt; <a
 class="moz-txt-link-abbreviated"
 href="">ferret_users@ferret.wrc.noaa.gov</a>.
&gt;
&gt; Can someone tell me someone to contact to send me the source so I can
&gt; patch it ?
&gt;
&gt; --
&gt; Olivier
&gt;
&gt; Olivier Archer wrote:
&gt; &gt; Hi,
&gt; &gt;    I've *temporary* solved my problem, with a so ugly hack:
&gt; &gt; I've overload the fopen libc function to set errno whith EACCES when it
&gt; &gt; is EROFS...
&gt; &gt;
&gt; &gt; #include <stdlib
 .h="">
&gt; &gt; #include <dlfcn .h="">
&gt; &gt; #include <signal
 .h="">
&gt; &gt; #include <errno .h="">
&gt; &gt;
&gt; &gt;
&gt; &gt; FILE *fopen(const char *path, const char *mode){
&gt; &gt;        static FILE *(*RealFopen)(const char *path, const char *mode)=0;
&gt; &gt;        FILE *fid;
&gt; &gt;
&gt; &gt;
&gt; &gt;  // set it up only once
&gt; &gt;  if (!RealFopen){
&gt; &gt;    RealFopen=dlsym(((void *) -1l), "fopen");
&gt; &gt;    if (!RealFopen){
&gt; &gt;      fprintf(stderr, "Fatal error - cannot find fopen()\n");
&gt; &gt;      abort();
&gt; &gt;    }
&gt; &gt;  }
&gt; &gt;
&gt; &gt;  fid= RealFopen(path,mode);
&gt; &gt;    /* force errno to be EACCES if it is EROFS */
&gt; &gt;  if( (fid == NULL) &amp;&amp; ( errno == EROFS ) ){ errno=EACCES; }
&gt; &gt;  return fid;
&gt; &gt; }
&gt; &gt;
&gt; &gt; %gcc -o fopen.so -shared fopen.c
&gt; &gt; %setenv LD_PRELOAD fopen.so
&gt; &gt; %ferret
&gt; &gt;
&gt; &gt; This hack permit me go ahead with LAS, but I think something is doable
&gt; &gt; source side...
&gt; &gt;

--
Kevin O'Brien                   UW/JISAO
Research Scientist              NOAA/PMEL/TMAP
206-526-6751                    <a
 class="moz-txt-link-freetext" href="">http://tmap.pmel.noaa.gov</a>


</errno></signal></dlfcn></stdlib></pre>
 
<pre class="moz-signature" cols="$mailwrapcol"></pre>
 <br>
<pre class="moz-signature" cols="$mailwrapcol">-- 
Kevin O'Brien                   UW/JISAO	
Research Scientist              NOAA/PMEL/TMAP
206-526-6751                    <a class="moz-txt-link-freetext" href="">http://tmap.pmel.noaa.gov</a>

</pre>



<!--X-Body-of-Message-End-->
<!--X-MsgBody-End-->
<!--X-Follow-Ups-->
<hr>
<ul><li><strong>Follow-Ups</strong>:
<ul>
<li><strong><a name="00371" href="msg00371.html">Re: hack to run ferret on RO FS. (Was Re: Ferret open .jnl file rw ?)</a></strong>
<ul><li><em>From:</em> Olivier ARCHER</li></ul></li>
</ul></li></ul>
<!--X-Follow-Ups-End-->
<!--X-References-->
<!--X-References-End-->
<!--X-BotPNI-->
<UL>
<li>Previous by thread:
<strong><a href="msg00345.html">Heat content in the mixed layer</a></strong>
</li>
<li>Next by thread:
<strong><a href="msg00371.html">Re: hack to run ferret on RO FS. (Was Re: Ferret open .jnl file rw ?)</a></strong>
</li>

</UL>
<center>[<a href="msg00345.html">Thread Prev</a>][<a href="msg00371.html">Thread Next</a>][<A HREF="threads.html#00353">Index</A>]</center>

<!--X-BotPNI-End-->
<!--X-User-Footer-->
<hr>
<font size=-1>
<address>
<a href="http://www.doc.gov">Dept of Commerce</a> / 
<a href="http://www.noaa.gov">NOAA</a> /
<a href="http://www.oar.noaa.gov">OAR</a> /
<a href="http://www.pmel.noaa.gov">PMEL</a> /
<a href="http://tmap.pmel.noaa.gov">TMAP</a>
</address> <br> <a href="http://ferret.pmel.noaa.gov/Ferret/ferret_contact_us.html">Contact Us</a> | <a href="http://www.noaa.gov/privacy.html">Privacy Policy</a> | <a href="http://www.noaa.gov/disclaimer.html">Disclaimer</a> | <a href="accessibility.html">Accessibility Statement</a> 
</font>
<!--X-User-Footer-End-->
</body>
</html>
