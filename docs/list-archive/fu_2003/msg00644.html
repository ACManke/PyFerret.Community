<!-- MHonArc v2.5.13 -->
<!--X-Subject: Re: eof calculus and missing values -->
<!--X-From-R13: Oafyrl [naxr <Oafyrl.P.[naxrNabnn.tbi> -->
<!--X-Date: Fri, 12 Sep 2003 09:05:25 &#45;0700 -->
<!--X-Message-Id: 3F61EF30.156F144C@noaa.gov -->
<!--X-Content-Type: text/plain -->
<!--X-Reference: IPEFKICOHOECENGJBAGLOEPJCCAA.arv@ono.com -->
<!--X-Head-End-->
<!doctype html public "-//W3C//DTD HTML//EN">
<html>
<head>
<title>Re: eof calculus and missing values</title>
</head>
<body>
<!--X-Body-Begin-->
<!--X-User-Header-->
<!--X-User-Header-End-->
<!--X-TopPNI-->
<HR>
<center>[<a href="msg00641.html">Thread Prev</a>][<a href="msg00642.html">Thread Next</a>][<A HREF="threads.html#00644">Index</A>]</center>

<!--X-TopPNI-End-->
<!--X-MsgBody-->
<!--X-Subject-Header-Begin-->
<h1>Re: eof calculus and missing values</h1>
<hr>
<!--X-Subject-Header-End-->
<!--X-Head-of-Message-->
<ul>
<li><strong>To</strong>: <strong>antonio rodriguez &lt;<a href="mailto:arv@DOMAIN.HIDDEN">arv@xxxxxxx</a>&gt;</strong></li>
<li><strong>Subject</strong>: <strong>Re: eof calculus and missing values</strong></li>
<li><strong>From</strong>: <strong>Ansley Manke &lt;<a href="mailto:Ansley.B.Manke@DOMAIN.HIDDEN">Ansley.B.Manke@xxxxxxxx</a>&gt;</strong></li>
<li>Date: Fri, 12 Sep 2003 09:07:12 -0700</li>
<li>Cc: Mick Spillane &lt;<a href="mailto:spillane@DOMAIN.HIDDEN">spillane@xxxxxxxxxxxxx</a>&gt;,  Ferret &lt;<a href="mailto:ferret_users@DOMAIN.HIDDEN">ferret_users@xxxxxxxxxxxxxxxxxxx</a>&gt;</li>
<li>References: &lt;<a href="msg00641.html">IPEFKICOHOECENGJBAGLOEPJCCAA.arv@ono.com</a>&gt;</li>
<li>Sender: <a href="mailto:owner-ferret_users@DOMAIN.HIDDEN">owner-ferret_users@xxxxxxxxxxxxxxxxxxxx</a></li>
</ul>
<!--X-Head-of-Message-End-->
<!--X-Head-Body-Sep-Begin-->
<hr>
<!--X-Head-Body-Sep-End-->
<!--X-Body-of-Message-->
<pre>Hi Antonio,
The author of the code underlying the EOF functions, Billy Kessler, has also
provided us with an EOF solver that uses SVD.  No gaps are allowed in the
time series for this method.  We have implemented this code as a Ferret external
function, but have not yet included it in a release.

Ansley Manke

antonio rodriguez wrote:

&gt; Dear Mick,
&gt;
&gt; Yes it helps a lot and is a very good explanation. Wouldn't be more
&gt; interesting instead of using covariance matrices, the use of the singular
&gt; value decomposition to obtain both the eigenvectors and eigenvalues. I've
&gt; read that it is a more robust and computanionally efficent method than the
&gt; use of huge covariance matrices. The issue is that I don't know if the svd
&gt; method accepts missing values.
&gt;
&gt; Cheers,
&gt;
&gt; Antonio
&gt;
&gt; &gt; -----Mensaje original-----
&gt; &gt; De: Mick Spillane [<a  href="mailto:spillane@pmel.noaa.gov">mailto:spillane@pmel.noaa.gov</a>]
&gt; &gt; Enviado el: jueves, 11 de septiembre de 2003 19:15
&gt; &gt; Para: antonio rodriguez
&gt; &gt; CC: Ferret
&gt; &gt; Asunto: Re: eof calculus and missing values
&gt; &gt;
&gt; &gt;
&gt; &gt;
&gt; &gt; &gt; Is it possible to know how Ferret manages the presence of
&gt; &gt; missing values in
&gt; &gt; &gt; the calculation of the EOF.
&gt; &gt;
&gt; &gt; Hi Antonio,
&gt; &gt;       You may get a more detailed explanation of this from one of the
&gt; &gt; others in the group or by looking at the code for these external
&gt; &gt; functions.  However here is a brief statement of how it is done.
&gt; &gt;
&gt; &gt;       Basically what needs to be done is to get the eigensolution to
&gt; &gt; a covariance matrix. Such a matrix can be calculated even when some
&gt; &gt; data values are missing, provided that sufficient cross products are
&gt; &gt; available to make all elements in the matrix meaningful.  The latter
&gt; &gt; is the point of the PERCENT parameter in eof_stat, eof_space, and
&gt; &gt; eof_tfunc - if a grid point has so many missing values that its cross
&gt; &gt; products are unreliable it is dropped entirely from the analysis.
&gt; &gt;       So now there is a covariance matrix, slightly imperfect, but
&gt; &gt; for which a set of eigenvectors can be computed, using a standard
&gt; &gt; method (such as &quot;jacobi.f&quot; in Numerical Recipes, Press et al.).  The
&gt; &gt; trick comes in computing the &quot;time functions&quot;.  Some of the values
&gt; &gt; of the individual data series, needed for a normal evaluation are
&gt; &gt; missing.  The ferret eof routines use an objective method, based on
&gt; &gt; some unpublished notes of Dudley Chelton and similar to the algebra
&gt; &gt; in Davis (1976) and Chelton et al. (1982) to find the best, in a least
&gt; &gt; squares sense, value of the time function at times where there are
&gt; &gt; missing values.  Not provided in the Ferret version, though available
&gt; &gt; via the underlying algorithm, is a measure of the &quot;expected&quot; error at
&gt; &gt; those points in time where the objective estimation is necessary.
&gt; &gt;
&gt; &gt; Hope this helps.  The references below should give you the flavor
&gt; &gt; of the objective method employed.
&gt; &gt;
&gt; &gt; Mick
&gt; &gt;
&gt; &gt; Davis, R.E., 1976 Journal of Physical Oceanography, 6: 249-266.
&gt; &gt;
&gt; &gt; Chelton, D.B., P.A. Bernal, and J.A. McGowan, 1982, Journal of
&gt; &gt;       Marine Research, 40(4): 1095-1125.
&gt; &gt;
&gt; &gt;
&gt; &gt; ---
&gt; &gt; Incoming mail is certified Virus Free.
&gt; &gt; Checked by AVG anti-virus system (<a  href="http://www.grisoft.com">http://www.grisoft.com</a>).
&gt; &gt; Version: 6.0.512 / Virus Database: 309 - Release Date: 19/08/2003
&gt; &gt;
&gt; ---
&gt; Outgoing mail is certified Virus Free.
&gt; Checked by AVG anti-virus system (<a  href="http://www.grisoft.com">http://www.grisoft.com</a>).
&gt; Version: 6.0.512 / Virus Database: 309 - Release Date: 19/08/2003

--
Ansley Manke  Pacific Marine Environmental Laboratory  Seattle WA



</pre>

<!--X-Body-of-Message-End-->
<!--X-MsgBody-End-->
<!--X-Follow-Ups-->
<hr>
<!--X-Follow-Ups-End-->
<!--X-References-->
<ul><li><strong>References</strong>:
<ul>
<li><strong><a name="00641" href="msg00641.html">RE: eof calculus and missing values</a></strong>
<ul><li><em>From:</em> antonio rodriguez</li></ul></li>
</ul></li></ul>
<!--X-References-End-->
<!--X-BotPNI-->
<UL>
<li>Previous by thread:
<strong><a href="msg00641.html">RE: eof calculus and missing values</a></strong>
</li>
<li>Next by thread:
<strong><a href="msg00642.html">more on eof calculus and missing values</a></strong>
</li>

</UL>
<center>[<a href="msg00641.html">Thread Prev</a>][<a href="msg00642.html">Thread Next</a>][<A HREF="threads.html#00644">Index</A>]</center>

<!--X-BotPNI-End-->
<!--X-User-Footer-->
<hr>
<font size=-1>
<address>
<a href="http://www.doc.gov">Dept of Commerce</a> / 
<a href="http://www.noaa.gov">NOAA</a> /
<a href="http://www.oar.noaa.gov">OAR</a> /
<a href="http://www.pmel.noaa.gov">PMEL</a> /
<a href="http://tmap.pmel.noaa.gov">TMAP</a>
</address> <br> <a href="http://ferret.pmel.noaa.gov/Ferret/ferret_contact_us.html">Contact Us</a> | <a href="http://www.noaa.gov/privacy.html">Privacy Policy</a> | <a href="http://www.noaa.gov/disclaimer.html">Disclaimer</a> | <a href="accessibility.html">Accessibility Statement</a> 
</font>
<!--X-User-Footer-End-->
</body>
</html>
