<!-- MHonArc v2.5.13 -->
<!--X-Subject: how to select the highest values in a 3d file? -->
<!--X-From-R13: Qryvar Pbasvyf <pryvarNfrdhbvn.Ogzbf.Prexryrl.rqh> -->
<!--X-Date: Mon, 14 Jul 2003 19:34:07 &#45;0700 -->
<!--X-Message-Id: 200307150234.h6F2Y5h41208@sequoia.Atmos.Berkeley.edu -->
<!--X-Content-Type: text/plain -->
<!--X-Head-End-->
<!doctype html public "-//W3C//DTD HTML//EN">
<html>
<head>
<title>how to select the highest values in a 3d file?</title>
</head>
<body>
<!--X-Body-Begin-->
<!--X-User-Header-->
<!--X-User-Header-End-->
<!--X-TopPNI-->
<HR>
<center>[<a href="msg00498.html">Thread Prev</a>][<a href="msg00500.html">Thread Next</a>][<A HREF="threads.html#00499">Index</A>]</center>

<!--X-TopPNI-End-->
<!--X-MsgBody-->
<!--X-Subject-Header-Begin-->
<h1>how to select the highest values in a 3d file?</h1>
<hr>
<!--X-Subject-Header-End-->
<!--X-Head-of-Message-->
<ul>
<li><strong>To</strong>: <strong><a href="mailto:ferret_users@DOMAIN.HIDDEN">ferret_users@xxxxxxxxxxxxxxxxxxx</a></strong></li>
<li><strong>Subject</strong>: <strong>how to select the highest values in a 3d file?</strong></li>
<li><strong>From</strong>: <strong>Celine Bonfils &lt;<a href="mailto:celine@DOMAIN.HIDDEN">celine@xxxxxxxxxxxxxxxxxxxxxxxxxx</a>&gt;</strong></li>
<li>Date: Mon, 14 Jul 2003 19:34:05 -0700</li>
<li>Cc: <a href="mailto:celine@DOMAIN.HIDDEN">celine@xxxxxxxxxxxxxxxxxx</a></li>
<li>Sender: <a href="mailto:owner-ferret_users@DOMAIN.HIDDEN">owner-ferret_users@xxxxxxxxxxxxxxxxxxxx</a></li>
</ul>
<!--X-Head-of-Message-End-->
<!--X-Head-Body-Sep-Begin-->
<hr>
<!--X-Head-Body-Sep-End-->
<!--X-Body-of-Message-->
<pre>Dear Ferret users,

I have a 3D temperature file (lon,lat,time), the time axis representing
200 annual averages. I would like to average the 10 warmest years together for 
each grid point (the selected years will be different from one grid point 
to another). 

Up to now, I did the following: 

use &quot;annual_T_200years.nc&quot;        ---&gt; x=1;97,y=1:24,k=1:200
let Tp=T[d=1]
LET sorted_indices = sortk(Tp)
LET ki = k[k=1:200]
LET sorted_indices_2 = if ki GT 190 then sorted_indices
LET sorted_Tp = samplek(Tp, sorted_indices_2)
LIST sorted_indices_2[x=90W,y=40n,k=189:200], sorted_Tp[x=90W,y=40n,k=189:200]
LIST sorted_Tp[x=90W,y=40n,k=189:200@ave]

LIST sorted_indices_2[x=90W,y=40n,k=189:200], sorted_Tp[x=90W,y=40n,k=189:200]
             Z: 188.5 to 200.5
             LONGITUDE: 90W
             LATITUDE: 39N
 Column  1: SORTED_INDICES_2 is IF KI GT 190 THEN SORTED_INDICES
 Column  2: SORTED_TP is SAMPLEK(TP, SORTED_INDICES_2)
           SORTED_ISORTED_T 
189   / 189:    ....    ....
190   / 190:    ....    ....
191   / 191:   147.0   10.00
192   / 192:     5.0   10.07
193   / 193:   141.0   10.12
194   / 194:   124.0   10.12
195   / 195:    63.0   10.22
196   / 196:     1.0   10.26
197   / 197:     9.0   10.33
198   / 198:    68.0   10.37
199   / 199:    69.0   10.40
200   / 200:   146.0   10.54


LIST sorted_Tp[x=90W,y=40n,k=189:200@ave]
             VARIABLE : SAMPLEK(TP, SORTED_INDICES_2)
             LONGITUDE: 90W
             LATITUDE : 39N
             Z        : 188.5 to 200.5 (averaged)
          10.24

But I cannot do it for ALL gridpoints, since samplek works only with 1D list.

I tried to do a mask:
let test= if k EQ 146 OR k EQ 69 then Tp
&quot;test&quot; provides the 2 temperatures corresponding to the 2 warmest years for 
the point x=90w, y=40n. Unfortunately, I did not find out the general 
command which allows to identify when k is equal to one of the values of 
&quot;sorted_indices_2&quot;.
let test= if k EQ sorted_indices_2 then Tp     does not work.

Thank you in advance for any help,
Celine

</pre>

<!--X-Body-of-Message-End-->
<!--X-MsgBody-End-->
<!--X-Follow-Ups-->
<hr>
<!--X-Follow-Ups-End-->
<!--X-References-->
<!--X-References-End-->
<!--X-BotPNI-->
<UL>
<li>Previous by thread:
<strong><a href="msg00498.html">ferret auto stats</a></strong>
</li>
<li>Next by thread:
<strong><a href="msg00500.html">vector and shade in curvilinear coordinates</a></strong>
</li>

</UL>
<center>[<a href="msg00498.html">Thread Prev</a>][<a href="msg00500.html">Thread Next</a>][<A HREF="threads.html#00499">Index</A>]</center>

<!--X-BotPNI-End-->
<!--X-User-Footer-->
<hr>
<font size=-1>
<address>
<a href="http://www.doc.gov">Dept of Commerce</a> / 
<a href="http://www.noaa.gov">NOAA</a> /
<a href="http://www.oar.noaa.gov">OAR</a> /
<a href="http://www.pmel.noaa.gov">PMEL</a> /
<a href="http://tmap.pmel.noaa.gov">TMAP</a>
</address> <br> <a href="http://ferret.pmel.noaa.gov/Ferret/ferret_contact_us.html">Contact Us</a> | <a href="http://www.noaa.gov/privacy.html">Privacy Policy</a> | <a href="http://www.noaa.gov/disclaimer.html">Disclaimer</a> | <a href="accessibility.html">Accessibility Statement</a> 
</font>
<!--X-User-Footer-End-->
</body>
</html>
