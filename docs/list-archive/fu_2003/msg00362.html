<!-- MHonArc v2.5.13 -->
<!--X-Subject: Re: derivatives on an uneven grid -->
<!--X-From-R13: Xbua Rbaaref <qbaarefNxazv.ay> -->
<!--X-Date: Thu, 8 May 2003 09:29:03 &#45;0700 -->
<!--X-Message-Id: Pine.LNX.4.33.0305081816410.27975&#45;100000@bcw006.knmi.nl -->
<!--X-Content-Type: text/plain -->
<!--X-Reference: Pine.LNX.4.33.0305071611060.4764&#45;100000@vorlon.eas.gatech.edu -->
<!--X-Head-End-->
<!doctype html public "-//W3C//DTD HTML//EN">
<html>
<head>
<title>Re: derivatives on an uneven grid</title>
</head>
<body>
<!--X-Body-Begin-->
<!--X-User-Header-->
<!--X-User-Header-End-->
<!--X-TopPNI-->
<HR>
<center>[<a href="msg00356.html">Thread Prev</a>][<a href="msg00364.html">Thread Next</a>][<A HREF="threads.html#00362">Index</A>]</center>

<!--X-TopPNI-End-->
<!--X-MsgBody-->
<!--X-Subject-Header-Begin-->
<h1>Re: derivatives on an uneven grid</h1>
<hr>
<!--X-Subject-Header-End-->
<!--X-Head-of-Message-->
<ul>
<li><strong>To</strong>: <strong>Brent A McDaniel &lt;<a href="mailto:gte328r@DOMAIN.HIDDEN">gte328r@xxxxxxxxxxxxxxxxxxxxx</a>&gt;</strong></li>
<li><strong>Subject</strong>: <strong>Re: derivatives on an uneven grid</strong></li>
<li><strong>From</strong>: <strong>John Donners &lt;<a href="mailto:donners@DOMAIN.HIDDEN">donners@xxxxxxx</a>&gt;</strong></li>
<li>Date: Thu, 08 May 2003 18:27:25 +0200 (CEST)</li>
<li>Cc: <a href="mailto:ferret_users@DOMAIN.HIDDEN">ferret_users@xxxxxxxxxxxxxxxxxxx</a></li>
<li>Importance: normal</li>
<li>In-reply-to: &lt;<a href="msg00356.html">Pine.LNX.4.33.0305071611060.4764-100000@vorlon.eas.gatech.edu</a>&gt;</li>
<li>Sender: <a href="mailto:owner-ferret_users@DOMAIN.HIDDEN">owner-ferret_users@xxxxxxxxxxxxxxxxxxxx</a></li>
<li>Thread-index: AcMVfrXa36Nk94dgQCuIUu0KS2/3Qg==</li>
</ul>
<!--X-Head-of-Message-End-->
<!--X-Head-Body-Sep-Begin-->
<hr>
<!--X-Head-Body-Sep-End-->
<!--X-Body-of-Message-->
<pre>
Hi Brent,

some weeks ago I ran into the same problem. I wrote a ferret script to 
calculate first and second derivatives on an unequal grid:

let zet=z[gz=rho]
let h1=zet-zet[k=@shf:-1]
let h2=zet[k=@shf:1]-zet

let a=(-1)/(h1+h1*h1/h2)
let b=1/(h2+h2*h2/h1)
let c=(-1)*(a+b)
let rhoz=a*rho[k=@shf:-1]+b*rho[k=@shf:1]+c*rho
let aa=2/(h1*h1+h1*h2)
let bb=2/(h2*h2+h1*h2)
let cc=(-1)*(aa+bb)
let rhozz=aa*rho[k=@shf:-1]+bb*rho[k=@shf:1]+cc*rho

The variables rho and rhozz are now the first and second derivatives (in
the vertical direction)  of the variable rho. The variable h1 is
the distance between the uppermost and the central 
points. The variable h2 is the distance between the central and the 
lowermost points. It can easily be seen that the centered difference 
formulations will show up if h1=h2.

Hopefully this answers your questions. If there are any more questions 
I'll be happy to answer them.

Regards,

John

------------------------------------------
John Donners
Royal Netherlands Meteorological Institute
Dept. Oceanographic Research

P.O. Box 201
Wilheminalaan 10
3730 AE  De Bilt
tel. nr. : ++31 30 2206701
fax. nr. : ++31 30 2202570
e-mail   : donners@knmi.nl
--------------------------------------------------------------
Zie ook/see also: <a  href="http://www.knmi.nl/maildisclaimer.html">http://www.knmi.nl/maildisclaimer.html</a> 

</pre>

<!--X-Body-of-Message-End-->
<!--X-MsgBody-End-->
<!--X-Follow-Ups-->
<hr>
<ul><li><strong>Follow-Ups</strong>:
<ul>
<li><strong><a name="00364" href="msg00364.html">Re: derivatives on an uneven grid</a></strong>
<ul><li><em>From:</em> Rolando S. Balotro</li></ul></li>
</ul></li></ul>
<!--X-Follow-Ups-End-->
<!--X-References-->
<ul><li><strong>References</strong>:
<ul>
<li><strong><a name="00356" href="msg00356.html">derivatives on an uneven grid</a></strong>
<ul><li><em>From:</em> Brent A McDaniel</li></ul></li>
</ul></li></ul>
<!--X-References-End-->
<!--X-BotPNI-->
<UL>
<li>Previous by thread:
<strong><a href="msg00356.html">derivatives on an uneven grid</a></strong>
</li>
<li>Next by thread:
<strong><a href="msg00364.html">Re: derivatives on an uneven grid</a></strong>
</li>

</UL>
<center>[<a href="msg00356.html">Thread Prev</a>][<a href="msg00364.html">Thread Next</a>][<A HREF="threads.html#00362">Index</A>]</center>

<!--X-BotPNI-End-->
<!--X-User-Footer-->
<hr>
<font size=-1>
<address>
<a href="http://www.doc.gov">Dept of Commerce</a> / 
<a href="http://www.noaa.gov">NOAA</a> /
<a href="http://www.oar.noaa.gov">OAR</a> /
<a href="http://www.pmel.noaa.gov">PMEL</a> /
<a href="http://tmap.pmel.noaa.gov">TMAP</a>
</address> <br> <a href="http://ferret.pmel.noaa.gov/Ferret/ferret_contact_us.html">Contact Us</a> | <a href="http://www.noaa.gov/privacy.html">Privacy Policy</a> | <a href="http://www.noaa.gov/disclaimer.html">Disclaimer</a> | <a href="accessibility.html">Accessibility Statement</a> 
</font>
<!--X-User-Footer-End-->
</body>
</html>
