<!-- MHonArc v2.5.13 -->
<!--X-Subject: Re: eof calculus and missing values -->
<!--X-From-R13: [vpx Ecvyynar <fcvyynarNczry.abnn.tbi> -->
<!--X-Date: Thu, 11 Sep 2003 10:15:23 &#45;0700 -->
<!--X-Message-Id: Pine.GSO.4.33.0309110936340.12444&#45;100000@heron.pmel.noaa.gov -->
<!--X-Content-Type: text/plain -->
<!--X-Reference: IPEFKICOHOECENGJBAGLMEOGCCAA.arv@ono.com -->
<!--X-Head-End-->
<!doctype html public "-//W3C//DTD HTML//EN">
<html>
<head>
<title>Re: eof calculus and missing values</title>
</head>
<body>
<!--X-Body-Begin-->
<!--X-User-Header-->
<!--X-User-Header-End-->
<!--X-TopPNI-->
<HR>
<center>[<a href="msg00632.html">Thread Prev</a>][<a href="msg00641.html">Thread Next</a>][<A HREF="threads.html#00638">Index</A>]</center>

<!--X-TopPNI-End-->
<!--X-MsgBody-->
<!--X-Subject-Header-Begin-->
<h1>Re: eof calculus and missing values</h1>
<hr>
<!--X-Subject-Header-End-->
<!--X-Head-of-Message-->
<ul>
<li><strong>To</strong>: <strong>antonio rodriguez &lt;<a href="mailto:arv@DOMAIN.HIDDEN">arv@xxxxxxx</a>&gt;</strong></li>
<li><strong>Subject</strong>: <strong>Re: eof calculus and missing values</strong></li>
<li><strong>From</strong>: <strong>Mick Spillane &lt;<a href="mailto:spillane@DOMAIN.HIDDEN">spillane@xxxxxxxxxxxxx</a>&gt;</strong></li>
<li>Date: Thu, 11 Sep 2003 10:15:21 -0700 (PDT)</li>
<li>Cc: Ferret &lt;<a href="mailto:ferret_users@DOMAIN.HIDDEN">ferret_users@xxxxxxxxxxxxxxxxxxx</a>&gt;</li>
<li>In-reply-to: &lt;<a href="msg00632.html">IPEFKICOHOECENGJBAGLMEOGCCAA.arv@ono.com</a>&gt;</li>
<li>Sender: <a href="mailto:owner-ferret_users@DOMAIN.HIDDEN">owner-ferret_users@xxxxxxxxxxxxxxxxxxxx</a></li>
</ul>
<!--X-Head-of-Message-End-->
<!--X-Head-Body-Sep-Begin-->
<hr>
<!--X-Head-Body-Sep-End-->
<!--X-Body-of-Message-->
<pre>
&gt; Is it possible to know how Ferret manages the presence of missing values in
&gt; the calculation of the EOF.

Hi Antonio,
	You may get a more detailed explanation of this from one of the
others in the group or by looking at the code for these external
functions.  However here is a brief statement of how it is done.

	Basically what needs to be done is to get the eigensolution to
a covariance matrix. Such a matrix can be calculated even when some
data values are missing, provided that sufficient cross products are
available to make all elements in the matrix meaningful.  The latter
is the point of the PERCENT parameter in eof_stat, eof_space, and
eof_tfunc - if a grid point has so many missing values that its cross
products are unreliable it is dropped entirely from the analysis.
	So now there is a covariance matrix, slightly imperfect, but
for which a set of eigenvectors can be computed, using a standard
method (such as &quot;jacobi.f&quot; in Numerical Recipes, Press et al.).  The
trick comes in computing the &quot;time functions&quot;.  Some of the values
of the individual data series, needed for a normal evaluation are
missing.  The ferret eof routines use an objective method, based on
some unpublished notes of Dudley Chelton and similar to the algebra
in Davis (1976) and Chelton et al. (1982) to find the best, in a least
squares sense, value of the time function at times where there are
missing values.  Not provided in the Ferret version, though available
via the underlying algorithm, is a measure of the &quot;expected&quot; error at
those points in time where the objective estimation is necessary.

Hope this helps.  The references below should give you the flavor
of the objective method employed.

Mick

Davis, R.E., 1976 Journal of Physical Oceanography, 6: 249-266.

Chelton, D.B., P.A. Bernal, and J.A. McGowan, 1982, Journal of
	Marine Research, 40(4): 1095-1125.



</pre>

<!--X-Body-of-Message-End-->
<!--X-MsgBody-End-->
<!--X-Follow-Ups-->
<hr>
<ul><li><strong>Follow-Ups</strong>:
<ul>
<li><strong><a name="00642" href="msg00642.html">more on eof calculus and missing values</a></strong>
<ul><li><em>From:</em> antonio rodriguez</li></ul></li>
<li><strong><a name="00641" href="msg00641.html">RE: eof calculus and missing values</a></strong>
<ul><li><em>From:</em> antonio rodriguez</li></ul></li>
</ul></li></ul>
<!--X-Follow-Ups-End-->
<!--X-References-->
<ul><li><strong>References</strong>:
<ul>
<li><strong><a name="00632" href="msg00632.html">eof calculus and missing values</a></strong>
<ul><li><em>From:</em> antonio rodriguez</li></ul></li>
</ul></li></ul>
<!--X-References-End-->
<!--X-BotPNI-->
<UL>
<li>Previous by thread:
<strong><a href="msg00632.html">eof calculus and missing values</a></strong>
</li>
<li>Next by thread:
<strong><a href="msg00641.html">RE: eof calculus and missing values</a></strong>
</li>

</UL>
<center>[<a href="msg00632.html">Thread Prev</a>][<a href="msg00641.html">Thread Next</a>][<A HREF="threads.html#00638">Index</A>]</center>

<!--X-BotPNI-End-->
<!--X-User-Footer-->
<hr>
<font size=-1>
<address>
<a href="http://www.doc.gov">Dept of Commerce</a> / 
<a href="http://www.noaa.gov">NOAA</a> /
<a href="http://www.oar.noaa.gov">OAR</a> /
<a href="http://www.pmel.noaa.gov">PMEL</a> /
<a href="http://tmap.pmel.noaa.gov">TMAP</a>
</address> <br> <a href="http://ferret.pmel.noaa.gov/Ferret/ferret_contact_us.html">Contact Us</a> | <a href="http://www.noaa.gov/privacy.html">Privacy Policy</a> | <a href="http://www.noaa.gov/disclaimer.html">Disclaimer</a> | <a href="accessibility.html">Accessibility Statement</a> 
</font>
<!--X-User-Footer-End-->
</body>
</html>
