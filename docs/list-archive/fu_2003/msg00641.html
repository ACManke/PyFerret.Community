<!-- MHonArc v2.5.13 -->
<!--X-Subject: RE: eof calculus and missing values -->
<!--X-From-R13: nagbavb ebqevthrm <neiNbab.pbz> -->
<!--X-Date: Fri, 12 Sep 2003 00:42:08 &#45;0700 -->
<!--X-Message-Id: IPEFKICOHOECENGJBAGLOEPJCCAA.arv@ono.com -->
<!--X-Content-Type: text/plain -->
<!--X-Reference: Pine.GSO.4.33.0309110936340.12444&#45;100000@heron.pmel.noaa.gov -->
<!--X-Head-End-->
<!doctype html public "-//W3C//DTD HTML//EN">
<html>
<head>
<title>RE: eof calculus and missing values</title>
</head>
<body>
<!--X-Body-Begin-->
<!--X-User-Header-->
<!--X-User-Header-End-->
<!--X-TopPNI-->
<HR>
<center>[<a href="msg00638.html">Thread Prev</a>][<a href="msg00644.html">Thread Next</a>][<A HREF="threads.html#00641">Index</A>]</center>

<!--X-TopPNI-End-->
<!--X-MsgBody-->
<!--X-Subject-Header-Begin-->
<h1>RE: eof calculus and missing values</h1>
<hr>
<!--X-Subject-Header-End-->
<!--X-Head-of-Message-->
<ul>
<li><strong>To</strong>: <strong>Mick Spillane &lt;<a href="mailto:spillane@DOMAIN.HIDDEN">spillane@xxxxxxxxxxxxx</a>&gt;</strong></li>
<li><strong>Subject</strong>: <strong>RE: eof calculus and missing values</strong></li>
<li><strong>From</strong>: <strong>antonio rodriguez &lt;<a href="mailto:arv@DOMAIN.HIDDEN">arv@xxxxxxx</a>&gt;</strong></li>
<li>Date: Fri, 12 Sep 2003 09:45:23 +0200</li>
<li>Cc: Ferret &lt;<a href="mailto:ferret_users@DOMAIN.HIDDEN">ferret_users@xxxxxxxxxxxxxxxxxxx</a>&gt;</li>
<li>Importance: Normal</li>
<li>In-reply-to: &lt;<a href="msg00638.html">Pine.GSO.4.33.0309110936340.12444-100000@heron.pmel.noaa.gov</a>&gt;</li>
<li>Sender: <a href="mailto:owner-ferret_users@DOMAIN.HIDDEN">owner-ferret_users@xxxxxxxxxxxxxxxxxxxx</a></li>
</ul>
<!--X-Head-of-Message-End-->
<!--X-Head-Body-Sep-Begin-->
<hr>
<!--X-Head-Body-Sep-End-->
<!--X-Body-of-Message-->
<pre>Dear Mick,

Yes it helps a lot and is a very good explanation. Wouldn't be more
interesting instead of using covariance matrices, the use of the singular
value decomposition to obtain both the eigenvectors and eigenvalues. I've
read that it is a more robust and computanionally efficent method than the
use of huge covariance matrices. The issue is that I don't know if the svd
method accepts missing values.

Cheers,

Antonio

&gt; -----Mensaje original-----
&gt; De: Mick Spillane [<a  href="mailto:spillane@pmel.noaa.gov">mailto:spillane@pmel.noaa.gov</a>]
&gt; Enviado el: jueves, 11 de septiembre de 2003 19:15
&gt; Para: antonio rodriguez
&gt; CC: Ferret
&gt; Asunto: Re: eof calculus and missing values
&gt;
&gt;
&gt;
&gt; &gt; Is it possible to know how Ferret manages the presence of
&gt; missing values in
&gt; &gt; the calculation of the EOF.
&gt;
&gt; Hi Antonio,
&gt; 	You may get a more detailed explanation of this from one of the
&gt; others in the group or by looking at the code for these external
&gt; functions.  However here is a brief statement of how it is done.
&gt;
&gt; 	Basically what needs to be done is to get the eigensolution to
&gt; a covariance matrix. Such a matrix can be calculated even when some
&gt; data values are missing, provided that sufficient cross products are
&gt; available to make all elements in the matrix meaningful.  The latter
&gt; is the point of the PERCENT parameter in eof_stat, eof_space, and
&gt; eof_tfunc - if a grid point has so many missing values that its cross
&gt; products are unreliable it is dropped entirely from the analysis.
&gt; 	So now there is a covariance matrix, slightly imperfect, but
&gt; for which a set of eigenvectors can be computed, using a standard
&gt; method (such as &quot;jacobi.f&quot; in Numerical Recipes, Press et al.).  The
&gt; trick comes in computing the &quot;time functions&quot;.  Some of the values
&gt; of the individual data series, needed for a normal evaluation are
&gt; missing.  The ferret eof routines use an objective method, based on
&gt; some unpublished notes of Dudley Chelton and similar to the algebra
&gt; in Davis (1976) and Chelton et al. (1982) to find the best, in a least
&gt; squares sense, value of the time function at times where there are
&gt; missing values.  Not provided in the Ferret version, though available
&gt; via the underlying algorithm, is a measure of the &quot;expected&quot; error at
&gt; those points in time where the objective estimation is necessary.
&gt;
&gt; Hope this helps.  The references below should give you the flavor
&gt; of the objective method employed.
&gt;
&gt; Mick
&gt;
&gt; Davis, R.E., 1976 Journal of Physical Oceanography, 6: 249-266.
&gt;
&gt; Chelton, D.B., P.A. Bernal, and J.A. McGowan, 1982, Journal of
&gt; 	Marine Research, 40(4): 1095-1125.
&gt;
&gt;
&gt; ---
&gt; Incoming mail is certified Virus Free.
&gt; Checked by AVG anti-virus system (<a  href="http://www.grisoft.com">http://www.grisoft.com</a>).
&gt; Version: 6.0.512 / Virus Database: 309 - Release Date: 19/08/2003
&gt;
---
Outgoing mail is certified Virus Free.
Checked by AVG anti-virus system (<a  href="http://www.grisoft.com">http://www.grisoft.com</a>).
Version: 6.0.512 / Virus Database: 309 - Release Date: 19/08/2003


</pre>

<!--X-Body-of-Message-End-->
<!--X-MsgBody-End-->
<!--X-Follow-Ups-->
<hr>
<ul><li><strong>Follow-Ups</strong>:
<ul>
<li><strong><a name="00644" href="msg00644.html">Re: eof calculus and missing values</a></strong>
<ul><li><em>From:</em> Ansley Manke</li></ul></li>
</ul></li></ul>
<!--X-Follow-Ups-End-->
<!--X-References-->
<ul><li><strong>References</strong>:
<ul>
<li><strong><a name="00638" href="msg00638.html">Re: eof calculus and missing values</a></strong>
<ul><li><em>From:</em> Mick Spillane</li></ul></li>
</ul></li></ul>
<!--X-References-End-->
<!--X-BotPNI-->
<UL>
<li>Previous by thread:
<strong><a href="msg00638.html">Re: eof calculus and missing values</a></strong>
</li>
<li>Next by thread:
<strong><a href="msg00644.html">Re: eof calculus and missing values</a></strong>
</li>

</UL>
<center>[<a href="msg00638.html">Thread Prev</a>][<a href="msg00644.html">Thread Next</a>][<A HREF="threads.html#00641">Index</A>]</center>

<!--X-BotPNI-End-->
<!--X-User-Footer-->
<hr>
<font size=-1>
<address>
<a href="http://www.doc.gov">Dept of Commerce</a> / 
<a href="http://www.noaa.gov">NOAA</a> /
<a href="http://www.oar.noaa.gov">OAR</a> /
<a href="http://www.pmel.noaa.gov">PMEL</a> /
<a href="http://tmap.pmel.noaa.gov">TMAP</a>
</address> <br> <a href="http://ferret.pmel.noaa.gov/Ferret/ferret_contact_us.html">Contact Us</a> | <a href="http://www.noaa.gov/privacy.html">Privacy Policy</a> | <a href="http://www.noaa.gov/disclaimer.html">Disclaimer</a> | <a href="accessibility.html">Accessibility Statement</a> 
</font>
<!--X-User-Footer-End-->
</body>
</html>
