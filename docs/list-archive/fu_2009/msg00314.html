<!-- MHonArc v2.6.16 -->
<!--X-Subject: Re: [ferret_users] mm/day to mm/month -->
<!--X-From-R13: Brgre Emnob <fmnocrg83Ntznvy.pbz> -->
<!--X-Date: Mon, 25 May 2009 00:38:35 &#45;0700 -->
<!--X-Message-Id: 8cc42c030905250038v654d8ce3s82cffd3e2e592d71@mail.gmail.com -->
<!--X-Content-Type: multipart/alternative -->
<!--X-Reference: 8cc42c030905210258u1b3d2e9y1777e612a2026987@mail.gmail.com -->
<!--X-Reference: 200905221046.09068.russell.fiedler@csiro.au -->
<!--X-Reference: 8cc42c030905212357o2e5e1261j21415c364d2aa4a1@mail.gmail.com -->
<!--X-Reference: 4A16F8E8.8090405@noaa.gov -->
<!--X-Head-End-->
<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN"
        "http://www.w3.org/TR/html4/loose.dtd">
<html>
<head>
<title>Re: [ferret_users] mm/day to mm/month</title>
</head>
<body>
<!--X-Body-Begin-->
<!--X-User-Header-->
<!--X-User-Header-End-->
<!--X-TopPNI-->
<HR>
<center>[<a href="msg00310.html">Thread Prev</a>][<a href="msg00307.html">Thread Next</a>][<A HREF="threads.html#00314">Index</A>]</center>

<!--X-TopPNI-End-->
<!--X-MsgBody-->
<!--X-Subject-Header-Begin-->
<h1>Re: [ferret_users] mm/day to mm/month</h1>
<hr>
<!--X-Subject-Header-End-->
<!--X-Head-of-Message-->
<ul>
<li><strong>To</strong>: <strong>ferret &lt;<a href="mailto:ferret_users@DOMAIN.HIDDEN">ferret_users@xxxxxxxx</a>&gt;</strong></li>
<li><strong>Subject</strong>: <strong>Re: [ferret_users] mm/day to mm/month</strong></li>
<li><strong>From</strong>: <strong>Peter Szabo &lt;<a href="mailto:szabpet83@DOMAIN.HIDDEN">szabpet83@xxxxxxxxx</a>&gt;</strong></li>
<li>Date: Mon, 25 May 2009 09:38:14 +0200</li>
<li>Cc: Russell Fiedler &lt;<a href="mailto:russell.fiedler@DOMAIN.HIDDEN">russell.fiedler@xxxxxxxx</a>&gt;,        Ansley Manke &lt;<a href="mailto:Ansley.B.Manke@DOMAIN.HIDDEN">Ansley.B.Manke@xxxxxxxx</a>&gt;,        mick spillane &lt;<a href="mailto:Mick.Spillane@DOMAIN.HIDDEN">Mick.Spillane@xxxxxxxx</a>&gt;</li>
<li>Dkim-signature: v=1; a=rsa-sha256; c=relaxed/relaxed;        d=gmail.com; s=gamma; h=domainkey-signature:mime-version:received:in-reply-to:references :date:message-id:subject:from:to:cc:content-type; bh=ROcf6UfqkuqwCUz02n1vkgqPvdkxcs3Po/IKPQlvTMI=; b=KXt2lyo8hwkYhfRELqrSygazCIYhigcQffmqSjKfOPaiO918Br6qGSekcN1Tm50Bif lejQFaBz9Fml/jsoYdMseXwzo/XdHeMkbuEEASN+Y25IuafQb3p8lwF53SlBdSDYGr7f 70myiG2Ra3qmTHCApWm371e2sTFbMR31l8Q5k=</li>
<li>Domainkey-signature: a=rsa-sha1; c=nofws;        d=gmail.com; s=gamma; h=mime-version:in-reply-to:references:date:message-id:subject:from:to :cc:content-type; b=d/wWJWJdaXKOQnvgsVJTDkC8gUhMWsxnKyt5Pe2jDJn3VwBY6Pc5sfpMlHh6TVuMfp oB+XBF9czmdfpul+RduPmHfupyMw+QVikKaN2BKjSvV6AKNhHe5rcRHzWVx6bTX5bRGO 5IhrnLCVsyQR1EmJvaIeaTuOUCW8LmdoiiQvg=</li>
<li>In-reply-to: &lt;<a href="mailto:4A16F8E8.8090405@DOMAIN.HIDDEN">4A16F8E8.8090405@xxxxxxxx</a>&gt;</li>
<li>References: &lt;<a href="mailto:8cc42c030905210258u1b3d2e9y1777e612a2026987@DOMAIN.HIDDEN">8cc42c030905210258u1b3d2e9y1777e612a2026987@xxxxxxxxxxxxxx</a>&gt; &lt;<a href="mailto:200905221046.09068.russell.fiedler@DOMAIN.HIDDEN">200905221046.09068.russell.fiedler@xxxxxxxx</a>&gt; &lt;<a href="mailto:8cc42c030905212357o2e5e1261j21415c364d2aa4a1@DOMAIN.HIDDEN">8cc42c030905212357o2e5e1261j21415c364d2aa4a1@xxxxxxxxxxxxxx</a>&gt; &lt;<a href="mailto:4A16F8E8.8090405@DOMAIN.HIDDEN">4A16F8E8.8090405@xxxxxxxx</a>&gt;</li>
<li>Sender: <a href="mailto:owner-ferret_users@DOMAIN.HIDDEN">owner-ferret_users@xxxxxxxx</a></li>
</ul>
<!--X-Head-of-Message-End-->
<!--X-Head-Body-Sep-Begin-->
<hr>
<!--X-Head-Body-Sep-End-->
<!--X-Body-of-Message-->
Dear Mick, Russell, Ansley,<br><br>Thank You for your help.<br>I solved already the problem with a repeat and some if-then-else (not that nice, i know), but here is what i did with the suggested approaches:<br><br>1) I put my data on a truemonth axis, then used the pseudo-variable tbox. It worked, though there is a slight difference between the original data and the new one on truemonth.<br>
<br>yes? list/x=19/y=47/l=1:38 precipday,rt<br>&#xA0;WARNING: Listed variables have ambiguous coordinates on axes: T<br>&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0; DATA SET: ELTE-kozos/RegCM/RegCM_ECHAM_pre_6190.nc<br>&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0; LONGITUDE: 19.1E(19.1)<br>
&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0; LATITUDE: 47N<br>&#xA0;Column&#xA0; 1: PRECIPDAY[T=01-JAN-1961 00:00:01-MAR-1964 00:00] is RT[GT=TRUEMONTH]<br>&#xA0;Column&#xA0; 2: RT[T=31-DEC-1960 06:45:01-MAR-1964 21:11] is Total Precipitation (mm/day)<br>&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0; PRECIPD&#xA0;&#xA0;&#xA0; RT<br>
L /&#xA0; 1:&#xA0;&#xA0; 1.189&#xA0; 1.219<br>L /&#xA0; 2:&#xA0;&#xA0; 0.307&#xA0; 0.305<br>L /&#xA0; 3:&#xA0;&#xA0; 1.237&#xA0; 1.265<br>L /&#xA0; 4:&#xA0;&#xA0; 2.413&#xA0; 2.444<br>L /&#xA0; 5:&#xA0;&#xA0; 1.395&#xA0; 1.369<br>L /&#xA0; 6:&#xA0;&#xA0; 2.594&#xA0; 2.623<br>L /&#xA0; 7:&#xA0;&#xA0; 0.822&#xA0; 0.784<br>L /&#xA0; 8:&#xA0;&#xA0; 0.833&#xA0; 0.833<br>L /&#xA0; 9:&#xA0;&#xA0; 1.418&#xA0; 1.418<br>
L / 10:&#xA0;&#xA0; 2.972&#xA0; 2.975<br>L / 11:&#xA0;&#xA0; 1.724&#xA0; 1.719<br>L / 12:&#xA0;&#xA0; 2.828&#xA0; 2.842<br>L / 13:&#xA0;&#xA0; 0.559&#xA0; 0.524<br>L / 14:&#xA0;&#xA0; 1.927&#xA0; 1.935<br>L / 15:&#xA0;&#xA0; 1.487&#xA0; 1.470<br><br>2) The dayspermonth script worked without changing the original data set.<br>
<br>Cheers, Peter<br><br><br><br><br><div class="gmail_quote">On Fri, May 22, 2009 at 9:11 PM, mick spillane <span dir="ltr">&lt;<a rel="nofollow" href="mailto:Mick.Spillane@xxxxxxxx">Mick.Spillane@xxxxxxxx</a>&gt;</span> wrote:<br><blockquote class="gmail_quote" style="border-left: 1px solid rgb(204, 204, 204); margin: 0pt 0pt 0pt 0.8ex; padding-left: 1ex;">
Hi Peter &amp; Ansley,<br>
<br>
 &#xA0; I actually prefer Russell&#39;s DAYS_IN_MONTH approach which beats by miles the clunky things I&#39;ve used at various times in the past in similar situations. There is a slight omission in not having a YEAR0 in the definition of YEAR and maybe its worth generalizing to situations where a monthly series did not begin in January. &#xA0;With these thoughts in mind, I&#39;m putting the attached DaysPerMonth.jnl script in my toolkit. Apologies to anyone whose reaction is &quot;duh&quot; -- though there&#39;s probably no one like that in the ferret-users group.<br>

<br>
Mick<br>
<br>
PS As an example of how to use it in a situation like yours Peter (but with series starting with &#xA0;Feb 1960 say)<br>
<br>
! demo of russell&#39;s days-in-month approach to mm/day --&gt; mm/month conversion<br>
def axis/t=&quot;15-Feb-1960&quot;:&quot;15-JAN-1990&quot;/npoints=360 tax ; def grid/t=tax grd<br>
let/title=&quot;rainfall&quot;/units=&quot;mm/day&quot; drain=randu(t[g=grd]) &#xA0;! a fake rainfall series<br>
! generate the days/month variable for the daily rainfall variable &quot;drain&quot;<br>
go dayspermonth 1960 2 drain<br>
! and apply it to generate monthly rate<br>
let/title=&quot;rainfall&quot;/units=&quot;mm/month&quot; mrain=dpm*drain<br>
! and list some results to check dpm in leap and non-leap years<br>
list/nohead/L=1:16 yrser,mnser,d1900,dpm,drain,mrain<br>
15-FEB-1960 / &#xA0;1: &#xA0;1960. &#xA0; 2.00 &#xA0;21945. &#xA0;29.00 &#xA0;0.6862 &#xA0;19.90 &#xA0; &#xA0;&lt;== 29 days in Feb&#39;60<br>
16-MAR-1960 / &#xA0;2: &#xA0;1960. &#xA0; 3.00 &#xA0;21974. &#xA0;31.00 &#xA0;0.6201 &#xA0;19.22<br>
15-APR-1960 / &#xA0;3: &#xA0;1960. &#xA0; 4.00 &#xA0;22005. &#xA0;30.00 &#xA0;0.5975 &#xA0;17.92<br>
16-MAY-1960 / &#xA0;4: &#xA0;1960. &#xA0; 5.00 &#xA0;22035. &#xA0;31.00 &#xA0;0.4654 &#xA0;14.43<br>
15-JUN-1960 / &#xA0;5: &#xA0;1960. &#xA0; 6.00 &#xA0;22066. &#xA0;30.00 &#xA0;0.6546 &#xA0;19.64<br>
16-JUL-1960 / &#xA0;6: &#xA0;1960. &#xA0; 7.00 &#xA0;22096. &#xA0;31.00 &#xA0;0.8547 &#xA0;26.50<br>
15-AUG-1960 / &#xA0;7: &#xA0;1960. &#xA0; 8.00 &#xA0;22127. &#xA0;31.00 &#xA0;0.2217 &#xA0; 6.87<br>
15-SEP-1960 / &#xA0;8: &#xA0;1960. &#xA0; 9.00 &#xA0;22158. &#xA0;30.00 &#xA0;0.4683 &#xA0;14.05<br>
15-OCT-1960 / &#xA0;9: &#xA0;1960. &#xA0;10.00 &#xA0;22188. &#xA0;31.00 &#xA0;0.8639 &#xA0;26.78<br>
14-NOV-1960 / 10: &#xA0;1960. &#xA0;11.00 &#xA0;22219. &#xA0;30.00 &#xA0;0.3296 &#xA0; 9.89<br>
15-DEC-1960 / 11: &#xA0;1960. &#xA0;12.00 &#xA0;22249. &#xA0;31.00 &#xA0;0.9992 &#xA0;30.97<br>
14-JAN-1961 / 12: &#xA0;1961. &#xA0; 1.00 &#xA0;22280. &#xA0;31.00 &#xA0;0.4089 &#xA0;12.67<br>
14-FEB-1961 / 13: &#xA0;1961. &#xA0; 2.00 &#xA0;22311. &#xA0;28.00 &#xA0;0.7811 &#xA0;21.87 &#xA0;&lt;== &amp; 28 in Feb&#39;61<br>
16-MAR-1961 / 14: &#xA0;1961. &#xA0; 3.00 &#xA0;22339. &#xA0;31.00 &#xA0;0.4778 &#xA0;14.81<br>
16-APR-1961 / 15: &#xA0;1961. &#xA0; 4.00 &#xA0;22370. &#xA0;30.00 &#xA0;0.4869 &#xA0;14.61<br>
16-MAY-1961 / 16: &#xA0;1961. &#xA0; 5.00 &#xA0;22400. &#xA0;31.00 &#xA0;0.5987 &#xA0;18.56<br>
<br>
<br>
<br>! DaysPerMonth : Creates a variable &quot;dpm&quot; for days per month to associate with a<br>
! &#xA0; &#xA0; &#xA0; &#xA0; &#xA0; &#xA0; &#xA0; &#xA0;particular monthly time series. Other variables introduced may<br>
! &#xA0; &#xA0; &#xA0; &#xA0; &#xA0; &#xA0; &#xA0; &#xA0;be useful, eg mnser in generating monthly climatologies, d1900<br>
! &#xA0; &#xA0; &#xA0; &#xA0; &#xA0; &#xA0; &#xA0; &#xA0;which is days1900 for the first of the month<br>
<br>
! Usage Example: If series &quot;myvar&quot; starts May 1959 then before using &quot;dpm&quot;<br>
! &#xA0; go DaysPerMonth 1959 5 myvar<br>
<br>
let LVAL=L[g=$3]<br>
let/title=&quot;Year Series&quot; &#xA0; &#xA0; yrser=`$1`+int((LVAL+`$2`-2)/12)<br>
let mser0=mod(LVAL+`$2`-1,12)<br>
let/title=&quot;Month Series&quot; &#xA0; &#xA0;mnser=if(mser0 eq 0)then 12 else mser0<br>
let/title=&quot;Days1900 Series&quot; d1900=days1900(yrser,mnser,1)<br>
let/title=&quot;Days/Month&quot; &#xA0; &#xA0; &#xA0;dpm=d1900[L=@shf]-d1900<br>
<br>
<br></blockquote></div><br>

<!--X-Body-of-Message-End-->
<!--X-MsgBody-End-->
<!--X-Follow-Ups-->
<hr>
<!--X-Follow-Ups-End-->
<!--X-References-->
<ul><li><strong>References</strong>:
<ul>
<li><strong><a name="00303" href="msg00303.html">[ferret_users] mm/day to mm/month</a></strong>
<ul><li><em>From:</em> Peter Szabo</li></ul></li>
<li><strong><a name="00306" href="msg00306.html">Re: [ferret_users] mm/day to mm/month</a></strong>
<ul><li><em>From:</em> Peter Szabo</li></ul></li>
<li><strong><a name="00310" href="msg00310.html">Re: [ferret_users] mm/day to mm/month</a></strong>
<ul><li><em>From:</em> mick spillane</li></ul></li>
</ul></li></ul>
<!--X-References-End-->
<!--X-BotPNI-->
<UL>
<li>Previous by thread:
<strong><a href="msg00310.html">Re: [ferret_users] mm/day to mm/month</a></strong>
</li>
<li>Next by thread:
<strong><a href="msg00307.html">[ferret_users] listing to ASCII file without missing values</a></strong>
</li>

</UL>
<center>[<a href="msg00310.html">Thread Prev</a>][<a href="msg00307.html">Thread Next</a>][<A HREF="threads.html#00314">Index</A>]</center>

<!--X-BotPNI-End-->
<!--X-User-Footer-->
<hr>
<A HREF="ferret_contact_us.html">Contact Us</A>
<br>
<font size=-1>
<address>
<a href="http://www.doc.gov">Dept of Commerce</a> / 
<a href="http://www.noaa.gov">NOAA</a> /
<a href="http://www.oar.noaa.gov">OAR</a> /
<a href="http://www.pmel.noaa.gov">PMEL</a> /
<a href="http://tmap.pmel.noaa.gov">TMAP</a>
</address>
<br>
 <a href="http://www.noaa.gov/privacy.html">Privacy Policy</a> | <a href="http://www.noaa.gov/disclaimer.html">Disclaimer</a> | <a href="accessibility.html">Accessibility Statement</a> 
</font>
<!--X-User-Footer-End-->
</body>
</html>
