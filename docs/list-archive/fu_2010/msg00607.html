<!-- MHonArc v2.6.16 -->
<!--X-Subject: Re: [ferret_users] Re: Remapping curvilinear coordinates to rectilinear coordinates -->
<!--X-From-R13: Yney Ezvgu <Yney.EzvguNabnn.tbi> -->
<!--X-Date: Fri, 8 Oct 2010 09:02:21 &#45;0700 -->
<!--X-Message-Id: 4CAF408D.1040701@noaa.gov -->
<!--X-Content-Type: text/plain -->
<!--X-Reference: AANLkTi=8Q23JqDj_5svXvLO06HitAzt&#45;eukb6XYaLOdo@mail.gmail.com -->
<!--X-Reference: AANLkTin+DHfyArs6EH269t2P5=MhWjiO+G&#45;juVzSzUTS@mail.gmail.com -->
<!--X-Reference: AANLkTikEDgwDnLLXXDJiNENMztLc183RZG_ntmGOWqKk@mail.gmail.com -->
<!--X-Reference: AANLkTikRVPw87m3kwZV0O0MNtkCXNBLQCuyzEdVCfH2L@mail.gmail.com -->
<!--X-Head-End-->
<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN"
        "http://www.w3.org/TR/html4/loose.dtd">
<html>
<head>
<title>Re: [ferret_users] Re: Remapping curvilinear coordinates to rectilinear coordinates</title>
</head>
<body>
<!--X-Body-Begin-->
<!--X-User-Header-->
<!--X-User-Header-End-->
<!--X-TopPNI-->
<HR>
<center>[<a href="msg00606.html">Thread Prev</a>][<a href="msg00608.html">Thread Next</a>][<A HREF="threads.html#00607">Index</A>]</center>

<!--X-TopPNI-End-->
<!--X-MsgBody-->
<!--X-Subject-Header-Begin-->
<h1>Re: [ferret_users] Re: Remapping curvilinear coordinates to rectilinear coordinates</h1>
<hr>
<!--X-Subject-Header-End-->
<!--X-Head-of-Message-->
<ul>
<li><strong>To</strong>: <strong>Szymon Roziewski &lt;<a href="mailto:szymon.roziewski@DOMAIN.HIDDEN">szymon.roziewski@xxxxxxxxx</a>&gt;</strong></li>
<li><strong>Subject</strong>: <strong>Re: [ferret_users] Re: Remapping curvilinear coordinates to rectilinear coordinates</strong></li>
<li><strong>From</strong>: <strong>Karl Smith &lt;<a href="mailto:Karl.Smith@DOMAIN.HIDDEN">Karl.Smith@xxxxxxxx</a>&gt;</strong></li>
<li>Date: Fri, 08 Oct 2010 09:02:21 -0700</li>
<li>Cc: <a href="mailto:oar.pmel.ferret_users@DOMAIN.HIDDEN">oar.pmel.ferret_users@xxxxxxxx</a></li>
<li>In-reply-to: &lt;<a href="mailto:AANLkTikRVPw87m3kwZV0O0MNtkCXNBLQCuyzEdVCfH2L@DOMAIN.HIDDEN">AANLkTikRVPw87m3kwZV0O0MNtkCXNBLQCuyzEdVCfH2L@xxxxxxxxxxxxxx</a>&gt;</li>
<li>References: &lt;<a href="mailto:AANLkTi%3D8Q23JqDj_5svXvLO06HitAzt-eukb6XYaLOdo@DOMAIN.HIDDEN">AANLkTi=8Q23JqDj_5svXvLO06HitAzt-eukb6XYaLOdo@xxxxxxxxxxxxxx</a>&gt; &lt;<a href="mailto:AANLkTin%2BDHfyArs6EH269t2P5%3DMhWjiO%2BG-juVzSzUTS@DOMAIN.HIDDEN">AANLkTin+DHfyArs6EH269t2P5=MhWjiO+G-juVzSzUTS@xxxxxxxxxxxxxx</a>&gt; &lt;<a href="mailto:AANLkTikEDgwDnLLXXDJiNENMztLc183RZG_ntmGOWqKk@DOMAIN.HIDDEN">AANLkTikEDgwDnLLXXDJiNENMztLc183RZG_ntmGOWqKk@xxxxxxxxxxxxxx</a>&gt; &lt;<a href="mailto:AANLkTikRVPw87m3kwZV0O0MNtkCXNBLQCuyzEdVCfH2L@DOMAIN.HIDDEN">AANLkTikRVPw87m3kwZV0O0MNtkCXNBLQCuyzEdVCfH2L@xxxxxxxxxxxxxx</a>&gt;</li>
<li>Sender: <a href="mailto:owner-ferret_users@DOMAIN.HIDDEN">owner-ferret_users@xxxxxxxx</a></li>
<li>User-agent: Mozilla/5.0 (Windows; U; Windows NT 6.1; en-US; rv:1.9.2.9) Gecko/20100915 Lightning/1.0b2 Thunderbird/3.1.4</li>
</ul>
<!--X-Head-of-Message-End-->
<!--X-Head-Body-Sep-Begin-->
<hr>
<!--X-Head-Body-Sep-End-->
<!--X-Body-of-Message-->
<pre style="margin: 0em;">
Hi Simon,

</pre><tt>Using the E/W on the X axis and N/S on the Y axis will identify them as 
</tt><tt>longitude/latitude.  So you were close.
</tt><pre style="margin: 0em;">

-- Karl


define axis /x=5.666666667E:5.25W:0.083333333 xax
def axis /y=2.0S:10.0N:0.083333333 yax
def grid /x=xax /y=yax grid_out


On 10/8/2010 7:54 AM, Szymon Roziewski wrote:
</pre><blockquote style="border-left: #5555EE solid 0.2em; margin: 0em; padding-left: 0.85em"><pre style="margin: 0em;">
Now I'm thinking how to make appropriate grid for that:

My data are on grid;

(bottom left) -5.67E, -2S (bottom right) 5.25W, -2S
(top left) -5.67E, 10N (top right) 5.25W, 10N

Maybe there is special function wchich dealing with it in ferret?

2010/10/8 Szymon Roziewski &lt;szymon.roziewski@xxxxxxxxx
&lt;<a  rel="nofollow" href="mailto:szymon.roziewski@xxxxxxxxx">mailto:szymon.roziewski@xxxxxxxxx</a>&gt;&gt;

    Ok,
    I found it,
    the problem was about statement:

    let grid_out = y[gy=yax] + x[gx=xax]
    which I didn't get well.

    Cheers


    2010/10/8 Szymon Roziewski &lt;szymon.roziewski@xxxxxxxxx
    &lt;<a  rel="nofollow" href="mailto:szymon.roziewski@xxxxxxxxx">mailto:szymon.roziewski@xxxxxxxxx</a>&gt;&gt;


        I also attach my script which does compute coefficient matrix.

        DEFINE AXIS/x=1:448:1/unit=degree xaxis
        DEFINE AXIS/y=1:615:1/unit=degree yaxis
        DEFINE GRID/x=xaxis/y=yaxis gridlonlat
        !read curvilinear coordinates onto grid 448x615
        FILE/VARIABLES=clon_in/COLUMNS=448/GRID=gridlonlat
        &quot;/home/szymon/WAM/CHECK/umlonicm448x615.dat&quot;
        FILE/VARIABLES=clat_in/COLUMNS=448/GRID=gridlonlat
        &quot;/home/szymon/WAM/CHECK/umlaticm448x615.dat&quot;
        !create grid which we desire
        define axis/x=-5.666666667:5.25:0.083333333/modulo/units=degrees xax
        def axis/y=-2.0:10.0:0.083333333/units=degrees yax
        let grid_out = y[gy=yax] + x[gx=xax]
        !do transformation matrix
        let map = CURV_TO_RECT_MAP(clon_in[d=1], clat_in[d=2], grid_out, 4)
        !save data
        save/clobber/file=curv_map_UM_TO_ICM.nc map

        and another script which uses it:

        DEFINE AXIS/x=1:448:1/unit=degree xaxis
        DEFINE AXIS/y=1:615:1/unit=degree yaxis
        DEFINE GRID/x=xaxis/y=yaxis gridlonlat
        !load data for transformation  - wind fields u,v
        file/var=wlon/grid=gridlonlat/format=stream/type=r4/swap
        &quot;/home/szymon/WAM/CHECK/03225_2010092100+48000000c3hs000000000000000&quot;
        file/var=wlat/grid=gridlonlat/format=stream/type=r4/swap
        &quot;/home/szymon/WAM/CHECK/03226_2010092100+48000000c3hs000000000000000&quot;
        !using transform matrix
        use &quot;/home/szymon/ferret/vectors/curv_map_UM_TO_ICM.nc&quot;
        ! do transformation
        let wlon_icm = curv_to_rect(wlon[d=1], map[d=3])
        let wlat_icm = curv_to_rect(wlat[d=2], map[d=3])
        !save transformation data which You can see for example in the
        picture
        *wind_2010092103_ICM_remapped_132x145_and_interpolated.gif* or
        *UM_Significant_Wave_Height_21_September_2010_020000_TMP.gif
        (vectors only)*
        save/format=(448F8.2)/file=winduumicm+48.txt/clobber wlon_icm
        save/format=(448F8.2)/file=windvumicm+48.txt/clobber wlat_icm

        Best regards,
        Simon


        2010/10/8 Szymon Roziewski &lt;szymon.roziewski@xxxxxxxxx
        &lt;<a  rel="nofollow" href="mailto:szymon.roziewski@xxxxxxxxx">mailto:szymon.roziewski@xxxxxxxxx</a>&gt;&gt;

            Hello there,
            I have problem with appropriate remapping from curvilinear
            coordinates to rectilinear coordinates.
            The area which is covered with curvilinear coordinates is
            bigger than I need in rectilinear coordinates (it's a subset
            of curvilinear grid).
            I would like to raise such a question if ferret can do this
            transformation automaticly i.e. I needn't to care about the
            curvilinear grid is about bigger area than rectilinear.
            Or I need to tell ferret that fact by some computations and
            findings.
            I attach files:
            - wind_2010092103_ICM_aspect.gif - this is wind on
            curvilinear grid it is a bigger area
            - wind_2010092103_ICM_remaped_132x145_and_interpolated.gif -
            this is wind on rectilinear grid it's a smaller area.

            As You can see ferret did transformation but in a way I
            didn't intend. The Baltic Sea area is a little bit
            translated to the north and the northern part of sea was
            cut. The picture should wrap all area of Baltic Sea.
            In the picture
            UM_Significant_Wave_Height_21_September_2010_020000_TMP.gif
            I marked the area which matches interpolated wind field on
            Baltic Sea and You can see that it disagrees to significant
            wave height which occupies properly area. It means that
            interpolation from curvilinear grid 448x615 to the
            rectilinear grid 132x145 was done improperly.
            I hope I was understood.

            Kind regards,
            Szymon Roziewski




        --
        Z wyrazami szacunku,
        Szymon Roziewski




    --
    Z wyrazami szacunku,
    Szymon Roziewski




--
Z wyrazami szacunku,
Szymon Roziewski
</pre></blockquote><pre style="margin: 0em;">

--
Karl M. Smith, Ph.D.
Research Scientist and Software Developer
UW/JISAO and NOAA/PMEL/TMAP
karl.smith@xxxxxxxx
(206) 526-4806

&quot;The contents of this message are mine personally and do
not necessarily reflect any position of the Government
or the National Oceanic and Atmospheric Administration.&quot;

</pre>
<!--X-Body-of-Message-End-->
<!--X-MsgBody-End-->
<!--X-Follow-Ups-->
<hr>
<!--X-Follow-Ups-End-->
<!--X-References-->
<ul><li><strong>References</strong>:
<ul>
<li><strong><a name="00602" href="msg00602.html">[ferret_users] Remapping curvilinear coordinates to rectilinear coordinates</a></strong>
<ul><li><em>From:</em> Szymon Roziewski</li></ul></li>
<li><strong><a name="00603" href="msg00603.html">[ferret_users] Re: Remapping curvilinear coordinates to rectilinear coordinates</a></strong>
<ul><li><em>From:</em> Szymon Roziewski</li></ul></li>
<li><strong><a name="00604" href="msg00604.html">[ferret_users] Re: Remapping curvilinear coordinates to rectilinear coordinates</a></strong>
<ul><li><em>From:</em> Szymon Roziewski</li></ul></li>
<li><strong><a name="00605" href="msg00605.html">[ferret_users] Re: Remapping curvilinear coordinates to rectilinear coordinates</a></strong>
<ul><li><em>From:</em> Szymon Roziewski</li></ul></li>
</ul></li></ul>
<!--X-References-End-->
<!--X-BotPNI-->
<UL>
<li>Previous by thread:
<strong><a href="msg00606.html">[ferret_users] Re: Remapping curvilinear coordinates to rectilinear coordinates</a></strong>
</li>
<li>Next by thread:
<strong><a href="msg00608.html">Re: [ferret_users] Re: Remapping curvilinear coordinates to rectilinear coordinates</a></strong>
</li>

</UL>
<center>[<a href="msg00606.html">Thread Prev</a>][<a href="msg00608.html">Thread Next</a>][<A HREF="threads.html#00607">Index</A>]</center>

<!--X-BotPNI-End-->
<!--X-User-Footer-->
<hr>
<A HREF="ferret_contact_us.html">Contact Us</A>
<br>
<font size=-1>
<address>
<a href="http://www.doc.gov">Dept of Commerce</a> / 
<a href="http://www.noaa.gov">NOAA</a> /
<a href="http://www.oar.noaa.gov">OAR</a> /
<a href="http://www.pmel.noaa.gov">PMEL</a> /
<a href="http://tmap.pmel.noaa.gov">TMAP</a>
</address>
<br>
 <a href="http://www.noaa.gov/privacy.html">Privacy Policy</a> | <a href="http://www.noaa.gov/disclaimer.html">Disclaimer</a> | <a href="accessibility.html">Accessibility Statement</a> 
</font>
<!--X-User-Footer-End-->
</body>
</html>
