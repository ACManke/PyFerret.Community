<!-- MHonArc v2.6.16 -->
<!--X-Subject: [ferret_users] Re: Remapping curvilinear coordinates to rectilinear coordinates -->
<!--X-From-R13: Emlzba Dbmvrjfxv <fmlzba.ebmvrjfxvNtznvy.pbz> -->
<!--X-Date: Fri, 8 Oct 2010 06:07:10 &#45;0700 -->
<!--X-Message-Id: AANLkTin+DHfyArs6EH269t2P5=MhWjiO+G&#45;juVzSzUTS@mail.gmail.com -->
<!--X-Content-Type: multipart/alternative -->
<!--X-Reference: AANLkTi=8Q23JqDj_5svXvLO06HitAzt&#45;eukb6XYaLOdo@mail.gmail.com -->
<!--X-Head-End-->
<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN"
        "http://www.w3.org/TR/html4/loose.dtd">
<html>
<head>
<title>[ferret_users] Re: Remapping curvilinear coordinates to rectilinear coordinates</title>
</head>
<body>
<!--X-Body-Begin-->
<!--X-User-Header-->
<!--X-User-Header-End-->
<!--X-TopPNI-->
<HR>
<center>[<a href="msg00602.html">Thread Prev</a>][<a href="msg00604.html">Thread Next</a>][<A HREF="threads.html#00603">Index</A>]</center>

<!--X-TopPNI-End-->
<!--X-MsgBody-->
<!--X-Subject-Header-Begin-->
<h1>[ferret_users] Re: Remapping curvilinear coordinates to rectilinear coordinates</h1>
<hr>
<!--X-Subject-Header-End-->
<!--X-Head-of-Message-->
<ul>
<li><strong>To</strong>: <strong><a href="mailto:ferret_users@DOMAIN.HIDDEN">ferret_users@xxxxxxxx</a></strong></li>
<li><strong>Subject</strong>: <strong>[ferret_users] Re: Remapping curvilinear coordinates to rectilinear coordinates</strong></li>
<li><strong>From</strong>: <strong>Szymon Roziewski &lt;<a href="mailto:szymon.roziewski@DOMAIN.HIDDEN">szymon.roziewski@xxxxxxxxx</a>&gt;</strong></li>
<li>Date: Fri, 08 Oct 2010 15:07:07 +0200</li>
<li>Dkim-signature: v=1; a=rsa-sha256; c=relaxed/relaxed;        d=gmail.com; s=gamma; h=domainkey-signature:mime-version:received:received:in-reply-to :references:date:message-id:subject:from:to:content-type; bh=f70W8UMCDffNbawaj1VDNis9my15976ipo0V7FJZkAQ=; b=o2sKT9ud5hrl+7B63gqG88DiVu6zysaxspQ+/CSDEdC0HZK2VeuSr8x+zb8B3gXP3q 96tiLDFcfreNZHpxfTjH7Ljf4XZoMF8wOUmCJa7swbAKxHZsvok9IUuFZMP5+H8kbuMg 6VOI67Z+EhwufODlh736omkcx7OgwtN90nC2M=</li>
<li>Domainkey-signature: a=rsa-sha1; c=nofws;        d=gmail.com; s=gamma; h=mime-version:in-reply-to:references:date:message-id:subject:from:to :content-type; b=vVRs96dlvJhzV4d3lB4njO3jBSXaxdt4PB9IAO2IjixbiCSvwZPc4BRa5rJkz6NbN5 nkh1baMoZ2L5qpiCuJzr/wj6+ZURtl1PwB97PHMm0OlDyI/04uk2Z/0i7KMy188JxDpH 8eyuLTD0AbvJi3L6J3fEFppho4gC625Nsd+1w=</li>
<li>In-reply-to: &lt;<a href="mailto:AANLkTi%3D8Q23JqDj_5svXvLO06HitAzt-eukb6XYaLOdo@DOMAIN.HIDDEN">AANLkTi=8Q23JqDj_5svXvLO06HitAzt-eukb6XYaLOdo@xxxxxxxxxxxxxx</a>&gt;</li>
<li>References: &lt;<a href="mailto:AANLkTi%3D8Q23JqDj_5svXvLO06HitAzt-eukb6XYaLOdo@DOMAIN.HIDDEN">AANLkTi=8Q23JqDj_5svXvLO06HitAzt-eukb6XYaLOdo@xxxxxxxxxxxxxx</a>&gt;</li>
<li>Sender: <a href="mailto:owner-ferret_users@DOMAIN.HIDDEN">owner-ferret_users@xxxxxxxx</a></li>
</ul>
<!--X-Head-of-Message-End-->
<!--X-Head-Body-Sep-Begin-->
<hr>
<!--X-Head-Body-Sep-End-->
<!--X-Body-of-Message-->
<br>I also attach my script which does compute coefficient matrix.<br><br>DEFINE AXIS/x=1:448:1/unit=degree xaxis<br>DEFINE AXIS/y=1:615:1/unit=degree yaxis<br>DEFINE GRID/x=xaxis/y=yaxis gridlonlat<br>!read curvilinear coordinates onto grid 448x615<br>
FILE/VARIABLES=clon_in/COLUMNS=448/GRID=gridlonlat &quot;/home/szymon/WAM/CHECK/umlonicm448x615.dat&quot;<br>FILE/VARIABLES=clat_in/COLUMNS=448/GRID=gridlonlat &quot;/home/szymon/WAM/CHECK/umlaticm448x615.dat&quot;<br>!create grid which we desire<br>
define axis/x=-5.666666667:5.25:0.083333333/modulo/units=degrees xax<br>def axis/y=-2.0:10.0:0.083333333/units=degrees yax<br>let grid_out = y[gy=yax] + x[gx=xax]<br>!do transformation matrix<br>let map = CURV_TO_RECT_MAP(clon_in[d=1], clat_in[d=2], grid_out, 4)<br>
!save data<br>save/clobber/file=curv_map_UM_TO_ICM.nc map<br><br>and another script which uses it:<br><br>DEFINE AXIS/x=1:448:1/unit=degree xaxis<br>DEFINE AXIS/y=1:615:1/unit=degree yaxis<br>DEFINE GRID/x=xaxis/y=yaxis gridlonlat<br>
!load data for transformation&#xA0; - wind fields u,v<br>file/var=wlon/grid=gridlonlat/format=stream/type=r4/swap &quot;/home/szymon/WAM/CHECK/03225_2010092100+48000000c3hs000000000000000&quot;<br>file/var=wlat/grid=gridlonlat/format=stream/type=r4/swap &quot;/home/szymon/WAM/CHECK/03226_2010092100+48000000c3hs000000000000000&quot;<br>
!using transform matrix<br>use &quot;/home/szymon/ferret/vectors/curv_map_UM_TO_ICM.nc&quot;<br>! do transformation <br>let wlon_icm = curv_to_rect(wlon[d=1], map[d=3])<br>let wlat_icm = curv_to_rect(wlat[d=2], map[d=3])<br>
!save transformation data which You can see for example in the picture <b>wind_2010092103_ICM_remapped_132x145_and_interpolated.gif</b> or <b>UM_Significant_Wave_Height_21_September_2010_020000_TMP.gif (vectors only)</b><br>
save/format=(448F8.2)/file=winduumicm+48.txt/clobber wlon_icm<br>save/format=(448F8.2)/file=windvumicm+48.txt/clobber wlat_icm<br><br>Best regards,<br>Simon<br><br><br><div class="gmail_quote">2010/10/8 Szymon Roziewski <span dir="ltr">&lt;<a rel="nofollow" href="mailto:szymon.roziewski@xxxxxxxxx">szymon.roziewski@xxxxxxxxx</a>&gt;</span><br>
<blockquote class="gmail_quote" style="border-left: 1px solid rgb(204, 204, 204); margin: 0pt 0pt 0pt 0.8ex; padding-left: 1ex;">Hello there,<br>I have problem with appropriate remapping from curvilinear coordinates to rectilinear coordinates.<br>
The area which is covered with curvilinear coordinates is bigger than I need in rectilinear coordinates (it&#39;s a subset of curvilinear grid).<br clear="all">
I would like to raise such a question if ferret can do this transformation automaticly i.e. I needn&#39;t to care about the curvilinear grid is about bigger area than rectilinear.<br>Or I need to tell ferret that fact by some computations and findings.<br>

I attach files:<br>- wind_2010092103_ICM_aspect.gif - this is wind on curvilinear grid it is a bigger area<br>- wind_2010092103_ICM_remaped_132x145_and_interpolated.gif - this is wind on rectilinear grid it&#39;s a smaller area.<br>

<br>As You can see ferret did transformation but in a way I didn&#39;t intend. The Baltic Sea area is a little bit translated to the north and the northern part of sea was cut. The picture should wrap all area of Baltic Sea.<br>

In the picture UM_Significant_Wave_Height_21_September_2010_020000_TMP.gif I marked the area which matches interpolated wind field on Baltic Sea and You can see that it disagrees to significant wave height which occupies properly area. It means that interpolation from curvilinear grid 448x615 to the rectilinear grid 132x145 was done improperly.<br>

I hope I was understood.<br><br>Kind regards,<br><font color="#888888">Szymon Roziewski<br>
</font></blockquote></div><br><br clear="all"><br>-- <br>Z wyrazami szacunku,<br>Szymon Roziewski<br>

<!--X-Body-of-Message-End-->
<!--X-MsgBody-End-->
<!--X-Follow-Ups-->
<hr>
<ul><li><strong>Follow-Ups</strong>:
<ul>
<li><strong><a name="00604" href="msg00604.html">[ferret_users] Re: Remapping curvilinear coordinates to rectilinear coordinates</a></strong>
<ul><li><em>From:</em> Szymon Roziewski</li></ul></li>
</ul></li></ul>
<!--X-Follow-Ups-End-->
<!--X-References-->
<ul><li><strong>References</strong>:
<ul>
<li><strong><a name="00602" href="msg00602.html">[ferret_users] Remapping curvilinear coordinates to rectilinear coordinates</a></strong>
<ul><li><em>From:</em> Szymon Roziewski</li></ul></li>
</ul></li></ul>
<!--X-References-End-->
<!--X-BotPNI-->
<UL>
<li>Previous by thread:
<strong><a href="msg00602.html">[ferret_users] Remapping curvilinear coordinates to rectilinear coordinates</a></strong>
</li>
<li>Next by thread:
<strong><a href="msg00604.html">[ferret_users] Re: Remapping curvilinear coordinates to rectilinear coordinates</a></strong>
</li>

</UL>
<center>[<a href="msg00602.html">Thread Prev</a>][<a href="msg00604.html">Thread Next</a>][<A HREF="threads.html#00603">Index</A>]</center>

<!--X-BotPNI-End-->
<!--X-User-Footer-->
<hr>
<A HREF="ferret_contact_us.html">Contact Us</A>
<br>
<font size=-1>
<address>
<a href="http://www.doc.gov">Dept of Commerce</a> / 
<a href="http://www.noaa.gov">NOAA</a> /
<a href="http://www.oar.noaa.gov">OAR</a> /
<a href="http://www.pmel.noaa.gov">PMEL</a> /
<a href="http://tmap.pmel.noaa.gov">TMAP</a>
</address>
<br>
 <a href="http://www.noaa.gov/privacy.html">Privacy Policy</a> | <a href="http://www.noaa.gov/disclaimer.html">Disclaimer</a> | <a href="accessibility.html">Accessibility Statement</a> 
</font>
<!--X-User-Footer-End-->
</body>
</html>
