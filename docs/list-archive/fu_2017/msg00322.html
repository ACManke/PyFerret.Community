<!-- MHonArc v2.6.18 -->
<!--X-Subject: Re: [ferret_users] Looping over multiple input files to plot file variables and save to png -->
<!--X-From-R13: Dhff Tvrqyre <ehffryy.svrqyreNpfveb.nh> -->
<!--X-Date: Mon, 1 May 2017 21:11:46 &#45;0700 -->
<!--X-Message-Id: d3ad6d3a&#45;e7c1&#45;0d33&#45;d7d6&#45;4099c64001ad@csiro.au -->
<!--X-Content-Type: multipart/alternative -->
<!--X-Reference: 2595E167&#45;F5E9&#45;446A&#45;B269&#45;BC3569338DF4@llnl.gov -->
<!--X-Reference: dbfaef1a&#45;3e74&#45;32ff&#45;a89e&#45;8f07b1f90eee@csiro.au -->
<!--X-Reference: E9252927&#45;AFE7&#45;4723&#45;9018&#45;DE7F61C81867@llnl.gov -->
<!--X-Head-End-->
<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN"
        "http://www.w3.org/TR/html4/loose.dtd">
<html>
<head>
<title>Re: [ferret_users] Looping over multiple input files to plot file variables and save to png</title>
</head>
<body>
<!--X-Body-Begin-->
<!--X-User-Header-->
<!--X-User-Header-End-->
<!--X-TopPNI-->
<HR>
<center>[<a href="msg00321.html">Thread Prev</a>][<a href="msg00323.html">Thread Next</a>][<A HREF="threads.html#00322">Index</A>]</center>

<!--X-TopPNI-End-->
<!--X-MsgBody-->
<!--X-Subject-Header-Begin-->
<h1>Re: [ferret_users] Looping over multiple input files to plot file variables and save to png</h1>
<hr>
<!--X-Subject-Header-End-->
<!--X-Head-of-Message-->
<ul>
<li><strong>To</strong>: <strong><a href="mailto:ferret_users@DOMAIN.HIDDEN">ferret_users@xxxxxxxx</a></strong></li>
<li><strong>Subject</strong>: <strong>Re: [ferret_users] Looping over multiple input files to plot file variables and save to png</strong></li>
<li><strong>From</strong>: <strong>Russ Fiedler &lt;<a href="mailto:russell.fiedler@DOMAIN.HIDDEN">russell.fiedler@xxxxxxxx</a>&gt;</strong></li>
<li>Date: Tue, 2 May 2017 14:11:39 +1000</li>
<li>Dkim-signature: v=1; a=rsa-sha256; c=relaxed/relaxed;        d=noaa-gov.20150623.gappssmtp.com; s=20150623;        h=ironport-phdr:subject:to:references:from:message-id:date:user-agent         :mime-version:in-reply-to:x-original-sender         :x-original-authentication-results:precedence:mailing-list:list-id         :list-post:list-help:list-archive:list-unsubscribe;        bh=EiK9NuHM8NopIDF8zLP0y7zfh992W8Uq0S//LO43M/I=;        b=1WBFowJuyAyzr/LENcpDV1eFnPInCwAF+KIf7XLa1ofcyJITGOo4uaoAqnIn8fHmQT         XAZt+G/s2oFa7AAP7TUCAvdGZMtKjAufuvKOyewZ9L5OowXhM9GxnuAY0BlXJ9m7mFrW         FfhRaZ/2pUmJQp473c7IWlpb4IYLYDh9tYRWAlWSfUBBQXY1xdkm8qaBHlrRPgp6U4BX         RYeh77Lyq2owFcvmIog6XTlEcvJFU9eNkKrrR30oxVV3vnUIi1Fdz9WPAVWg4ztksQVl         BmymFCnyWLBkhpU0qEn8ra7MqhFmBhHYbknvx586f+6yBEjO8KeBh9xurliUuslMbWsi         rayA==</li>
<li>In-reply-to: &lt;<a href="msg00321.html">E9252927-AFE7-4723-9018-DE7F61C81867@llnl.gov</a>&gt;</li>
<li>Ironport-phdr: 9a23:oZCd/By/MMzLb8jXCy+O+j09IxM/srCxBDY+r6Qd1O4RIJqq85mqBkHD//Il1AaPBtSHraocw8Pt8InYEVQa5piAtH1QOLdtbDQizfssogo7HcSeAlf6JvO5JwYzHcBFSUM3tyrjaRsdF8nxfUDdrWOv5jAOBBr/KRB1JuPoEYLOksi7ze6/9pncbglSmDaxfa55IQmrownWqsQYm5ZpJLwryhvOrHtIeuBWyn1tKFmOgRvy5dq+8YB6/ShItP0v68BPUaPhf6QlVrNYFygpM3o05MLwqxbOSxaE62YGXWUXlhpIBBXF7A3/U5zsvCb2qvZx1S+HNsL4V7A0XSmp4bltRhHmlSwLMyc1/HzLhsB1iq9QvRCvqAFlw4PMfY+bKvR+cKPec90US2VOUcReWDBaD4ymc4cCFfAMMfpWooT/oVYFsBuwBROrBOPq0jJGmmL23bYh0+88EQ/G3RIvEM8KsHvKttX+KaAfUfqozKnT1jXMcfdW2TPn5IjGcxAuv+yDXbZufsrL0kQgCxjFjlSKqYziJT+azPkNvnGd4uF9Vuyvk3Yqpxx+rzSz3MshiI3EipgIxl3G7yl0xJs5KNulQ0Bhe9GkCoFftySCOotzRcMtXn9ntT4hyr0DpZ67ZC8KyIk7xxLHa/yIbYyI4hX7WemVPDt1i25pdKi9ihu260Ss1+/xWtOw3VpXqCVJitjMtnYT2BzP8sWLV/Rw8lu71TuN0w3f8PxILEIumaffNpIt2rswmYASsUTHEC/2gkL2jKqOe0U+5+io8P/nbavipp+YLYN0hAD+Pbozlcy7H+s4KBMDUHSA+eS9zr3j+lf1T69XjvEuiKnWrIjaJdgHpq6+GwJV3Jgs6wylDzi4zNQXhWQHLElbdxKdlIjkIFfOIPfiAvilmVisnzBrx+6VdoHmV5vANGLOjID8Zrtn8GZazwM6i99Y+cF6ELYEdcjuQVS5mt3VAhs0KUTg2fv8E9h50sUQWG+DBqKDGKjJsEWPoOsydbrfLLQJsSrwfqB2r8XlimU0zBpEJaQ=</li>
<li>List-archive: &lt;<a href="https://groups.google.com/a/noaa.gov/group/ferret_users/">https://groups.google.com/a/noaa.gov/group/ferret_users/</a>&gt;</li>
<li>List-help: &lt;<a href="https://support.google.com/a/noaa.gov/bin/topic.py?topic=25838">https://support.google.com/a/noaa.gov/bin/topic.py?topic=25838</a>&gt;, &lt;<a href="mailto:ferret_users+help@noaa.gov">mailto:ferret_users+help@noaa.gov</a>&gt;</li>
<li>List-id: &lt;ferret_users.noaa.gov&gt;</li>
<li>List-post: &lt;<a href="https://groups.google.com/a/noaa.gov/group/ferret_users/post">https://groups.google.com/a/noaa.gov/group/ferret_users/post</a>&gt;, &lt;<a href="mailto:ferret_users@noaa.gov">mailto:ferret_users@noaa.gov</a>&gt;</li>
<li>List-unsubscribe: &lt;<a href="mailto:googlegroups-manage+809428289204+unsubscribe@googlegroups.com">mailto:googlegroups-manage+809428289204+unsubscribe@googlegroups.com</a>&gt;, &lt;<a href="https://groups.google.com/a/noaa.gov/group/ferret_users/subscribe">https://groups.google.com/a/noaa.gov/group/ferret_users/subscribe</a>&gt;</li>
<li>Mailing-list: list <a href="mailto:ferret_users@DOMAIN.HIDDEN">ferret_users@xxxxxxxx</a>; contact <a href="mailto:ferret_users%2Bowners@DOMAIN.HIDDEN">ferret_users+owners@xxxxxxxx</a></li>
<li>References: &lt;<a href="msg00319.html">2595E167-F5E9-446A-B269-BC3569338DF4@llnl.gov</a>&gt; &lt;<a href="msg00320.html">dbfaef1a-3e74-32ff-a89e-8f07b1f90eee@csiro.au</a>&gt; &lt;<a href="msg00321.html">E9252927-AFE7-4723-9018-DE7F61C81867@llnl.gov</a>&gt;</li>
<li>Sender: <a href="mailto:owner-ferret_users@DOMAIN.HIDDEN">owner-ferret_users@xxxxxxxx</a></li>
<li>User-agent: Mozilla/5.0 (X11; Linux x86_64; rv:45.0) Gecko/20100101 Thunderbird/45.3.0</li>
</ul>
<!--X-Head-of-Message-End-->
<!--X-Head-Body-Sep-Begin-->
<hr>
<!--X-Head-Body-Sep-End-->
<!--X-Body-of-Message-->
<table width="100%"><tr><td bgcolor="#FFFFFF" style="background-color: #FFFFFF; color: #000000; "><font color="#000000">
  
  
    <div class="moz-cite-prefix">Hi Paul,<br>
      <br>
      You can strip the .nc suffix by passing through "sed".
      Alternatively using basename to strip suffixes works too. You can
      muck around with the Ferret string functions but they are awkward.
      Since you're using pyferret it would probably be rather simple to
      do this in python too.<br>
      <br>
      Try something like<br>
      <br>
      <span style="font-size:11.0pt">let filenames = SPAWN("/bin/ls -1
        basinmask/*.nc | sed -e s/\.nc//")</span><br>
      repeat/range=1:`filenames,ret=iend`/name=ifile go process_file
      filenames[i=`ifile`]<br>
      <br>
      where process_file takes a filename as an argument.<br>
      <br>
      e.g.<br>
      <br>
      \can mode verify<br>
      ! Usage:<br>
      ! go process_file filename<br>
      !<br>
      def sym filename $1<br>
      use ($filename)<br>
      ! Could use ($filename).nc <br>
      set win 1<br>
      <span style="font-size:11.0pt">sha basinmask4</span><br>
      <span style="font-size:11.0pt">frame/file="($outpath)($filename).png"</span><br>
      can data ($filename)<br>
      can sym filename<br>
      can win 1<br>
      set mode verify/last<br>
      <br>
      <br>
      Russ<br>
      <br>
      On 02/05/17 13:06, Durack, Paul J. wrote:<br>
    </div>
    <blockquote cite=""
      type="cite">
      
      
      
      
      
      <div class="WordSection1">
        <p class="MsoNormal"><span style="font-size:11.0pt">Thanks Russ,
            so how do I then loop over the entries:<o:p></o:p></span></p>
        <p class="MsoNormal"><span style="font-size:11.0pt"><o:p>&#xA0;</o:p></span></p>
        <p class="MsoNormal"><span style="font-size:11.0pt">let
            filenames = SPAWN("/bin/ls -1 basinmask/*.nc")<o:p></o:p></span></p>
        <p class="MsoNormal"><span style="font-size:11.0pt">! How do I
            loop over filenames?<o:p></o:p></span></p>
        <p class="MsoNormal"><span style="font-size:11.0pt">!REPEAT/RANGE=1:
            ($filenames)<o:p></o:p></span></p>
        <p class="MsoNormal"><span style="font-size:11.0pt">!<o:p></o:p></span></p>
        <p class="MsoNormal"><span style="font-size:11.0pt">! Then plot<o:p></o:p></span></p>
        <p class="MsoNormal"><span style="font-size:11.0pt">use
            ($filename)<o:p></o:p></span></p>
        <p class="MsoNormal"><span style="font-size:11.0pt">set win 1<o:p></o:p></span></p>
        <p class="MsoNormal"><span style="font-size:11.0pt">sha
            basinmask4<o:p></o:p></span></p>
        <p class="MsoNormal"><span style="font-size:11.0pt">frame/file="($outpath)($filename).png"
            ! How to I replace *.nc in the filename with *.png?<o:p></o:p></span></p>
        <p class="MsoNormal"><span style="font-size:11.0pt">cancel win 1<o:p></o:p></span></p>
        <p class="MsoNormal"><span style="font-size:11.0pt"><o:p>&#xA0;</o:p></span></p>
        <p class="MsoNormal"><span style="font-size:11.0pt">Cheers,<o:p></o:p></span></p>
        <p class="MsoNormal"><span style="font-size:11.0pt"><o:p>&#xA0;</o:p></span></p>
        <p class="MsoNormal"><span style="font-size:11.0pt">P<o:p></o:p></span></p>
        <p class="MsoNormal"><span style="font-size:11.0pt"><o:p>&#xA0;</o:p></span></p>
        <div style="border:none;border-top:solid #B5C4DF
          1.0pt;padding:3.0pt 0in 0in 0in">
          <p class="MsoNormal"><b><span style="color:black">From: </span></b><span
              style="color:black"><a rel="nofollow" class="moz-txt-link-rfc2396E" href="mailto:owner-ferret_users@xxxxxxxx">&lt;owner-ferret_users@xxxxxxxx&gt;</a> on
              behalf of Russ Fiedler <a rel="nofollow" class="moz-txt-link-rfc2396E" href="mailto:russell.fiedler@xxxxxxxx">&lt;russell.fiedler@xxxxxxxx&gt;</a><br>
              <b>Date: </b>Monday, May 1, 2017 at 5:36 PM<br>
              <b>To: </b><a rel="nofollow" class="moz-txt-link-rfc2396E" href="mailto:ferret_users@xxxxxxxx">"ferret_users@xxxxxxxx"</a>
              <a rel="nofollow" class="moz-txt-link-rfc2396E" href="mailto:ferret_users@xxxxxxxx">&lt;ferret_users@xxxxxxxx&gt;</a><br>
              <b>Subject: </b>Re: [ferret_users] Looping over multiple
              input files to plot file variables and save to png<o:p></o:p></span></p>
        </div>
        <div>
          <p class="MsoNormal"><span style="font-family:&quot;Times New
              Roman&quot;"><o:p>&#xA0;</o:p></span></p>
        </div>
        <div>
          <p class="MsoNormal"><br>
            Hi Paul,<br>
            <br>
            Rather than writing your filenames to a file you can create
            a variable using the SPAWN function directly.<br>
            <br>
            let filenames = SPAWN("/bin/ls -1 basinmask/*.nc")<br>
            <br>
            Another way would be to create the file as you are at the
            moment and read it in via a spawn and 'cat' command<br>
            <br>
            let filenames = SPAWN("cat filenames.txt")<br>
            <br>
            I'd prefer the first method.<br>
            <br>
            Cheers,<br>
            Russ<br>
            <br>
            On 02/05/17 08:20, Durack, Paul J. wrote:<o:p></o:p></p>
        </div>
        <blockquote style="margin-top:5.0pt;margin-bottom:5.0pt">
          <p class="MsoNormal"><span style="font-size:10.0pt">I have 51
              netcdf files in a directory, and want to loop over each of
              these and for each plot the contents of a gridded variable
              and save this to a png file, using pyferret 7.1</span><o:p></o:p></p>
          <p class="MsoNormal"><span style="font-size:10.0pt">&#xA0;</span><o:p></o:p></p>
          <p class="MsoNormal"><span style="font-size:10.0pt">I&#x2019;ve been
              struggling with syntax, and am getting &#x201C;**TMAP ERR:
              non-existent or not on line&#xA0; filenames.txt&#x201D;, with the
              following partial code:</span><o:p></o:p></p>
          <p class="MsoNormal"><span style="font-size:10.0pt">&#xA0;</span><o:p></o:p></p>
          <p class="MsoNormal"><span style="font-size:10.0pt">spawn "ls
              basinmask/*.nc &gt; filenames.txt" ! This is generating a
              file, but if I could create the filelist in memory this
              step could be removed</span><o:p></o:p></p>
          <p class="MsoNormal"><span style="font-size:10.0pt">FILE/FORMAT=DELIMITED/var="filenames"
              filenames.txt ! &lt; This generates the error</span><o:p></o:p></p>
          <p class="MsoNormal"><span style="font-size:10.0pt">say
              "processing: ",($file) ! don&#x2019;t get to here</span><o:p></o:p></p>
          <p class="MsoNormal"><span style="font-size:10.0pt">&#xA0;</span><o:p></o:p></p>
          <p class="MsoNormal"><span style="font-size:10.0pt">&#xA0;</span><o:p></o:p></p>
          <p class="MsoNormal"><span style="font-size:10.0pt">The plot
              and save command will be a simple:</span><o:p></o:p></p>
          <p class="MsoNormal"><span style="font-size:10.0pt">&#xA0;</span><o:p></o:p></p>
          <p class="MsoNormal"><span style="font-size:10.0pt">&gt; sha
              basinmask4 ! Each file contains the same named variable</span><o:p></o:p></p>
          <p class="MsoNormal"><span style="font-size:10.0pt">&gt;
              frame/file=&#x201D;($mypath)($myfile).png&#x201D;</span><o:p></o:p></p>
          <p class="MsoNormal"><span style="font-size:10.0pt">&#xA0;</span><o:p></o:p></p>
          <p class="MsoNormal"><span style="font-size:10.0pt">Can
              someone help me out to fill in the missing logic/syntax
              here?</span><o:p></o:p></p>
          <p class="MsoNormal"><span style="font-size:10.0pt">&#xA0;</span><o:p></o:p></p>
          <p class="MsoNormal"><span style="font-size:10.0pt">Thanks,</span><o:p></o:p></p>
          <p class="MsoNormal"><span style="font-size:10.0pt">&#xA0;</span><o:p></o:p></p>
          <p class="MsoNormal"><span style="font-size:10.0pt">P</span><o:p></o:p></p>
        </blockquote>
        <p><o:p>&#xA0;</o:p></p>
      </div>
    </blockquote>
    <p><br>
    </p>
  

</font></td></tr></table>
<!--X-Body-of-Message-End-->
<!--X-MsgBody-End-->
<!--X-Follow-Ups-->
<hr>
<!--X-Follow-Ups-End-->
<!--X-References-->
<ul><li><strong>References</strong>:
<ul>
<li><strong><a name="00319" href="msg00319.html">[ferret_users] Looping over multiple input files to plot file variables and save to png</a></strong>
<ul><li><em>From:</em> Durack, Paul J.</li></ul></li>
<li><strong><a name="00320" href="msg00320.html">Re: [ferret_users] Looping over multiple input files to plot file variables and save to png</a></strong>
<ul><li><em>From:</em> Russ Fiedler</li></ul></li>
<li><strong><a name="00321" href="msg00321.html">Re: [ferret_users] Looping over multiple input files to plot file variables and save to png</a></strong>
<ul><li><em>From:</em> Durack, Paul J.</li></ul></li>
</ul></li></ul>
<!--X-References-End-->
<!--X-BotPNI-->
<UL>
<li>Previous by thread:
<strong><a href="msg00321.html">Re: [ferret_users] Looping over multiple input files to plot file variables and save to png</a></strong>
</li>
<li>Next by thread:
<strong><a href="msg00323.html">Re: [ferret_users] Looping over multiple input files to plot file variables and save to png</a></strong>
</li>

</UL>
<center>[<a href="msg00321.html">Thread Prev</a>][<a href="msg00323.html">Thread Next</a>][<A HREF="threads.html#00322">Index</A>]</center>

<!--X-BotPNI-End-->
<!--X-User-Footer-->
<A HREF="http://ferret.pmel.noaa.gov/Ferret/contact-us">Contact Us</A>
<br>
<font size=-1>
<address>
<a href="http://www.doc.gov">Dept of Commerce</a> /
<a href="http://www.noaa.gov">NOAA</a> /
<a href="http://www.oar.noaa.gov">OAR</a> /
<a href="http://www.pmel.noaa.gov">PMEL</a> /
<a href="http://ferret.pmel.noaa.gov">Ferret</a>
</address>

<br>
 <a href="http://www.noaa.gov/privacy.html">Privacy Policy</a> | <a href="http://www.noaa.gov/disclaimer.html">Disclaimer</a> | <a href="accessibility.html">Accessibility Statement</a> 

</font>
<!--X-User-Footer-End-->
</body>
</html>
