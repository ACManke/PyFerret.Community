<!-- MHonArc v2.6.18 -->
<!--X-Subject: [ferret_users] pyferret crash while storing large dataset &#45; alternatives to prepare an ensemble? -->
<!--X-From-R13: "Dvrqr, Vryyn" <uryyn.evrqrNzcvp.qr> -->
<!--X-Date: Wed, 26 Apr 2017 17:25:13 &#45;0700 -->
<!--X-Message-Id: cf5668f33b2f4a9eb9cc4a23e086fbea@mpic.de -->
<!--X-Content-Type: text/plain -->
<!--X-Head-End-->
<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN"
        "http://www.w3.org/TR/html4/loose.dtd">
<html>
<head>
<title>[ferret_users] pyferret crash while storing large dataset - alternatives to prepare an ensemble?</title>
</head>
<body>
<!--X-Body-Begin-->
<!--X-User-Header-->
<!--X-User-Header-End-->
<!--X-TopPNI-->
<HR>
<center>[<a href="msg00303.html">Thread Prev</a>][<a href="msg00307.html">Thread Next</a>][<A HREF="threads.html#00305">Index</A>]</center>

<!--X-TopPNI-End-->
<!--X-MsgBody-->
<!--X-Subject-Header-Begin-->
<h1>[ferret_users] pyferret crash while storing large dataset - alternatives to prepare an ensemble?</h1>
<hr>
<!--X-Subject-Header-End-->
<!--X-Head-of-Message-->
<ul>
<li><strong>To</strong>: <strong>ferret users &lt;<a href="mailto:ferret_users@DOMAIN.HIDDEN">ferret_users@xxxxxxxx</a>&gt;</strong></li>
<li><strong>Subject</strong>: <strong>[ferret_users] pyferret crash while storing large dataset - alternatives to prepare an ensemble?</strong></li>
<li><strong>From</strong>: <strong>&quot;Riede, Hella&quot; &lt;<a href="mailto:hella.riede@DOMAIN.HIDDEN">hella.riede@xxxxxxx</a>&gt;</strong></li>
<li>Date: Thu, 27 Apr 2017 00:25:01 +0000</li>
<li>Accept-language: en-US, de-DE</li>
<li>Dkim-signature: v=1; a=rsa-sha256; c=relaxed/relaxed;        d=noaa-gov.20150623.gappssmtp.com; s=20150623;        h=from:to:subject:thread-topic:thread-index:date:message-id         :accept-language:content-language:content-transfer-encoding         :mime-version:x-original-sender:x-original-authentication-results         :precedence:mailing-list:list-id:list-post:list-help:list-archive         :list-unsubscribe;        bh=QGEJaSwGfBpHHPLeUVJ/03/qkxWzgEY8obozFtnqC44=;        b=FDfoSsebBvRuaKcjQA1p5oe6TZWIE5DMVn2uRCc8rWoYllJZ8kBE5Uh+YV3Gg3h/b1         ydO/3wG2wfh9PDGmemB0IRr8lIpAMwIL+isgJ7dEql+kqpl0t5YiyWFt8p6iek6ksfCY         0RUbi91NEjudHxT8EcEdmKevVQPXgEfgBcr6CcplH+Ic90PiTLvTM3fSsrr0DhkqYx49         f1uvFUkGCJFk2xBWMoe87GgEOk9SW0Rz6dR+ml0Sxt8BUjcNKR6/QZSvbGcAhMKOdm6F         PSYFAAhn95ZFkgV8k7Sg1u/EIvXygGzvdMyw3bckUn4jnDesZItMwc+W4r1TD6OqEgz2         eSlw==</li>
<li>List-archive: &lt;<a href="https://groups.google.com/a/noaa.gov/group/ferret_users/">https://groups.google.com/a/noaa.gov/group/ferret_users/</a>&gt;</li>
<li>List-help: &lt;<a href="https://support.google.com/a/noaa.gov/bin/topic.py?topic=25838">https://support.google.com/a/noaa.gov/bin/topic.py?topic=25838</a>&gt;, &lt;<a href="mailto:ferret_users+help@noaa.gov">mailto:ferret_users+help@noaa.gov</a>&gt;</li>
<li>List-id: &lt;ferret_users.noaa.gov&gt;</li>
<li>List-post: &lt;<a href="https://groups.google.com/a/noaa.gov/group/ferret_users/post">https://groups.google.com/a/noaa.gov/group/ferret_users/post</a>&gt;, &lt;<a href="mailto:ferret_users@noaa.gov">mailto:ferret_users@noaa.gov</a>&gt;</li>
<li>List-unsubscribe: &lt;<a href="mailto:googlegroups-manage+809428289204+unsubscribe@googlegroups.com">mailto:googlegroups-manage+809428289204+unsubscribe@googlegroups.com</a>&gt;, &lt;<a href="https://groups.google.com/a/noaa.gov/group/ferret_users/subscribe">https://groups.google.com/a/noaa.gov/group/ferret_users/subscribe</a>&gt;</li>
<li>Mailing-list: list <a href="mailto:ferret_users@DOMAIN.HIDDEN">ferret_users@xxxxxxxx</a>; contact <a href="mailto:ferret_users%2Bowners@DOMAIN.HIDDEN">ferret_users+owners@xxxxxxxx</a></li>
<li>Sender: <a href="mailto:owner-ferret_users@DOMAIN.HIDDEN">owner-ferret_users@xxxxxxxx</a></li>
<li>Thread-index: AQHSvuy1i0fY1xkLH0+HdD5JDEFOfg==</li>
<li>Thread-topic: pyferret crash while storing large dataset - alternatives to prepare an ensemble?</li>
</ul>
<!--X-Head-of-Message-End-->
<!--X-Head-Body-Sep-Begin-->
<hr>
<!--X-Head-Body-Sep-End-->
<!--X-Body-of-Message-->
<pre>Hello ferreters,

I am storing a large dataset, looping over variables. The main line for that is
save/quiet/file=($out)/NCFORMAT=4/DEFLATE=4/append ($var);\

After the file has grown to 713 MB, the script crashes with the following error message:

/afs/ipp/.cs/python_modules/amd64_generic/pyferret/anaconda/2/4.1.1/bin/ferret: line 17: 40827 Killed                  python ${python_flags} -c &quot;import sys; import pyferret; (errval, errmsg) = pyferret.init(sys.argv[1:], True)&quot; &quot;$@&quot;

Same happens when using DEFLATE=1 instead as recommended.

This is quite cryptic to me - can anybody help?



*Background* (Maybe there's another more efficient way?)

I have about 80 large netCDF files with 2 dimensions - time and E. The times overlap partially and cover altogether about 3 years. The E dimension has different lengths. I'd like to combine those datasets into an ensemble / one file, for instance along F.

To combine the data as an ensemble, I have to unify the existing dimensions first, so I
1) read in a dataset
2) define the unified axes for T and E
3) loop over all variables in the files (they are the same in all files)
4) write out all variables on the new T and E axes.

After having written 713 MB of the new file, which corresponds to 31 of the 115 variables, the above error occurs. There's no special issues with the variable where it happens, no non-standard name.


An other method I have tried: Enlarge the E dimension by producing an empty hyperslab and glueing this onto the original dataset via ncrcat. This is impossibly slow.


Any other way to efficiently fill a file with undefined values to make them ready for being an ensemble?


Thanks in advance!

Hella



</pre>
<!--X-Body-of-Message-End-->
<!--X-MsgBody-End-->
<!--X-Follow-Ups-->
<hr>
<ul><li><strong>Follow-Ups</strong>:
<ul>
<li><strong><a name="00307" href="msg00307.html">Re: [ferret_users] pyferret crash while storing large dataset - alternatives to prepare an ensemble?</a></strong>
<ul><li><em>From:</em> Karl Smith - NOAA Affiliate</li></ul></li>
</ul></li></ul>
<!--X-Follow-Ups-End-->
<!--X-References-->
<!--X-References-End-->
<!--X-BotPNI-->
<UL>
<li>Previous by thread:
<strong><a href="msg00303.html">[ferret_users] Ekman spiral equation from wind curl</a></strong>
</li>
<li>Next by thread:
<strong><a href="msg00307.html">Re: [ferret_users] pyferret crash while storing large dataset - alternatives to prepare an ensemble?</a></strong>
</li>

</UL>
<center>[<a href="msg00303.html">Thread Prev</a>][<a href="msg00307.html">Thread Next</a>][<A HREF="threads.html#00305">Index</A>]</center>

<!--X-BotPNI-End-->
<!--X-User-Footer-->
<A HREF="http://ferret.pmel.noaa.gov/Ferret/contact-us">Contact Us</A>
<br>
<font size=-1>
<address>
<a href="http://www.doc.gov">Dept of Commerce</a> /
<a href="http://www.noaa.gov">NOAA</a> /
<a href="http://www.oar.noaa.gov">OAR</a> /
<a href="http://www.pmel.noaa.gov">PMEL</a> /
<a href="http://ferret.pmel.noaa.gov">Ferret</a>
</address>

<br>
 <a href="http://www.noaa.gov/privacy.html">Privacy Policy</a> | <a href="http://www.noaa.gov/disclaimer.html">Disclaimer</a> | <a href="accessibility.html">Accessibility Statement</a> 

</font>
<!--X-User-Footer-End-->
</body>
</html>
