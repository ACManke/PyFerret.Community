<!-- MHonArc v2.6.18 -->
<!--X-Subject: Re: [ferret_users] unexpected difference depending on order of integration and annual cycle -->
<!--X-From-R13: [negva Epuzvqg <znegva.fpuzvqgNvb&#45;jnearzhraqr.qr> -->
<!--X-Date: Wed, 22 Mar 2017 13:41:00 &#45;0700 -->
<!--X-Message-Id: 9d9869b5&#45;e074&#45;69f8&#45;7b32&#45;38dbbcf58165@io&#45;warnemuende.de -->
<!--X-Content-Type: multipart/alternative -->
<!--X-Reference: 6DADBCE5&#45;7F1A&#45;4EBF&#45;AFB6&#45;DDA5416DE892@noaa.gov -->
<!--X-Head-End-->
<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN"
        "http://www.w3.org/TR/html4/loose.dtd">
<html>
<head>
<title>Re: [ferret_users] unexpected difference depending on order of integration and annual cycle</title>
</head>
<body>
<!--X-Body-Begin-->
<!--X-User-Header-->
<!--X-User-Header-End-->
<!--X-TopPNI-->
<HR>
<center>[<a href="msg00230.html">Thread Prev</a>][<a href="msg00232.html">Thread Next</a>][<A HREF="threads.html#00231">Index</A>]</center>

<!--X-TopPNI-End-->
<!--X-MsgBody-->
<!--X-Subject-Header-Begin-->
<h1>Re: [ferret_users] unexpected difference depending on order of integration and annual cycle</h1>
<hr>
<!--X-Subject-Header-End-->
<!--X-Head-of-Message-->
<ul>
<li><strong>To</strong>: <strong><a href="mailto:ferret_users@DOMAIN.HIDDEN">ferret_users@xxxxxxxx</a></strong></li>
<li><strong>Subject</strong>: <strong>Re: [ferret_users] unexpected difference depending on order of integration and annual cycle</strong></li>
<li><strong>From</strong>: <strong>Martin Schmidt &lt;<a href="mailto:martin.schmidt@DOMAIN.HIDDEN">martin.schmidt@xxxxxxxxxxxxxxxxx</a>&gt;</strong></li>
<li>Date: Wed, 22 Mar 2017 21:39:12 +0100</li>
<li>Dkim-signature: v=1; a=rsa-sha256; c=relaxed/relaxed;        d=noaa-gov.20150623.gappssmtp.com; s=20150623;        h=subject:to:references:from:message-id:date:user-agent:mime-version         :in-reply-to:x-original-sender:x-original-authentication-results         :precedence:mailing-list:list-id:list-post:list-help:list-archive         :list-unsubscribe;        bh=GEPRxnIVeINk1aVblvq0qcC6nrbQYCKS/gEOkf80h+U=;        b=Oot59PvVWEcy0NpO4w+HTIqQs5j19Jqx1M+3X7i9lN7AdSCRoUWY6AuEU2s1zuN1FD         4Axy/jwktd1+PlnClrFOtMXuyOvM8v1ruNCKbWG2tfKxLdvlIdDwW5tJv0irDbXBrGuL         LnWIuHYh/Ll1+owEyqQFez9XFiJHnfgFhoXxP9YU7jA6P5jZwYQb/Uuk46K8hKPsVew/         qwgGl/4VNlI/pmfSxsMxF4gNcpd6IY6/lobrUKWU2cJc7wz0+9Rm59QbC9BBW6k02A9Z         aN2Br1mMTj1yA8Z7VczVb4xpWP4um/6LsJdkXBJAkimBDFBz/hsw5HCuUP/nKZBD7i5e         wdvw==</li>
<li>In-reply-to: &lt;<a href="msg00230.html">6DADBCE5-7F1A-4EBF-AFB6-DDA5416DE892@noaa.gov</a>&gt;</li>
<li>List-archive: &lt;<a href="https://groups.google.com/a/noaa.gov/group/ferret_users/">https://groups.google.com/a/noaa.gov/group/ferret_users/</a>&gt;</li>
<li>List-help: &lt;<a href="https://support.google.com/a/noaa.gov/bin/topic.py?topic=25838">https://support.google.com/a/noaa.gov/bin/topic.py?topic=25838</a>&gt;, &lt;<a href="mailto:ferret_users+help@noaa.gov">mailto:ferret_users+help@noaa.gov</a>&gt;</li>
<li>List-id: &lt;ferret_users.noaa.gov&gt;</li>
<li>List-post: &lt;<a href="https://groups.google.com/a/noaa.gov/group/ferret_users/post">https://groups.google.com/a/noaa.gov/group/ferret_users/post</a>&gt;, &lt;<a href="mailto:ferret_users@noaa.gov">mailto:ferret_users@noaa.gov</a>&gt;</li>
<li>List-unsubscribe: &lt;<a href="mailto:googlegroups-manage+809428289204+unsubscribe@googlegroups.com">mailto:googlegroups-manage+809428289204+unsubscribe@googlegroups.com</a>&gt;, &lt;<a href="https://groups.google.com/a/noaa.gov/group/ferret_users/subscribe">https://groups.google.com/a/noaa.gov/group/ferret_users/subscribe</a>&gt;</li>
<li>Mailing-list: list <a href="mailto:ferret_users@DOMAIN.HIDDEN">ferret_users@xxxxxxxx</a>; contact <a href="mailto:ferret_users%2Bowners@DOMAIN.HIDDEN">ferret_users+owners@xxxxxxxx</a></li>
<li>References: &lt;<a href="msg00230.html">6DADBCE5-7F1A-4EBF-AFB6-DDA5416DE892@noaa.gov</a>&gt;</li>
<li>Sender: <a href="mailto:owner-ferret_users@DOMAIN.HIDDEN">owner-ferret_users@xxxxxxxx</a></li>
<li>User-agent: Mozilla/5.0 (X11; Linux x86_64; rv:45.0) Gecko/20100101 Thunderbird/45.6.0</li>
</ul>
<!--X-Head-of-Message-End-->
<!--X-Head-Body-Sep-Begin-->
<hr>
<!--X-Head-Body-Sep-End-->
<!--X-Body-of-Message-->
<table width="100%"><tr><td bgcolor="#FFFFFF" style="background-color: #FFFFFF; color: #000000; "><font color="#000000">
  
  
    <p>Hi William,</p>
    <p>I do not have the complete explanation. But:</p>
    <p>shade var</p>
    <p>reveals missing values with time dependent distribution.
      Replacing "var" by "missing(var,0)" gives results independent off
      the order of operations. <br>
    </p>
    <p>The @mod transformation should imply some division by @ngd. What
      @ngd is depends on the order of operations. So far, things may by
      not fully linear any more?</p>
    <p>Best,</p>
    <p>Martin<br>
    </p>
    <br>
    <div class="moz-cite-prefix">On 03/22/2017 07:32 PM, William Kessler
      wrote:<br>
    </div>
    <blockquote cite=""
      type="cite">
      <pre wrap="">Hi Ferreters -

I have a confusing difference in result depending on the order of operations. These should all be linear operations, so the order of doing them should not affect the result. I'm confused. 

The differences are smallish but could be significant. This is, by the way, the Ekman transport across 7.5S, and the differences are a few Sv.

In one case, I first find the annual cycle, then integrate the result in x. In the other, I first integrate in x, then find the annual cycle of the result. These should be identical, but aren't (attached gif plot). I don't know which is correct.

Why not? 

The attached cdf file (357Kb) has 5 variables:

VAR      original time series       
VAR_CL   annual cycle of original   
VAR_INT  x-integral of original     
VAR_INTCL  annual cycle of x-integral 
VAR_CLINT   x-integral of annual cycle 

These variables were defined by the following commands:

yes? let/tit="original time series" var=eky[y=7.5s,x=148e:82w]
yes? let/tit="annual cycle of original" var_cl=var[gt=month_irreg@mod]
yes? let/tit="x-integral of original" var_int=var[x=@din]
yes? let/tit="annual cycle of x-integral" var_intcl=var_int[gt=month_irreg@mod]
yes? let/tit="x-integral of annual cycle" var_clint=var_cl[x=@din]
yes? save/outtype=float/file=check_order_of_operations.cdf var,var_cl,var_int,var_intcl,var_clint

yes? plot/line/sym=27 var_intcl,var_clint

This is Ferret v6.94 (Mac)
~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
William S. Kessler
NOAA / Pacific Marine Environmental Laboratory
7600 Sand Point Way NE
Seattle WA 98115 USA

<a rel="nofollow" class="moz-txt-link-abbreviated" href="mailto:william.s.kessler@xxxxxxxx">william.s.kessler@xxxxxxxx</a>
Tel: +1 206-526-6221
Fax: +1 206-526-6744
</pre>
      <br>
      <fieldset class="mimeAttachmentHeader"></fieldset>
      <br>
      <pre wrap="">

</pre>
    </blockquote>
    <br>
  

</font></td></tr></table>
<!--X-Body-of-Message-End-->
<!--X-MsgBody-End-->
<!--X-Follow-Ups-->
<hr>
<ul><li><strong>Follow-Ups</strong>:
<ul>
<li><strong><a name="00232" href="msg00232.html">Re: [ferret_users] unexpected difference depending on order of integration and annual cycle</a></strong>
<ul><li><em>From:</em> Andrew Wittenberg - NOAA Federal</li></ul></li>
</ul></li></ul>
<!--X-Follow-Ups-End-->
<!--X-References-->
<ul><li><strong>References</strong>:
<ul>
<li><strong><a name="00230" href="msg00230.html">[ferret_users] unexpected difference depending on order of integration and annual cycle</a></strong>
<ul><li><em>From:</em> William Kessler</li></ul></li>
</ul></li></ul>
<!--X-References-End-->
<!--X-BotPNI-->
<UL>
<li>Previous by thread:
<strong><a href="msg00230.html">[ferret_users] unexpected difference depending on order of integration and annual cycle</a></strong>
</li>
<li>Next by thread:
<strong><a href="msg00232.html">Re: [ferret_users] unexpected difference depending on order of integration and annual cycle</a></strong>
</li>

</UL>
<center>[<a href="msg00230.html">Thread Prev</a>][<a href="msg00232.html">Thread Next</a>][<A HREF="threads.html#00231">Index</A>]</center>

<!--X-BotPNI-End-->
<!--X-User-Footer-->
<A HREF="http://ferret.pmel.noaa.gov/Ferret/contact-us">Contact Us</A>
<br>
<font size=-1>
<address>
<a href="http://www.doc.gov">Dept of Commerce</a> /
<a href="http://www.noaa.gov">NOAA</a> /
<a href="http://www.oar.noaa.gov">OAR</a> /
<a href="http://www.pmel.noaa.gov">PMEL</a> /
<a href="http://ferret.pmel.noaa.gov">Ferret</a>
</address>

<br>
 <a href="http://www.noaa.gov/privacy.html">Privacy Policy</a> | <a href="http://www.noaa.gov/disclaimer.html">Disclaimer</a> | <a href="accessibility.html">Accessibility Statement</a> 

</font>
<!--X-User-Footer-End-->
</body>
</html>
