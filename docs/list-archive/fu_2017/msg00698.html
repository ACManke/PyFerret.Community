<!-- MHonArc v2.6.18 -->
<!--X-Subject: Re: [ferret_users] problem with longitude lines drawing -->
<!--X-From-R13: Dhff Tvrqyre <ehffryy.svrqyreNpfveb.nh> -->
<!--X-Date: Tue, 5 Dec 2017 17:34:37 &#45;0800 -->
<!--X-Message-Id: eda102b1&#45;5603&#45;9787&#45;072b&#45;ece5bf0c37fb@csiro.au -->
<!--X-Content-Type: multipart/alternative -->
<!--X-Reference: 165079787&#45;6c1452cac70bdc64cc7c4cdec0278637@pmq2v.m5r2.onet -->
<!--X-Reference: 208466aa&#45;d3ad&#45;53e3&#45;6c8b&#45;b37211629893@noaa.gov -->
<!--X-Head-End-->
<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN"
        "http://www.w3.org/TR/html4/loose.dtd">
<html>
<head>
<title>Re: [ferret_users] problem with longitude lines drawing</title>
</head>
<body>
<!--X-Body-Begin-->
<!--X-User-Header-->
<!--X-User-Header-End-->
<!--X-TopPNI-->
<HR>
<center>[<a href="msg00697.html">Thread Prev</a>][<a href="msg00694.html">Thread Next</a>][<A HREF="threads.html#00698">Index</A>]</center>

<!--X-TopPNI-End-->
<!--X-MsgBody-->
<!--X-Subject-Header-Begin-->
<h1>Re: [ferret_users] problem with longitude lines drawing</h1>
<hr>
<!--X-Subject-Header-End-->
<!--X-Head-of-Message-->
<ul>
<li><strong>To</strong>: <strong><a href="mailto:ferret_users@DOMAIN.HIDDEN">ferret_users@xxxxxxxx</a></strong></li>
<li><strong>Subject</strong>: <strong>Re: [ferret_users] problem with longitude lines drawing</strong></li>
<li><strong>From</strong>: <strong>Russ Fiedler &lt;<a href="mailto:russell.fiedler@DOMAIN.HIDDEN">russell.fiedler@xxxxxxxx</a>&gt;</strong></li>
<li>Date: Wed, 6 Dec 2017 12:34:24 +1100</li>
<li>Arc-authentication-results: i=4; mx.google.com;       dkim=pass header.i=@csiro.au header.s=dkim header.b=WQPRO79D;       arc=pass (i=2 dkim=pass dkdomain=csiro.au);       spf=fail (google.com: domain of prvs=506c32bf7=<a href="mailto:russell.fiedler@DOMAIN.HIDDEN">russell.fiedler@xxxxxxxx</a> does not designate 52.222.5.176 as permitted sender) smtp.mailfrom=prvs=506c32bf7=<a href="mailto:russell.fiedler@DOMAIN.HIDDEN">russell.fiedler@xxxxxxxx</a>;       dmarc=pass (p=NONE sp=NONE dis=NONE) header.from=csiro.au</li>
<li>Arc-authentication-results: i=3; mx.google.com;       dkim=pass header.i=@csiro.au header.s=dkim header.b=WQPRO79D;       arc=pass (i=2 dkim=pass dkdomain=csiro.au);       spf=fail (google.com: domain of prvs=506c32bf7=<a href="mailto:russell.fiedler@DOMAIN.HIDDEN">russell.fiedler@xxxxxxxx</a> does not designate 52.222.5.176 as permitted sender) smtp.mailfrom=prvs=506c32bf7=<a href="mailto:russell.fiedler@DOMAIN.HIDDEN">russell.fiedler@xxxxxxxx</a>;       dmarc=pass (p=NONE sp=NONE dis=NONE) header.from=csiro.au</li>
<li>Arc-authentication-results: i=2; mx.google.com;       dkim=pass header.i=@csiro.au header.s=dkim header.b=WQPRO79D;       arc=pass (i=1 spf=pass spfdomain=csiro.au dkim=pass dkdomain=csiro.au dmarc=pass fromdomain=csiro.au);       spf=fail (google.com: domain of prvs=506c32bf7=<a href="mailto:russell.fiedler@DOMAIN.HIDDEN">russell.fiedler@xxxxxxxx</a> does not designate 65.127.216.226 as permitted sender) smtp.mailfrom=prvs=506c32bf7=<a href="mailto:russell.fiedler@DOMAIN.HIDDEN">russell.fiedler@xxxxxxxx</a></li>
<li>Arc-authentication-results: i=1; mx.google.com;       dkim=pass header.i=@csiro.au header.s=dkim header.b=WQPRO79D;       spf=pass (google.com: domain of prvs=506c32bf7=<a href="mailto:russell.fiedler@DOMAIN.HIDDEN">russell.fiedler@xxxxxxxx</a> designates 2405:b000:e00:257::7:41 as permitted sender) smtp.mailfrom=prvs=506c32bf7=<a href="mailto:russell.fiedler@DOMAIN.HIDDEN">russell.fiedler@xxxxxxxx</a>;       dmarc=pass (p=NONE sp=NONE dis=NONE) header.from=csiro.au</li>
<li>Arc-message-signature: i=4; a=rsa-sha256; c=relaxed/relaxed; d=google.com; s=arc-20160816;        h=list-archive:list-help:list-post:list-id:mailing-list:precedence         :content-language:in-reply-to:mime-version:user-agent:date:from         :references:to:subject:arc-authentication-results         :arc-message-signature:arc-authentication-results         :arc-message-signature:message-id:arc-authentication-results         :arc-message-signature:dkim-signature:arc-authentication-results;        bh=Y5YWMmCXQrucOpHGbENnZkqJsmPBAIHvdFcBLQq3Tig=;        b=hGAx9kE5rcFdishpo/aixFcKp/CGZibWr8VkhM6tINieKefhpTsEcR8Uu/Lka5Jy5V         oQrIYdoOFMNpbWHJSU2TXKQMbaUmoRFXkK2cJS23d4StliQzHrlyCLGlLSVLirm+g8np         LQeBKjVDN/XX+Yms9Oqr62KQXVX+XQVmcZUbt9CdnByW/TTf9y0blr3ziOWRbeSsT62K         tP/4So1sOH+L9DxBPEfaHYiSINLPvQ95JZ4ggYyVhEKI5wuxV3p9cnWqZR4Dq+HRsoob         n1EbTt3PJxYLA9ZVkxoGLHBFJJI7XJW2v6ZC+G8sIK9V0PwZocQ9f9YlTT6FVhkxpJgS         ng5g==</li>
<li>Arc-message-signature: i=3; a=rsa-sha256; c=relaxed/relaxed; d=google.com; s=arc-20160816;        h=content-language:in-reply-to:mime-version:user-agent:date:from         :references:to:subject:dkim-signature:arc-authentication-results         :arc-message-signature:arc-authentication-results         :arc-message-signature:message-id:arc-authentication-results;        bh=Y5YWMmCXQrucOpHGbENnZkqJsmPBAIHvdFcBLQq3Tig=;        b=c0EHAr4tY6JDT/gJv2892JdKvSBj4CpUElgRhDsHktoUzYbqIEpCe2mdvuFaSaikeA         mX6eabCgxlFP3AVFQ5pOJ7YdXMCLybGYUngDnztvij0Q/XvQGYVR+nx8nb+L+ZfcDp+u         N5F6EPMdCj+CZF08M965YETfaiX0WLNpxoo4id+P676VMk+4iQC6Yvufk8BaEva/KPU3         Ke3FBelwo0LyAqCO14CSa9XF5kW4ds2IfEoha7c6nHsZtxZJUm6BJuUu63iORdDwyIrZ         CL4hROtD53FTsl4ItzlG1q6e/tiydfkw9zq8rMPCpSp/XeQdVKnaRg5FNL3pOSehNUbG         mtsA==</li>
<li>Arc-message-signature: i=2; a=rsa-sha256; c=relaxed/relaxed; d=google.com; s=arc-20160816;        h=content-language:in-reply-to:mime-version:user-agent:date         :message-id:from:references:to:subject:dkim-signature         :arc-authentication-results:arc-message-signature         :arc-authentication-results;        bh=Y5YWMmCXQrucOpHGbENnZkqJsmPBAIHvdFcBLQq3Tig=;        b=WTlWNS6UgdYkIpYkGWJdET0nHEsxs/qoUs0fmzEm2AFfomKFjQzuriXTw1hiHMZ1He         B0Mt9TlHH9hnKm+UGrIZ0ltbDbstVVVuHHeexQ/5Watext2JJjnOrus2OFOTvaheoyjN         mxaQSKWmKEUnCyzJqbqsrL+5pKTEbvaIL+UcEpvNxUj28eA7fyXhPprJ38p4enC3fS6x         k3QwXcUsuc4Nc78ZBKCwn3jeJcnqqSfIWf5S58phZg64T6DDIgQ65eh5H5JhwRRvIZp5         chm4HsM543JHV4H0kkaYgGY4cF9CnpY9R+Cn8Da7cHg3evL6TFCkFsDzs3fgm33ZI6sb         SJmw==</li>
<li>Arc-message-signature: i=1; a=rsa-sha256; c=relaxed/relaxed; d=google.com; s=arc-20160816;        h=content-language:in-reply-to:mime-version:user-agent:date         :message-id:from:references:to:subject:dkim-signature         :arc-authentication-results;        bh=Y5YWMmCXQrucOpHGbENnZkqJsmPBAIHvdFcBLQq3Tig=;        b=NLzYw5J3yYr610g1aMMStW7ARQaXMTuRSpc1WMmzhEKLhx1L89zOmBjkNnX3wmYV4o         JT4uYmeUp1jothyD46azewb6RsoTV9QKYAQLvnlezwyFo0plExvWEhuPdGSwuxyelHzL         pYM97/QkODSmvofYir6Zn4GgvkZnB0knlPyKma+p93dTSpKmMmcQdfJnVEv23Ji1njR4         MtlF3Z+RKXXgdxR5b/5IXtKJ0RAMcwC4jI1vmLD5ln1AZ+nI4tS+NFfaD3mSFrEqwEpd         6bhkR2/LtReYUdpaB8m1fkk0iKh9ejXA9JIRSg6sFfaPUGt9RhkyoC7pdl8CTa04kSM3         yxpg==</li>
<li>Arc-seal: i=4; a=rsa-sha256; t=1512524076; cv=pass;        d=google.com; s=arc-20160816;        b=VCqsvZ1HfyR3frfnmzB5eo2X6hSxhRjKS6/bh6ZmmB1Pxq1X0iD9XlmYil8vHcR1QX         3hYMo0rAPPV6Va8iToj42UQt9DUq4CL+CVyTOC00zntrFI9hClYJSd4VvxL1S4ooESKO         sXtpSxpxa+6na4tLSPHKZBpO76FSRE0RyvvyAtFEqik9aYk61dmeSVX/3yddEmEocEZ6         OU9av7pthRtpcLi9VE3paM6QSzYsSEP0oN3JYWha0n7wXnevREwZhkU4ijVfhmTqHDYm         43kteKNbfUX+awn1N/3yVj87HEciEUEjcViEghtKwY72s/EJTa7nHEeGnjTwcHN6x9qW         xUDw==</li>
<li>Arc-seal: i=3; a=rsa-sha256; t=1512524076; cv=pass;        d=google.com; s=arc-20160816;        b=ZDZ+HaYK7SKYz5OaOZ7F++75+6PE0SvQpxZ2ORcwspkSCZehRpuarP1b9xp2m4/IdQ         m3JZ/ULvGcEL+TMgeRXbnJ5GfzfPp3U78rbF6jc58LOp3/+D8lhR0+o7RX5EbQuCLaIW         DcztjKwYCW//bgiDta9NbKsqBJICCXVtzltto2Dp4gAuuXJO39HfpaGr1vVmVrW/QEGg         d/IW/Rp2uXQusWtjxbTATaClhYwjXFim2mR5Fq9kZ482FXmi8wVSFDQ5q1Vdl8qSC7h+         qcYfqyVNa0O16vp74OdyW+xu3lAFYLj9YoVDowHFUJhyqbI76aOb+PY2SUo3udpIMSwL         ae9w==</li>
<li>Arc-seal: i=2; a=rsa-sha256; t=1512524073; cv=pass;        d=google.com; s=arc-20160816;        b=om9nOweRW5C0J8Trh7qTS5uhi2Nw0Niyhxvd/GYHdBYuxCwP1VFoZnyS1YlNvabwZ4         B/TZBK2vIetVbJkNRQYUzVXtjCtAQ+FEWxmhxQTB92C9YTkcBJC6AIhwqKFJY7z90vxt         NDThGaMlJqyTUvMcTp//SGrg4hWqlbKXkt5MhQqLwzx2cSmnEBWwZz/nijWLGVYci8xU         L3+/Ise8BzhLcgLQ4N093TWdZ432UvENCIVtTyLO3uVTAfIA3E6tYDFcTCRUHA89xfgn         kiDinU4HCFFsOLyh4Ys0ibtkfiRVQ0fd7tMVP/884JTJJEtuhmC7M0YNV+ndoPvDN8TR         acgQ==</li>
<li>Arc-seal: i=1; a=rsa-sha256; t=1512524068; cv=none;        d=google.com; s=arc-20160816;        b=HLEfXTvr4+kO/ba5l81+RZ/hDrlOIAJCr7aHh8oCfBiNyDNb2+Z37hkv2TwB2g04k1         GtqtVfFX3/h9T8yjMsZ5wnATdliClf+FoqkVgf8hz8Myj5PrvN/GcT2in1z8mayBSiKv         47Ztc1yUOXq4rr/hfxZ2DOQPoftXvnx0Y5S8EB/PYpbJ83xt64mzp5YCl3aCPQ2halQp         CJvHgxaV3NEoLMpMaOVFMgKPxKtfZgSYRCSNjkPw96rbjSTmHfgK/JeKbKWM/XBnOB9Q         p3mU2UynwL8R8mD+lscGR2lAVf3nHrry/D+tVZ04ysJh4oqY5LOhg+VkGGoA46Hhe2up         Aqhg==</li>
<li>Dkim-signature: v=1; a=rsa-sha256; c=relaxed/relaxed;        d=noaa-gov.20150623.gappssmtp.com; s=20150623;        h=message-id:subject:to:references:from:date:user-agent:mime-version         :in-reply-to:content-language:x-original-sender         :x-original-authentication-results:precedence:mailing-list:list-id         :list-post:list-help:list-archive;        bh=Y5YWMmCXQrucOpHGbENnZkqJsmPBAIHvdFcBLQq3Tig=;        b=b/zlaJj+FxS4cU7IH0iiS6okOYCxzl59kTNoIDYYeNH4n9zE0SZ77Jg3RZ7igHYWNo         jR1B2maYwPVjncn51LhWOiCP3TNgpagLiy3UQ6u4+TH5I39KU5/B/vmZViSwf5aJHZOY         fRG2LPBcJpapMzMpTZXQSaW02ql0MZ01hLtXc2WEsEz4W3197HoyZarCmICAcRvIKzws         OES9gruOBAugbfLnBUTDk/m9eg47WeGcpqGn2tr6AZJ572dY2qq4Msu2v4OHLpgRxDIu         3Jb+T7Q7k9BIr9LLsKDpcWpPwtKue1/WLT6NX5spUFcXK0TUKJ69wfYvp50gaKfcpc74         7qJA==</li>
<li>In-reply-to: &lt;<a href="msg00697.html">208466aa-d3ad-53e3-6c8b-b37211629893@noaa.gov</a>&gt;</li>
<li>List-archive: &lt;<a href="https://groups.google.com/a/noaa.gov/group/ferret_users/">https://groups.google.com/a/noaa.gov/group/ferret_users/</a>&gt;</li>
<li>List-help: &lt;<a href="https://support.google.com/a/noaa.gov/bin/topic.py?topic=25838">https://support.google.com/a/noaa.gov/bin/topic.py?topic=25838</a>&gt;, &lt;<a href="mailto:ferret_users+help@noaa.gov">mailto:ferret_users+help@noaa.gov</a>&gt;</li>
<li>List-id: &lt;ferret_users.noaa.gov&gt;</li>
<li>List-post: &lt;<a href="https://groups.google.com/a/noaa.gov/group/ferret_users/post">https://groups.google.com/a/noaa.gov/group/ferret_users/post</a>&gt;, &lt;<a href="mailto:ferret_users@noaa.gov">mailto:ferret_users@noaa.gov</a>&gt;</li>
<li>Mailing-list: list <a href="mailto:ferret_users@DOMAIN.HIDDEN">ferret_users@xxxxxxxx</a>; contact <a href="mailto:ferret_users%2Bowners@DOMAIN.HIDDEN">ferret_users+owners@xxxxxxxx</a></li>
<li>References: &lt;<a href="msg00693.html">165079787-6c1452cac70bdc64cc7c4cdec0278637@pmq2v.m5r2.onet</a>&gt; &lt;<a href="msg00697.html">208466aa-d3ad-53e3-6c8b-b37211629893@noaa.gov</a>&gt;</li>
<li>Sender: <a href="mailto:owner-ferret_users@DOMAIN.HIDDEN">owner-ferret_users@xxxxxxxx</a></li>
<li>User-agent: Mozilla/5.0 (X11; Linux x86_64; rv:52.0) Gecko/20100101 Thunderbird/52.5.0</li>
</ul>
<!--X-Head-of-Message-End-->
<!--X-Head-Body-Sep-Begin-->
<hr>
<!--X-Head-Body-Sep-End-->
<!--X-Body-of-Message-->
<table width="100%"><tr><td bgcolor="#FFFFFF" style="background-color: #FFFFFF; color: #000000; "><font color="#000000">
  
  
    <div class="moz-cite-prefix">Ah, I think I misinterpreted the
      question and Ansley is on the right track. If you need to include
      the prime meridian then try the following<br>
      <br>
      let tlong1 = if tlong gt 25 then tlong<br>
      let tlong2 = if tlong lt 90 or tlong gt 270 then mod(
      tlong+180,360)-180&#xA0; ! Remaps to -90-&gt;90 smooth at 0. masks
      abs(lon)&gt;90<br>
      <br>
      contour tlat<br>
      contour/over/lev=(0,360,30) tlong1<br>
      contour/over/lev=(0,360,30) tlong2<br>
      <br>
      Russ<br>
      <br>
      On 06/12/17 11:07, Ansley C. Manke wrote:<br>
    </div>
    <blockquote type="cite"
      cite="">
      
      Hi,<br>
      <br>
      This is because of the discontinuity in the longitudes, where they
      change from 0 to 360.&#xA0; The thicker wiggling line you see is all of
      the contour lines being interpolated across that discontinuity.&#xA0;&#xA0;
      In a SHADE plot of "tlong" you can see the sharp break between 0
      and 360, right where that line is.<br>
      <br>
      Try just one contour level:<tt><br>
      </tt>
      <blockquote><tt> </tt><tt>set data File1.nc</tt><br>
        <tt> </tt><tt>contour tlat</tt><br>
        <tt> </tt><tt>contour/over/lev=(40) tlong</tt><br>
        <tt> </tt><br>
        <tt> (plot1.png)</tt><br>
      </blockquote>
      <tt> </tt> you can see that it has drawn the line that you want,
      along y=40, but then there is another where the contouring method
      is interpolating to find where there are values of 40 lying, for
      instance, between adjoining values of 0.2 and 359.75.&#xA0; There is no
      direct way to prevent this, but we can define new variables which
      avoid the issue.<br>
      <br>
      Define another variable that does not include the branch cut.&#xA0; My
      first try was to define a longitude variable with values only in 5
      to 355, and contour that.&#xA0; It's pretty good.&#xA0; (Do "SHADE tlong1"
      to see what's going on.)<tt><br>
      </tt>
      <blockquote><tt>use File1.nc</tt><br>
        <tt> contour tlat</tt><br>
        <br>
        <tt> let tlong1 = if tlong GE 5 and tlong LE 355 then tlong</tt><br>
        <tt> contour/over/lev=(10,350,20) tlong1</tt><br>
        <br>
        <tt> (plot2.png)</tt><br>
      </blockquote>
      <tt> </tt> There is still some extra contouring going on near the
      center.&#xA0; The data excluded isn't enough to prevent the same kind
      of interpolating where we don't want it.<br>
      <br>
      Another try, first contouring only a variable with values between
      0 and 180, then a second with values between 180 and 360.<tt><br>
      </tt>
      <blockquote><tt>contour tlat</tt><br>
        <br>
        <tt> let tlong1 = if tlong lt 180 then tlong</tt><br>
        <tt>let tlong2 = if tlong ge 180 then tlong</tt><br>
        <br>
        <tt> contour/over/lev=(10,350,20) tlong1</tt><br>
        <tt> contour/over/lev=(10,350,20) tlong2</tt><br>
        <br>
        <tt>(plot3.png)</tt><br>
      </blockquote>
      <br>
      I've allowed all of these to be drawn using the default colors for
      plot/overlay plots, just to make it easy to see, but of course you
      would use PLOT/OVER/NOLABEL/COLOR=black <br>
      <br>
      -Ansley<br>
      &#xA0;<br>
      <div class="moz-cite-prefix">On 12/3/2017 11:30 PM, niciej wrote:q<br>
      </div>
      <blockquote type="cite"
        cite="">
        <div><span style="color: #222222; font-family: arial,
            sans-serif; font-size: 12.8px;">Dear Ferreters,</span><span
            style="color: #313131; font-family: Verdana, Tahoma, Arial,
            Sans;">&#xA0;</span>
          <div style="font-family: arial, sans-serif; font-size: 12.8px;
            color: #222222;">I'm trying to draw longitude/latitude from
            data set (tlat, tlong):</div>
          <div style="font-family: arial, sans-serif; font-size: 12.8px;
            color: #222222;">set data File1.nc</div>
          <div style="font-family: arial, sans-serif; font-size: 12.8px;
            color: #222222;">contour tlat</div>
          <div style="font-family: arial, sans-serif; font-size: 12.8px;
            color: #222222;">contour/ov tlong</div>
          <div style="font-family: arial, sans-serif; font-size: 12.8px;
            color: #222222;">&#xA0;</div>
          <div style="font-family: arial, sans-serif; font-size: 12.8px;
            color: #222222;">&#xA0;</div>
          <div style="font-family: arial, sans-serif; font-size: 12.8px;
            color: #222222;">The problem is that longitude lines don't
            finish in the middle - on the pole - but they are
            multiplicated in one direction - as in attached picture. How
            can I fix it?&#xA0;</div>
          <div style="font-family: arial, sans-serif; font-size: 12.8px;
            color: #222222;">I'm absolutely new to Ferret (I'm using&#xA0;<span
              style="font-size: 12.8px;">v6.93) Thanks in advance for
              your tips!</span></div>
        </div>
      </blockquote>
      <br>
    </blockquote>
    <p><br>
    </p>
  

</font></td></tr></table>
<!--X-Body-of-Message-End-->
<!--X-MsgBody-End-->
<!--X-Follow-Ups-->
<hr>
<!--X-Follow-Ups-End-->
<!--X-References-->
<ul><li><strong>References</strong>:
<ul>
<li><strong><a name="00693" href="msg00693.html">[ferret_users] problem with longitude lines drawing</a></strong>
<ul><li><em>From:</em> niciej</li></ul></li>
<li><strong><a name="00697" href="msg00697.html">Re: [ferret_users] problem with longitude lines drawing</a></strong>
<ul><li><em>From:</em> Ansley C. Manke</li></ul></li>
</ul></li></ul>
<!--X-References-End-->
<!--X-BotPNI-->
<UL>
<li>Previous by thread:
<strong><a href="msg00697.html">Re: [ferret_users] problem with longitude lines drawing</a></strong>
</li>
<li>Next by thread:
<strong><a href="msg00694.html">Re: [ferret_users] problem with longitude lines drawing</a></strong>
</li>

</UL>
<center>[<a href="msg00697.html">Thread Prev</a>][<a href="msg00694.html">Thread Next</a>][<A HREF="threads.html#00698">Index</A>]</center>

<!--X-BotPNI-End-->
<!--X-User-Footer-->
<A HREF="http://ferret.pmel.noaa.gov/Ferret/contact-us">Contact Us</A>
<br>
<font size=-1>
<address>
<a href="http://www.doc.gov">Dept of Commerce</a> /
<a href="http://www.noaa.gov">NOAA</a> /
<a href="http://www.oar.noaa.gov">OAR</a> /
<a href="http://www.pmel.noaa.gov">PMEL</a> /
<a href="http://ferret.pmel.noaa.gov">Ferret</a>
</address>

<br>
 <a href="http://www.noaa.gov/privacy.html">Privacy Policy</a> | <a href="http://www.noaa.gov/disclaimer.html">Disclaimer</a> | <a href="accessibility.html">Accessibility Statement</a> 

</font>
<!--X-User-Footer-End-->
</body>
</html>
