<!-- MHonArc v2.6.18 -->
<!--X-Subject: Re: [ferret_users] SAVE precision of var from binary data? -->
<!--X-From-R13: Dlb Thehr <shehrNunjnvv.rqh> -->
<!--X-Date: Wed, 5 Jul 2017 21:59:53 &#45;0700 -->
<!--X-Message-Id: CAEwQpaJirAVqLJULkSoEDESXhGHyqpsU3RJ56vX6j5ipudmmGQ@mail.gmail.com -->
<!--X-Content-Type: multipart/alternative -->
<!--X-Reference: CAEwQpaJVbAeDozChhF_poCvDrXt3kLvGfedVBDr8N7Psh_jv&#45;g@mail.gmail.com -->
<!--X-Reference: 0887a488&#45;8c20&#45;3bc9&#45;a194&#45;5258fcdb15bb@noaa.gov -->
<!--X-Head-End-->
<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN"
        "http://www.w3.org/TR/html4/loose.dtd">
<html>
<head>
<title>Re: [ferret_users] SAVE precision of var from binary data?</title>
</head>
<body>
<!--X-Body-Begin-->
<!--X-User-Header-->
<!--X-User-Header-End-->
<!--X-TopPNI-->
<HR>
<center>[<a href="msg00473.html">Thread Prev</a>][<a href="msg00481.html">Thread Next</a>][<A HREF="threads.html#00479">Index</A>]</center>

<!--X-TopPNI-End-->
<!--X-MsgBody-->
<!--X-Subject-Header-Begin-->
<h1>Re: [ferret_users] SAVE precision of var from binary data?</h1>
<hr>
<!--X-Subject-Header-End-->
<!--X-Head-of-Message-->
<ul>
<li><strong>To</strong>: <strong>&quot;Ansley C. Manke&quot; &lt;<a href="mailto:ansley.b.manke@DOMAIN.HIDDEN">ansley.b.manke@xxxxxxxx</a>&gt;</strong></li>
<li><strong>Subject</strong>: <strong>Re: [ferret_users] SAVE precision of var from binary data?</strong></li>
<li><strong>From</strong>: <strong>Ryo Furue &lt;<a href="mailto:furue@DOMAIN.HIDDEN">furue@xxxxxxxxxx</a>&gt;</strong></li>
<li>Date: Thu, 6 Jul 2017 13:59:51 +0900</li>
<li>Arc-authentication-results: i=2; mx.google.com;       dkim=pass header.i=@hawaii-edu.20150623.gappssmtp.com header.b=tq3Hhhjs;       spf=pass (google.com: domain of <a href="mailto:furue@DOMAIN.HIDDEN">furue@xxxxxxxxxx</a> designates 2607:f8b0:400c:c08::22e as permitted sender) smtp.mailfrom=<a href="mailto:furue@DOMAIN.HIDDEN">furue@xxxxxxxxxx</a></li>
<li>Arc-authentication-results: i=1; mx.google.com;       dkim=pass header.i=@hawaii-edu.20150623.gappssmtp.com header.b=tq3Hhhjs;       spf=pass (google.com: domain of <a href="mailto:furue@DOMAIN.HIDDEN">furue@xxxxxxxxxx</a> designates 2607:f8b0:400c:c08::22e as permitted sender) smtp.mailfrom=<a href="mailto:furue@DOMAIN.HIDDEN">furue@xxxxxxxxxx</a></li>
<li>Arc-message-signature: i=2; a=rsa-sha256; c=relaxed/relaxed; d=google.com; s=arc-20160816;        h=list-archive:list-help:list-post:list-id:mailing-list:precedence:cc         :to:subject:message-id:date:from:references:in-reply-to:mime-version         :arc-authentication-results:arc-message-signature:dkim-signature         :arc-authentication-results;        bh=W2fKAU3UAEbNMI/QTol4idS8sZOKzo9Eq+E0rbNRyu8=;        b=nE5KxtbJ1DzPiEHjHf6ip+9MzW4HHg0xX9bfdjjZbCrh4SVrTwdpV3jzKqt4xTs4fp         3eJkFDF9whX9q3GJOBwv4XoMBrU1V2O0Tp6pMGx/NvOZ0FxuTD3h9bIJdGNtPm0gFHEz         W0WkWjm04vNZfHxyn8Ery/WviRfRoz6Y1DTEEmhb3usqc2GeUWlOWOiNGBA0WfOV0ONe         QhiFGIjlMEnr4jaAgAkthuRVcB5MJHa3tWfKCpSL0Zzl3jA7N15Fzz63VEE06Zmg414t         weLeCfUrQySPIB+oTgIcTP1xGOnVGa6mLYSWywks+UnTRvF/wWxB/nSvgP4uUMASFhQC         Gc9g==</li>
<li>Arc-message-signature: i=1; a=rsa-sha256; c=relaxed/relaxed; d=google.com; s=arc-20160816;        h=cc:to:subject:message-id:date:from:references:in-reply-to         :mime-version:dkim-signature:arc-authentication-results;        bh=W2fKAU3UAEbNMI/QTol4idS8sZOKzo9Eq+E0rbNRyu8=;        b=Wav6N/pS8wD+OlGB5jQoi3RpN/CwfLC3GKen2NsIngJywyU1COP32+c9M08ehmExk7         Bp5w5wshrNTf6Xo5RigM9634xZYiFYPi6LG0U99oR06lTtytC3mSTomCDvqRgOqlhcuD         l9HSlh/JqOduka/Q4ThCGsqC9bnMLzKPT3aFglVQ6iu4xHWTVrCiqJLzvMoSKzAgyCks         +O8KusBtIOXsiN4Pmd8CEq+87uNRPiPft4E88r1ouN7/WORCdghaQqDfvLGeH+gfm7dm         OlkS75cIOL2B7e7gh8P75N6S9QCVpmgX5RcwedAC50Y8l9Fz1YHHW2ed+Kksr6439iQ3         TVaQ==</li>
<li>Arc-seal: i=2; a=rsa-sha256; t=1499317192; cv=pass;        d=google.com; s=arc-20160816;        b=GnNt2Za8YePu+cdFrBWR1YfsE/eciJmDh0CdVD0xy04JIx4yGB4SIYgDePht/rG3a4         RnhA8BztZnvz8zWAcsjGFLCtopdiBXLtXAh+4M1EmlIv4JWpFUO2Hsr4CfNteMd82DgS         reiIrMvvBUfTbUT/ZZSWGsVC9DgETucEHvEkf9EeUVh8yRfp8fpgBQi302AWVBGbCKYO         nEQjEPDv1sWqbJb5s6ne8+0pH6lmnYPvJBtbU7oFygjxexMhVA4c1Spusrwri/8iRfsB         Imb2YunnK3iMaCBUhs0mmSRsx0sQnr027O/7XMhuLwORbQO7FZdwpnEm0NBFVUqXcEpE         xURw==</li>
<li>Arc-seal: i=1; a=rsa-sha256; t=1499317192; cv=none;        d=google.com; s=arc-20160816;        b=Qkk7TwOS8akO1L5BKVJHtgFLKEMHIgUXEwPkFI7phz21D10GiSLUECK2+rLiMhH1NE         /+Y9rLiAydwjzwQ5VM2emuKpMsqiop4hcAoosABn1mLFZtZhwT5Wa+DoOgZyF5avQx/+         KS6E0VUJ4TLIPvYVOMLdN2+gvyb6VVupgrcg1D7r3xIrmLMw9MWgwU6omWo0AU+qHnY0         fK034dt1e5SWAIxcXQkYFsIWt7pOYODoczbH5wX8KVVEdeFhX3MLtpvY3ZDXOSIzsRoD         YwhYANrS9ikifJAerShRjJ5/R7YfYuL5uKmhI/Jq2kmkkedML/VsTMigg5CkthDBCQVb         b/wQ==</li>
<li>Cc: ferret users &lt;<a href="mailto:ferret_users@DOMAIN.HIDDEN">ferret_users@xxxxxxxx</a>&gt;</li>
<li>Dkim-signature: v=1; a=rsa-sha256; c=relaxed/relaxed;        d=noaa-gov.20150623.gappssmtp.com; s=20150623;        h=mime-version:in-reply-to:references:from:date:message-id:subject:to         :cc:x-original-sender:x-original-authentication-results:precedence         :mailing-list:list-id:list-post:list-help:list-archive;        bh=W2fKAU3UAEbNMI/QTol4idS8sZOKzo9Eq+E0rbNRyu8=;        b=n5EkGB1h/kuUv6DqkImvc9kTojbbEgJYNUbiTZKxCNtU2J/WAOVvoVA8ewiIOpG/uz         19YiJM5rMA1EZDPfL2eAHZRmHP6iO18EF3o6I5sNT12tONT3ZpgsVjEuLljAMumnKnI4         xEy4tNwfQORPt2yl/6S9Gk1GRu+nnZaIjM/qf6l9SzHycdwpgNxyHNArOwGg0qVktheF         oFvB/NyUss9HjC/srPny0NtfS4kTxCPAV2ulwKixru8KYYrjugdXarUgFuzjnZPwuS7k         8yz9Gv+p2kLbeTv+f+pqzS4LJRsLExXgd9O/qB0LTUVwSOI1PFgoGA/4mjm0H4ifILrh         RaQQ==</li>
<li>In-reply-to: &lt;<a href="msg00473.html">0887a488-8c20-3bc9-a194-5258fcdb15bb@noaa.gov</a>&gt;</li>
<li>List-archive: &lt;<a href="https://groups.google.com/a/noaa.gov/group/ferret_users/">https://groups.google.com/a/noaa.gov/group/ferret_users/</a>&gt;</li>
<li>List-help: &lt;<a href="https://support.google.com/a/noaa.gov/bin/topic.py?topic=25838">https://support.google.com/a/noaa.gov/bin/topic.py?topic=25838</a>&gt;, &lt;<a href="mailto:ferret_users+help@noaa.gov">mailto:ferret_users+help@noaa.gov</a>&gt;</li>
<li>List-id: &lt;ferret_users.noaa.gov&gt;</li>
<li>List-post: &lt;<a href="https://groups.google.com/a/noaa.gov/group/ferret_users/post">https://groups.google.com/a/noaa.gov/group/ferret_users/post</a>&gt;, &lt;<a href="mailto:ferret_users@noaa.gov">mailto:ferret_users@noaa.gov</a>&gt;</li>
<li>Mailing-list: list <a href="mailto:ferret_users@DOMAIN.HIDDEN">ferret_users@xxxxxxxx</a>; contact <a href="mailto:ferret_users%2Bowners@DOMAIN.HIDDEN">ferret_users+owners@xxxxxxxx</a></li>
<li>References: &lt;<a href="msg00472.html">CAEwQpaJVbAeDozChhF_poCvDrXt3kLvGfedVBDr8N7Psh_jv-g@mail.gmail.com</a>&gt; &lt;<a href="msg00473.html">0887a488-8c20-3bc9-a194-5258fcdb15bb@noaa.gov</a>&gt;</li>
<li>Sender: <a href="mailto:owner-ferret_users@DOMAIN.HIDDEN">owner-ferret_users@xxxxxxxx</a></li>
</ul>
<!--X-Head-of-Message-End-->
<!--X-Head-Body-Sep-Begin-->
<hr>
<!--X-Head-Body-Sep-End-->
<!--X-Body-of-Message-->
<div dir="ltr">Hi Ansley,<br><div class="gmail_extra"><br><div class="gmail_quote"><blockquote class="gmail_quote" style="margin:0px 0px 0px 0.8ex;border-left:1px solid rgb(204,204,204);padding-left:1ex"><div bgcolor="#FFFFFF"><p>The /OUTTYPE option is available for any netCDF write, regardless
      of the source of the data.</p></div></blockquote><div>Yes!&#xA0; But, what I was talking about is what happens when OUTTYPE is not specified.</div><div><br></div><div>If it&#39;s not specified, &quot;SAVE/file=<a rel="nofollow" href="http://data.nc">data.nc</a> var&quot; will write the variable in SINGLE precision, even though it&#39;s from a double-precision binary file --- which is inconsistent, because everywhere else precision defaults to double.</div><div><br></div><div>So, my guess is that there is somewhere in the Ferret code that defaults to single precision for netCDF write.</div><div><br></div><blockquote class="gmail_quote" style="margin:0px 0px 0px 0.8ex;border-left:1px solid rgb(204,204,204);padding-left:1ex"><div bgcolor="#FFFFFF"><p>To apply that setting to all files written in the session.&#xA0; (Often
    people use SET LIST/OUTTYPE=float or even /OUTTYPE=int, to save disk
    space when their data does not need double precision output.)&#xA0; The
    default type for writing netCDF files is the input data type; does
    your data have more than 6-7 digits?&#xA0; Are the data correct within
    Ferret when it reads from your binary file?<br></p></div></blockquote><div>The original binary data is in double precision and when imported into Ferret, they have correct values.&#xA0; You can actually run the sample script I attached at the end of my last message, which</div><div><br></div><div>1) saves Levitus temperature in a double-precision netCDF,</div><div>2) extracts the binary data from the netCDF file,</div><div>3) reads the binary data using the file/format=STREAM/type=r8 command, and</div><div>4) writes the variable in a new netCDF file, without specifying any OUTTYPE.</div><div><br></div><div>You can verify the variable from step (3) is correct in Ferret (except the bad value is not specified) and you can verify the netCDF file created at step (4) includes the variable in single precision, using ncdump -h .</div><div><br></div><div>Okay, I&#39;ve improved my sample script so that it specifies the correct BAD value.&#xA0; You can now easily see that the variable is correctly imported at step (3).</div><div><br></div><div><tt>&gt; set list/outtype=double&#xA0;</tt><br style="font-size:12.8px"></div><div><tt><br></tt></div><div><tt><font face="arial, helvetica, sans-serif">That is a good idea, but I trust you can override it at each SAVE/OUTTYPE command or SET VAR/OUTTYPE= command, right?</font></tt></div><div><tt><font face="arial, helvetica, sans-serif"><br></font></tt></div><div><tt><font face="arial, helvetica, sans-serif">Yes, I suppose that &#39;set list/outtype=double&#39; should be the default initial state of Ferret until the user overrides it with her/his own set list/outtype command.</font></tt></div><div><br></div><div>Cheers,</div><div><br></div><div>Ryo</div><div>---------------------------------------</div><div><div style="font-size:12.8px">set data levitus_climatology</div><div style="font-size:12.8px">save/clobber/file=<a rel="nofollow" href="http://tmp.nc/outtype=double" target="_blank">tmp.nc/outtype=<wbr>double</a>&#xA0;temp[k=1,l=1]</div><div style="font-size:12.8px">cancel data/all</div><div style="font-size:12.8px">SPAWN ncks -O -C -b tmp.bin -v TEMP&#xA0;<a rel="nofollow" href="http://tmp.nc/" target="_blank">tmp.nc</a>&#xA0;-o&#xA0;<a rel="nofollow" href="http://tmp2.nc/" target="_blank">tmp2.nc</a></div><div><div style="font-size:12.8px">define axis/x=0:359:1 xax</div><div style="font-size:12.8px">define axis/y=-89.5:89.5:1 yax</div><div style="font-size:12.8px">define grid/x=xax/y=yax mygrid</div><div style="font-size:12.8px">file/form=STREAM/var=temp/<wbr>type=r8/grid=mygrid tmp.bin</div><div><span style="font-size:12.8px">set var/bad=-10000000000 temp</span></div><div><span style="font-size:12.8px">save/clobber/file=</span><a rel="nofollow" href="http://tmp-new.nc/" target="_blank" style="font-size:12.8px">tmp-new.nc</a><span style="font-size:12.8px">&#xA0;temp</span></div></div></div><div><span style="font-size:12.8px"><br></span></div></div></div></div>

<!--X-Body-of-Message-End-->
<!--X-MsgBody-End-->
<!--X-Follow-Ups-->
<hr>
<ul><li><strong>Follow-Ups</strong>:
<ul>
<li><strong><a name="00481" href="msg00481.html">Re: [ferret_users] SAVE precision of var from binary data?</a></strong>
<ul><li><em>From:</em> Ansley C. Manke</li></ul></li>
</ul></li></ul>
<!--X-Follow-Ups-End-->
<!--X-References-->
<ul><li><strong>References</strong>:
<ul>
<li><strong><a name="00472" href="msg00472.html">[ferret_users] SAVE precision of var from binary data?</a></strong>
<ul><li><em>From:</em> Ryo Furue</li></ul></li>
<li><strong><a name="00473" href="msg00473.html">Re: [ferret_users] SAVE precision of var from binary data?</a></strong>
<ul><li><em>From:</em> Ansley C. Manke</li></ul></li>
</ul></li></ul>
<!--X-References-End-->
<!--X-BotPNI-->
<UL>
<li>Previous by thread:
<strong><a href="msg00473.html">Re: [ferret_users] SAVE precision of var from binary data?</a></strong>
</li>
<li>Next by thread:
<strong><a href="msg00481.html">Re: [ferret_users] SAVE precision of var from binary data?</a></strong>
</li>

</UL>
<center>[<a href="msg00473.html">Thread Prev</a>][<a href="msg00481.html">Thread Next</a>][<A HREF="threads.html#00479">Index</A>]</center>

<!--X-BotPNI-End-->
<!--X-User-Footer-->
<A HREF="http://ferret.pmel.noaa.gov/Ferret/contact-us">Contact Us</A>
<br>
<font size=-1>
<address>
<a href="http://www.doc.gov">Dept of Commerce</a> /
<a href="http://www.noaa.gov">NOAA</a> /
<a href="http://www.oar.noaa.gov">OAR</a> /
<a href="http://www.pmel.noaa.gov">PMEL</a> /
<a href="http://ferret.pmel.noaa.gov">Ferret</a>
</address>

<br>
 <a href="http://www.noaa.gov/privacy.html">Privacy Policy</a> | <a href="http://www.noaa.gov/disclaimer.html">Disclaimer</a> | <a href="accessibility.html">Accessibility Statement</a> 

</font>
<!--X-User-Footer-End-->
</body>
</html>
