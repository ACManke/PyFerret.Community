<!-- MHonArc v2.6.18 -->
<!--X-Subject: Re: [ferret_users] SAVE precision of var from binary data? -->
<!--X-From-R13: "Oafyrl Q. [naxr" <nafyrl.o.znaxrNabnn.tbi> -->
<!--X-Date: Thu, 6 Jul 2017 11:11:40 &#45;0700 -->
<!--X-Message-Id: 0ee7ab13&#45;60bd&#45;547a&#45;ed44&#45;025cca26bd5a@noaa.gov -->
<!--X-Content-Type: multipart/alternative -->
<!--X-Reference: CAEwQpaJVbAeDozChhF_poCvDrXt3kLvGfedVBDr8N7Psh_jv&#45;g@mail.gmail.com -->
<!--X-Reference: 0887a488&#45;8c20&#45;3bc9&#45;a194&#45;5258fcdb15bb@noaa.gov -->
<!--X-Reference: CAEwQpaJirAVqLJULkSoEDESXhGHyqpsU3RJ56vX6j5ipudmmGQ@mail.gmail.com -->
<!--X-Head-End-->
<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN"
        "http://www.w3.org/TR/html4/loose.dtd">
<html>
<head>
<title>Re: [ferret_users] SAVE precision of var from binary data?</title>
</head>
<body>
<!--X-Body-Begin-->
<!--X-User-Header-->
<!--X-User-Header-End-->
<!--X-TopPNI-->
<HR>
<center>[<a href="msg00479.html">Thread Prev</a>][<a href="msg00478.html">Thread Next</a>][<A HREF="threads.html#00481">Index</A>]</center>

<!--X-TopPNI-End-->
<!--X-MsgBody-->
<!--X-Subject-Header-Begin-->
<h1>Re: [ferret_users] SAVE precision of var from binary data?</h1>
<hr>
<!--X-Subject-Header-End-->
<!--X-Head-of-Message-->
<ul>
<li><strong>To</strong>: <strong>Ryo Furue &lt;<a href="mailto:furue@DOMAIN.HIDDEN">furue@xxxxxxxxxx</a>&gt;</strong></li>
<li><strong>Subject</strong>: <strong>Re: [ferret_users] SAVE precision of var from binary data?</strong></li>
<li><strong>From</strong>: <strong>&quot;Ansley C. Manke&quot; &lt;<a href="mailto:ansley.b.manke@DOMAIN.HIDDEN">ansley.b.manke@xxxxxxxx</a>&gt;</strong></li>
<li>Date: Thu, 6 Jul 2017 11:11:36 -0700</li>
<li>Arc-authentication-results: i=2; mx.google.com;       dkim=pass header.i=@noaa-gov.20150623.gappssmtp.com header.b=Cv0mm4D1;       spf=pass (google.com: domain of <a href="mailto:ansley.b.manke@DOMAIN.HIDDEN">ansley.b.manke@xxxxxxxx</a> designates 2607:f8b0:400d:c0d::230 as permitted sender) smtp.mailfrom=<a href="mailto:ansley.b.manke@DOMAIN.HIDDEN">ansley.b.manke@xxxxxxxx</a></li>
<li>Arc-authentication-results: i=1; mx.google.com;       dkim=pass header.i=@noaa-gov.20150623.gappssmtp.com header.b=Cv0mm4D1;       spf=pass (google.com: domain of <a href="mailto:ansley.b.manke@DOMAIN.HIDDEN">ansley.b.manke@xxxxxxxx</a> designates 2607:f8b0:400d:c0d::230 as permitted sender) smtp.mailfrom=<a href="mailto:ansley.b.manke@DOMAIN.HIDDEN">ansley.b.manke@xxxxxxxx</a></li>
<li>Arc-message-signature: i=2; a=rsa-sha256; c=relaxed/relaxed; d=google.com; s=arc-20160816;        h=list-archive:list-help:list-post:list-id:mailing-list:precedence         :content-language:in-reply-to:mime-version:user-agent:date         :message-id:from:references:cc:to:subject:arc-authentication-results         :arc-message-signature:dkim-signature:arc-authentication-results;        bh=7Ibm5Tbn3YJQlHlDXTEaR/tF8ectvo8MmAQ/UfPkO3I=;        b=T0qds3ku3VL9Z/1RB9IGAk0P0JsZ3IH3Pz9jcycvsDRZ9MLwMmMRxhoPUlePKspI0d         8K3ngPZ18R1/ytu/ENgG3CdT64GNIwzVgq0s0lHAQwfJSvz78QKefcx9AybF8GraBg53         1T7McsoC6tS15sUwGZSx46BPET6S1R0tGo1IJq+kbV9ydZ+1hfjZdMW/XmnrsmbGtrGK         PFFYqKu6dFLGovqQsDbGRF3NYqjDY+mFazHR2+8Ttn3hvS2z08VRq2oH1Da176/t8uX0         dm35wx35UaxfJMbRRYeGjUPS7c2jGvr2+4nCKmyB/1n8+mPHY114HYJ2rrLhFFDk+IN8         Ps+g==</li>
<li>Arc-message-signature: i=1; a=rsa-sha256; c=relaxed/relaxed; d=google.com; s=arc-20160816;        h=content-language:in-reply-to:mime-version:user-agent:date         :message-id:from:references:cc:to:subject:dkim-signature         :arc-authentication-results;        bh=7Ibm5Tbn3YJQlHlDXTEaR/tF8ectvo8MmAQ/UfPkO3I=;        b=PqMksoj7aa+ZYbahODE7sHlxEBY5tmnfAZ8yZvW4LW4Eqe8nGbSpvM0xMko8FA1dDJ         VEBvy5Ap2FM/BA6T3C0aKJSpt8OpANKOBj32CgWTX7A1Ks/iApJWBoznaYIFGOZNBi5Y         oU0DVk1sLfARDUYt8sDrTpO0xwmduBsvmVrGxEw0pCsBXuOrx9jYLVC5OEFdw3dB1i/8         Rw4VjdyCu4eqXflgB7kwLUkHBT0GHDDTB8N7JmZc1Ly6N+Fl/hlccpf7v4sq1pEOWJwC         Q9D7mwwFNzFmk6gkrsaQOZhkjSP4Z2NkxHlnFh7UBoL4wX2HvjWLqUdJ080E9FByBRk0         RjQw==</li>
<li>Arc-seal: i=2; a=rsa-sha256; t=1499364699; cv=pass;        d=google.com; s=arc-20160816;        b=hgQTBCb9/phCvieL4Nqiecd1M4oVDr7/mRy2ijffXAd/PMtjsnZqIQcKKWXPrqIeNl         EP+LgfR4hJb9+FypNLPsIf205+R25UbxHx+QolUP+4Ejz92PuhYA+OKBR2Og+5KG2Wn2         KRX6+N2HIYN900k81pHPUPqTLOOQYAddU4/NSY2evYpIQOMrxWsZCBH9GxWP2mJm+9b5         K17ggHdxcH4+ksZGQeGXR42xGAH0fWQLGQxPgJturcA1ggPSP21aE6IIlmd0EReCgXUu         1r/8+nNly0tWEdnGKp4S9sDtMKnQ1hcwUrnmlkOzcEak2fEyWDBHvEYuxAomFkfdoRHg         BnjQ==</li>
<li>Arc-seal: i=1; a=rsa-sha256; t=1499364699; cv=none;        d=google.com; s=arc-20160816;        b=DMFGCvJ937+4KNHdgL4eRGCNBorOSuTT/2pboidoXPpuvwlYgtc22RAo5AhktDqB3r         MP2eStlONlT6BA7jKn55pvWoi1f79frq///YHuZaHC2bTVC9RwH/CD6RXdJRIxH/yvC/         U17FKBH3MiZzC0TirCOaRC5vvDtdx/Z0B5nrTRtAgdB8+8dqzzFNPa5sOAxRrMRbzs3X         E2dvfTwGIF36w7k1UIBCfbmtofOZXifZH1lF/QoEqkIMQ5hWitK6aXyOujxev4fX0YQX         zddknTWeBohpMbWVl7IHyansodDcPcA9P/qPWe3BuqkR5Vr6PE5MEa+vY050BG/Fi3QH         VITQ==</li>
<li>Cc: ferret users &lt;<a href="mailto:ferret_users@DOMAIN.HIDDEN">ferret_users@xxxxxxxx</a>&gt;</li>
<li>Dkim-signature: v=1; a=rsa-sha256; c=relaxed/relaxed;        d=noaa-gov.20150623.gappssmtp.com; s=20150623;        h=subject:to:cc:references:from:message-id:date:user-agent         :mime-version:in-reply-to:content-language:x-original-sender         :x-original-authentication-results:precedence:mailing-list:list-id         :list-post:list-help:list-archive;        bh=7Ibm5Tbn3YJQlHlDXTEaR/tF8ectvo8MmAQ/UfPkO3I=;        b=ZeYKtM1jzzKxUUtHYL3S7jfeRUCtQm+ZK4M6POXCSTLxGgLMWS7B9LMa8MepiMaq8x         oCJX2hma/rSB6lcYCrfICvLcK8A9+ZDdgXIMjS7ovzjJTGhWUmet+aMXE4SIuu2UZ6Yy         MrFWIyR+wPEt57lOdvuzDE8+YM7cjhXV2KPksLpaiDRnMWF2YP6jxIJKEqzU7IZIFwIg         LQv6mfoZkhKKY0PBcDkLvkHOW4Ff8S2a2sLeCytrImcU+L1VCz+OwcBSu0rUdwyqo92Z         TYWvH6WvvjVY/jWSN5TBc7Z02j1pZfzhSLkjiRI4VLb25HpBvG0MryFvCrUuE2mBV5/x         1AKA==</li>
<li>In-reply-to: &lt;<a href="msg00479.html">CAEwQpaJirAVqLJULkSoEDESXhGHyqpsU3RJ56vX6j5ipudmmGQ@mail.gmail.com</a>&gt;</li>
<li>List-archive: &lt;<a href="https://groups.google.com/a/noaa.gov/group/ferret_users/">https://groups.google.com/a/noaa.gov/group/ferret_users/</a>&gt;</li>
<li>List-help: &lt;<a href="https://support.google.com/a/noaa.gov/bin/topic.py?topic=25838">https://support.google.com/a/noaa.gov/bin/topic.py?topic=25838</a>&gt;, &lt;<a href="mailto:ferret_users+help@noaa.gov">mailto:ferret_users+help@noaa.gov</a>&gt;</li>
<li>List-id: &lt;ferret_users.noaa.gov&gt;</li>
<li>List-post: &lt;<a href="https://groups.google.com/a/noaa.gov/group/ferret_users/post">https://groups.google.com/a/noaa.gov/group/ferret_users/post</a>&gt;, &lt;<a href="mailto:ferret_users@noaa.gov">mailto:ferret_users@noaa.gov</a>&gt;</li>
<li>Mailing-list: list <a href="mailto:ferret_users@DOMAIN.HIDDEN">ferret_users@xxxxxxxx</a>; contact <a href="mailto:ferret_users%2Bowners@DOMAIN.HIDDEN">ferret_users+owners@xxxxxxxx</a></li>
<li>References: &lt;<a href="msg00472.html">CAEwQpaJVbAeDozChhF_poCvDrXt3kLvGfedVBDr8N7Psh_jv-g@mail.gmail.com</a>&gt; &lt;<a href="msg00473.html">0887a488-8c20-3bc9-a194-5258fcdb15bb@noaa.gov</a>&gt; &lt;<a href="msg00479.html">CAEwQpaJirAVqLJULkSoEDESXhGHyqpsU3RJ56vX6j5ipudmmGQ@mail.gmail.com</a>&gt;</li>
<li>Sender: <a href="mailto:owner-ferret_users@DOMAIN.HIDDEN">owner-ferret_users@xxxxxxxx</a></li>
<li>User-agent: Mozilla/5.0 (Windows NT 6.1; WOW64; rv:52.0) Gecko/20100101 Thunderbird/52.2.1</li>
</ul>
<!--X-Head-of-Message-End-->
<!--X-Head-Body-Sep-Begin-->
<hr>
<!--X-Head-Body-Sep-End-->
<!--X-Body-of-Message-->
<table width="100%"><tr><td bgcolor="#FFFFFF" style="background-color: #FFFFFF; color: #000000; "><font color="#000000">
  
  
    <p>Hi,</p>
    <p>Ok, yes. You're right.&#xA0; When writing netCDF files, Ferret
      defaults to whatever is the input-type when writing data read from
      NetCDF files. For stream data and data from ascii files, the
      default type for netCDF writes has been set to single-precision
      float.&#xA0; For user-defined variables, the default is double
      precision.<br>
    </p>
    <p>In the next release the default for binary and ascii data will
      also be double-precision.</p>
    <p>-Ansley<br>
    </p>
    <br>
    <div class="moz-cite-prefix">On 7/5/2017 9:59 PM, Ryo Furue wrote:<br>
    </div>
    <blockquote type="cite"
cite="">
      <div dir="ltr">Hi Ansley,<br>
        <div class="gmail_extra"><br>
          <div class="gmail_quote">
            <blockquote class="gmail_quote" style="margin:0px 0px 0px
              0.8ex;border-left:1px solid
              rgb(204,204,204);padding-left:1ex">
              <div bgcolor="#FFFFFF">
                <p>The /OUTTYPE option is available for any netCDF
                  write, regardless of the source of the data.</p>
              </div>
            </blockquote>
            <div>Yes!&#xA0; But, what I was talking about is what happens
              when OUTTYPE is not specified.</div>
            <div><br>
            </div>
            <div>If it's not specified, "SAVE/file=<a rel="nofollow"
                href="http://data.nc" moz-do-not-send="true">data.nc</a>
              var" will write the variable in SINGLE precision, even
              though it's from a double-precision binary file --- which
              is inconsistent, because everywhere else precision
              defaults to double.</div>
            <div><br>
            </div>
            <div>So, my guess is that there is somewhere in the Ferret
              code that defaults to single precision for netCDF write.</div>
            <div><br>
            </div>
            <blockquote class="gmail_quote" style="margin:0px 0px 0px
              0.8ex;border-left:1px solid
              rgb(204,204,204);padding-left:1ex">
              <div bgcolor="#FFFFFF">
                <p>To apply that setting to all files written in the
                  session.&#xA0; (Often people use SET LIST/OUTTYPE=float or
                  even /OUTTYPE=int, to save disk space when their data
                  does not need double precision output.)&#xA0; The default
                  type for writing netCDF files is the input data type;
                  does your data have more than 6-7 digits?&#xA0; Are the
                  data correct within Ferret when it reads from your
                  binary file?<br>
                </p>
              </div>
            </blockquote>
            <div>The original binary data is in double precision and
              when imported into Ferret, they have correct values.&#xA0; You
              can actually run the sample script I attached at the end
              of my last message, which</div>
            <div><br>
            </div>
            <div>1) saves Levitus temperature in a double-precision
              netCDF,</div>
            <div>2) extracts the binary data from the netCDF file,</div>
            <div>3) reads the binary data using the
              file/format=STREAM/type=r8 command, and</div>
            <div>4) writes the variable in a new netCDF file, without
              specifying any OUTTYPE.</div>
            <div><br>
            </div>
            <div>You can verify the variable from step (3) is correct in
              Ferret (except the bad value is not specified) and you can
              verify the netCDF file created at step (4) includes the
              variable in single precision, using ncdump -h .</div>
            <div><br>
            </div>
            <div>Okay, I've improved my sample script so that it
              specifies the correct BAD value.&#xA0; You can now easily see
              that the variable is correctly imported at step (3).</div>
            <div><br>
            </div>
            <div><tt>&gt; set list/outtype=double&#xA0;</tt><br
                style="font-size:12.8px">
            </div>
            <div><tt><br>
              </tt></div>
            <div><tt><font face="arial, helvetica, sans-serif">That is a
                  good idea, but I trust you can override it at each
                  SAVE/OUTTYPE command or SET VAR/OUTTYPE= command,
                  right?</font></tt></div>
            <div><tt><font face="arial, helvetica, sans-serif"><br>
                </font></tt></div>
            <div><tt><font face="arial, helvetica, sans-serif">Yes, I
                  suppose that 'set list/outtype=double' should be the
                  default initial state of Ferret until the user
                  overrides it with her/his own set list/outtype
                  command.</font></tt></div>
            <div><br>
            </div>
            <div>Cheers,</div>
            <div><br>
            </div>
            <div>Ryo</div>
            <div>---------------------------------------</div>
            <div>
              <div style="font-size:12.8px">set data levitus_climatology</div>
              <div style="font-size:12.8px">save/clobber/file=<a rel="nofollow"
                  href="http://tmp.nc/outtype=double" target="_blank"
                  moz-do-not-send="true">tmp.nc/outtype=<wbr>double</a>&#xA0;temp[k=1,l=1]</div>
              <div style="font-size:12.8px">cancel data/all</div>
              <div style="font-size:12.8px">SPAWN ncks -O -C -b tmp.bin
                -v TEMP&#xA0;<a rel="nofollow" href="http://tmp.nc/" target="_blank"
                  moz-do-not-send="true">tmp.nc</a>&#xA0;-o&#xA0;<a rel="nofollow"
                  href="http://tmp2.nc/" target="_blank"
                  moz-do-not-send="true">tmp2.nc</a></div>
              <div>
                <div style="font-size:12.8px">define axis/x=0:359:1 xax</div>
                <div style="font-size:12.8px">define axis/y=-89.5:89.5:1
                  yax</div>
                <div style="font-size:12.8px">define grid/x=xax/y=yax
                  mygrid</div>
                <div style="font-size:12.8px">file/form=STREAM/var=temp/<wbr>type=r8/grid=mygrid
                  tmp.bin</div>
                <div><span style="font-size:12.8px">set
                    var/bad=-10000000000 temp</span></div>
                <div><span style="font-size:12.8px">save/clobber/file=</span><a rel="nofollow"
                    href="http://tmp-new.nc/" target="_blank"
                    style="font-size:12.8px" moz-do-not-send="true">tmp-new.nc</a><span
                    style="font-size:12.8px">&#xA0;temp</span></div>
              </div>
            </div>
            <div><span style="font-size:12.8px"><br>
              </span></div>
          </div>
        </div>
      </div>
    </blockquote>
    <br>
  

</font></td></tr></table>
<!--X-Body-of-Message-End-->
<!--X-MsgBody-End-->
<!--X-Follow-Ups-->
<hr>
<!--X-Follow-Ups-End-->
<!--X-References-->
<ul><li><strong>References</strong>:
<ul>
<li><strong><a name="00472" href="msg00472.html">[ferret_users] SAVE precision of var from binary data?</a></strong>
<ul><li><em>From:</em> Ryo Furue</li></ul></li>
<li><strong><a name="00473" href="msg00473.html">Re: [ferret_users] SAVE precision of var from binary data?</a></strong>
<ul><li><em>From:</em> Ansley C. Manke</li></ul></li>
<li><strong><a name="00479" href="msg00479.html">Re: [ferret_users] SAVE precision of var from binary data?</a></strong>
<ul><li><em>From:</em> Ryo Furue</li></ul></li>
</ul></li></ul>
<!--X-References-End-->
<!--X-BotPNI-->
<UL>
<li>Previous by thread:
<strong><a href="msg00479.html">Re: [ferret_users] SAVE precision of var from binary data?</a></strong>
</li>
<li>Next by thread:
<strong><a href="msg00478.html">[ferret_users] regarding changing the pen color used for legend</a></strong>
</li>

</UL>
<center>[<a href="msg00479.html">Thread Prev</a>][<a href="msg00478.html">Thread Next</a>][<A HREF="threads.html#00481">Index</A>]</center>

<!--X-BotPNI-End-->
<!--X-User-Footer-->
<A HREF="http://ferret.pmel.noaa.gov/Ferret/contact-us">Contact Us</A>
<br>
<font size=-1>
<address>
<a href="http://www.doc.gov">Dept of Commerce</a> /
<a href="http://www.noaa.gov">NOAA</a> /
<a href="http://www.oar.noaa.gov">OAR</a> /
<a href="http://www.pmel.noaa.gov">PMEL</a> /
<a href="http://ferret.pmel.noaa.gov">Ferret</a>
</address>

<br>
 <a href="http://www.noaa.gov/privacy.html">Privacy Policy</a> | <a href="http://www.noaa.gov/disclaimer.html">Disclaimer</a> | <a href="accessibility.html">Accessibility Statement</a> 

</font>
<!--X-User-Footer-End-->
</body>
</html>
