<!-- MHonArc v2.6.18 -->
<!--X-Subject: Re: [ferret_users] sample_dimension in ferret -->
<!--X-From-R13: Vryyn Dvrqr <uryyn.evrqrNzcvp.qr> -->
<!--X-Date: Thu, 9 Mar 2017 07:22:41 &#45;0800 -->
<!--X-Message-Id: 56b6ee8d&#45;673c&#45;8e81&#45;03ac&#45;876d2572eef7@mpic.de -->
<!--X-Content-Type: multipart/mixed -->
<!--X-Reference: 0921c83c&#45;2beb&#45;2911&#45;5e02&#45;a019f35b00c8@mpic.de -->
<!--X-Reference: 550d7fa7&#45;ea4b&#45;0879&#45;8463&#45;8c214b81b3bd@noaa.gov -->
<!--X-Derived: cdf6ajxPJL5yP.cdf -->
<!--X-Head-End-->
<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN"
        "http://www.w3.org/TR/html4/loose.dtd">
<html>
<head>
<title>Re: [ferret_users] sample_dimension in ferret</title>
</head>
<body>
<!--X-Body-Begin-->
<!--X-User-Header-->
<!--X-User-Header-End-->
<!--X-TopPNI-->
<HR>
<center>[<a href="msg00170.html">Thread Prev</a>][<a href="msg00171.html">Thread Next</a>][<A HREF="threads.html#00178">Index</A>]</center>

<!--X-TopPNI-End-->
<!--X-MsgBody-->
<!--X-Subject-Header-Begin-->
<h1>Re: [ferret_users] sample_dimension in ferret</h1>
<hr>
<!--X-Subject-Header-End-->
<!--X-Head-of-Message-->
<ul>
<li><strong>To</strong>: <strong>&lt;<a href="mailto:ferret_users@DOMAIN.HIDDEN">ferret_users@xxxxxxxx</a>&gt;</strong></li>
<li><strong>Subject</strong>: <strong>Re: [ferret_users] sample_dimension in ferret</strong></li>
<li><strong>From</strong>: <strong>Hella Riede &lt;<a href="mailto:hella.riede@DOMAIN.HIDDEN">hella.riede@xxxxxxx</a>&gt;</strong></li>
<li>Date: Thu, 9 Mar 2017 16:22:35 +0100</li>
<li>Dkim-signature: v=1; a=rsa-sha256; c=relaxed/relaxed;        d=noaa-gov.20150623.gappssmtp.com; s=20150623;        h=from:subject:to:references:message-id:date:user-agent:mime-version         :in-reply-to:x-original-sender:x-original-authentication-results         :precedence:mailing-list:list-id:list-post:list-help:list-archive         :list-unsubscribe;        bh=fD3/3dFfsH3xMoKogFTmu+G3wK4lLetIZRvLjslnQTw=;        b=m5488fgifIQVtdwj/zta3+tQADXK08U47aY9kSjrGQ5kuNsQRhaqWIgFWU0TvqF1Fx         ESFLKqJsNFPQz75Kt4ZuMuFOyvqwOWOLGNvLwBn2/CimEIHQayc8iWGGLijldX6fLQjW         EpneV7HubYwhzHXm+fUjX9ZpNZF5tWBmZPOr6TmnbGvRzkCUjHSeKy2PrF+9MM5DdvKS         aNEVYY2heswGTVqCnmUE7IDFNIhFbJC81oaj9oMVLzi3EuZchkufEQDcfs7YVGUhSnQU         vYAmjTnrNdIATFADufosFg6IpA0SErOw2Bl7JIO1waDdvxq2jZ0uzEvK5ckaZpEERpLY         eV4Q==</li>
<li>In-reply-to: &lt;<a href="msg00170.html">550d7fa7-ea4b-0879-8463-8c214b81b3bd@noaa.gov</a>&gt;</li>
<li>List-archive: &lt;<a href="https://groups.google.com/a/noaa.gov/group/ferret_users/">https://groups.google.com/a/noaa.gov/group/ferret_users/</a>&gt;</li>
<li>List-help: &lt;<a href="https://support.google.com/a/noaa.gov/bin/topic.py?topic=25838">https://support.google.com/a/noaa.gov/bin/topic.py?topic=25838</a>&gt;, &lt;<a href="mailto:ferret_users+help@noaa.gov">mailto:ferret_users+help@noaa.gov</a>&gt;</li>
<li>List-id: &lt;ferret_users.noaa.gov&gt;</li>
<li>List-post: &lt;<a href="https://groups.google.com/a/noaa.gov/group/ferret_users/post">https://groups.google.com/a/noaa.gov/group/ferret_users/post</a>&gt;, &lt;<a href="mailto:ferret_users@noaa.gov">mailto:ferret_users@noaa.gov</a>&gt;</li>
<li>List-unsubscribe: &lt;<a href="mailto:googlegroups-manage+809428289204+unsubscribe@googlegroups.com">mailto:googlegroups-manage+809428289204+unsubscribe@googlegroups.com</a>&gt;, &lt;<a href="https://groups.google.com/a/noaa.gov/group/ferret_users/subscribe">https://groups.google.com/a/noaa.gov/group/ferret_users/subscribe</a>&gt;</li>
<li>Mailing-list: list <a href="mailto:ferret_users@DOMAIN.HIDDEN">ferret_users@xxxxxxxx</a>; contact <a href="mailto:ferret_users%2Bowners@DOMAIN.HIDDEN">ferret_users+owners@xxxxxxxx</a></li>
<li>References: &lt;<a href="msg00169.html">0921c83c-2beb-2911-5e02-a019f35b00c8@mpic.de</a>&gt; &lt;<a href="msg00170.html">550d7fa7-ea4b-0879-8463-8c214b81b3bd@noaa.gov</a>&gt;</li>
<li>Sender: <a href="mailto:owner-ferret_users@DOMAIN.HIDDEN">owner-ferret_users@xxxxxxxx</a></li>
<li>User-agent: Mozilla/5.0 (X11; Linux x86_64; rv:45.0) Gecko/20100101 Thunderbird/45.7.0</li>
</ul>
<!--X-Head-of-Message-End-->
<!--X-Head-Body-Sep-Begin-->
<hr>
<!--X-Head-Body-Sep-End-->
<!--X-Body-of-Message-->
<pre style="margin: 0em;">
Hi Ansley,

thanks - including the station ID and 'cf_role' attribute did shift the variables that are a function of 'station' to the E axis; updated simple files in the attachment.



FYI: The other thing that had been unclear to me: On the ferret and cfconventions.org website mentioned below, 'temp' is only a function of 'obs':

yes? show grid temp
     GRID GQA2
  name       axis              # pts   start                end
  OBS       X                20787 r   1                    20787
  normal    Y
  normal    Z
  normal    T
  normal    E
  normal    F

So I assume that all measurements from all stations are concatenated in temp (to save space and dimensions as opposed to having temp be a function of 'obs' AND 'station'), and can be assigned to the respective stations by means of the 'rowsize' variable.



The SEPARATE function works well as described on the ferret website:

yes? let/units=&quot;`temp,return=units`&quot;/title=&quot;`temp,return=title`&quot; separate_temp = SEPARATE(temp, rowsize, 0)
yes? list separate_temp
             VARIABLE : temperature (Celsius)
             FILENAME : ragged.nc
             SUBSET   : 13 points (X)
 1    /  1:   1.00
 2    /  2:   2.00
 3    /  3:   3.00
 4    /  4:   4.00
 5    /  5:   ....
 6    /  6:   5.00
 7    /  7:   6.00
 8    /  8:   7.00
 9    /  9:   8.00
 10   / 10:   9.00
 11   / 11:   ....
 12   / 12:  10.00
 13   / 13:  11.00


... and expanding the variable into 2-D also works well as described by ferret, e.g.,

yes? let longest = `rowsize[m=@max]`
yes? let temp2d = EXPNDI_BY_M_COUNTS(temp, rowsize, longest)
yes? shade temp2d


Nice!


Best wishes,
Hella







On 08/03/17 21:13, Ansley C. Manke wrote:
</pre><blockquote style="border-left: #5555EE solid 0.2em; margin: 0em; padding-left: 0.85em"><pre style="margin: 0em;">
Hi Hella,

The other attribute that's needed is &quot;cf_role&quot;, as an attribute on a
variable which will identify the station (or trajectory, or whatever the
feature type is, in general). Your file doesn't seem to have a variable
that is a station id. This is described in the CF conventions but it
looks like we need to add this information to the Ferret documentation
about Discrete Sampling Geometries files.

-Ansley


On 3/8/2017 8:07 AM, Hella Riede wrote:
</pre><blockquote style="border-left: #5555EE solid 0.2em; margin: 0em; padding-left: 0.85em"><pre style="margin: 0em;">
Hello ferreters,


I checked out the ferret documentation website about discrete
geometries
<a  rel="nofollow" href="http://ferret.pmel.noaa.gov/Ferret/documentation/users-guide/data-set-basics/2-8-discrete-geometries-datasets-1">http://ferret.pmel.noaa.gov/Ferret/documentation/users-guide/data-set-basics/2-8-discrete-geometries-datasets-1</a>,
especially about the attribute 'sample_dimension'.

Based on
<a  rel="nofollow" href="http://cfconventions.org/cf-conventions/v1.6.0/cf-conventions.html#_contiguous_ragged_array_representation_of_time_series">http://cfconventions.org/cf-conventions/v1.6.0/cf-conventions.html#_contiguous_ragged_array_representation_of_time_series</a>,
I made a simple dataset, see attachments, containing the
'sample_dimension' attribute.

When I load this simple example into ferret, I don't get the
observations on the X axis and the instance axis ('station') in E
direction as described on the ferret website above, but rather two X
grids instead, see output below.

Any idea why? Is the 'dsg_file.nc' dataset used in the ferret example
available somewhere to better understand the structure?

I am not sure if 'obs' should be the sum of all observations of all
stations which 'rowsize' will then divide up per station, or if 'obs'
should be the maximum length per 'station'.

Thanks in advance!

Best wishes,
Hella
on FERRET v7.022 (beta/debug)




yes? use ragged.nc
yes? sh da
      currently SET data sets:
     1&gt; ./ragged.nc  (default)
  name     title                             I         J K         L
  LON      station longitude                1:3       ... ...       ...
  LAT      station latitude                 1:3       ... ...       ...
  ROWSIZE  number of observations for this  1:3       ... ...       ...
  TEMP     temperature                      1:11      ... ...       ...
  yes? sh grid temp
     GRID GNN2
  name       axis              # pts   start end                 subset
  OBS       X                   11 r   1 11                  full
  normal    Y
  normal    Z
  normal    T
yes? sh grid rowsize
     GRID GNN1
  name       axis              # pts   start end                 subset
  STATION   X                    3 r   1 3                   full
  normal    Y
  normal    Z
  normal    T

</pre></blockquote></blockquote><pre style="margin: 0em;">

</pre><p><strong>Attachment:
<a href="cdf6ajxPJL5yP.cdf" ><tt>ragged.nc</tt></a></strong><br>
<em>Description:</em> Cdf file</p>
<pre>netcdf ragged {
dimensions:
      station = 3 ;
      obs = 11 ;
      name_strlen = 4 ;

   variables:
      float lon(station) ;
          lon:long_name = &quot;station longitude&quot;;
          lon:units = &quot;degrees_east&quot;;
      float lat(station) ;
          lat:long_name = &quot;station latitude&quot; ;
          lat:units = &quot;degrees_north&quot; ;
      int rowsize(station) ;
          rowsize:long_name = &quot;number of observations for this station&quot; ;
          rowsize:sample_dimension = &quot;obs&quot; ;
      char station_name(station,name_strlen) ;
          station_name:long_name = &quot;station name&quot; ;
          station_name:cf_role = &quot;timeseries_id&quot;;
      float temp(obs) ;
          temp:long_name = &quot;temperature&quot; ;
          temp:units = &quot;Celsius&quot; ;
          temp:coordinates = &quot;lat lon&quot; ;
          temp:_FillValue = -999.9;

data:

 lon = 10., 20., 30. ;

 lat = 40., 50., 60. ;

 rowsize = 4, 5, 2 ;

 station_name = &quot;A&quot;, &quot;B&quot;, &quot;C&quot; ;

 temp = 1., 2., 3., 4., 5., 6., 7., 8., 9., 10., 11. ;
}
</pre>
<!--X-Body-of-Message-End-->
<!--X-MsgBody-End-->
<!--X-Follow-Ups-->
<hr>
<!--X-Follow-Ups-End-->
<!--X-References-->
<ul><li><strong>References</strong>:
<ul>
<li><strong><a name="00169" href="msg00169.html">[ferret_users] sample_dimension in ferret</a></strong>
<ul><li><em>From:</em> Hella Riede</li></ul></li>
<li><strong><a name="00170" href="msg00170.html">Re: [ferret_users] sample_dimension in ferret</a></strong>
<ul><li><em>From:</em> Ansley C. Manke</li></ul></li>
</ul></li></ul>
<!--X-References-End-->
<!--X-BotPNI-->
<UL>
<li>Previous by thread:
<strong><a href="msg00170.html">Re: [ferret_users] sample_dimension in ferret</a></strong>
</li>
<li>Next by thread:
<strong><a href="msg00171.html">[ferret_users] Calculate cell area on a curvilinear grid</a></strong>
</li>

</UL>
<center>[<a href="msg00170.html">Thread Prev</a>][<a href="msg00171.html">Thread Next</a>][<A HREF="threads.html#00178">Index</A>]</center>

<!--X-BotPNI-End-->
<!--X-User-Footer-->
<A HREF="http://ferret.pmel.noaa.gov/Ferret/contact-us">Contact Us</A>
<br>
<font size=-1>
<address>
<a href="http://www.doc.gov">Dept of Commerce</a> /
<a href="http://www.noaa.gov">NOAA</a> /
<a href="http://www.oar.noaa.gov">OAR</a> /
<a href="http://www.pmel.noaa.gov">PMEL</a> /
<a href="http://ferret.pmel.noaa.gov">Ferret</a>
</address>

<br>
 <a href="http://www.noaa.gov/privacy.html">Privacy Policy</a> | <a href="http://www.noaa.gov/disclaimer.html">Disclaimer</a> | <a href="accessibility.html">Accessibility Statement</a> 

</font>
<!--X-User-Footer-End-->
</body>
</html>
