<!-- MHonArc v2.6.18 -->
<!--X-Subject: [ferret_users] masking with OR and undefined values doesn't work as expected -->
<!--X-From-R13: Vryyn Dvrqr <uryyn.evrqrNzcvp.qr> -->
<!--X-Date: Thu, 20 Jul 2017 10:11:14 &#45;0700 -->
<!--X-Message-Id: e1e0cd1d&#45;3033&#45;5695&#45;661c&#45;1eaf1e65add4@mpic.de -->
<!--X-Content-Type: text/plain -->
<!--X-Head-End-->
<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN"
        "http://www.w3.org/TR/html4/loose.dtd">
<html>
<head>
<title>[ferret_users] masking with OR and undefined values doesn't work as expected</title>
</head>
<body>
<!--X-Body-Begin-->
<!--X-User-Header-->
<!--X-User-Header-End-->
<!--X-TopPNI-->
<HR>
<center>[<a href="msg00504.html">Thread Prev</a>][<a href="msg00508.html">Thread Next</a>][<A HREF="threads.html#00506">Index</A>]</center>

<!--X-TopPNI-End-->
<!--X-MsgBody-->
<!--X-Subject-Header-Begin-->
<h1>[ferret_users] masking with OR and undefined values doesn't work as expected</h1>
<hr>
<!--X-Subject-Header-End-->
<!--X-Head-of-Message-->
<ul>
<li><strong>To</strong>: <strong>ferret users &lt;<a href="mailto:ferret_users@DOMAIN.HIDDEN">ferret_users@xxxxxxxx</a>&gt;</strong></li>
<li><strong>Subject</strong>: <strong>[ferret_users] masking with OR and undefined values doesn't work as expected</strong></li>
<li><strong>From</strong>: <strong>Hella Riede &lt;<a href="mailto:hella.riede@DOMAIN.HIDDEN">hella.riede@xxxxxxx</a>&gt;</strong></li>
<li>Date: Thu, 20 Jul 2017 19:11:04 +0200</li>
<li>Arc-authentication-results: i=1; mx.google.com;       spf=pass (google.com: best guess record for domain of <a href="mailto:hella.riede@DOMAIN.HIDDEN">hella.riede@xxxxxxx</a> designates 192.67.218.51 as permitted sender) smtp.mailfrom=<a href="mailto:hella.riede@DOMAIN.HIDDEN">hella.riede@xxxxxxx</a></li>
<li>Arc-message-signature: i=1; a=rsa-sha256; c=relaxed/relaxed; d=google.com; s=arc-20160816;        h=content-transfer-encoding:content-language:mime-version:user-agent         :date:message-id:subject:from:to:arc-authentication-results;        bh=W5bGtiZBofyGBgn2yO2G2vH1en74C29w4+/L6jFnlVo=;        b=q+Zqy2Gw6MN8kBjDls6LrSRuThrCzwounGgmTemANR8AczL/Nf/owJ8I/QocYI8D0Z         xHYHla1rpGH8huhkM2OxkWITA1Whw3lG4dfq34VjdNlQlhkqTs54VY73LVTCU/XyrQLM         quvt32g5oSWg9bycjMbDMbUI0WMlIWNHJXslzfF7/4xUGbbcdbU+WJAztwPPdoWKkxjA         N6YfUGFuApMV5iyR+DrEnZjtR7xHOiGbWrJg/ULXS7whuwYAmQdHsybq17p9H1ZUvf5x         nMpxLjwEB6oxcsKI1dnqTLnMCd57dRAyiVfrS7J6SUVJRBlflq1PmtFxfCVnR/h0pCdP         LzIg==</li>
<li>Arc-seal: i=1; a=rsa-sha256; t=1500570673; cv=none;        d=google.com; s=arc-20160816;        b=eBR7Hps1ZBF5MRtsbHx7VaBOF+yqxjBjY83hsBCf9e57bUjW1YYlLBmPHILs3bkrfX         ROsHYDR3K1OIisB71ZrlZ2NN3OzVZY8zZM4A6oMx3VLniV9ZAKJ02mVWIKKXr25KJ8yj         vwfYsQk/AvzKlos7CgNjgbQ34o9kwrpXl9YGEIOr9+6bxawuJGleECTnYhFQlHJV32oU         QmEaayWy4VyrgcRSX96CX6Nh2d+pVxsyPOhIy/j1theZlUFgaxF5sQg3h42ZDKY2i5R9         j3L8u1P//RJfBfETETLBk19XDsCy2qdkPuqRZS3hn9KFWxpOe47P9QWqgsUTRn2qOfJE         ri1g==</li>
<li>Dkim-signature: v=1; a=rsa-sha256; c=relaxed/relaxed;        d=noaa-gov.20150623.gappssmtp.com; s=20150623;        h=to:from:subject:message-id:date:user-agent:mime-version         :content-language:content-transfer-encoding:x-original-sender         :x-original-authentication-results:precedence:mailing-list:list-id         :list-post:list-help:list-archive;        bh=W5bGtiZBofyGBgn2yO2G2vH1en74C29w4+/L6jFnlVo=;        b=Co4Tl+TaH+ISD58qHvbcY4vE1QFVDU7C409XtogVtNsj+yuLTLbnW9JzRJ4r1AzFCi         c8YTj1QBPd7NZU74wdHb5T4vIkdm9SJXO6fOwyjmSnkyDGAcCaYlGPxoAX3DEtLOpLtv         ro3HfpBc0xMbj0ZwD63JMz0f2Jil5GWn28l/SPYND8p3oH0jghQP1wLhdB7VFvkzFp6n         A/4DPCo5iCONiRidPCOOagtDLvdpiSc0jood7m5ZK+/j3Vms+BWbOqQ6BXzcImmpTZXm         L/KGdJ2qvJa96jPaBWP1XVmSVAWeLyG4AfDYqXmsaAPYCFlJQHbnlslrGMgOmxMXP8L3         IOhA==</li>
<li>List-archive: &lt;<a href="https://groups.google.com/a/noaa.gov/group/ferret_users/">https://groups.google.com/a/noaa.gov/group/ferret_users/</a>&gt;</li>
<li>List-help: &lt;<a href="https://support.google.com/a/noaa.gov/bin/topic.py?topic=25838">https://support.google.com/a/noaa.gov/bin/topic.py?topic=25838</a>&gt;, &lt;<a href="mailto:ferret_users+help@noaa.gov">mailto:ferret_users+help@noaa.gov</a>&gt;</li>
<li>List-id: &lt;ferret_users.noaa.gov&gt;</li>
<li>List-post: &lt;<a href="https://groups.google.com/a/noaa.gov/group/ferret_users/post">https://groups.google.com/a/noaa.gov/group/ferret_users/post</a>&gt;, &lt;<a href="mailto:ferret_users@noaa.gov">mailto:ferret_users@noaa.gov</a>&gt;</li>
<li>Mailing-list: list <a href="mailto:ferret_users@DOMAIN.HIDDEN">ferret_users@xxxxxxxx</a>; contact <a href="mailto:ferret_users%2Bowners@DOMAIN.HIDDEN">ferret_users+owners@xxxxxxxx</a></li>
<li>Sender: <a href="mailto:owner-ferret_users@DOMAIN.HIDDEN">owner-ferret_users@xxxxxxxx</a></li>
<li>User-agent: Mozilla/5.0 (X11; Linux x86_64; rv:52.0) Gecko/20100101 Thunderbird/52.2.1</li>
</ul>
<!--X-Head-of-Message-End-->
<!--X-Head-Body-Sep-Begin-->
<hr>
<!--X-Head-Body-Sep-End-->
<!--X-Body-of-Message-->
<pre>Hi ferreters, hi developers,


masking is a bit counterintuitive in ferret when involving undefined values:


yes? let a = {1,2,-1E34,4}
yes? let b = {1,-1E34,3,4}
yes? let bla = if (a OR b) then 1
yes? list bla
             VARIABLE : IF (A OR B) THEN 1
             SUBSET   : 4 points (X)
 1   / 1:  1.000
 2   / 2:   ....
 3   / 3:   ....
 4   / 4:  1.000

'OR' implies that 'bla' should be equal to 1 for all 4 data points, because at all 4 points either a or b is actually defined. However, it sets all points to undefined that are undefined in either a or b.


Also this not very elegant version won't work:

yes? let bla = if (a NE -1E34 OR b NE -1E34) then 1
yes? list bla
             VARIABLE : IF (A NE -1E34 OR B NE -1E34) THEN 1
             SUBSET   : 4 points (X)
 1   / 1:  1.000
 2   / 2:   ....
 3   / 3:   ....
 4   / 4:  1.000


Of course this is only a problem when undefined values are involved. Otherwise masking with OR works as expected:

yes? let a = {1,1,2,1}
yes? let b = {1,2,1,1}
yes? let bla = if (a EQ 2 OR b EQ 2) then 1
yes? list bla
             VARIABLE : IF (A EQ 2 OR B EQ 2) THEN 1
             SUBSET   : 4 points (X)
 1   / 1:   ....
 2   / 2:  1.000
 3   / 3:  1.000
 4   / 4:   ....


A workaround is to set undefined values to zero and then do the masking. However, this makes 'real' zero values indistinguishable from undefined values, which could otherwise be kept apart by 'if (a or a EQ 0) then ...'.

Sorry if I missed a note on this in the ferret documentation.



Best wishes,
Hella

</pre>
<!--X-Body-of-Message-End-->
<!--X-MsgBody-End-->
<!--X-Follow-Ups-->
<hr>
<ul><li><strong>Follow-Ups</strong>:
<ul>
<li><strong><a name="00508" href="msg00508.html">Re: [ferret_users] masking with OR and undefined values doesn't work as expected</a></strong>
<ul><li><em>From:</em> Andrew Wittenberg - NOAA Federal</li></ul></li>
</ul></li></ul>
<!--X-Follow-Ups-End-->
<!--X-References-->
<!--X-References-End-->
<!--X-BotPNI-->
<UL>
<li>Previous by thread:
<strong><a href="msg00504.html">[ferret_users] regarding .eps file formate figures</a></strong>
</li>
<li>Next by thread:
<strong><a href="msg00508.html">Re: [ferret_users] masking with OR and undefined values doesn't work as expected</a></strong>
</li>

</UL>
<center>[<a href="msg00504.html">Thread Prev</a>][<a href="msg00508.html">Thread Next</a>][<A HREF="threads.html#00506">Index</A>]</center>

<!--X-BotPNI-End-->
<!--X-User-Footer-->
<A HREF="http://ferret.pmel.noaa.gov/Ferret/contact-us">Contact Us</A>
<br>
<font size=-1>
<address>
<a href="http://www.doc.gov">Dept of Commerce</a> /
<a href="http://www.noaa.gov">NOAA</a> /
<a href="http://www.oar.noaa.gov">OAR</a> /
<a href="http://www.pmel.noaa.gov">PMEL</a> /
<a href="http://ferret.pmel.noaa.gov">Ferret</a>
</address>

<br>
 <a href="http://www.noaa.gov/privacy.html">Privacy Policy</a> | <a href="http://www.noaa.gov/disclaimer.html">Disclaimer</a> | <a href="accessibility.html">Accessibility Statement</a> 

</font>
<!--X-User-Footer-End-->
</body>
</html>
