<!-- MHonArc v2.6.18 -->
<!--X-Subject: Re: [ferret_users] Time regridding from descriptor file returns missing values -->
<!--X-From-R13: "Oafyrl Q. [naxr" <nafyrl.o.znaxrNabnn.tbi> -->
<!--X-Date: Wed, 19 Apr 2017 09:36:15 &#45;0700 -->
<!--X-Message-Id: d03f147d&#45;7854&#45;0b19&#45;3aca&#45;631c4af8b5ee@noaa.gov -->
<!--X-Content-Type: multipart/alternative -->
<!--X-Reference: 535826DD&#45;7F9B&#45;4860&#45;8218&#45;4E680DBC7F94@pnnl.gov -->
<!--X-Head-End-->
<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN"
        "http://www.w3.org/TR/html4/loose.dtd">
<html>
<head>
<title>Re: [ferret_users] Time regridding from descriptor file returns missing values</title>
</head>
<body>
<!--X-Body-Begin-->
<!--X-User-Header-->
<!--X-User-Header-End-->
<!--X-TopPNI-->
<HR>
<center>[<a href="msg00277.html">Thread Prev</a>][<a href="msg00291.html">Thread Next</a>][<A HREF="threads.html#00278">Index</A>]</center>

<!--X-TopPNI-End-->
<!--X-MsgBody-->
<!--X-Subject-Header-Begin-->
<h1>Re: [ferret_users] Time regridding from descriptor file returns missing values</h1>
<hr>
<!--X-Subject-Header-End-->
<!--X-Head-of-Message-->
<ul>
<li><strong>To</strong>: <strong><a href="mailto:ferret_users@DOMAIN.HIDDEN">ferret_users@xxxxxxxx</a></strong></li>
<li><strong>Subject</strong>: <strong>Re: [ferret_users] Time regridding from descriptor file returns missing values</strong></li>
<li><strong>From</strong>: <strong>&quot;Ansley C. Manke&quot; &lt;<a href="mailto:ansley.b.manke@DOMAIN.HIDDEN">ansley.b.manke@xxxxxxxx</a>&gt;</strong></li>
<li>Date: Wed, 19 Apr 2017 09:36:12 -0700</li>
<li>Dkim-signature: v=1; a=rsa-sha256; c=relaxed/relaxed;        d=noaa-gov.20150623.gappssmtp.com; s=20150623;        h=subject:to:references:from:message-id:date:user-agent:mime-version         :in-reply-to:x-original-sender:x-original-authentication-results         :precedence:mailing-list:list-id:list-post:list-help:list-archive         :list-unsubscribe;        bh=D6iQ8XrUSmWWpUXiB0psLdhpXrxgmDZOPylpus/OsJM=;        b=kaat/+qZvS7aDFz1SDQGDPff6iBQ38u3AAdHKVKAFFL9sjwoOQe3j5Yn+7hsRbFC7V         yJMYDLI7HPtKGYUcOGMbhq13XcoCZ/hCa+eDxc2pHpvEIDkrx9y2t6YYEPnEMaAwzBHn         Icv5z/g55iUghQvTMi9epsaJxyIYFOmfgqDQPodJFMIATuJmkwDoXuTlVvkkVCFb9XXV         wAtw1VpWl70Rc/2rFcc/LQQ4TBhh0V6bRVmKMFwdaa4YNZGz5iixyeIq3P0ovhkaoOTF         LrR+YZI9QDK/wpvjKBhKgJpI9scUaw+OaC2li0ZuYMyekXfBYdWmatuVtkwYjUxr4JfB         68Kw==</li>
<li>In-reply-to: &lt;<a href="msg00277.html">535826DD-7F9B-4860-8218-4E680DBC7F94@pnnl.gov</a>&gt;</li>
<li>List-archive: &lt;<a href="https://groups.google.com/a/noaa.gov/group/ferret_users/">https://groups.google.com/a/noaa.gov/group/ferret_users/</a>&gt;</li>
<li>List-help: &lt;<a href="https://support.google.com/a/noaa.gov/bin/topic.py?topic=25838">https://support.google.com/a/noaa.gov/bin/topic.py?topic=25838</a>&gt;, &lt;<a href="mailto:ferret_users+help@noaa.gov">mailto:ferret_users+help@noaa.gov</a>&gt;</li>
<li>List-id: &lt;ferret_users.noaa.gov&gt;</li>
<li>List-post: &lt;<a href="https://groups.google.com/a/noaa.gov/group/ferret_users/post">https://groups.google.com/a/noaa.gov/group/ferret_users/post</a>&gt;, &lt;<a href="mailto:ferret_users@noaa.gov">mailto:ferret_users@noaa.gov</a>&gt;</li>
<li>List-unsubscribe: &lt;<a href="mailto:googlegroups-manage+809428289204+unsubscribe@googlegroups.com">mailto:googlegroups-manage+809428289204+unsubscribe@googlegroups.com</a>&gt;, &lt;<a href="https://groups.google.com/a/noaa.gov/group/ferret_users/subscribe">https://groups.google.com/a/noaa.gov/group/ferret_users/subscribe</a>&gt;</li>
<li>Mailing-list: list <a href="mailto:ferret_users@DOMAIN.HIDDEN">ferret_users@xxxxxxxx</a>; contact <a href="mailto:ferret_users%2Bowners@DOMAIN.HIDDEN">ferret_users+owners@xxxxxxxx</a></li>
<li>References: &lt;<a href="msg00277.html">535826DD-7F9B-4860-8218-4E680DBC7F94@pnnl.gov</a>&gt;</li>
<li>Sender: <a href="mailto:owner-ferret_users@DOMAIN.HIDDEN">owner-ferret_users@xxxxxxxx</a></li>
<li>User-agent: Mozilla/5.0 (Windows NT 6.1; WOW64; rv:45.0) Gecko/20100101 Thunderbird/45.8.0</li>
</ul>
<!--X-Head-of-Message-End-->
<!--X-Head-Body-Sep-Begin-->
<hr>
<!--X-Head-Body-Sep-End-->
<!--X-Body-of-Message-->
<table width="100%"><tr><td bgcolor="#FFFFFF" style="background-color: #FFFFFF; color: #000000; "><font color="#000000">
  
  
    <p>Hi Bill,</p>
    <p>Thank you for the report and example files; we'll have a look at
      it. <br>
    </p>
    <p>In Ferret v7+&#xA0; you have the option of the TSERIES (alias for
      DEFINE DATA/AGGREGATE/T), which acts like a descriptor file does
      to aggregate timeseries datasets, but it is much more flexible.&#xA0;
      It handles irregular or missing time steps which descriptor files
      do not. It reads and analyzes the time axis information in the
      files, so you start with files that have good time axis
      definitions. I don't know whether this would be useful to you or
      whether it relates to what you're seeing, but I want to point it
      out to you.</p>
    <p>-Ansley<br>
    </p>
    <br>
    <div class="moz-cite-prefix">On 4/18/2017 2:56 PM, Gustafson,
      William I wrote:<br>
    </div>
    <blockquote cite=""
      type="cite">
      
      
      
      
      
      <div class="WordSection1">
        <p class="MsoNormal"><span style="font-size:11.0pt">Hi,<o:p></o:p></span></p>
        <p class="MsoNormal"><span style="font-size:11.0pt"><o:p>&#xA0;</o:p></span></p>
        <p class="MsoNormal"><span style="font-size:11.0pt">I discovered
            an odd inconsistency when time regridding with Ferret that
            is most likely a bug, or at least an annoying feature,
            assuming I am not doing something wrong. Attached is a
            script and data files necessary to reproduce the issue. If I
            read a variable directly from a netcdf file, assign a time
            axis to it, and then regrid to a second time axis I get the
            desired result. In my case, the data in the netcdf file is
            every 3 hours and I would like to regrid to daily data. So
            far so good. Next, I wrap the netcdf file with a descriptor
            file to take care of mapping the 3-hourly time axis for the
            data in the netcdf file. Then, I do the same time regridding
            to the daily time axis. This time the result is missing
            values instead of daily data.<o:p></o:p></span></p>
        <p class="MsoNormal"><span style="font-size:11.0pt"><o:p>&#xA0;</o:p></span></p>
        <p class="MsoNormal"><span style="font-size:11.0pt">For the
            attached simplified case, there is the trivial fix of not
            using the des file. However, in production situations, this
            complicates things a lot for me. Is this "missing value"
            feature a bug? Am I doing something wrong? I have been able
            to reproduce the problem in both Ferret v6.9.3 and v7.1 on a
            Linux box.<o:p></o:p></span></p>
        <p class="MsoNormal"><span style="font-size:11.0pt"><o:p>&#xA0;</o:p></span></p>
        <p class="MsoNormal"><span style="font-size:11.0pt">Thanks for
            any suggestions.<o:p></o:p></span></p>
        <p class="MsoNormal"><span style="font-size:11.0pt"><o:p>&#xA0;</o:p></span></p>
        <p class="MsoNormal"><span style="font-size:11.0pt">-Bill<o:p></o:p></span></p>
        <p class="MsoNormal"><span style="font-size:11.0pt"><o:p>&#xA0;</o:p></span></p>
        <p class="MsoNormal"><span style="font-size:11.0pt"><o:p>&#xA0;</o:p></span></p>
        <p class="MsoNormal"><span style="font-size:11.0pt">The script
            that produces the error:<o:p></o:p></span></p>
        <p class="MsoNormal"><span style="font-size:11.0pt"><o:p>&#xA0;</o:p></span></p>
        <p class="MsoNormal"><span style="font-size:11.0pt">---SCRIPT
            BEGIN---<o:p></o:p></span></p>
        <p class="MsoNormal"><span style="font-size:11.0pt">! Script
            demonstrating a Ferret bug/feature when doing time
            interpolation<o:p></o:p></span></p>
        <p class="MsoNormal"><span style="font-size:11.0pt">! from input
            directly from a netCDF file vs. input that has been read via<o:p></o:p></span></p>
        <p class="MsoNormal"><span style="font-size:11.0pt">! a
            descriptor file. For some reason, when regridding data read
            via the<o:p></o:p></span></p>
        <p class="MsoNormal"><span style="font-size:11.0pt">! descriptor
            file results in all missing values. However, bypassing the<o:p></o:p></span></p>
        <p class="MsoNormal"><span style="font-size:11.0pt">! des file
            and assigning the time grid from the Ferret command line<o:p></o:p></span></p>
        <p class="MsoNormal"><span style="font-size:11.0pt">! before
            doing the regridding works.<o:p></o:p></span></p>
        <p class="MsoNormal"><span style="font-size:11.0pt">!
            <a rel="nofollow" class="moz-txt-link-abbreviated" href="mailto:William.Gustafson@xxxxxxxx">William.Gustafson@xxxxxxxx</a>, 18-Apr-2017<o:p></o:p></span></p>
        <p class="MsoNormal"><span style="font-size:11.0pt"><o:p>&#xA0;</o:p></span></p>
        <p class="MsoNormal"><span style="font-size:11.0pt">use
            timeseries.nc<o:p></o:p></span></p>
        <p class="MsoNormal"><span style="font-size:11.0pt">use
            timeseries.des<o:p></o:p></span></p>
        <p class="MsoNormal"><span style="font-size:11.0pt"><o:p>&#xA0;</o:p></span></p>
        <p class="MsoNormal"><span style="font-size:11.0pt">! Define
            needed time axes<o:p></o:p></span></p>
        <p class="MsoNormal"><span style="font-size:11.0pt">define
            axis/t/t0="1-jan-2011:00"/t="1-jan-2011:00":"1-may-2011:00":3/units=hour
            tax3h<o:p></o:p></span></p>
        <p class="MsoNormal"><span style="font-size:11.0pt">define
axis/t/t0="1-jan-2011:00"/t="1-jan-2011:00":"1-may-2011:00":1/edges/units=day
            taxday<o:p></o:p></span></p>
        <p class="MsoNormal"><span style="font-size:11.0pt"><o:p>&#xA0;</o:p></span></p>
        <p class="MsoNormal"><span style="font-size:11.0pt">! Set up
            daily data from 3-hourly data via nc file. First, map the
            data<o:p></o:p></span></p>
        <p class="MsoNormal"><span style="font-size:11.0pt">! to the 3-h
            grid, and then regrid to the final daily grid. This works.<o:p></o:p></span></p>
        <p class="MsoNormal"><span style="font-size:11.0pt">let nc3h =
            t2[gt=tax3h@asn,d=1]<o:p></o:p></span></p>
        <p class="MsoNormal"><span style="font-size:11.0pt">let nc1day =
            nc3h[gt=taxday]<o:p></o:p></span></p>
        <p class="MsoNormal"><span style="font-size:11.0pt"><o:p>&#xA0;</o:p></span></p>
        <p class="MsoNormal"><span style="font-size:11.0pt">! Set up
            daily data from 3-hourly data via des file. The descriptor
            file<o:p></o:p></span></p>
        <p class="MsoNormal"><span style="font-size:11.0pt">! is
            responsible for putting the data on the 3-h grid this time.
            Then,<o:p></o:p></span></p>
        <p class="MsoNormal"><span style="font-size:11.0pt">! we regrid
            to the daily grid. This returns missing values.<o:p></o:p></span></p>
        <p class="MsoNormal"><span style="font-size:11.0pt">let des3h =
            t2[d=2]&#xA0; !des file defines this as 3-hourly<o:p></o:p></span></p>
        <p class="MsoNormal"><span style="font-size:11.0pt">let des1day
            = des3h[gt=taxday]<o:p></o:p></span></p>
        <p class="MsoNormal"><span style="font-size:11.0pt"><o:p>&#xA0;</o:p></span></p>
        <p class="MsoNormal"><span style="font-size:11.0pt">list nc1day,
            des1day<o:p></o:p></span></p>
        <p class="MsoNormal"><span style="font-size:11.0pt"><o:p>&#xA0;</o:p></span></p>
        <p class="MsoNormal"><span style="font-size:11.0pt">---SCRIPT
            END---<o:p></o:p></span></p>
        <p class="MsoNormal"><span style="font-size:11.0pt"><o:p>&#xA0;</o:p></span></p>
        <p class="MsoNormal"><span style="font-size:11.0pt"><o:p>&#xA0;</o:p></span></p>
        <p class="MsoNormal"><span style="font-size:11.0pt">---TRUNCATED
            OUTPUT FROM SCRIPT BEGIN---<o:p></o:p></span></p>
        <p class="MsoNormal"><span style="font-size:11.0pt">&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;
            TIME: 01-JAN-2011 00:00 to 01-MAY-2011 00:00<o:p></o:p></span></p>
        <p class="MsoNormal"><span style="font-size:11.0pt">&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;
            X: 100<o:p></o:p></span></p>
        <p class="MsoNormal"><span style="font-size:11.0pt">&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;
            Y: 100<o:p></o:p></span></p>
        <p class="MsoNormal"><span style="font-size:11.0pt">Column&#xA0; 1:
            NC1DAY is NC3H[GT=TAXDAY]<o:p></o:p></span></p>
        <p class="MsoNormal"><span style="font-size:11.0pt">Column&#xA0; 2:
            DES1DAY is DES3H[GT=TAXDAY]<o:p></o:p></span></p>
        <p class="MsoNormal"><span style="font-size:11.0pt">&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;
            NC1DAY&#xA0; DES1DAY<o:p></o:p></span></p>
        <p class="MsoNormal"><span style="font-size:11.0pt">01-JAN-2011
            12 /&#xA0;&#xA0; 1:&#xA0; 250.5 ....<o:p></o:p></span></p>
        <p class="MsoNormal"><span style="font-size:11.0pt">02-JAN-2011
            12 /&#xA0;&#xA0; 2:&#xA0; 256.0 ....<o:p></o:p></span></p>
        <p class="MsoNormal"><span style="font-size:11.0pt">03-JAN-2011
            12 /&#xA0;&#xA0; 3:&#xA0; 253.7 ....<o:p></o:p></span></p>
        <p class="MsoNormal"><span style="font-size:11.0pt">04-JAN-2011
            12 /&#xA0;&#xA0; 4:&#xA0; 250.0 ....<o:p></o:p></span></p>
        <p class="MsoNormal"><span style="font-size:11.0pt">05-JAN-2011
            12 /&#xA0;&#xA0; 5:&#xA0; 241.8 ....<o:p></o:p></span></p>
        <p class="MsoNormal"><span style="font-size:11.0pt">06-JAN-2011
            12 /&#xA0;&#xA0; 6:&#xA0; 237.3 ....<o:p></o:p></span></p>
        <p class="MsoNormal"><span style="font-size:11.0pt">07-JAN-2011
            12 /&#xA0;&#xA0; 7:&#xA0; 251.9 ....<o:p></o:p></span></p>
        <p class="MsoNormal"><span style="font-size:11.0pt">08-JAN-2011
            12 /&#xA0;&#xA0; 8:&#xA0; 247.3 ....<o:p></o:p></span></p>
        <p class="MsoNormal"><span style="font-size:11.0pt">09-JAN-2011
            12 /&#xA0;&#xA0; 9:&#xA0; 247.0 ....<o:p></o:p></span></p>
        <p class="MsoNormal"><span style="font-size:11.0pt">---TRUNCATED
            OUTPUT FROM SCRIPT END---<o:p></o:p></span></p>
        <p class="MsoNormal" style="text-autospace:none"><b><span
              style="font-size:10.0pt;font-family:Helvetica;color:#D27416">___________________________________________________________________</span></b><span
            style="font-size:10.0pt;font-family:Helvetica"><o:p></o:p></span></p>
        <p class="MsoNormal" style="text-autospace:none"><span
            style="font-size:10.0pt;font-family:Helvetica">&#xA0;<o:p></o:p></span></p>
        <p class="MsoNormal" style="text-autospace:none"><b><span
              style="font-size:10.0pt;font-family:Helvetica">William I.
              Gustafson Jr., Ph.D.<o:p></o:p></span></b></p>
        <p class="MsoNormal" style="text-autospace:none"><span
            style="font-size:10.0pt;font-family:Helvetica">Scientist&#x2028;<o:p></o:p></span></p>
        <p class="MsoNormal" style="text-autospace:none"><span
            style="font-size:10.0pt;font-family:Helvetica">ATMOSPHERIC
            SCIENCES AND GLOBAL CHANGE DIVISION<o:p></o:p></span></p>
        <p class="MsoNormal" style="text-autospace:none"><span
            style="font-size:10.0pt;font-family:Helvetica">&#x2028;Pacific
            Northwest National Laboratory<o:p></o:p></span></p>
        <p class="MsoNormal" style="text-autospace:none"><span
            style="font-size:10.0pt;font-family:Helvetica">P.O. 999,
            MSIN K9-30<o:p></o:p></span></p>
        <p class="MsoNormal" style="text-autospace:none"><span
            style="font-size:10.0pt;font-family:Helvetica">Richland,WA
            &#xA0;99352<o:p></o:p></span></p>
        <p class="MsoNormal" style="text-autospace:none"><span
            style="font-size:10.0pt;font-family:Helvetica">Tel:
            509-372-6110<o:p></o:p></span></p>
        <p class="MsoNormal" style="text-autospace:none"><span
            style="font-size:10.0pt;font-family:Helvetica"><o:p>&#xA0;</o:p></span></p>
        <p class="MsoNormal" style="text-autospace:none"><span
            style="font-size:10.0pt;font-family:Helvetica"><a rel="nofollow"
              moz-do-not-send="true"
              href="mailto:William.Gustafson@xxxxxxxx"><span
                style="color:#D57507">William.Gustafson@xxxxxxxx</span></a><o:p></o:p></span></p>
        <p class="MsoNormal" style="text-autospace:none"><span
            style="font-size:10.0pt;font-family:Helvetica"><a rel="nofollow"
              moz-do-not-send="true"
href="http://www.pnnl.gov/atmospheric/staff/staff_info.asp?staff_num=5716"><span
                style="color:#D27416">http://www.pnnl.gov/atmospheric/staff/staff_info.asp?staff_num=5716</span></a><o:p></o:p></span></p>
        <p class="MsoNormal"><span
            style="font-size:10.0pt;font-family:Helvetica;color:#D27416"><a rel="nofollow"
              moz-do-not-send="true"
              href="http://www.researcherid.com/rid/A-7732-2008"><span
                style="color:#D27416">http://www.researcherid.com/rid/A-7732-2008</span></a></span><o:p></o:p></p>
      </div>
    </blockquote>
    <br>
  

</font></td></tr></table>
<!--X-Body-of-Message-End-->
<!--X-MsgBody-End-->
<!--X-Follow-Ups-->
<hr>
<ul><li><strong>Follow-Ups</strong>:
<ul>
<li><strong><a name="00291" href="msg00291.html">Re: [ferret_users] Time regridding from descriptor file returns missing values</a></strong>
<ul><li><em>From:</em> Ansley C. Manke</li></ul></li>
</ul></li></ul>
<!--X-Follow-Ups-End-->
<!--X-References-->
<ul><li><strong>References</strong>:
<ul>
<li><strong><a name="00277" href="msg00277.html">[ferret_users] Time regridding from descriptor file returns missing values</a></strong>
<ul><li><em>From:</em> Gustafson, William I</li></ul></li>
</ul></li></ul>
<!--X-References-End-->
<!--X-BotPNI-->
<UL>
<li>Previous by thread:
<strong><a href="msg00277.html">[ferret_users] Time regridding from descriptor file returns missing values</a></strong>
</li>
<li>Next by thread:
<strong><a href="msg00291.html">Re: [ferret_users] Time regridding from descriptor file returns missing values</a></strong>
</li>

</UL>
<center>[<a href="msg00277.html">Thread Prev</a>][<a href="msg00291.html">Thread Next</a>][<A HREF="threads.html#00278">Index</A>]</center>

<!--X-BotPNI-End-->
<!--X-User-Footer-->
<A HREF="http://ferret.pmel.noaa.gov/Ferret/contact-us">Contact Us</A>
<br>
<font size=-1>
<address>
<a href="http://www.doc.gov">Dept of Commerce</a> /
<a href="http://www.noaa.gov">NOAA</a> /
<a href="http://www.oar.noaa.gov">OAR</a> /
<a href="http://www.pmel.noaa.gov">PMEL</a> /
<a href="http://ferret.pmel.noaa.gov">Ferret</a>
</address>

<br>
 <a href="http://www.noaa.gov/privacy.html">Privacy Policy</a> | <a href="http://www.noaa.gov/disclaimer.html">Disclaimer</a> | <a href="accessibility.html">Accessibility Statement</a> 

</font>
<!--X-User-Footer-End-->
</body>
</html>
