<!-- MHonArc v2.6.18 -->
<!--X-Subject: Re: [ferret_users] Masking in list command works for floats, not strings -->
<!--X-From-R13: "Oafyrl Q. [naxr" <nafyrl.o.znaxrNabnn.tbi> -->
<!--X-Date: Tue, 27 Jun 2017 14:35:30 &#45;0700 -->
<!--X-Message-Id: 93be072b&#45;992c&#45;e4ec&#45;ed4e&#45;61a900ec45ff@noaa.gov -->
<!--X-Content-Type: text/plain -->
<!--X-Reference: 99e4f7ced0844554ba730089bf8c4f1c@mpic.de -->
<!--X-Head-End-->
<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN"
        "http://www.w3.org/TR/html4/loose.dtd">
<html>
<head>
<title>Re: [ferret_users] Masking in list command works for floats, not strings</title>
</head>
<body>
<!--X-Body-Begin-->
<!--X-User-Header-->
<!--X-User-Header-End-->
<!--X-TopPNI-->
<HR>
<center>[<a href="msg00464.html">Thread Prev</a>][<a href="msg00470.html">Thread Next</a>][<A HREF="threads.html#00465">Index</A>]</center>

<!--X-TopPNI-End-->
<!--X-MsgBody-->
<!--X-Subject-Header-Begin-->
<h1>Re: [ferret_users] Masking in list command works for floats, not strings</h1>
<hr>
<!--X-Subject-Header-End-->
<!--X-Head-of-Message-->
<ul>
<li><strong>To</strong>: <strong>&quot;Riede, Hella&quot; &lt;<a href="mailto:hella.riede@DOMAIN.HIDDEN">hella.riede@xxxxxxx</a>&gt;, ferret users &lt;<a href="mailto:ferret_users@DOMAIN.HIDDEN">ferret_users@xxxxxxxx</a>&gt;</strong></li>
<li><strong>Subject</strong>: <strong>Re: [ferret_users] Masking in list command works for floats, not strings</strong></li>
<li><strong>From</strong>: <strong>&quot;Ansley C. Manke&quot; &lt;<a href="mailto:ansley.b.manke@DOMAIN.HIDDEN">ansley.b.manke@xxxxxxxx</a>&gt;</strong></li>
<li>Date: Tue, 27 Jun 2017 14:35:27 -0700</li>
<li>Arc-authentication-results: i=2; mx.google.com;       dkim=pass header.i=@noaa-gov.20150623.gappssmtp.com header.b=SSqjbTIe;       spf=pass (google.com: domain of <a href="mailto:ansley.b.manke@DOMAIN.HIDDEN">ansley.b.manke@xxxxxxxx</a> designates 2607:f8b0:400e:c05::229 as permitted sender) smtp.mailfrom=<a href="mailto:ansley.b.manke@DOMAIN.HIDDEN">ansley.b.manke@xxxxxxxx</a></li>
<li>Arc-authentication-results: i=1; mx.google.com;       dkim=pass header.i=@noaa-gov.20150623.gappssmtp.com header.b=SSqjbTIe;       spf=pass (google.com: domain of <a href="mailto:ansley.b.manke@DOMAIN.HIDDEN">ansley.b.manke@xxxxxxxx</a> designates 2607:f8b0:400e:c05::229 as permitted sender) smtp.mailfrom=<a href="mailto:ansley.b.manke@DOMAIN.HIDDEN">ansley.b.manke@xxxxxxxx</a></li>
<li>Arc-message-signature: i=2; a=rsa-sha256; c=relaxed/relaxed; d=google.com; s=arc-20160816;        h=list-archive:list-help:list-post:list-id:mailing-list:precedence         :content-language:content-transfer-encoding:in-reply-to:mime-version         :user-agent:date:message-id:from:references:to:subject         :arc-authentication-results:arc-message-signature:dkim-signature         :arc-authentication-results;        bh=rL+HfC20PeAbzq6P3XNxxCdnZZkyKdmFgDEbxkGGUo0=;        b=0SwDaj6430VbSx8+mFXdEk9skcEwITb2wE4WGrKWffzsx74jfD3IkU0X74Y7g/0mee         rjbL473AFvav39F+cZrTAiEbO3saIPVvNfIVIZp+Xljnie0/WQ4myoOG4OsyCeMnqmEM         wdofYMXUwTvitT33elPGNodp2kcEF6NC3lfCQzaLXyBom32Tccue20SO5OuyOVkQTp2o         +Tzef4IgcN6IrUT7MAesCJa0mgfuCIL2t7Kp9cHrVKn/8WaMGC6wF4x2zV5MyVNEHoja         0mMZi4V+jWtZkDFoM/MF/CQmH4atyfmW2yKjlVA16fCauiF2/nkgh1bcnHtd10YvO2Jf         NpWQ==</li>
<li>Arc-message-signature: i=1; a=rsa-sha256; c=relaxed/relaxed; d=google.com; s=arc-20160816;        h=content-language:content-transfer-encoding:in-reply-to:mime-version         :user-agent:date:message-id:from:references:to:subject         :dkim-signature:arc-authentication-results;        bh=rL+HfC20PeAbzq6P3XNxxCdnZZkyKdmFgDEbxkGGUo0=;        b=rPjMD8HO6SbcGGLzBnf4DS+bujYUHQiI+5HWwDzswcFYdFkgHvk60kzCgFRv7UelQ2         nBqNtKSX6AfadX0RwbOJb4EVteLnqvCqc+6t7vBhBinDULdo4FuRdbKDiGeb5ELXftcg         2stBBwpxwSwUzo56hqP8YsdD0V/YZB6TTbZ48y5a46Ci+yLRMxRBxuuBdDMlVKhA1uJl         bRDmnikQP172bJONZ6LzqU2veSMfp3asa+J+lHVyOdARXXub1X/0QvxodC4INIHbYMcd         pmRcMFCXIhrcq5KUbPdrbv0LOglc/OBa2+ZOucvKQ9kOwMcCugjqjjds/e/EKP+LJplV         z6PA==</li>
<li>Arc-seal: i=2; a=rsa-sha256; t=1498599329; cv=pass;        d=google.com; s=arc-20160816;        b=ZVqtCdvceKm3vrbsoXr6mgO7rQQ7viGEzAYlXCWp9fOyXDKkMOxUa5O8mSdarCiTge         pPc1oK9rzxu3jBPdZd59mm6Nkpw3LtHuXvSn+hJkjKYZYm/iSHDebU9Cz6JMQK0KOPOI         3B0ncjo3FhALuhOiJYgRTyOIRE9O81mF419Nk/XLDo2Zs1i2QEOnrcPB4Zwhz68AlybQ         5TkojkWpmlTAB/n6ebn51MefIbKasTgSXXfCIx9RjPxDw9Qid3zmfsXoqgn8kNWXBHRl         1gEwkw/mr3rQMEfqQjogEAEA5SMPNUJ6YdebkxHwD1jpsSTG7VZUQ9Sehl3qW2yPK8Sy         gNyQ==</li>
<li>Arc-seal: i=1; a=rsa-sha256; t=1498599329; cv=none;        d=google.com; s=arc-20160816;        b=ZUZoZFepZvrr+2lMoTI5Kbk+EKSNw8rz4WplcQwed5WsNO3Bnn4ePRheJMCe3nWDOh         xXp7jtdZjga06Pd5DFW6/sagmXCLzbcN4iNhWUeDCa5VeY6yrP5zypAU/8dexXOcZsVI         rR59BokVw6HkKfcSDXf5BKpRcyjiYdSd+rBijKafG+nn5cibt7IahaB1SeG5mIQJTNPW         oxnPpwnGjXMB7Lg96sCHWpWevyuB0gG2MiL3Q8+hwJ2AwLTXcHyC5V7LXtOX2irvrVxi         Xh3tGt8k5kDthzOsDfYbkSrS+pAHJcQI4g7y38U/aN141Bza3cPp0AAfPRpe7gApGzla         gVpA==</li>
<li>Dkim-signature: v=1; a=rsa-sha256; c=relaxed/relaxed;        d=noaa-gov.20150623.gappssmtp.com; s=20150623;        h=subject:to:references:from:message-id:date:user-agent:mime-version         :in-reply-to:content-transfer-encoding:content-language         :x-original-sender:x-original-authentication-results:precedence         :mailing-list:list-id:list-post:list-help:list-archive;        bh=rL+HfC20PeAbzq6P3XNxxCdnZZkyKdmFgDEbxkGGUo0=;        b=PqXczdCkzkakrt5FqCWp27GjIRToWeEJEGvdlBL5Z8fmB0/oOAW/jNkAdrgXjxr4EY         79/t4xRrTzICdd22/XUhs6D1YKnUrVk7Y5vxjocCooXC7SoDm9dJfZYO3WZJpf+pIuS3         uYzmtAzEBJmQWvhYwZYUc+efpFRy2iZY2c9b+0/cSPDi5SRkN9/kHamR8OiQrgUUfwrB         ts0T3kw5GjXnFuPGzXxW8s/2XBnp/ws9W+vrGTZYJqHGBMLwW6jESyQAX6AMwDTRuLYj         ndux8vdvtJ1y1WL5is1ANZ6hVtfwZftq8JaIIEbPhyP3mIzrlf0wUVoPgtgX85G12Afy         I4Lw==</li>
<li>In-reply-to: &lt;<a href="msg00464.html">99e4f7ced0844554ba730089bf8c4f1c@mpic.de</a>&gt;</li>
<li>List-archive: &lt;<a href="https://groups.google.com/a/noaa.gov/group/ferret_users/">https://groups.google.com/a/noaa.gov/group/ferret_users/</a>&gt;</li>
<li>List-help: &lt;<a href="https://support.google.com/a/noaa.gov/bin/topic.py?topic=25838">https://support.google.com/a/noaa.gov/bin/topic.py?topic=25838</a>&gt;, &lt;<a href="mailto:ferret_users+help@noaa.gov">mailto:ferret_users+help@noaa.gov</a>&gt;</li>
<li>List-id: &lt;ferret_users.noaa.gov&gt;</li>
<li>List-post: &lt;<a href="https://groups.google.com/a/noaa.gov/group/ferret_users/post">https://groups.google.com/a/noaa.gov/group/ferret_users/post</a>&gt;, &lt;<a href="mailto:ferret_users@noaa.gov">mailto:ferret_users@noaa.gov</a>&gt;</li>
<li>Mailing-list: list <a href="mailto:ferret_users@DOMAIN.HIDDEN">ferret_users@xxxxxxxx</a>; contact <a href="mailto:ferret_users%2Bowners@DOMAIN.HIDDEN">ferret_users+owners@xxxxxxxx</a></li>
<li>References: &lt;<a href="msg00464.html">99e4f7ced0844554ba730089bf8c4f1c@mpic.de</a>&gt;</li>
<li>Sender: <a href="mailto:owner-ferret_users@DOMAIN.HIDDEN">owner-ferret_users@xxxxxxxx</a></li>
<li>User-agent: Mozilla/5.0 (Windows NT 6.1; WOW64; rv:52.0) Gecko/20100101 Thunderbird/52.2.1</li>
</ul>
<!--X-Head-of-Message-End-->
<!--X-Head-Body-Sep-Begin-->
<hr>
<!--X-Head-Body-Sep-End-->
<!--X-Body-of-Message-->
<pre style="margin: 0em;">
Hi Hella,

</pre><tt>Thank you for the example.  In principle, specifying an expression as 
</tt><tt>the argument to a command:
</tt><pre style="margin: 0em;">

  yes? list if (test) then strings

</pre><tt>should be equivalent to defining a variable with that same expression 
</tt><tt>and sending that to the command:
</tt><pre style="margin: 0em;">

   yes? let masked = if (test) then strings
   yes? list masked

</pre><tt>However there winds up being a slight variation in how the computation 
</tt><tt>is done with occasionally different and incorrect results. (Here we're 
</tt><tt>seeing pointers to the strings which should be returned!)  We had a 
</tt><tt>similar bug report a year or two back which I think has been fixed; I'll 
</tt><tt>check into this.
</tt><pre style="margin: 0em;">

Ansley

On 6/27/2017 9:38 AM, Riede, Hella wrote:
</pre><blockquote style="border-left: #5555EE solid 0.2em; margin: 0em; padding-left: 0.85em"><pre style="margin: 0em;">
Dear ferreters,

I discovered listing while masking seems to work. But not in all cases (see also attached script file with more examples and comments):


yes? let test = {1,1,0}

!! problem with masked strings -&gt; unexpected values
yes? let strings = {&quot;a&quot;,&quot;b&quot;,&quot;c&quot;}
yes? list if (test) then strings
              VARIABLE : IF (TEST) THEN STRINGS
              SUBSET   : 3 points (X)
  1   / 1:  2.109-316
  2   / 2:  2.109-316
  3   / 3:  2.109-316
!! repeat the listing, and the values change every time

!! define a masked variable instead, then list - works
yes? let masked = if (test) then strings
yes? list masked
              VARIABLE : IF (TEST) THEN STRINGS
              SUBSET   : 3 points (X)
  1   / 1:&quot;a&quot;
  2   / 2:&quot;b&quot;
  3   / 3:&quot;&quot;

!! OR do the same listing for a float first
yes? let floats = {2,3,4}
yes? list if (test) then floats
              VARIABLE : IF (TEST) THEN FLOATS
              SUBSET   : 3 points (X)
  1   / 1:  2.000
  2   / 2:  3.000
  3   / 3:   ....

!! now, also for strings listing while masking works
yes? list if (test) then strings
              VARIABLE : IF (TEST) THEN STRINGS
              SUBSET   : 3 points (X)
  1   / 1:&quot;a&quot;
  2   / 2:&quot;b&quot;
  3   / 3:&quot;&quot;


In an interactive ferret session, I first had defined a masked variable for strings (in this example 'masked'), and had also listed it for testing. After that I discovered that listing while masking works too (of course I didn't know it only worked because I had defined and listed the 'masked' variable before, in the same session). So later in my ferret script I omitted defining the 'masked' variable, and used the listing while masking. The script did not crash, but gave me unexpected values like the ones above, instead of proper strings.

Would be good to fix this, or - if the syntax of listing while masking is not supported - to catch these cases and throw an error.

The story goes on, however, see attached script as it seems not possible to mask a string variable and then make an xsequence out of it - unless you do for instance the &quot;faulty listing while masking&quot; from above before the &quot;right&quot; listing.



Best wishes,
Hella

PyFerret v7.11 (beta/optim), Linux 4.4.0-72-generic - 04/19/17
</pre></blockquote><pre style="margin: 0em;">


</pre>
<!--X-Body-of-Message-End-->
<!--X-MsgBody-End-->
<!--X-Follow-Ups-->
<hr>
<ul><li><strong>Follow-Ups</strong>:
<ul>
<li><strong><a name="00470" href="msg00470.html">Re: [ferret_users] Masking in list command works for floats, not strings</a></strong>
<ul><li><em>From:</em> Riede, Hella</li></ul></li>
</ul></li></ul>
<!--X-Follow-Ups-End-->
<!--X-References-->
<ul><li><strong>References</strong>:
<ul>
<li><strong><a name="00464" href="msg00464.html">[ferret_users] Masking in list command works for floats, not strings</a></strong>
<ul><li><em>From:</em> Riede, Hella</li></ul></li>
</ul></li></ul>
<!--X-References-End-->
<!--X-BotPNI-->
<UL>
<li>Previous by thread:
<strong><a href="msg00464.html">[ferret_users] Masking in list command works for floats, not strings</a></strong>
</li>
<li>Next by thread:
<strong><a href="msg00470.html">Re: [ferret_users] Masking in list command works for floats, not strings</a></strong>
</li>

</UL>
<center>[<a href="msg00464.html">Thread Prev</a>][<a href="msg00470.html">Thread Next</a>][<A HREF="threads.html#00465">Index</A>]</center>

<!--X-BotPNI-End-->
<!--X-User-Footer-->
<A HREF="http://ferret.pmel.noaa.gov/Ferret/contact-us">Contact Us</A>
<br>
<font size=-1>
<address>
<a href="http://www.doc.gov">Dept of Commerce</a> /
<a href="http://www.noaa.gov">NOAA</a> /
<a href="http://www.oar.noaa.gov">OAR</a> /
<a href="http://www.pmel.noaa.gov">PMEL</a> /
<a href="http://ferret.pmel.noaa.gov">Ferret</a>
</address>

<br>
 <a href="http://www.noaa.gov/privacy.html">Privacy Policy</a> | <a href="http://www.noaa.gov/disclaimer.html">Disclaimer</a> | <a href="accessibility.html">Accessibility Statement</a> 

</font>
<!--X-User-Footer-End-->
</body>
</html>
