<!-- MHonArc v2.6.18 -->
<!--X-Subject: Re: [ferret_users] Manually interpolate zero degree level -->
<!--X-From-R13: Xnfcre Rravffra <wnfcre.qravffra1992Ntznvy.pbz> -->
<!--X-Date: Fri, 19 May 2017 05:45:20 &#45;0700 -->
<!--X-Message-Id: CAA4txigrt=32Uate168+psh&#45;Qcp+cAbg3i&#45;wp2neWarw7V_JwA@mail.gmail.com -->
<!--X-Content-Type: multipart/alternative -->
<!--X-Reference: CAA4txijPD1MRFHG_aWhkZYkk4kynjSfnUBWvyCJEWjrUmoksVQ@mail.gmail.com -->
<!--X-Reference: f48baeaa&#45;a2c3&#45;6155&#45;9dde&#45;7e29ceb91714@noaa.gov -->
<!--X-Reference: 5b8c67e5&#45;ba27&#45;b34d&#45;5b3d&#45;d9992599cffc@csiro.au -->
<!--X-Reference: CAA4txiieztwmQbkQk4MBSHY+kqvxzPj0rdDcO+tbe3SXnFhV1g@mail.gmail.com -->
<!--X-Reference: f2c96790&#45;1cdf&#45;189b&#45;f75a&#45;dde8de513c10@csiro.au -->
<!--X-Head-End-->
<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN"
        "http://www.w3.org/TR/html4/loose.dtd">
<html>
<head>
<title>Re: [ferret_users] Manually interpolate zero degree level</title>
</head>
<body>
<!--X-Body-Begin-->
<!--X-User-Header-->
<!--X-User-Header-End-->
<!--X-TopPNI-->
<HR>
<center>[<a href="msg00356.html">Thread Prev</a>][<a href="msg00349.html">Thread Next</a>][<A HREF="threads.html#00358">Index</A>]</center>

<!--X-TopPNI-End-->
<!--X-MsgBody-->
<!--X-Subject-Header-Begin-->
<h1>Re: [ferret_users] Manually interpolate zero degree level</h1>
<hr>
<!--X-Subject-Header-End-->
<!--X-Head-of-Message-->
<ul>
<li><strong>To</strong>: <strong>Russ Fiedler &lt;<a href="mailto:russell.fiedler@DOMAIN.HIDDEN">russell.fiedler@xxxxxxxx</a>&gt;</strong></li>
<li><strong>Subject</strong>: <strong>Re: [ferret_users] Manually interpolate zero degree level</strong></li>
<li><strong>From</strong>: <strong>Jasper Denissen &lt;<a href="mailto:jasper.denissen1992@DOMAIN.HIDDEN">jasper.denissen1992@xxxxxxxxx</a>&gt;</strong></li>
<li>Date: Fri, 19 May 2017 14:45:18 +0200</li>
<li>Arc-authentication-results: i=2; mx.google.com;       dkim=pass header.i=@gmail.com;       spf=pass (google.com: domain of <a href="mailto:jasper.denissen1992@DOMAIN.HIDDEN">jasper.denissen1992@xxxxxxxxx</a> designates 2607:f8b0:400d:c0d::229 as permitted sender) smtp.mailfrom=<a href="mailto:jasper.denissen1992@DOMAIN.HIDDEN">jasper.denissen1992@xxxxxxxxx</a>;       dmarc=pass (p=NONE sp=NONE dis=NONE) header.from=gmail.com</li>
<li>Arc-authentication-results: i=1; mx.google.com;       dkim=pass header.i=@gmail.com;       spf=pass (google.com: domain of <a href="mailto:jasper.denissen1992@DOMAIN.HIDDEN">jasper.denissen1992@xxxxxxxxx</a> designates 2607:f8b0:400d:c0d::229 as permitted sender) smtp.mailfrom=<a href="mailto:jasper.denissen1992@DOMAIN.HIDDEN">jasper.denissen1992@xxxxxxxxx</a>;       dmarc=pass (p=NONE sp=NONE dis=NONE) header.from=gmail.com</li>
<li>Arc-message-signature: i=2; a=rsa-sha256; c=relaxed/relaxed; d=google.com; s=arc-20160816;        h=list-unsubscribe:list-archive:list-help:list-post:list-id         :mailing-list:precedence:cc:to:subject:message-id:date:from         :references:in-reply-to:mime-version:arc-authentication-results         :arc-message-signature:dkim-signature:arc-authentication-results;        bh=xP2yAGH02It4MpFNSJGwU0wuLUh0OVArvsvCMytfTXI=;        b=Sbi9K36HHXd7tWFS7QoDV3/Iflb9acwD5F3B9XfGwgnCoIK2lZjFHzlBufWHsjCaMS         NnuAXJy6z+GNYcP6otTJBKE/W4qsSbc14j2TW7lh4fD0NNkSlojANahKV7C6jT3LLogm         ayG241bz38bCP7P02Rq3kOuc6CcODbZhcfu5q5Zihrz9ZVlivw/pWZ/gz4Cr05cCwhSL         wYkAZmt7V0Dym0tYucNm6ydkDqod0vcplAShK3qDAUHoEX3iCpFGH6+y9IwVlxRzdeUR         +Vrrp+Nf2OhH/sd026OAWs9KTrwq9M0zjRkvYI0NwTzGN7Dr/j8kG8s9BSgS/AoLPqFd         oSew==</li>
<li>Arc-message-signature: i=1; a=rsa-sha256; c=relaxed/relaxed; d=google.com; s=arc-20160816;        h=cc:to:subject:message-id:date:from:references:in-reply-to         :mime-version:dkim-signature:arc-authentication-results;        bh=xP2yAGH02It4MpFNSJGwU0wuLUh0OVArvsvCMytfTXI=;        b=QPJ2NnmxTLQvAvCkRjxw6aTmlwY9AJWeexpfSbOybndBCq53zX/1rSxvWTJ0S2MkBn         hSTWSwBTmWcT75Iu1M/SmT0QDOxI+NTgc6wbA6iBVfnFJKVDc3y0s/fwD4rR9X3Y8rRN         d1YDaPDYZqM1nSlEPkCckvj3hF9fgWypM9rnbu+NuwlWhbBnu1foXPRgo74OA+SVvHSQ         q4ivDohoKizcmmwe53/mXMJs98+hPpUZY7rMKVX1CedWs9xCp7SPdI9nOa64wwszYuZh         xJv9IuN7GRR2bTe+Z+wDsjf49vcK+zXIALqvPjLP8AQNBZZjVNtYyfCXtVS+E7imbAZw         nzLw==</li>
<li>Arc-seal: i=2; a=rsa-sha256; t=1495197920; cv=pass;        d=google.com; s=arc-20160816;        b=MOmBhNf/9ycByIFIerTZAx7zTYRHYmNZnlEDegSlLvUcnpG/g3kOslmiL0hcH4Rb13         vzcsUvFdUufFwza2+EU/nFnOhVqSnXAB+swzFLYLJ6IXUpVsjPGXK/3Ss6lfpAlj6+UO         WTXddP0pbJMXlsrwhOYauaQOdjOOQb/5OAcWl5JT1r3V+5IFA8k4c1UiRlnf2kjad4WO         Sqk6p2uzUpcciyky0Fq9HKzBY2WPl2Xk15swuhO1MR+u6uk4SioJPfgCoxJXAhjoJIGk         pM7kJeoOpJxDZ4ioUHnrih2SoWTRNS0fF1uExWKqUTQu2zchOzVH+RDsxdU4cX4cewPC         vyFg==</li>
<li>Arc-seal: i=1; a=rsa-sha256; t=1495197919; cv=none;        d=google.com; s=arc-20160816;        b=XEdHnVPGyPBYUr0Lzx9hI/fb2bejUZTz+GHHa25OFF1ZEmK7SDEInnwtnrcmzBhZvC         mlDzAd41NuGfwwW55vctSLaaWZfjmTlXwGB0d1hx1tCGfb0vxWCRoi1v8EXiihO4JmZK         E57tJ1UVAsJqDJ1IBiuOvmD1txC+XN1QDHn7ZxcL0+i5Emvy3UwyNOm5oCVT7coxRIn+         lDS33S8ioedoC7ek7N0lLcxrGOAcUOdQTFXFz1luG1rPoypXIZZTC1ip7I1tH/cic199         8wXDkCBXWZTw0rB4BL8NEWYMVPVsDR04EsUibkKlTbMnB2wxSgt3X4jJt4kzd/BW1sBC         ubKw==</li>
<li>Cc: <a href="mailto:ferret_users@DOMAIN.HIDDEN">ferret_users@xxxxxxxx</a></li>
<li>Dkim-signature: v=1; a=rsa-sha256; c=relaxed/relaxed;        d=noaa-gov.20150623.gappssmtp.com; s=20150623;        h=mime-version:in-reply-to:references:from:date:message-id:subject:to         :cc:x-original-sender:x-original-authentication-results:precedence         :mailing-list:list-id:list-post:list-help:list-archive         :list-unsubscribe;        bh=xP2yAGH02It4MpFNSJGwU0wuLUh0OVArvsvCMytfTXI=;        b=Z5SpjGwUibx43fHHQKfQcTTRNRTWg0RaJ/v1OXbdeRPqhhVSVUMMkQD7elJOitPEF7         4LNaPil2YSSzMjyIX9ypEoSziub1O4LV0Fl0ORxqoUOWQ9A743foU3eSIkufEbgulpE0         FaPcxIL9Kux0roWrOXnTOu2Fm/Q8mXPpqYSmk1COj3svknGwG0WOu+OL+c3edu2seRxP         UZFnYV03QEuYkNjlmSpzyjJA3J3jP6ZwEsF/FEwbr6wCFTQ1xc0Pget/Ll949AsMdCaR         Gl1LXKZtFORUomij0v0wvJ9mizIh0yUDOBlEfKECroah1zKhPZjJuU8NcKe8G01Iq/ic         yhvg==</li>
<li>In-reply-to: &lt;<a href="msg00356.html">f2c96790-1cdf-189b-f75a-dde8de513c10@csiro.au</a>&gt;</li>
<li>List-archive: &lt;<a href="https://groups.google.com/a/noaa.gov/group/ferret_users/">https://groups.google.com/a/noaa.gov/group/ferret_users/</a>&gt;</li>
<li>List-help: &lt;<a href="https://support.google.com/a/noaa.gov/bin/topic.py?topic=25838">https://support.google.com/a/noaa.gov/bin/topic.py?topic=25838</a>&gt;, &lt;<a href="mailto:ferret_users+help@noaa.gov">mailto:ferret_users+help@noaa.gov</a>&gt;</li>
<li>List-id: &lt;ferret_users.noaa.gov&gt;</li>
<li>List-post: &lt;<a href="https://groups.google.com/a/noaa.gov/group/ferret_users/post">https://groups.google.com/a/noaa.gov/group/ferret_users/post</a>&gt;, &lt;<a href="mailto:ferret_users@noaa.gov">mailto:ferret_users@noaa.gov</a>&gt;</li>
<li>List-unsubscribe: &lt;<a href="mailto:googlegroups-manage+809428289204+unsubscribe@googlegroups.com">mailto:googlegroups-manage+809428289204+unsubscribe@googlegroups.com</a>&gt;, &lt;<a href="https://groups.google.com/a/noaa.gov/group/ferret_users/subscribe">https://groups.google.com/a/noaa.gov/group/ferret_users/subscribe</a>&gt;</li>
<li>Mailing-list: list <a href="mailto:ferret_users@DOMAIN.HIDDEN">ferret_users@xxxxxxxx</a>; contact <a href="mailto:ferret_users%2Bowners@DOMAIN.HIDDEN">ferret_users+owners@xxxxxxxx</a></li>
<li>References: &lt;<a href="msg00348.html">CAA4txijPD1MRFHG_aWhkZYkk4kynjSfnUBWvyCJEWjrUmoksVQ@mail.gmail.com</a>&gt; &lt;<a href="msg00352.html">f48baeaa-a2c3-6155-9dde-7e29ceb91714@noaa.gov</a>&gt; &lt;<a href="msg00354.html">5b8c67e5-ba27-b34d-5b3d-d9992599cffc@csiro.au</a>&gt; &lt;<a href="msg00355.html">CAA4txiieztwmQbkQk4MBSHY+kqvxzPj0rdDcO+tbe3SXnFhV1g@mail.gmail.com</a>&gt; &lt;<a href="msg00356.html">f2c96790-1cdf-189b-f75a-dde8de513c10@csiro.au</a>&gt;</li>
<li>Sender: <a href="mailto:owner-ferret_users@DOMAIN.HIDDEN">owner-ferret_users@xxxxxxxx</a></li>
</ul>
<!--X-Head-of-Message-End-->
<!--X-Head-Body-Sep-Begin-->
<hr>
<!--X-Head-Body-Sep-End-->
<!--X-Body-of-Message-->
<div dir="ltr"><div><div><div>Hey Russ,<br><br></div>This totally works, but I need to do it for another application. There is another variable which is the cloud based height (cbh) in meters above mean sea level. I need to find the lowest interpolated zero degree level above this cbh. So is it possible to retrieve multiple zero degree level heights, then conduct it through the statement (if it&#39;s higher than cbh) and then select the lowest one?<br><br></div>Kind regards,<br><br></div>Jasper Denissen<br></div><div class="gmail_extra"><br><div class="gmail_quote">2017-05-19 4:45 GMT+02:00 Russ Fiedler <span dir="ltr">&lt;<a rel="nofollow" href="mailto:russell.fiedler@xxxxxxxx" target="_blank">russell.fiedler@xxxxxxxx</a>&gt;</span>:<br><blockquote class="gmail_quote" style="margin:0 0 0 .8ex;border-left:1px #ccc solid;padding-left:1ex">
  
    
  
  <div bgcolor="#FFFFFF" text="#000000">
    <div class="m_636239464595414496moz-cite-prefix"><br>
      Hi,<br>
      <br>
      Ah, I thought that might be a problem. You can use the event mask
      transformation @EVNT to get the last occurrence and mask out all
      the preceding<br>
      events.<br>
      <br>
<a rel="nofollow" class="m_636239464595414496moz-txt-link-freetext" href="http://ferret.pmel.noaa.gov/Ferret/documentation/users-guide/variables-xpressions/XPRESSIONS#_VPINDEXENTRY_550" target="_blank">http://ferret.pmel.noaa.gov/<wbr>Ferret/documentation/users-<wbr>guide/variables-xpressions/<wbr>XPRESSIONS#_VPINDEXENTRY_550</a><br>
      <br>
      <br>
      It&#39;s a bit tricky though.<br>
      <br>
      let event=temp[z=@EVNT:0]&#xA0; ! Increments every time temp crosses
      zero starting from the highest<br>
      let event_rev = event[z=@max] - event &#xA0; ! Reverse the order. Zero
      beneath the lowest crossing and increases thereafter<br>
      let temp_mask = if event_rev le 1 then temp&#xA0; ! We only want the
      temps surrounding the lowest crossing<br>
      let isotherm_0 = temp_mask[z=@WEQ:0] <br>
      ...<br>
      <br>
      You can also mask like this<br>
      <br>
      let event=temp[z=@EVNT:0]&#xA0; <br>
      let last_cross=event[z=@max]<br>
      let next_last=max(last_cross-1,0)<br>
      let temp_mask = if event ge next_last then temp<br>
      ...<br>
      <br>
      c.f.<br>
      <br>
<a rel="nofollow" class="m_636239464595414496moz-txt-link-freetext" href="http://ferret.pmel.noaa.gov/Ferret/faq/finding-the-location-of-last-isotherm" target="_blank">http://ferret.pmel.noaa.gov/<wbr>Ferret/faq/finding-the-<wbr>location-of-last-isotherm</a><span class="HOEnZb"><font color="#888888"><br>
      <br>
      <br>
      <br>
      Russ</font></span><div><div class="h5"><br>
      <br>
      <br>
      On 18/05/17 19:32, Jasper Denissen wrote:<br>
    </div></div></div><div><div class="h5">
    <blockquote type="cite">
      
      <div dir="ltr">
        <div>
          <div>
            <div>
              <div>Dear Ansley and Russ,<br>
                <br>
              </div>
              Thank you both for your helpful answers. I was indeed
              looking for what you mentioned Russ. But there is one
              remaining problem: In some cases there are multiple zero
              degree levels; I did some sampling and found out that when
              I execute:<br>
              <br>
              let/title=&quot;geopotential height on 0 degree isotherm&quot; z_g_0
              = integrand_0[z=@sum]&#xA0; ! interpolated Z_g<br>
              <br>
            </div>
            it gives me the heighest height at which this situation
            occurs. I&#39;d like for it to give me all interpolated heights
            at which T=0, so that I can manually select the lowest level
            (so use this variable and k=@min). Is this possible?<br>
            <br>
          </div>
          Kind regards,<br>
          <br>
        </div>
        Jasper Denissen<br>
      </div>
      <div class="gmail_extra"><br>
        <div class="gmail_quote">2017-05-18 2:44 GMT+02:00 Russ Fiedler
          <span dir="ltr">&lt;<a rel="nofollow" href="mailto:russell.fiedler@xxxxxxxx" target="_blank">russell.fiedler@xxxxxxxx</a>&gt;</span>:<br>
          <blockquote class="gmail_quote" style="margin:0 0 0 .8ex;border-left:1px #ccc solid;padding-left:1ex">Hi,<br>
            <br>
            I think Jasper actually wants @WEQ rather than @LOC since
            his independent height variable is pressure not geopotential
            height.<br>
            <br>
            <a rel="nofollow" href="http://ferret.pmel.noaa.gov/Ferret/documentation/users-guide/variables-xpressions/XPRESSIONS#_VPID_175" rel="noreferrer" target="_blank">http://ferret.pmel.noaa.gov/Fe<wbr>rret/documentation/users-guide<wbr>/variables-xpressions/XPRESSIO<wbr>NS#_VPID_175</a><br>
            <br>
            <br>
            let isotherm_0 = temp[z=@WEQ:0]&#xA0; ! pressure kernel at 0
            degrees<br>
            let integrand_0 = geopotential*isotherm_0/9.81&#xA0; !<br>
            let/title=&quot;geopotential height on 0 degree isotherm&quot; z_g_0 =
            integrand_0[z=@sum]&#xA0; ! interpolated Z_g<br>
            <br>
            <br>
            Cheers,<br>
            Russ
            <div class="m_636239464595414496HOEnZb">
              <div class="m_636239464595414496h5"><br>
                <br>
                On 18/05/17 05:17, Ansley C. Manke wrote:<br>
                <blockquote class="gmail_quote" style="margin:0 0 0 .8ex;border-left:1px #ccc solid;padding-left:1ex">
                  Hi,<br>
                  <br>
                  Look at the transformation @LOC which picks out the
                  data at a specified value.<br>
                  <br>
                  -Ansley<br>
                  <br>
                  <br>
                  On 5/17/2017 6:14 AM, Jasper Denissen wrote:<br>
                  <blockquote class="gmail_quote" style="margin:0 0 0 .8ex;border-left:1px #ccc solid;padding-left:1ex">
                    Dear ferret users,<br>
                    <br>
                    I&#39;ve got two variables, temperature T (K) and
                    geopotential Z (m^2/s^2) on 25 pressure levels and a
                    certain spatial extent. What I want to do is find
                    the exact (read linearly interpolated) height of the
                    zero degree level. All I found in the ferret
                    documentation was interpolate transformations which
                    fill data gaps, but I just need to define one
                    variable which contains the interpolated
                    geopotential height (geopotential / 9.81) at which
                    the interpolated temperature equals zero. If there
                    are several heights where T = 0, please take the
                    lowest height.<br>
                    <br>
                    I think this should be a fairly simple
                    transformation, but I can&#39;t seem to find the answer
                    myself. Someone please help me!<br>
                    <br>
                    Kind regards,<br>
                    <br>
                    Jasper Denissen<br>
                    MSc student Earth &amp; Environment<br>
                    Wageningen University<br>
                  </blockquote>
                  <br>
                </blockquote>
                <br>
              </div>
            </div>
          </blockquote>
        </div>
        <br>
      </div>
    </blockquote>
    <p><br>
    </p>
  </div></div></div>

</blockquote></div><br></div>

<!--X-Body-of-Message-End-->
<!--X-MsgBody-End-->
<!--X-Follow-Ups-->
<hr>
<!--X-Follow-Ups-End-->
<!--X-References-->
<ul><li><strong>References</strong>:
<ul>
<li><strong><a name="00348" href="msg00348.html">[ferret_users] Manually interpolate zero degree level</a></strong>
<ul><li><em>From:</em> Jasper Denissen</li></ul></li>
<li><strong><a name="00352" href="msg00352.html">Re: [ferret_users] Manually interpolate zero degree level</a></strong>
<ul><li><em>From:</em> Ansley C. Manke</li></ul></li>
<li><strong><a name="00354" href="msg00354.html">Re: [ferret_users] Manually interpolate zero degree level</a></strong>
<ul><li><em>From:</em> Russ Fiedler</li></ul></li>
<li><strong><a name="00355" href="msg00355.html">Re: [ferret_users] Manually interpolate zero degree level</a></strong>
<ul><li><em>From:</em> Jasper Denissen</li></ul></li>
<li><strong><a name="00356" href="msg00356.html">Re: [ferret_users] Manually interpolate zero degree level</a></strong>
<ul><li><em>From:</em> Russ Fiedler</li></ul></li>
</ul></li></ul>
<!--X-References-End-->
<!--X-BotPNI-->
<UL>
<li>Previous by thread:
<strong><a href="msg00356.html">Re: [ferret_users] Manually interpolate zero degree level</a></strong>
</li>
<li>Next by thread:
<strong><a href="msg00349.html">[ferret_users] Ferret and debian/ubuntu packages</a></strong>
</li>

</UL>
<center>[<a href="msg00356.html">Thread Prev</a>][<a href="msg00349.html">Thread Next</a>][<A HREF="threads.html#00358">Index</A>]</center>

<!--X-BotPNI-End-->
<!--X-User-Footer-->
<A HREF="http://ferret.pmel.noaa.gov/Ferret/contact-us">Contact Us</A>
<br>
<font size=-1>
<address>
<a href="http://www.doc.gov">Dept of Commerce</a> /
<a href="http://www.noaa.gov">NOAA</a> /
<a href="http://www.oar.noaa.gov">OAR</a> /
<a href="http://www.pmel.noaa.gov">PMEL</a> /
<a href="http://ferret.pmel.noaa.gov">Ferret</a>
</address>

<br>
 <a href="http://www.noaa.gov/privacy.html">Privacy Policy</a> | <a href="http://www.noaa.gov/disclaimer.html">Disclaimer</a> | <a href="accessibility.html">Accessibility Statement</a> 

</font>
<!--X-User-Footer-End-->
</body>
</html>
