<!-- MHonArc v2.6.18 -->
<!--X-Subject: [ferret_users] unexpected difference depending on order of integration and annual cycle -->
<!--X-From-R13: Ivyyvnz Yrffyre <jvyyvnz.f.xrffyreNabnn.tbi> -->
<!--X-Date: Wed, 22 Mar 2017 11:32:53 &#45;0700 -->
<!--X-Message-Id: 6DADBCE5&#45;7F1A&#45;4EBF&#45;AFB6&#45;DDA5416DE892@noaa.gov -->
<!--X-Content-Type: multipart/mixed -->
<!--X-Derived: gifwQSZSFXp_d.gif -->
<!--X-Derived: binfTIGkFwVHw.bin -->
<!--X-Head-End-->
<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN"
        "http://www.w3.org/TR/html4/loose.dtd">
<html>
<head>
<title>[ferret_users] unexpected difference depending on order of integration and annual cycle</title>
</head>
<body>
<!--X-Body-Begin-->
<!--X-User-Header-->
<!--X-User-Header-End-->
<!--X-TopPNI-->
<HR>
<center>[<a href="msg00226.html">Thread Prev</a>][<a href="msg00231.html">Thread Next</a>][<A HREF="threads.html#00230">Index</A>]</center>

<!--X-TopPNI-End-->
<!--X-MsgBody-->
<!--X-Subject-Header-Begin-->
<h1>[ferret_users] unexpected difference depending on order of integration and annual cycle</h1>
<hr>
<!--X-Subject-Header-End-->
<!--X-Head-of-Message-->
<ul>
<li><strong>To</strong>: <strong>Ferret &lt;<a href="mailto:ferret_users@DOMAIN.HIDDEN">ferret_users@xxxxxxxx</a>&gt;</strong></li>
<li><strong>Subject</strong>: <strong>[ferret_users] unexpected difference depending on order of integration and annual cycle</strong></li>
<li><strong>From</strong>: <strong>William Kessler &lt;<a href="mailto:william.s.kessler@DOMAIN.HIDDEN">william.s.kessler@xxxxxxxx</a>&gt;</strong></li>
<li>Date: Wed, 22 Mar 2017 11:32:46 -0700</li>
<li>Cc: &quot;William S. Kessler&quot; &lt;<a href="mailto:William.S.Kessler@DOMAIN.HIDDEN">William.S.Kessler@xxxxxxxx</a>&gt;</li>
<li>Dkim-signature: v=1; a=rsa-sha256; c=relaxed/relaxed;        d=noaa-gov.20150623.gappssmtp.com; s=20150623;        h=from:subject:date:message-id:cc:to:mime-version:x-original-sender         :x-original-authentication-results:precedence:mailing-list:list-id         :list-post:list-help:list-archive:list-unsubscribe;        bh=uG8hEIFVWuNs/0qRdzVWEDG739/TmYTYHhewjCnjMmU=;        b=stKU4gTzPKMXIXBCmTwi0f5f03oBoM4i9MvH/kNJod96Xykvcq3tMnEL0r+5XhaxbH         5SK+YpCV7xuDWB0CzddJZE5ZLYSRKELpJldbleSVgJTQbH106P2oy3bzfMs7lHF4BDq2         sWjKU+g9hvtUGmi22Ze51teUaZLh/1hdWLit2vBczpN0M+MoVSXx6xdOoZ/i9hoPb8FU         K/c+rFZtP+w43WkS5IbUFljlwgaKl4aVg6iTP0APS4rqNH8tIGakM6YgfSSNb5SKuhuF         AH4quDPPWdtDtz+juzPrhuIAunW0zeBGpJwWEruI9wimesKvD/Pr7KLzaDxsJoBq8OIa         aa0Q==</li>
<li>List-archive: &lt;<a href="https://groups.google.com/a/noaa.gov/group/ferret_users/">https://groups.google.com/a/noaa.gov/group/ferret_users/</a>&gt;</li>
<li>List-help: &lt;<a href="https://support.google.com/a/noaa.gov/bin/topic.py?topic=25838">https://support.google.com/a/noaa.gov/bin/topic.py?topic=25838</a>&gt;, &lt;<a href="mailto:ferret_users+help@noaa.gov">mailto:ferret_users+help@noaa.gov</a>&gt;</li>
<li>List-id: &lt;ferret_users.noaa.gov&gt;</li>
<li>List-post: &lt;<a href="https://groups.google.com/a/noaa.gov/group/ferret_users/post">https://groups.google.com/a/noaa.gov/group/ferret_users/post</a>&gt;, &lt;<a href="mailto:ferret_users@noaa.gov">mailto:ferret_users@noaa.gov</a>&gt;</li>
<li>List-unsubscribe: &lt;<a href="mailto:googlegroups-manage+809428289204+unsubscribe@googlegroups.com">mailto:googlegroups-manage+809428289204+unsubscribe@googlegroups.com</a>&gt;, &lt;<a href="https://groups.google.com/a/noaa.gov/group/ferret_users/subscribe">https://groups.google.com/a/noaa.gov/group/ferret_users/subscribe</a>&gt;</li>
<li>Mailing-list: list <a href="mailto:ferret_users@DOMAIN.HIDDEN">ferret_users@xxxxxxxx</a>; contact <a href="mailto:ferret_users%2Bowners@DOMAIN.HIDDEN">ferret_users+owners@xxxxxxxx</a></li>
<li>Sender: <a href="mailto:owner-ferret_users@DOMAIN.HIDDEN">owner-ferret_users@xxxxxxxx</a></li>
</ul>
<!--X-Head-of-Message-End-->
<!--X-Head-Body-Sep-Begin-->
<hr>
<!--X-Head-Body-Sep-End-->
<!--X-Body-of-Message-->
<pre>Hi Ferreters -

I have a confusing difference in result depending on the order of operations. These should all be linear operations, so the order of doing them should not affect the result. I'm confused. 

The differences are smallish but could be significant. This is, by the way, the Ekman transport across 7.5S, and the differences are a few Sv.

In one case, I first find the annual cycle, then integrate the result in x. In the other, I first integrate in x, then find the annual cycle of the result. These should be identical, but aren't (attached gif plot). I don't know which is correct.

Why not? 

The attached cdf file (357Kb) has 5 variables:

VAR      original time series       
VAR_CL   annual cycle of original   
VAR_INT  x-integral of original     
VAR_INTCL  annual cycle of x-integral 
VAR_CLINT   x-integral of annual cycle 

These variables were defined by the following commands:

yes? let/tit=&quot;original time series&quot; var=eky[y=7.5s,x=148e:82w]
yes? let/tit=&quot;annual cycle of original&quot; var_cl=var[gt=month_irreg@mod]
yes? let/tit=&quot;x-integral of original&quot; var_int=var[x=@din]
yes? let/tit=&quot;annual cycle of x-integral&quot; var_intcl=var_int[gt=month_irreg@mod]
yes? let/tit=&quot;x-integral of annual cycle&quot; var_clint=var_cl[x=@din]
yes? save/outtype=float/file=check_order_of_operations.cdf var,var_cl,var_int,var_intcl,var_clint

yes? plot/line/sym=27 var_intcl,var_clint

This is Ferret v6.94 (Mac)
~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
William S. Kessler
NOAA / Pacific Marine Environmental Laboratory
7600 Sand Point Way NE
Seattle WA 98115 USA

william.s.kessler@xxxxxxxx
Tel: +1 206-526-6221
Fax: +1 206-526-6744
</pre><p><a href="gifwQSZSFXp_d.gif" ><img src="gifwQSZSFXp_d.gif" alt="GIF image"></a></p>
<pre>

</pre><p><strong>Attachment:
<a href="binfTIGkFwVHw.bin" ><tt>check_order_of_operations.cdf</tt></a></strong><br>
<em>Description:</em> Binary data</p>

<!--X-Body-of-Message-End-->
<!--X-MsgBody-End-->
<!--X-Follow-Ups-->
<hr>
<ul><li><strong>Follow-Ups</strong>:
<ul>
<li><strong><a name="00231" href="msg00231.html">Re: [ferret_users] unexpected difference depending on order of integration and annual cycle</a></strong>
<ul><li><em>From:</em> Martin Schmidt</li></ul></li>
</ul></li></ul>
<!--X-Follow-Ups-End-->
<!--X-References-->
<!--X-References-End-->
<!--X-BotPNI-->
<UL>
<li>Previous by thread:
<strong><a href="msg00226.html">[ferret_users] PyFerret 7.1 on Mac OS X 10.12 ?</a></strong>
</li>
<li>Next by thread:
<strong><a href="msg00231.html">Re: [ferret_users] unexpected difference depending on order of integration and annual cycle</a></strong>
</li>

</UL>
<center>[<a href="msg00226.html">Thread Prev</a>][<a href="msg00231.html">Thread Next</a>][<A HREF="threads.html#00230">Index</A>]</center>

<!--X-BotPNI-End-->
<!--X-User-Footer-->
<A HREF="http://ferret.pmel.noaa.gov/Ferret/contact-us">Contact Us</A>
<br>
<font size=-1>
<address>
<a href="http://www.doc.gov">Dept of Commerce</a> /
<a href="http://www.noaa.gov">NOAA</a> /
<a href="http://www.oar.noaa.gov">OAR</a> /
<a href="http://www.pmel.noaa.gov">PMEL</a> /
<a href="http://ferret.pmel.noaa.gov">Ferret</a>
</address>

<br>
 <a href="http://www.noaa.gov/privacy.html">Privacy Policy</a> | <a href="http://www.noaa.gov/disclaimer.html">Disclaimer</a> | <a href="accessibility.html">Accessibility Statement</a> 

</font>
<!--X-User-Footer-End-->
</body>
</html>
