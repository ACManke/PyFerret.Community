<!-- MHonArc v2.6.18 -->
<!--X-Subject: Re: [ferret_users] Re: memory strategies for handling large computational requests -->
<!--X-From-R13: @vpbynf Terlpurg <avpbynf.serlpurgNtznvy.pbz> -->
<!--X-Date: Wed, 22 Nov 2017 10:48:32 &#45;0800 -->
<!--X-Message-Id: CAPTKT0dncO8ZgUM22Xc=Ge1PGPjNA7pHt97US_=FZ7e69UMc3Q@mail.gmail.com -->
<!--X-Content-Type: multipart/alternative -->
<!--X-Reference: 400769719.1005202.1511348224834.JavaMail.zimbra@lsce.ipsl.fr -->
<!--X-Reference: DB6PR0602MB28693D48A23DD1612203758596200@DB6PR0602MB2869.eurprd06.prod.outlook.com -->
<!--X-Reference: 1651150376.1183719.1511370528931.JavaMail.zimbra@lsce.ipsl.fr -->
<!--X-Head-End-->
<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN"
        "http://www.w3.org/TR/html4/loose.dtd">
<html>
<head>
<title>Re: [ferret_users] Re: memory strategies for handling large computational requests</title>
</head>
<body>
<!--X-Body-Begin-->
<!--X-User-Header-->
<!--X-User-Header-End-->
<!--X-TopPNI-->
<HR>
<center>[<a href="msg00678.html">Thread Prev</a>][<a href="msg00684.html">Thread Next</a>][<A HREF="threads.html#00679">Index</A>]</center>

<!--X-TopPNI-End-->
<!--X-MsgBody-->
<!--X-Subject-Header-Begin-->
<h1>Re: [ferret_users] Re: memory strategies for handling large computational requests</h1>
<hr>
<!--X-Subject-Header-End-->
<!--X-Head-of-Message-->
<ul>
<li><strong>To</strong>: <strong>Patrick Brockmann &lt;<a href="mailto:patrick.brockmann@DOMAIN.HIDDEN">patrick.brockmann@xxxxxxxxxxxx</a>&gt;</strong></li>
<li><strong>Subject</strong>: <strong>Re: [ferret_users] Re: memory strategies for handling large computational requests</strong></li>
<li><strong>From</strong>: <strong>Nicolas Freychet &lt;<a href="mailto:nicolas.freychet@DOMAIN.HIDDEN">nicolas.freychet@xxxxxxxxx</a>&gt;</strong></li>
<li>Date: Wed, 22 Nov 2017 18:48:20 +0000</li>
<li>Arc-authentication-results: i=4; mx.google.com;       dkim=pass header.i=@gmail.com header.s=20161025 header.b=OUPDthJN;       arc=pass (i=2 dkim=pass dkdomain=gmail.com);       spf=softfail (google.com: domain of transitioning <a href="mailto:nicolas.freychet@DOMAIN.HIDDEN">nicolas.freychet@xxxxxxxxx</a> does not designate 52.222.5.176 as permitted sender) smtp.mailfrom=<a href="mailto:nicolas.freychet@DOMAIN.HIDDEN">nicolas.freychet@xxxxxxxxx</a>;       dmarc=pass (p=NONE sp=NONE dis=NONE) header.from=gmail.com</li>
<li>Arc-authentication-results: i=3; mx.google.com;       dkim=pass header.i=@gmail.com header.s=20161025 header.b=OUPDthJN;       arc=pass (i=2 dkim=pass dkdomain=gmail.com);       spf=softfail (google.com: domain of transitioning <a href="mailto:nicolas.freychet@DOMAIN.HIDDEN">nicolas.freychet@xxxxxxxxx</a> does not designate 52.222.5.176 as permitted sender) smtp.mailfrom=<a href="mailto:nicolas.freychet@DOMAIN.HIDDEN">nicolas.freychet@xxxxxxxxx</a>;       dmarc=pass (p=NONE sp=NONE dis=NONE) header.from=gmail.com</li>
<li>Arc-authentication-results: i=2; mx.google.com;       dkim=pass header.i=@gmail.com header.s=20161025 header.b=OUPDthJN;       arc=pass (i=1 spf=pass spfdomain=gmail.com dkim=pass dkdomain=gmail.com dmarc=pass fromdomain=gmail.com);       spf=softfail (google.com: domain of transitioning <a href="mailto:nicolas.freychet@DOMAIN.HIDDEN">nicolas.freychet@xxxxxxxxx</a> does not designate 65.127.216.227 as permitted sender) smtp.mailfrom=<a href="mailto:nicolas.freychet@DOMAIN.HIDDEN">nicolas.freychet@xxxxxxxxx</a></li>
<li>Arc-authentication-results: i=1; mx.google.com;       dkim=pass header.i=@gmail.com header.s=20161025 header.b=OUPDthJN;       spf=pass (google.com: domain of <a href="mailto:nicolas.freychet@DOMAIN.HIDDEN">nicolas.freychet@xxxxxxxxx</a> designates 209.85.220.41 as permitted sender) smtp.mailfrom=<a href="mailto:nicolas.freychet@DOMAIN.HIDDEN">nicolas.freychet@xxxxxxxxx</a>;       dmarc=pass (p=NONE sp=NONE dis=NONE) header.from=gmail.com</li>
<li>Arc-message-signature: i=4; a=rsa-sha256; c=relaxed/relaxed; d=google.com; s=arc-20160816;        h=list-archive:list-help:list-post:list-id:mailing-list:precedence:cc         :to:subject:date:from:references:in-reply-to:mime-version         :arc-authentication-results:arc-message-signature         :arc-authentication-results:arc-message-signature:message-id         :arc-authentication-results:arc-message-signature:dkim-signature         :arc-authentication-results;        bh=6z/AXi7vl1MJxX//K1KxtE9fbNO4O1uBD5S0u7q9tTQ=;        b=FvoKUPS9oJjDo+j3z36Y/Ch+olGvCqXXLQUMQle85mchIHfHtKZbMwRiuYGk4KYGq8         Oq0HAUGvpoK4VSsZ/R0jkN/irQv50jbuZqhFQU1z4brUkmYtEQCV5AdJ/fLV2RePBvQ1         6nlbRUK5U0DEtYGs3/YbpoyNw8Z7/WYSLiT5LjV+2Qr53lNMhhoxiPOtA6SQ1iL/PKIl         z+WyGpd8KHgl4DIPfLBanjvbTGQfDeMovCJ5JjXdzL6hiNfYFzBfLUvz+yCIEDY/JH1H         04LKHsVwhxaLasg6B5vtjp/DSIXXwOc25sGXV1gSi+RnTI4K1kPNQeJjXkRtlISCTuUt         jINQ==</li>
<li>Arc-message-signature: i=3; a=rsa-sha256; c=relaxed/relaxed; d=google.com; s=arc-20160816;        h=cc:to:subject:date:from:references:in-reply-to:mime-version         :dkim-signature:arc-authentication-results:arc-message-signature         :arc-authentication-results:arc-message-signature:message-id         :arc-authentication-results;        bh=6z/AXi7vl1MJxX//K1KxtE9fbNO4O1uBD5S0u7q9tTQ=;        b=SikacqSxNMV/tO39sywcfTQE9VLvkmCFpTtSWOQg1NdkbYBrNg1ni1hBlTCAu+7Jzg         z6rli/jeJUS+nGdoNL1jbGFawqLsVIX0Km0tqT3Jpzx0qAWqJ70SpXCchCnR3R8H4L7n         9Ngvhc1m0CGN1+d5pAGxbamFdngZa+Ytqbtq3Vk0mA0HGPaKO5iDR27xREltu4JsuDlw         SjtGVGkocLAEo0ibLwBr/xKXsKwBol9aQ3TpspWRg8cFFfriQfaYqj7/5UZ1FIREawA4         p58H878RZDC/3+y+hp/kWArUgPlNGcz55GAAiuu5Hc0mKcJJ3vLpHRbDFbMDmWnGE4zI         NAKw==</li>
<li>Arc-message-signature: i=2; a=rsa-sha256; c=relaxed/relaxed; d=google.com; s=arc-20160816;        h=cc:to:subject:message-id:date:from:references:in-reply-to         :mime-version:dkim-signature:arc-authentication-results         :arc-message-signature:arc-authentication-results;        bh=6z/AXi7vl1MJxX//K1KxtE9fbNO4O1uBD5S0u7q9tTQ=;        b=EdXfmVfcrAI5fEhMzvmUaKEN2qipENjo6+Tk9s+U99c+xC5qCPd8VWvqoNSVvsn6VL         kA97a9AYiaESpePLtk7wojhzKvXvFaH/6yOlZZ7gZxPCRgzc/i7MI8dsHb7uo5V3Ru6S         pT3ofiED3KcRzrdO9W+s+vUghtZ6YL7+Ir3WyNeK8yyRAsIMGFZr+kLzwgFs6/PAGvfg         kSqDDCKK6gMuRAlCg+Z52RkMJqfDdLk5NXk8Fks7/fJuCNv5YpTPtbK7RNURTdAjKhya         qnZbzlUQ3GLv1sUsasJ2d/Ta0/1rWJwkmPu7YQ3SS8mpnFmq7bSAbIAc7TJoRzLx5b1E         GAxw==</li>
<li>Arc-message-signature: i=1; a=rsa-sha256; c=relaxed/relaxed; d=google.com; s=arc-20160816;        h=cc:to:subject:message-id:date:from:references:in-reply-to         :mime-version:dkim-signature:arc-authentication-results;        bh=6z/AXi7vl1MJxX//K1KxtE9fbNO4O1uBD5S0u7q9tTQ=;        b=XR90N5db0WyBWq1bbSFCXB59Saa6/GkEwZv+Mq+W+jTAG+OqLg22En+kgEDL3/K2+6         dqIGD1AZcRNg2iCSpQyZu1xangstJ2PL5wZi0g0oHqigEVaGdpK9VtGeqehbFbK1Tevh         UqcU5eTtd5mBXWp5ELcNRlT/tTP2CJAX1a3XHdc+sRldOjaxV1ruPVNEm1fwrKk7UcaL         P31kicd1oMZI2oqZAJGrBQ1SG0HUFB2IUoJ4tgdLuzJFDGApmh9wwPwrryEsBXAQi2qs         iBPzZ/slI/+ZKIz96aBE1FIjUU2DkHQpF3FQ/08j36JP6PZV6RRFhTFwo+69GuZWR/Py         RMKg==</li>
<li>Arc-seal: i=4; a=rsa-sha256; t=1511376511; cv=pass;        d=google.com; s=arc-20160816;        b=sNA0xRlQl+04P82NDzu6g+sZ936BLxscbxD50VQCevw7ihPAAs0Lw9Szu6Buop+v5C         C+l0WJxYshq1BSfztXTkclm/Vlqk7LppPEojBqfannKXMZYHZ3Q/Xodp8mcmPPwxrI7l         bHedo3zpEPwjoT6zamlmfXWxLh4hQzlrnb/3QaCRLqIJXx1z6tKcrH0+JfCl+6NE02dx         jWmKAck5wnjzmYRbaA20FsrbHSBTVHWg7FTkB27zkMJ/M/N1+eAvCFFz/IDmsI2g6QQz         qSBObyFeDGRvXMWcDCB3KqOGweDnJNXtHJQWR8o2Xcp/m+51WT8dMtrN93/DUWMZPuAa         EwBw==</li>
<li>Arc-seal: i=3; a=rsa-sha256; t=1511376511; cv=pass;        d=google.com; s=arc-20160816;        b=PWNS2dWDznzt7fqqPfD6EkExUjKdtahU8i+cOlM6K96r6G0ZrgAgiYa8td+NETQMDJ         XCOUlsp4UEOHszTWL+42WckkEEK4Ayb+giAzFb26+ijvuHNR32hPBWaS8ePgB+GUBKj7         nQxfWvv+JffmCyNnvxx/ZAr2k7Due1ru9YsvUM+8yRbkcHSqHHy7FhwSMBrmQW9wZO14         sDhFa/LujLTxwl915220LHrlJMN9K5KnilWFiWZU7/4zdePHL0BxP20ymIu+65IeK8eo         Zu4Y45wTRK/GY1mVdBGwlh+YXZfaQyizfmf+cLzHIyiXe6GBZgXV6N4FbXm7Aso4AsYP         1tVA==</li>
<li>Arc-seal: i=2; a=rsa-sha256; t=1511376505; cv=pass;        d=google.com; s=arc-20160816;        b=gcUnaCCRxaK+URXX311pZq3pxLpiXqkpskxXa88FaPlZ6LB5woRj5T0voeqs8iJybS         bLSFe8SxceoIIn5efK7IDZr9NwMPg6Kygr28Ku3LjYlhq0MWRBx1/bys8NWc/BbzKBW1         5hqUHCDVDCbn09iGQnAMZ+j8+orVFcrbdjoNTtWe3tBA+GCtBZqsJPuRyOzEQMrs+uk1         ITx+I/jqMvE4Xmz1s1qRhM8WO9pbp4rdr96+PhDtpW1Bf0Jqhh3z6cbNX02U8QsxDoRV         dFezclsR/U4ai6DUrBH5ygseOhcradzhQMA37BVgh5M6706/1ZW1fypTlgj+EBOWa8eR         aZ5w==</li>
<li>Arc-seal: i=1; a=rsa-sha256; t=1511376501; cv=none;        d=google.com; s=arc-20160816;        b=IBcPYZEthqtvb9wCwT+NM5WSXDEmGRpkiusU4+FWOR+SQMqExr76l3m9FwuDEJUi7I         oInNIEwpzVdZ/95u73OcnOvLX1Smht2X/N7v1tXmtm79Kzm1s/INrMzkAc52iIrMhwVZ         rjZ6wUMMaXRs11HcAmhW7EqJ7c09uHcSzdceZ7nbn3btqeMjmRikeTfpCbI/sXR1GxfX         y3DFP7rSYv94I9zscPH/EL0OtUESOSzZWekC4fZrTrMSPQ4Q20xA7K6xN+Fvk7mkBqiX         w4m1fa5YopG9kLO3coYUmHhWiKUJq3GK1K33EpoxvSKfaOQWWTG7ww+EGTINJYhf5L4Y         ksjA==</li>
<li>Cc: &quot;Kaduk, Jorg D. (Dr.)&quot; &lt;<a href="mailto:jk61@DOMAIN.HIDDEN">jk61@xxxxxxxxxxxxxxx</a>&gt;,        ferret users &lt;<a href="mailto:ferret_users@DOMAIN.HIDDEN">ferret_users@xxxxxxxx</a>&gt;</li>
<li>Dkim-signature: v=1; a=rsa-sha256; c=relaxed/relaxed;        d=noaa-gov.20150623.gappssmtp.com; s=20150623;        h=message-id:mime-version:in-reply-to:references:from:date:subject:to         :cc:x-original-sender:x-original-authentication-results:precedence         :mailing-list:list-id:list-post:list-help:list-archive;        bh=6z/AXi7vl1MJxX//K1KxtE9fbNO4O1uBD5S0u7q9tTQ=;        b=Naq1W21VZaj+DCRBOmjq0wn0kF5adXpW5U7NwbdoYGOhZa319TWbbiNzx/sSzEmjUz         JIttIQrsEi9hYHia4/CPmzgt1GxAF7T466ECq4L85qqiuO8Jyl9uGWW218gbKhS/+R5T         swhCV68opmexLUkQ4MllkzbZkRgmNfba+FyPYiwhzpNBpCyUG3oPbSIUxygdRRMp8vh3         Shs4IW6WiYvE5e0rfXjFI+GOoXzse2L5TRp+hfjGTjMPskiY3Io676vDwmNdiSNu0GDK         SlVeT3DP3suGVj2brfhQm7qiE8I/9ODdRzGxObZvJ7sIecfDZZUVWYsMy2sv3/blb5OP         RiUw==</li>
<li>In-reply-to: &lt;<a href="msg00678.html">1651150376.1183719.1511370528931.JavaMail.zimbra@lsce.ipsl.fr</a>&gt;</li>
<li>List-archive: &lt;<a href="https://groups.google.com/a/noaa.gov/group/ferret_users/">https://groups.google.com/a/noaa.gov/group/ferret_users/</a>&gt;</li>
<li>List-help: &lt;<a href="https://support.google.com/a/noaa.gov/bin/topic.py?topic=25838">https://support.google.com/a/noaa.gov/bin/topic.py?topic=25838</a>&gt;, &lt;<a href="mailto:ferret_users+help@noaa.gov">mailto:ferret_users+help@noaa.gov</a>&gt;</li>
<li>List-id: &lt;ferret_users.noaa.gov&gt;</li>
<li>List-post: &lt;<a href="https://groups.google.com/a/noaa.gov/group/ferret_users/post">https://groups.google.com/a/noaa.gov/group/ferret_users/post</a>&gt;, &lt;<a href="mailto:ferret_users@noaa.gov">mailto:ferret_users@noaa.gov</a>&gt;</li>
<li>Mailing-list: list <a href="mailto:ferret_users@DOMAIN.HIDDEN">ferret_users@xxxxxxxx</a>; contact <a href="mailto:ferret_users%2Bowners@DOMAIN.HIDDEN">ferret_users+owners@xxxxxxxx</a></li>
<li>References: &lt;<a href="msg00676.html">400769719.1005202.1511348224834.JavaMail.zimbra@lsce.ipsl.fr</a>&gt; &lt;<a href="msg00677.html">DB6PR0602MB28693D48A23DD1612203758596200@DB6PR0602MB2869.eurprd06.prod.outlook.com</a>&gt; &lt;<a href="msg00678.html">1651150376.1183719.1511370528931.JavaMail.zimbra@lsce.ipsl.fr</a>&gt;</li>
<li>Sender: <a href="mailto:owner-ferret_users@DOMAIN.HIDDEN">owner-ferret_users@xxxxxxxx</a></li>
</ul>
<!--X-Head-of-Message-End-->
<!--X-Head-Body-Sep-Begin-->
<hr>
<!--X-Head-Body-Sep-End-->
<!--X-Body-of-Message-->
<div dir="ltr"><div><div><div><div><div>Hi Patrick, <br><br></div>What I would do in your case (if you just want to use Ferret), is to first record in a new file the output of your spatial average and vertical integration. As it may be to large to write at once, you can loop through the time index, something like: <br><br>use <a rel="nofollow" href="http://CM6012.1-pi-ttop-02_23200101_30091231_1M_transpir.nc" target="_blank">CM6012.1-pi-ttop-02_23200101_<wbr>30091231_1M_transpir.nc</a><br>let vardata=TRANSPIR[k=@sum, x=@ave, y=@ave]<br></div>repeat/range=1:1200/name=idloop (save/append/file=TMPfile.nc vardata[l=&#39;idloop&#39;] )<br><br></div>Then you cancel your first data, or at least the definition of &quot;var&quot; <br></div>cancel data/all<br></div>cancel var/all<br><div><div><div><div><br></div><div>You load your TMPfile.nc, and plot the data (as it&#39;s just a time series, now you can apply the @sbx:120 easily)</div><div><br></div><div>It may not be the most optimal way, but at least it&#39;s working ;)</div><div><br></div><div>Cheers,</div><div>Nico</div><div><br></div><div><br></div></div></div></div></div><div class="gmail_extra"><br><div class="gmail_quote">2017-11-22 17:08 GMT+00:00 Patrick Brockmann <span dir="ltr">&lt;<a rel="nofollow" href="mailto:patrick.brockmann@xxxxxxxxxxxx" target="_blank">patrick.brockmann@xxxxxxxxxxxx</a>&gt;</span>:<br><blockquote class="gmail_quote" style="margin:0 0 0 .8ex;border-left:1px #ccc solid;padding-left:1ex"><div><div style="font-family:arial,helvetica,sans-serif;font-size:12pt;color:#000000"><div>Hi J&#xF6;rg,<br></div><div><br></div><div>Thank you for your answer.<br></div><div>You are right, nco commands are sometimes a good choice to perform calculations.<br></div><div>But the example I have detailled is a very simple case of more complicated calculs where all the </div><div>nested variable definitions offered by ferret and its grammar is very well adapted.</div><div>It means opening multiple files, combining variables with different conditionnal definitions, producing<br></div><div>a plot with a same concise code.<br></div><div><br></div><div>I think it would be quite a big job to translate those ferret scripts with nco commands, </div><div>even with the ncap2 command that it is powerfull. So I would like to stay with ferret processing </div><div>in my case and get a solution to handle processings for &quot;large&quot; time series.<br></div><div></div><div><br></div><div>Best regards<br></div><span class=""><div>Patrick<br></div><div><br></div><div>--<br>Data Analysis and Visualization Engineer<br>LSCE/IPSL, CEA-CNRS-UVSQ laboratory<br>LSCE - Climate and Environment Sciences Laboratory<br>IPSL - Institut Pierre Simon Laplace<br>--</div><div><br></div></span></div></div></blockquote></div><br><br clear="all"><br>-- <br><div class="gmail_signature" data-smartmail="gmail_signature"><div dir="ltr"><div><div dir="ltr">----------------------------------------------------<br><div>Nicolas Freychet<br></div>PDRA, School of Geosciences<br>University of Edinburgh<br>----------------------------------------------------</div></div></div></div>
</div>

<!--X-Body-of-Message-End-->
<!--X-MsgBody-End-->
<!--X-Follow-Ups-->
<hr>
<!--X-Follow-Ups-End-->
<!--X-References-->
<ul><li><strong>References</strong>:
<ul>
<li><strong><a name="00676" href="msg00676.html">[ferret_users] memory strategies for handling large computational requests</a></strong>
<ul><li><em>From:</em> Patrick Brockmann</li></ul></li>
<li><strong><a name="00677" href="msg00677.html">[ferret_users] RE: memory strategies for handling large computational requests</a></strong>
<ul><li><em>From:</em> Kaduk, Jorg D. (Dr.)</li></ul></li>
<li><strong><a name="00678" href="msg00678.html">[ferret_users] Re: memory strategies for handling large computational requests</a></strong>
<ul><li><em>From:</em> Patrick Brockmann</li></ul></li>
</ul></li></ul>
<!--X-References-End-->
<!--X-BotPNI-->
<UL>
<li>Previous by thread:
<strong><a href="msg00678.html">[ferret_users] Re: memory strategies for handling large computational requests</a></strong>
</li>
<li>Next by thread:
<strong><a href="msg00684.html">Re: [ferret_users] memory strategies for handling large computational requests</a></strong>
</li>

</UL>
<center>[<a href="msg00678.html">Thread Prev</a>][<a href="msg00684.html">Thread Next</a>][<A HREF="threads.html#00679">Index</A>]</center>

<!--X-BotPNI-End-->
<!--X-User-Footer-->
<A HREF="http://ferret.pmel.noaa.gov/Ferret/contact-us">Contact Us</A>
<br>
<font size=-1>
<address>
<a href="http://www.doc.gov">Dept of Commerce</a> /
<a href="http://www.noaa.gov">NOAA</a> /
<a href="http://www.oar.noaa.gov">OAR</a> /
<a href="http://www.pmel.noaa.gov">PMEL</a> /
<a href="http://ferret.pmel.noaa.gov">Ferret</a>
</address>

<br>
 <a href="http://www.noaa.gov/privacy.html">Privacy Policy</a> | <a href="http://www.noaa.gov/disclaimer.html">Disclaimer</a> | <a href="accessibility.html">Accessibility Statement</a> 

</font>
<!--X-User-Footer-End-->
</body>
</html>
