<!-- MHonArc v2.6.18 -->
<!--X-Subject: [ferret_users] @FNR in 2D fills up x dimension first -->
<!--X-From-R13: Vryyn Dvrqr <Vryyn.DvrqrNqjq.qr> -->
<!--X-Date: Thu, 28 Jun 2018 07:38:10 &#45;0700 -->
<!--X-Message-Id: b707eb3a&#45;0146&#45;60d9&#45;b4c5&#45;9c768979a732@exch.dwd.de -->
<!--X-Content-Type: multipart/mixed -->
<!--X-Derived: pngZ8_6RK0jmy.png -->
<!--X-Derived: pngPPwbCWZpUA.png -->
<!--X-Derived: pngllz_VKraDs.png -->
<!--X-Head-End-->
<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN"
        "http://www.w3.org/TR/html4/loose.dtd">
<html>
<head>
<title>[ferret_users] @FNR in 2D fills up x dimension first</title>
</head>
<body>
<!--X-Body-Begin-->
<!--X-User-Header-->
<!--X-User-Header-End-->
<!--X-TopPNI-->
<HR>
<center>[<a href="msg00213.html">Thread Prev</a>][<a href="msg00220.html">Thread Next</a>][<A HREF="threads.html#00218">Index</A>]</center>

<!--X-TopPNI-End-->
<!--X-MsgBody-->
<!--X-Subject-Header-Begin-->
<h1>[ferret_users] @FNR in 2D fills up x dimension first</h1>
<hr>
<!--X-Subject-Header-End-->
<!--X-Head-of-Message-->
<ul>
<li><strong>To</strong>: <strong>ferret users &lt;<a href="mailto:ferret_users@DOMAIN.HIDDEN">ferret_users@xxxxxxxx</a>&gt;</strong></li>
<li><strong>Subject</strong>: <strong>[ferret_users] @FNR in 2D fills up x dimension first</strong></li>
<li><strong>From</strong>: <strong>Hella Riede &lt;<a href="mailto:Hella.Riede@DOMAIN.HIDDEN">Hella.Riede@xxxxxx</a>&gt;</strong></li>
<li>Date: Thu, 28 Jun 2018 16:37:55 +0200</li>
<li>Arc-authentication-results: i=3; mx.google.com;       arc=pass (i=2);       spf=softfail (google.com: domain of transitioning <a href="mailto:hella.riede@DOMAIN.HIDDEN">hella.riede@xxxxxx</a> does not designate 52.222.5.176 as permitted sender) smtp.mailfrom=<a href="mailto:hella.riede@DOMAIN.HIDDEN">hella.riede@xxxxxx</a></li>
<li>Arc-authentication-results: i=2; mx.google.com;       arc=pass (i=1 spf=pass spfdomain=dwd.de);       spf=softfail (google.com: domain of transitioning <a href="mailto:hella.riede@DOMAIN.HIDDEN">hella.riede@xxxxxx</a> does not designate 65.127.216.228 as permitted sender) smtp.mailfrom=<a href="mailto:Hella.Riede@DOMAIN.HIDDEN">Hella.Riede@xxxxxx</a></li>
<li>Arc-authentication-results: i=1; mx.google.com;       spf=pass (google.com: domain of <a href="mailto:hella.riede@DOMAIN.HIDDEN">hella.riede@xxxxxx</a> designates 141.38.3.245 as permitted sender) smtp.mailfrom=<a href="mailto:Hella.Riede@DOMAIN.HIDDEN">Hella.Riede@xxxxxx</a></li>
<li>Arc-message-signature: i=3; a=rsa-sha256; c=relaxed/relaxed; d=google.com; s=arc-20160816;        h=message-id:content-language:mime-version:user-agent:date:subject         :organization:from:to:arc-authentication-results         :arc-message-signature:arc-authentication-results         :arc-message-signature:arc-authentication-results;        bh=QGMEJE2E570uVXIm+6CCwai4RuzfvY6xMTwrr9vxXdE=;        b=VrGsGK5cEUFfsdQK/CkKEcRbO4GokMDKwYK7uE5+0i/Hd52BVGFx0PCu655HpBTN5F         ahgMqDE5DTOBfR/+J34R9kEv+GHrI8k8iTHpHUfo+jGY6qMLUJ4d44Po3DGW10yMnewt         d1lVpIoDu7/qhjHV6vrBcCpRTZZI/imZ7+iO+c6qG7UbMnqea2zWgFhU/9at9U8Y4Uvr         zj22F+t68Rf2fM/GVXwBGDy0HZ3Q9qywLlKdQdFmjytL0YjBLsUvnsnSDUyOv2KwzRCf         ROalDSGItAWSg8nLMt51+9+PUYvzqz+pOuWwbinv3NcC+iZqAm6gptPA5f6wJLhGTAXG         E96A==</li>
<li>Arc-message-signature: i=2; a=rsa-sha256; c=relaxed/relaxed; d=google.com; s=arc-20160816;        h=content-language:mime-version:user-agent:date:message-id:subject         :organization:from:to:arc-authentication-results         :arc-message-signature:arc-authentication-results;        bh=QGMEJE2E570uVXIm+6CCwai4RuzfvY6xMTwrr9vxXdE=;        b=SKa4nwEJUP4AXDT49EWtpIG7JufzNNzd8hHIuXTLai/MJi3LhLz22zlbRB66gGPfI0         M7APu/RwuDUuJ9jDeSRffv42DAM5OXzvAjsCc0CkFDsnwAyTPjJKa110x0lEiQGjp9VS         XDk/Em4VJAZGPTHbbP0d9SpRPC67AthJe6TDyIlgk9RHVQb2mHUC2p6z322/RyE3jske         Su+OO84cmzC3T0A+2dbH3Yia5Lh8UiMU4oHlzOgkaEvINOGMeLa66MNW9qhuxdi/77Pk         N2DnXh7xMxOTd3TbO8hS7IQ5D+/zNBvz8sEOFvhFcjKrrNGAijk7qQorJcMIPWWGsgCM         hudw==</li>
<li>Arc-message-signature: i=1; a=rsa-sha256; c=relaxed/relaxed; d=google.com; s=arc-20160816;        h=content-language:mime-version:user-agent:date:message-id:subject         :organization:from:to:arc-authentication-results;        bh=QGMEJE2E570uVXIm+6CCwai4RuzfvY6xMTwrr9vxXdE=;        b=o9ZBTVV1yxRdvCSHLCnsA9ygQ655RByz4R0bWxpOgzGWng69GfpIlFPGIH4Z1VJFuF         BgVAYDpRguuYBBbvSdCPIwnnk6UoASqUcZj0tcDxZINfhhAcrLVucUCeM/21Vyi0NdOu         mmtbx49oChXkflZOzC+uVDqWa6ahNINMdByohsmZu2UJqi1GDPUzWOTe95Zhe23Vr1Iu         hDYrPg8ewvcwqEZ4JgTunuTCKUfWQJW0WKXXiMDaa5aCVG0flpbPAaZQ1ncBiDe2Jewo         vIkHg3PAX52LiSa+2hjSJTelzNOm9dP6jR06HRZDiUqZIdb1uSn/2kKkMvKwzEdtec6+         bEzg==</li>
<li>Arc-seal: i=3; a=rsa-sha256; t=1530196688; cv=pass;        d=google.com; s=arc-20160816;        b=n6l0Ie4M9SocdcJHBdzLa6AtqffSOvHdpkQMGfaepbBLWV0kK3fNFGKCI37kvusgM/         r4Z6yfoGAioj3W1QFhMrbMVTjT0UnFS9kM6X5Js1Cvm2rP0W+mAfHjm4LHkMp437os4s         KTs8ybsmSe3DWPku+g33qyN3ROcb2V4Dlvn0+iQabdZ57rVyV71ZdKluYOQt6IN3GiUx         LtbKVUC2NXIc74qWCsu4Xmz11HnyiJUxUX3C+VrlLjzYNV/t+Q3b/mD7MxtmZGnPNKVr         Rz3XbnDStyR7rVf6eGEx2+JeSO0N7Q3h8Rh0fxcuJegtHesuJlvRV8qVy1OMwZnojkC9         rD/g==</li>
<li>Arc-seal: i=2; a=rsa-sha256; t=1530196682; cv=pass;        d=google.com; s=arc-20160816;        b=Lm81U26sJCYqf0IC6a1QphSnkIDp4taIVcnw5JhIInUpqgaKMj8kY5KuuxCfekGLkp         NZ6e5jfMJkr72Xb8EzzvwERpGz5aeQeWhMNmlQPQQo0N4ixASHVwBgCH0COTeuRNlPT0         LWyRHWPDBDZjMICvNz1e5bnv8WKZacV3pJ1CdlM4teK3/VDeYXtSz6KSVV4dVWeYNkHu         ovfWreQpdFqfSwC5APkVWU+kGGhhYLTku7CjcRNZ3G7G23JqBqHPUTiNyvqCeI31/z+m         RLunZWUco8lgUdzd0cBGE0qpW/8GCDDMiEFp04iMoAwtE3wpJb/segXSZmyN5mDdIE/l         qwhA==</li>
<li>Arc-seal: i=1; a=rsa-sha256; t=1530196676; cv=none;        d=google.com; s=arc-20160816;        b=MWAZoEzam9WAPVgRAPy6HCnGqI4xRcMwaYz5ecyYzQtgI6anpCDeIkhPlUkPzItYq/         VkWN8/iN2/POj2r/MT6cVQ0/tuDISntVBG0vBDDoBM42siIJ3nW09x2c++LjSHcKJFNg         4mQeNaBlvXx/SUUgP8KBJA0TYFxWl/Wc3Ho/3P0mgnqWp+k7vG1QvcUEbMYE8hd2xRaT         SKZOZI2fjuiVq04Xg61Kfc28MNc2f7wc37H7mMYdOdGFg7jKBxyh9IXfDRgXyvjO9j1t         j/9rCIZN1pwoke4odnQKfecJwT9Jj1cfOrI+uJabPCZxieHBFNmXcx3Jc3DlDnHefEIq         DlHw==</li>
<li>Dkim-signature: v=1; a=rsa-sha256; c=relaxed/relaxed;        d=noaa.gov; s=google;        h=sender:to:from:organization:subject:date:user-agent:mime-version         :content-language:message-id:x-original-sender         :x-original-authentication-results:precedence:mailing-list:list-id         :list-post:list-help:list-archive;        bh=QGMEJE2E570uVXIm+6CCwai4RuzfvY6xMTwrr9vxXdE=;        b=fATgR5QLXhTzpYPKuMOpNYl0V/ZiCacuUsHTjjL8zsYmgRKo60KonDZpat52Zirg9o         c2dY9hAqzPlvwd0UbR6hlhIpMqgcCKY+IsTJjZ+IxV1xeQo37Y8rnf/9Jf5Ndz+7NYKZ         DURYYRJso9RxQtHYcXYRtxGrxFGTvXk+VWTzyYhwG1dTNhEa7v9Ba0daecKkYtgW4Z8+         QT3hs74GsK15aJFiqTmgXzaMMKVqI8+FJTOgTa/O5ft8W5KikV7tCsvcUWWbhfIhUqTp         AZ6C6xNxmEr16CR8FCfqJ02AO1ZkV0TLBRXMMLbkY7pmsROvWkoSpp11zgYNts05vrAN         KbgQ==</li>
<li>List-archive: &lt;<a href="https://groups.google.com/a/noaa.gov/group/ferret_users/">https://groups.google.com/a/noaa.gov/group/ferret_users/</a>&gt;</li>
<li>List-help: &lt;<a href="https://support.google.com/a/noaa.gov/bin/topic.py?topic=25838">https://support.google.com/a/noaa.gov/bin/topic.py?topic=25838</a>&gt;, &lt;<a href="mailto:ferret_users+help@noaa.gov">mailto:ferret_users+help@noaa.gov</a>&gt;</li>
<li>List-id: &lt;ferret_users.noaa.gov&gt;</li>
<li>List-post: &lt;<a href="https://groups.google.com/a/noaa.gov/group/ferret_users/post">https://groups.google.com/a/noaa.gov/group/ferret_users/post</a>&gt;, &lt;<a href="mailto:ferret_users@noaa.gov">mailto:ferret_users@noaa.gov</a>&gt;</li>
<li>Mailing-list: list <a href="mailto:ferret_users@DOMAIN.HIDDEN">ferret_users@xxxxxxxx</a>; contact <a href="mailto:ferret_users%2Bowners@DOMAIN.HIDDEN">ferret_users+owners@xxxxxxxx</a></li>
<li>Organization: Deutscher Wetterdienst</li>
<li>Sender: <a href="mailto:owner-ferret_users@DOMAIN.HIDDEN">owner-ferret_users@xxxxxxxx</a></li>
<li>User-agent: Mozilla/5.0 (X11; Linux x86_64; rv:52.0) Gecko/20100101 Thunderbird/52.8.0</li>
</ul>
<!--X-Head-of-Message-End-->
<!--X-Head-Body-Sep-Begin-->
<hr>
<!--X-Head-Body-Sep-End-->
<!--X-Body-of-Message-->
<pre style="margin: 0em;">
Hello ferret community,

</pre><tt>I am using @FNR in two dimensions and got an unexpected result (see 
</tt><tt>ferret script at end of this mail):
</tt><pre style="margin: 0em;">

</pre><tt>In the attached ferret_before_FNR.png, the original 2D grid cells are 
</tt><tt>shown (values inherited from dots by scat2grid, see below).
</tt><pre style="margin: 0em;">

</pre><tt>ferret_after_FNR.png shows the result after applying @FNR (fill with 
</tt><tt>nearest neighbor) in 2 dimensions.
</tt><pre style="margin: 0em;">

</pre><tt>As an example for the unexpected result, lets take the grid cell at 
</tt><tt>(x=8,y=5). Its value before @FNR was undefined. The nearest neighbor is 
</tt><tt>(x=8,y=8). Yet, the value is inherited from (x=2,y=4).
</tt><pre style="margin: 0em;">

</pre><tt>Is @FNR not supposed to be applied in 2D or is the logic behind 
</tt><tt>different from what I expected? It seems the missing points are always 
</tt><tt>filled up in x dimension first, and only remaining missing values are 
</tt><tt>then filled up in y direction ...
</tt><pre style="margin: 0em;">

</pre><tt>I attached a manual version of what I would have expected as 
</tt><tt>ferret_FNR_expected.png.
</tt><pre style="margin: 0em;">


Thank you very much in advance for helping to clarify this.


Best regards,
Hella Riede




can var/all
can sym/all

let a   = {1,1,8,8,2}
let b   = {1,8,8,1,4}
let val = {2,4,6,8,10}

def ax/x=1:8:1 xax
def ax/y=1:8:1 yax

def sym lev = (1.5,10.5,1)

!! assign values from dots to grid cells
set win 1
let gridded = SCAT2GRIDGAUSS_XY(a,b,val,x[gx=xax],y[gy=yax],0.8,0.8,0.8,0)
shade/lev=($lev) gridded
!! plot original scattered values for comparison
go polymark poly/lev=($lev)/key/ov/line/fill a b val circle 2


!! fill up undefined values with nearest neighbor
set win 2
let nn = gridded[x=@FNR,y=@FNR]
shade/lev=($lev) nn
go polymark poly/lev=($lev)/key/ov/line/fill a b val circle 2

</pre><p><strong>Attachment:
<a href="pngZ8_6RK0jmy.png" ><tt>ferret_before_FNR.png</tt></a></strong><br>
<em>Description:</em> PNG image</p>
<p><strong>Attachment:
<a href="pngPPwbCWZpUA.png" ><tt>ferret_after_FNR.png</tt></a></strong><br>
<em>Description:</em> PNG image</p>
<p><strong>Attachment:
<a href="pngllz_VKraDs.png" ><tt>ferret_FNR_expected.png</tt></a></strong><br>
<em>Description:</em> PNG image</p>

<!--X-Body-of-Message-End-->
<!--X-MsgBody-End-->
<!--X-Follow-Ups-->
<hr>
<ul><li><strong>Follow-Ups</strong>:
<ul>
<li><strong><a name="00223" href="msg00223.html">Re: [ferret_users] @FNR in 2D fills up x dimension first</a></strong>
<ul><li><em>From:</em> Ansley C. Manke</li></ul></li>
<li><strong><a name="00220" href="msg00220.html">Re: [ferret_users] @FNR in 2D fills up x dimension first</a></strong>
<ul><li><em>From:</em> Ansley C. Manke</li></ul></li>
</ul></li></ul>
<!--X-Follow-Ups-End-->
<!--X-References-->
<!--X-References-End-->
<!--X-BotPNI-->
<UL>
<li>Previous by thread:
<strong><a href="msg00213.html">[ferret_users] regarding if-then-else mask</a></strong>
</li>
<li>Next by thread:
<strong><a href="msg00220.html">Re: [ferret_users] @FNR in 2D fills up x dimension first</a></strong>
</li>

</UL>
<center>[<a href="msg00213.html">Thread Prev</a>][<a href="msg00220.html">Thread Next</a>][<A HREF="threads.html#00218">Index</A>]</center>

<!--X-BotPNI-End-->
<!--X-User-Footer-->
<A HREF="http://ferret.pmel.noaa.gov/Ferret/contact-us">Contact Us</A>
<br>
<font size=-1>
<address>
<a href="http://www.doc.gov">Dept of Commerce</a> /
<a href="http://www.noaa.gov">NOAA</a> /
<a href="http://www.oar.noaa.gov">OAR</a> /
<a href="http://www.pmel.noaa.gov">PMEL</a> /
<a href="http://ferret.pmel.noaa.gov">Ferret</a>
</address>

<br>
 <a href="http://www.noaa.gov/privacy.html">Privacy Policy</a> | <a href="http://www.noaa.gov/disclaimer.html">Disclaimer</a> | <a href="accessibility.html">Accessibility Statement</a> 

</font>
<!--X-User-Footer-End-->
</body>
</html>
