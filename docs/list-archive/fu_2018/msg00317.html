<!-- MHonArc v2.6.18 -->
<!--X-Subject: Re: [ferret_users] 21 yr running correlation -->
<!--X-From-R13: Oaqerj Ivggraoret &#45; @AOO Trqreny <naqerj.jvggraoretNabnn.tbi> -->
<!--X-Date: Wed, 29 Aug 2018 15:16:41 &#45;0700 -->
<!--X-Message-Id: CAKoe08TJQdN_mAdMmhhCxoy+EZF8C3WKOtpP_siyA&#45;tO6ZewWw@mail.gmail.com -->
<!--X-Content-Type: multipart/alternative -->
<!--X-Reference: CAOhUinKa=DqR6q8Vi12PjJcxeWrr21PL6POVLv6SHXjWo1HsYQ@mail.gmail.com -->
<!--X-Reference: CAEwQpaLc1bXQ3cs5b9856QO_rN4Ac1Xa6VxQ2BAD5hNcbdTPCg@mail.gmail.com -->
<!--X-Reference: CAFXLzPg2ZzetV4ZaZJbMKWmXfFO=Fyj0UhoPr+hmUkx0Uw&#45;PtA@mail.gmail.com -->
<!--X-Reference: CAEwQpaLZmifxe9KNkK=UUAbyOsfuQCgERVbaUkEDFm7rpX8KPQ@mail.gmail.com -->
<!--X-Reference: CAFXLzPjBx83KX5n40Ex+vSn2qeLzbEX5+srnb7bNEFm1FoR_ow@mail.gmail.com -->
<!--X-Reference: CAEwQpaJrtt9RH9RXwJM_cD=Mme2_y5pFQ1afg7CbkRYq32xjgA@mail.gmail.com -->
<!--X-Reference: CALC=m4r0OjBk=&#45;Yp38EkdJPD0KtQmYRUKBUYo3HxJEoZS3oRXg@mail.gmail.com -->
<!--X-Reference: 97A70046&#45;1C6D&#45;48E1&#45;8C7D&#45;6CBD58B3D299@noaa.gov -->
<!--X-Reference: CAKoe08S=V8BgKvrdv4Zu=aM7&#45;Hpwf_4T1NP06jDsRuJYnMWoEQ@mail.gmail.com -->
<!--X-Reference: CAEwQpa+O3s6v0Rd3q7ob7k8gCXincTgUxE4q5OVtug1yVn3A4g@mail.gmail.com -->
<!--X-Reference: CAEwQpaJNffVf_8q4&#45;cDOeCQ8BjR=DR4J_xzuEdYBRQBk_zSpRQ@mail.gmail.com -->
<!--X-Head-End-->
<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN"
        "http://www.w3.org/TR/html4/loose.dtd">
<html>
<head>
<title>Re: [ferret_users] 21 yr running correlation</title>
</head>
<body>
<!--X-Body-Begin-->
<!--X-User-Header-->
<!--X-User-Header-End-->
<!--X-TopPNI-->
<HR>
<center>[<a href="msg00316.html">Thread Prev</a>][<a href="msg00308.html">Thread Next</a>][<A HREF="threads.html#00317">Index</A>]</center>

<!--X-TopPNI-End-->
<!--X-MsgBody-->
<!--X-Subject-Header-Begin-->
<h1>Re: [ferret_users] 21 yr running correlation</h1>
<hr>
<!--X-Subject-Header-End-->
<!--X-Head-of-Message-->
<ul>
<li><strong>To</strong>: <strong>Ryo Furue &lt;<a href="mailto:furue@DOMAIN.HIDDEN">furue@xxxxxxxxxx</a>&gt;</strong></li>
<li><strong>Subject</strong>: <strong>Re: [ferret_users] 21 yr running correlation</strong></li>
<li><strong>From</strong>: <strong>Andrew Wittenberg - NOAA Federal &lt;<a href="mailto:andrew.wittenberg@DOMAIN.HIDDEN">andrew.wittenberg@xxxxxxxx</a>&gt;</strong></li>
<li>Date: Wed, 29 Aug 2018 18:16:29 -0400</li>
<li>Arc-authentication-results: i=2; mx.google.com;       dkim=pass header.i=@noaa.gov header.s=google header.b=pa5j9Z7h;       spf=pass (google.com: domain of <a href="mailto:andrew.wittenberg@DOMAIN.HIDDEN">andrew.wittenberg@xxxxxxxx</a> designates 209.85.220.41 as permitted sender) smtp.mailfrom=<a href="mailto:andrew.wittenberg@DOMAIN.HIDDEN">andrew.wittenberg@xxxxxxxx</a>;       dmarc=pass (p=QUARANTINE sp=NONE dis=NONE) header.from=noaa.gov</li>
<li>Arc-authentication-results: i=1; mx.google.com;       dkim=pass header.i=@noaa.gov header.s=google header.b=pa5j9Z7h;       spf=pass (google.com: domain of <a href="mailto:andrew.wittenberg@DOMAIN.HIDDEN">andrew.wittenberg@xxxxxxxx</a> designates 209.85.220.41 as permitted sender) smtp.mailfrom=<a href="mailto:andrew.wittenberg@DOMAIN.HIDDEN">andrew.wittenberg@xxxxxxxx</a>;       dmarc=pass (p=QUARANTINE sp=NONE dis=NONE) header.from=noaa.gov</li>
<li>Arc-message-signature: i=2; a=rsa-sha256; c=relaxed/relaxed; d=google.com; s=arc-20160816;        h=list-archive:list-help:list-post:list-id:mailing-list:precedence:cc         :to:subject:message-id:date:from:in-reply-to:references:mime-version         :arc-authentication-results:arc-message-signature:dkim-signature         :arc-authentication-results;        bh=DAa9DiOGuy31ocMrEa9o8Q3ZFL4Ad/4etCeNE7xDCyw=;        b=MfiMG2Ytf3Stcoc/e7gytB8h6J4LTZj9lL6oqUtuYrDzpm4Tg45O+iUbHGEcbUijJM         2ricT6OmRjO88NnbiGxE/vo1BaSbpnGsgLIC/96afZWuzuSHyx9kSn8gwee1tZEShwAH         DFDXDo4EUJicEmOLa8r/bMmIWCakq0m9N2LMsvH2A0QfOGpvJl3Ae1LMRBr8VjQ6iufY         ihXMCvCuyK01r8ZM4zX40hGbN9T9j+urc7W/bj9dxDiaXJiLvQh9RsJvROOGIwwzrvbY         pbDR/zMNDYS+tUnEYPYni+GI7BsEJjZsqw9ExOmCFNqEIumuuYFdlWqjyOOZIrct6cPi         PY2g==</li>
<li>Arc-message-signature: i=1; a=rsa-sha256; c=relaxed/relaxed; d=google.com; s=arc-20160816;        h=cc:to:subject:message-id:date:from:in-reply-to:references         :mime-version:dkim-signature:arc-authentication-results;        bh=DAa9DiOGuy31ocMrEa9o8Q3ZFL4Ad/4etCeNE7xDCyw=;        b=zqxsqRn+xlqqQ6CLVKjuzM49g/maa7SWkkgNAZbTYbbCDEEjEq9MXhVyWAOGzreq+B         cSO8SkQjcmS1QemqFQAYjgH+Bjewe4o+giTcC+BZZbx4pS1DP1iIHfQzYKqA70zHMRsM         19050CNYLnm62emGpv+GGzZeME8fj9vidiZF9u5Ijlwq6ddX2Cuh2m40JiZbfD3+zy0q         871h3F9Ejq2/NLIREOtA848SI5vg/hgjUQJ7yR/yMYEVfNVQKYlroQ7mtHTAAFNjqCeB         tpAjwuvuk2Gtho4zAXxL60oY87w4JV9AL/N44DF7tt9opPbMiyiDjIlPWIYNfjvrmNko         TXgw==</li>
<li>Arc-seal: i=2; a=rsa-sha256; t=1535581001; cv=pass;        d=google.com; s=arc-20160816;        b=ZkrDtR95UYMifaVqRUEBwQToQrctok3QNy58KFHQNuFA39uSMKH1yoQ/L3Epy5Sq+7         1r1nLP8V1a3naw/oc3opAxzNSMZ9cmmDmJILn1Ezl+Eh6uyD3+ty5YTdmkqXLbEu2wWa         EmQVNE93E6QVtkblelgvL8RdywMjNK8N4k8S/8/ClDwk2eg7N5vbn03MMsjgmmLAG4HV         +69+ZF0mljarpXK6J6TXzeqL2w+EfwU8vLYwnE2MGxtHOqyuYAPMBiKUXBqcgbzGShhY         PQYMTHDC2/gxaDEGnF4Wnul5r4SRfKv6A6BQSfmc9Xc48NtL5v+OWctZMkhQYH8drpWo         JWrw==</li>
<li>Arc-seal: i=1; a=rsa-sha256; t=1535581000; cv=none;        d=google.com; s=arc-20160816;        b=Fzf+A3Ookm/RuPSwLhBf3p3MRhBC/QLmDuA3iP7A8sk8pxMmBwdkZLSGpeymm5/bxG         5fCRG0pimjQn9qCx4uxrUXGIMhz5+eAyImz7uKJvRFcudiF0r9HbeIG0GW5Cx3zZg8II         Eh15OPauhgS+xjzcu3cLnsvGOgF1giP+k2p2vibh3c7/jIL4EBhV0ZO9xN788oz0baK+         9fuIM3rrLG3PrxqFE3wHvJAvZv1pHZ7MucKaADQqVxt9BK6vIjPckexqCqZlgWj/oKwH         0yB7w3FCeWXsyagwBT9eL7UkTF1xYQ7YP9KbCLd9Whkqh/LD4WAXHsHKS++XyBG0iVaM         IDuA==</li>
<li>Cc: &quot;William S. Kessler&quot; &lt;<a href="mailto:william.s.kessler@DOMAIN.HIDDEN">william.s.kessler@xxxxxxxx</a>&gt;,        Satyesh Ghetiya &lt;<a href="mailto:satyeshghetiya@DOMAIN.HIDDEN">satyeshghetiya@xxxxxxxxx</a>&gt;,        Sandeep Mohapatra &lt;<a href="mailto:sandeepmohapatra21@DOMAIN.HIDDEN">sandeepmohapatra21@xxxxxxxxx</a>&gt;,        Ferret Users &lt;<a href="mailto:ferret_users@DOMAIN.HIDDEN">ferret_users@xxxxxxxx</a>&gt;</li>
<li>Dkim-signature: v=1; a=rsa-sha256; c=relaxed/relaxed;        d=noaa.gov; s=google;        h=mime-version:references:in-reply-to:from:date:message-id:subject:to         :cc:x-original-sender:x-original-authentication-results:precedence         :mailing-list:list-id:list-post:list-help:list-archive;        bh=DAa9DiOGuy31ocMrEa9o8Q3ZFL4Ad/4etCeNE7xDCyw=;        b=amZluqa/C5onTuFLP7BJnpZEzjXRqIzZSIVxTqXZZlGodJbYVhcTOKKQLjDWVC3Hed         qIMaylElHGFgUVoojuiaQ7DbFP667KFmZjdHEbg1wYtmxLpb5Wl6bMZhfF2n6XDtN4/c         mL1TwTi4BT2Xd01Fju7rwobKeuFnL+ANvmHBikXaingJ77u7d4wGCkl9R7Wt1pc0gaVZ         sVDLXTqxQDfcJW2xYZ1Las2j7BHNUni2M8SyaummyXkVKVOB7YwhV35OGGYfJpkmp8R8         gp4jUmVaSE6Iit8tiSQ2K5/Z+j4OmIRjctEBErw/J9MIyaRcI6efcvNUDvdLJEypy4UO         2vUA==</li>
<li>In-reply-to: &lt;CAEwQpaJNffVf_8q4-cDOeCQ8BjR=DR4J_xzuEdYBRQBk_zSpRQ@mail.gmail.com&gt;</li>
<li>List-archive: &lt;<a href="https://groups.google.com/a/noaa.gov/group/ferret_users/">https://groups.google.com/a/noaa.gov/group/ferret_users/</a>&gt;</li>
<li>List-help: &lt;<a href="https://support.google.com/a/noaa.gov/bin/topic.py?topic=25838">https://support.google.com/a/noaa.gov/bin/topic.py?topic=25838</a>&gt;, &lt;<a href="mailto:ferret_users+help@noaa.gov">mailto:ferret_users+help@noaa.gov</a>&gt;</li>
<li>List-id: &lt;ferret_users.noaa.gov&gt;</li>
<li>List-post: &lt;<a href="https://groups.google.com/a/noaa.gov/group/ferret_users/post">https://groups.google.com/a/noaa.gov/group/ferret_users/post</a>&gt;, &lt;<a href="mailto:ferret_users@noaa.gov">mailto:ferret_users@noaa.gov</a>&gt;</li>
<li>Mailing-list: list <a href="mailto:ferret_users@DOMAIN.HIDDEN">ferret_users@xxxxxxxx</a>; contact <a href="mailto:ferret_users%2Bowners@DOMAIN.HIDDEN">ferret_users+owners@xxxxxxxx</a></li>
<li>References: &lt;CAOhUinKa=DqR6q8Vi12PjJcxeWrr21PL6POVLv6SHXjWo1HsYQ@mail.gmail.com&gt; &lt;<a href="msg00295.html">CAEwQpaLc1bXQ3cs5b9856QO_rN4Ac1Xa6VxQ2BAD5hNcbdTPCg@mail.gmail.com</a>&gt; &lt;CAFXLzPg2ZzetV4ZaZJbMKWmXfFO=Fyj0UhoPr+hmUkx0Uw-PtA@mail.gmail.com&gt; &lt;CAEwQpaLZmifxe9KNkK=UUAbyOsfuQCgERVbaUkEDFm7rpX8KPQ@mail.gmail.com&gt; &lt;<a href="msg00299.html">CAFXLzPjBx83KX5n40Ex+vSn2qeLzbEX5+srnb7bNEFm1FoR_ow@mail.gmail.com</a>&gt; &lt;CAEwQpaJrtt9RH9RXwJM_cD=Mme2_y5pFQ1afg7CbkRYq32xjgA@mail.gmail.com&gt; &lt;CALC=m4r0OjBk=-Yp38EkdJPD0KtQmYRUKBUYo3HxJEoZS3oRXg@mail.gmail.com&gt; &lt;<a href="msg00305.html">97A70046-1C6D-48E1-8C7D-6CBD58B3D299@noaa.gov</a>&gt; &lt;CAKoe08S=V8BgKvrdv4Zu=aM7-Hpwf_4T1NP06jDsRuJYnMWoEQ@mail.gmail.com&gt; &lt;<a href="msg00307.html">CAEwQpa+O3s6v0Rd3q7ob7k8gCXincTgUxE4q5OVtug1yVn3A4g@mail.gmail.com</a>&gt; &lt;CAEwQpaJNffVf_8q4-cDOeCQ8BjR=DR4J_xzuEdYBRQBk_zSpRQ@mail.gmail.com&gt;</li>
<li>Sender: <a href="mailto:owner-ferret_users@DOMAIN.HIDDEN">owner-ferret_users@xxxxxxxx</a></li>
</ul>
<!--X-Head-of-Message-End-->
<!--X-Head-Body-Sep-Begin-->
<hr>
<!--X-Head-Body-Sep-End-->
<!--X-Body-of-Message-->
<div dir="ltr"><div class="gmail_default" style="font-family:arial,helvetica,sans-serif">Or equivalently, and perhaps faster to compute:</div><div class="gmail_default" style="font-family:arial,helvetica,sans-serif"><br></div><div class="gmail_default" style="font-family:arial,helvetica,sans-serif">let skew = (mean_cubed - mean * (3*second + mean*mean)) / second^1.5</div><div class="gmail_default" style="font-family:arial,helvetica,sans-serif"><br></div><div class="gmail_default" style="font-family:arial,helvetica,sans-serif">Andrew</div><br><br><div class="gmail_quote"><div dir="ltr">On Wed, Aug 29, 2018 at 8:14 AM Ryo Furue &lt;<a rel="nofollow" href="mailto:furue@xxxxxxxxxx" target="_blank">furue@xxxxxxxxxx</a>&gt; wrote:<br></div><blockquote class="gmail_quote" style="margin:0 0 0 .8ex;border-left:1px #ccc solid;padding-left:1ex"><div dir="ltr"><div dir="ltr">Hi Ferret users,<br><br><div class="gmail_quote"><div dir="ltr">On Wed, Aug 29, 2018 at 11:57 AM Ryo Furue &lt;<a rel="nofollow" href="mailto:furue@xxxxxxxxxx" target="_blank">furue@xxxxxxxxxx</a>&gt; wrote:</div><blockquote class="gmail_quote" style="margin:0px 0px 0px 0.8ex;border-left:1px solid rgb(204,204,204);padding-left:1ex">Your method utilizes the identity</blockquote><blockquote class="gmail_quote" style="margin:0px 0px 0px 0.8ex;border-left:1px solid rgb(204,204,204);padding-left:1ex"><div dir="ltr"><div class="gmail_quote"><div><br></div></div><blockquote style="margin:0px 0px 0px 40px;border:none;padding:0px"><div class="gmail_quote"><div>mean{ [a - mean(a)]^2}</div></div><div class="gmail_quote"><div>= mean(a^2) - [mean(a)]^2</div></div></blockquote><div class="gmail_quote"><div><br></div><div>so that the operation mean() is applied only once in each term.&#xA0; That&#39;s elegant.</div><div><br></div><div>Currently, I need a &quot;running skewness&quot;, which I think I can calculate applying your method.</div></div></div></blockquote><div><br></div><div>For a record, I describe how one can calculate it.</div><div><br></div><div>To extend Andrew&#39;s method, we first need a formula to calculate the third moment without nested applications of mean(). The formula is</div><div><br></div></div></div><blockquote style="margin:0 0 0 40px;border:none;padding:0px"><div><div class="gmail_quote"><div>mean{ [a - mean(a)]^3 }</div></div></div><div><div class="gmail_quote"><div>&#xA0;= mean{ a^3 - 3 a^2 mean(a) + 3 a [mean(a)]^2 - [mean(a)]^3 }</div></div></div><div><div class="gmail_quote"><div>&#xA0;= mean(a^3) - 3 mean(a^2) mean(a) + 3 mean(a) [mean(a)]^2 - [mean(a)]^3</div></div></div><div><div class="gmail_quote"><div>&#xA0;= mean(a^3) - 3 mean(a^2) mean(a) + 2 [mean(a)]^3</div></div></div></blockquote><div dir="ltr"><div class="gmail_quote"><div><br></div><div>So, my Ferret code looks like:</div><div><br></div></div></div><blockquote style="margin:0 0 0 40px;border:none;padding:0px"><div><div class="gmail_quote"><div><font face="monospace, monospace">define symbol avr_ t=@SBX:13</font></div></div></div><div><div class="gmail_quote"><div><font face="monospace, monospace"><br></font></div></div></div><div><div class="gmail_quote"><div><font face="monospace, monospace">let squared = a * a</font></div></div></div><div><div class="gmail_quote"><div><font face="monospace, monospace">let cubed&#xA0; &#xA0;= a * a * a</font></div></div></div><div><div class="gmail_quote"><div><font face="monospace, monospace"><br></font></div></div></div><div><div class="gmail_quote"><div><font face="monospace, monospace">let mean&#xA0; &#xA0; &#xA0; &#xA0; &#xA0;= a[($avr_)]</font></div></div></div><div><div class="gmail_quote"><div><font face="monospace, monospace">let mean_squared = squared[($avr_)]</font></div></div></div><div><div class="gmail_quote"><div><font face="monospace, monospace">let mean_cubed&#xA0; &#xA0;= cubed[($avr_)]</font></div></div></div><div><div class="gmail_quote"><div><font face="monospace, monospace"><br></font></div></div></div><div><div class="gmail_quote"><div><font face="monospace, monospace">let second = mean_squared - mean * mean</font></div></div></div><div><div class="gmail_quote"><div><font face="monospace, monospace">let stddev = second^0.5</font></div></div></div><div><div class="gmail_quote"><div><font face="monospace, monospace"><br></font></div></div></div><div><div class="gmail_quote"><div><font face="monospace, monospace">let third = mean_cubed - 3 * mean_squared * mean \</font></div></div></div><div><div class="gmail_quote"><div><font face="monospace, monospace">&#xA0; &#xA0; &#xA0; &#xA0; &#xA0; &#xA0; + 2 * (mean^3)</font></div></div></div><div><div class="gmail_quote"><div><font face="monospace, monospace"><br></font></div></div></div><div><div class="gmail_quote"><div><font face="monospace, monospace">let skew = third / (stddev^3)</font></div></div></div></blockquote><div dir="ltr"><div class="gmail_quote"><div><br></div><div>Cheers,</div><div>Ryo</div><div>&#xA0;<br></div></div></div></div>
</blockquote></div></div>

<!--X-Body-of-Message-End-->
<!--X-MsgBody-End-->
<!--X-Follow-Ups-->
<hr>
<!--X-Follow-Ups-End-->
<!--X-References-->
<ul><li><strong>References</strong>:
<ul>
<li><strong><a name="00294" href="msg00294.html">[ferret_users] 21 yr running correlation</a></strong>
<ul><li><em>From:</em> Sandeep Mohapatra</li></ul></li>
<li><strong><a name="00295" href="msg00295.html">Re: [ferret_users] 21 yr running correlation</a></strong>
<ul><li><em>From:</em> Ryo Furue</li></ul></li>
<li><strong><a name="00296" href="msg00296.html">Re: [ferret_users] 21 yr running correlation</a></strong>
<ul><li><em>From:</em> saurabh rathore</li></ul></li>
<li><strong><a name="00298" href="msg00298.html">Re: [ferret_users] 21 yr running correlation</a></strong>
<ul><li><em>From:</em> Ryo Furue</li></ul></li>
<li><strong><a name="00299" href="msg00299.html">Re: [ferret_users] 21 yr running correlation</a></strong>
<ul><li><em>From:</em> saurabh rathore</li></ul></li>
<li><strong><a name="00300" href="msg00300.html">Re: [ferret_users] 21 yr running correlation</a></strong>
<ul><li><em>From:</em> Ryo Furue</li></ul></li>
<li><strong><a name="00301" href="msg00301.html">Re: [ferret_users] 21 yr running correlation</a></strong>
<ul><li><em>From:</em> Satyesh Ghetiya</li></ul></li>
<li><strong><a name="00305" href="msg00305.html">Re: [ferret_users] 21 yr running correlation</a></strong>
<ul><li><em>From:</em> William S. Kessler</li></ul></li>
<li><strong><a name="00306" href="msg00306.html">Re: [ferret_users] 21 yr running correlation</a></strong>
<ul><li><em>From:</em> Andrew Wittenberg - NOAA Federal</li></ul></li>
<li><strong><a name="00307" href="msg00307.html">Re: [ferret_users] 21 yr running correlation</a></strong>
<ul><li><em>From:</em> Ryo Furue</li></ul></li>
<li><strong><a name="00313" href="msg00313.html">Re: [ferret_users] 21 yr running correlation</a></strong>
<ul><li><em>From:</em> Ryo Furue</li></ul></li>
</ul></li></ul>
<!--X-References-End-->
<!--X-BotPNI-->
<UL>
<li>Previous by thread:
<strong><a href="msg00316.html">Re: [ferret_users] 21 yr running correlation</a></strong>
</li>
<li>Next by thread:
<strong><a href="msg00308.html">[ferret_users] r^n (real number raised to the power of an integer)</a></strong>
</li>

</UL>
<center>[<a href="msg00316.html">Thread Prev</a>][<a href="msg00308.html">Thread Next</a>][<A HREF="threads.html#00317">Index</A>]</center>

<!--X-BotPNI-End-->
<!--X-User-Footer-->
<A HREF="http://ferret.pmel.noaa.gov/Ferret/contact-us">Contact Us</A>
<br>
<font size=-1>
<address>
<a href="http://www.doc.gov">Dept of Commerce</a> /
<a href="http://www.noaa.gov">NOAA</a> /
<a href="http://www.oar.noaa.gov">OAR</a> /
<a href="http://www.pmel.noaa.gov">PMEL</a> /
<a href="http://ferret.pmel.noaa.gov">Ferret</a>
</address>

<br>
 <a href="http://www.noaa.gov/privacy.html">Privacy Policy</a> | <a href="http://www.noaa.gov/disclaimer.html">Disclaimer</a> | <a href="accessibility.html">Accessibility Statement</a> 

</font>
<!--X-User-Footer-End-->
</body>
</html>
