<!-- MHonArc v2.6.16 -->
<!--X-Subject: Re: [ferret_users] Jason Images -->
<!--X-From-R13: [negva Epuzvqg <znegva.fpuzvqgNvb&#45;jnearzhraqr.qr> -->
<!--X-Date: Tue, 22 Mar 2011 04:10:25 &#45;0700 -->
<!--X-Message-Id: 4D888379.60804@io&#45;warnemuende.de -->
<!--X-Content-Type: text/plain -->
<!--X-Reference: 4D558413.7080709@noaa.gov -->
<!--X-Reference: 4D592AE2.4070100@io&#45;warnemuende.de -->
<!--X-Reference: 4D596F7A.2070609@noaa.gov -->
<!--X-Reference: 4D5EA165.6050501@io&#45;warnemuende.de -->
<!--X-Reference: 4D5EC739.9030703@noaa.gov -->
<!--X-Reference: BAY161&#45;w1283EE09FB9CECEF7729D8B5B50@phx.gbl -->
<!--X-Reference: BAY161&#45;w2637E9F7C8B0E3B61CF103B5B50@phx.gbl -->
<!--X-Head-End-->
<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN"
        "http://www.w3.org/TR/html4/loose.dtd">
<html>
<head>
<title>Re: [ferret_users] Jason Images</title>
</head>
<body>
<!--X-Body-Begin-->
<!--X-User-Header-->
<!--X-User-Header-End-->
<!--X-TopPNI-->
<HR>
<center>[<a href="msg00215.html">Thread Prev</a>][<a href="msg00219.html">Thread Next</a>][<A HREF="threads.html#00217">Index</A>]</center>

<!--X-TopPNI-End-->
<!--X-MsgBody-->
<!--X-Subject-Header-Begin-->
<h1>Re: [ferret_users] Jason Images</h1>
<hr>
<!--X-Subject-Header-End-->
<!--X-Head-of-Message-->
<ul>
<li><strong>To</strong>: <strong>PaulaOCN Nunes &lt;<a href="mailto:oceanografa@DOMAIN.HIDDEN">oceanografa@xxxxxxxxxxx</a>&gt;</strong></li>
<li><strong>Subject</strong>: <strong>Re: [ferret_users] Jason Images</strong></li>
<li><strong>From</strong>: <strong>Martin Schmidt &lt;<a href="mailto:martin.schmidt@DOMAIN.HIDDEN">martin.schmidt@xxxxxxxxxxxxxxxxx</a>&gt;</strong></li>
<li>Date: Tue, 22 Mar 2011 12:09:45 +0100</li>
<li>Cc: <a href="mailto:oar.pmel.ferret_users@DOMAIN.HIDDEN">oar.pmel.ferret_users@xxxxxxxx</a></li>
<li>In-reply-to: &lt;<a href="mailto:BAY161-w2637E9F7C8B0E3B61CF103B5B50@DOMAIN.HIDDEN">BAY161-w2637E9F7C8B0E3B61CF103B5B50@xxxxxxx</a>&gt;</li>
<li>Organization: IOW</li>
<li>References: &lt;<a href="mailto:4D558413.7080709@DOMAIN.HIDDEN">4D558413.7080709@xxxxxxxx</a>&gt; &lt;<a href="mailto:4D592AE2.4070100@DOMAIN.HIDDEN">4D592AE2.4070100@xxxxxxxxxxxxxxxxx</a>&gt; &lt;<a href="mailto:4D596F7A.2070609@DOMAIN.HIDDEN">4D596F7A.2070609@xxxxxxxx</a>&gt; &lt;<a href="mailto:4D5EA165.6050501@DOMAIN.HIDDEN">4D5EA165.6050501@xxxxxxxxxxxxxxxxx</a>&gt; &lt;<a href="mailto:4D5EC739.9030703@DOMAIN.HIDDEN">4D5EC739.9030703@xxxxxxxx</a>&gt; &lt;<a href="mailto:BAY161-w1283EE09FB9CECEF7729D8B5B50@DOMAIN.HIDDEN">BAY161-w1283EE09FB9CECEF7729D8B5B50@xxxxxxx</a>&gt; &lt;<a href="mailto:BAY161-w2637E9F7C8B0E3B61CF103B5B50@DOMAIN.HIDDEN">BAY161-w2637E9F7C8B0E3B61CF103B5B50@xxxxxxx</a>&gt;</li>
<li>Reply-to: <a href="mailto:martin.schmidt@DOMAIN.HIDDEN">martin.schmidt@xxxxxxxxxxxxxxxxx</a></li>
<li>Sender: <a href="mailto:owner-ferret_users@DOMAIN.HIDDEN">owner-ferret_users@xxxxxxxx</a></li>
<li>User-agent: Mozilla/5.0 (X11; U; AIX 5.3; en-US; rv:1.9.1.11) Gecko/20100701 SeaMonkey/2.0.6</li>
</ul>
<!--X-Head-of-Message-End-->
<!--X-Head-Body-Sep-Begin-->
<hr>
<!--X-Head-Body-Sep-End-->
<!--X-Body-of-Message-->
<pre style="margin: 0em;">
Hi Paula,

</pre><tt>looking into the example file it seems that the lat/lon values describe 
</tt><tt>the position of JASON as
</tt><tt>function of time. Hence, they do not define a grid and cannot be read 
</tt><tt>into ferret as grid co-ordinates. There seems to be
</tt><pre style="margin: 0em;">
no way around the gridding procedure.

</pre><tt>I think you should process all files separately. Hence, the first step 
</tt><tt>could be to put the track onto your grid,
</tt><tt>say with* scat2gridgauss_xy* . Save the result into a netcdf file. The 
</tt><tt>time stamp could be the time average of all
</tt><pre style="margin: 0em;">
times within the file.

</pre><tt>The next step would be to join the gridded files. I am sure that this 
</tt><tt>could be done file by file?
</tt><pre style="margin: 0em;">

Hope this helps?

Martin Schmidt



PaulaOCN Nunes wrote:
</pre><blockquote style="border-left: #5555EE solid 0.2em; margin: 0em; padding-left: 0.85em"><pre style="margin: 0em;">

Hello Ferret users;

</pre><tt>I attached an example of a netcdf Jason file which I'm working on 
</tt><tt>(&quot;JA1_IPR_2PcP334_001_20110125_040633_20110125_050240.nc&quot;)
</tt><tt>I'm interested in the sea surface height anomaly (SSHA) and their 
</tt><tt>coordinates (lat, lon), but the file comes with all the data in the 
</tt><tt>time axis
</tt><tt>(1 pair of coordinates and a measure of SSHA for each scan of the 
</tt><tt>satellite). Here goes the display of the data:
</tt><pre style="margin: 0em;">

* 1&gt; ./JA1_IPR_2PcP334_001_20110125_040633_20110125_050240.nc  (default)
</pre><tt> name     title                             I         J         
</tt><tt>K         L
</tt><tt> LAT      latitude                         ...       ...       
</tt><tt>...       1:2350
</tt><tt> LON      longitude                        ...       ...       
</tt><tt>...       1:2350
</tt><tt> SSHA     sea surface height anomaly       ...       ...       
</tt><tt>...       1:2350, etc
</tt><pre style="margin: 0em;">
*
</pre><tt>I realize I need to regrid it to the &quot;I&quot; and &quot;J&quot; axis to be able to 
</tt><tt>work with it, then, I first tried to regrid the &quot;lat&quot; variable to the 
</tt><tt>&quot;I&quot; axis:
</tt><pre style="margin: 0em;">

*define axis/x=1:2350:1 iaxis
define grid/x=iaxis gridCOL
let lat2=lat[g=gridCOL]
*
But it didn't show any difference on the grid ferret's display:

*sh grid lat
    GRID GSF1
 name       axis              # pts   start                end
 normal    X
 normal    Y
 normal    Z
</pre><tt> TIME      TIME              2350 i   25-JAN-2011 04:06    25-JAN-2011 
</tt><tt>05:02
</tt><pre style="margin: 0em;">

sh grid lat2
    GRID GSF1
 name       axis              # pts   start                end
 normal    X
 normal    Y
 normal    Z
</pre><tt> TIME      TIME              2350 i   25-JAN-2011 04:06    25-JAN-2011 
</tt><tt>05:02*
</tt><pre style="margin: 0em;">

</pre><tt>Second I tried to regrid the &quot;lat&quot; variable, but to a grid with the 3 
</tt><tt>axis:
</tt><pre style="margin: 0em;">

* define axis/y=1:2350:1 jaxis
 define axis/t=1:1:1 laxis
 define grid/x=iaxis/y=jaxis/t=laxis gridCOL_ROW
let lat3=lat[g=gridCOL_ROW]
sh grid lat3
    GRID (G002)
 name       axis              # pts   start                end
 normal    X
 normal    Y
 normal    Z
 LAXIS     T                    1 r   1                    1
*
</pre><tt>...it was worse, ferret and I got more confused...The only way I could 
</tt><tt>work out to give this data a X/Y axis was to save it as a binary:
</tt><pre style="margin: 0em;">

*list/clobber/format=unformatted/file=&quot;jason1.dat&quot; lon,lat,ssha*

...and open it again:

*define axis/x=1:2350:1 iaxis
define grid/x=iaxis gridCOL
file/format=unformatted/grid=gridCOL/var=lon,lat,ssha/col=3 &quot;jason1.dat&quot;*
* sh da
    2&gt; ./jason1.dat  (default)
</pre><tt> name     title                             I         J         
</tt><tt>K         L
</tt><tt> LON      LON                              1:2350    ...       
</tt><tt>...       ...
</tt><tt> LAT      LAT                              1:2350    ...       
</tt><tt>...       ...
</tt><tt> SSHA     SSHA                             1:2350    ...       
</tt><tt>...       ...
</tt><pre style="margin: 0em;">
*
</pre><tt>Does anyone have an easier way to regrid the data from the &quot;L&quot; axis to 
</tt><tt>the &quot;I&quot;/&quot;J&quot; axis?
</tt><tt> After this, I used the &quot;scat2gridgauss_xy&quot; command to put the 
</tt><tt>variables to this global grid:
</tt><pre style="margin: 0em;">

*!global grid for all Jason's possible tracks:
define axis/x=0:360:0.052252252/UNIT=degrees xJASON
define axis/y=-66.15:60.15:0.052252252/UNIT=degrees yJASON
</pre><tt>let 
</tt><tt>sshaJASON=scat2gridgauss_xy(lon,lat,ssha,x[gx=xJASON],y[gy=yJASON],0.5, 0.5, 
</tt><tt>2, 0)*
</tt><pre style="margin: 0em;">

</pre><tt>I ploted these &quot;sshaJASON&quot; variable with &quot;shade&quot;, no problems, but 
</tt><tt>isn't there a way to the axis recognize the coordinates described by 
</tt><tt>the variables &quot;lat&quot; and &quot;lon&quot;,
</tt><pre style="margin: 0em;">
without the need of the &quot;scat2gridgauss_xy&quot; command?
</pre><tt>Well, this file is one track of the satellite, and I 'd like to join a 
</tt><tt>hole cycle of it, which is the sum of 254 files, to do so, I made a 
</tt><tt>script in loop, for load and save the 254 binaries files
</tt><tt>but I'm not able, because Ferret allows until 100 datasets to be 
</tt><tt>loaded at the same time:
</tt><pre style="margin: 0em;">

*repeat/i=1:(numberFILES):1 (\
list `i`; \
file/var=ndata &quot;ndata_`i`.txt&quot;; \
define axis/x=1:`ndata[i=1]`:1 iaxis; \
ca da 1; \
define grid/x=iaxis gridTRIPA; \
let arq= &quot;JASON_`i`.dat&quot;; \
file/format=unformatted/grid=gridTRIPA/var=lon,lat,ssha/col=3 &quot;`arq`&quot; ; \
</pre><tt>let 
</tt><tt>sshaJASON=scat2gridgauss_xy(lon,lat,ssha,x[gx=xJASON],y[gy=yJASON],0.5, 0.5, 
</tt><tt>2, 0) ; \
</tt><pre style="margin: 0em;">
let sshaJASON`i` = missing(sshaJASON,0); \
</pre><tt>let sobrepoe`i`_ssha=if (sshaJASON NE 0) then (sshaJASON) else 
</tt><tt>(sobrepoe`i-1`_ssha[l=1]); \
</tt><pre style="margin: 0em;">
)
let sobrepoe_ssha=sobrepoe(numberFILES)_ssha[l=1]
set variable/bad=0 sobrepoe_ssha[l=1]
set memo/size=1000;shade sobrepoe_ssha;go land_hires
*
</pre><tt>So I tried to cancel the variables (&quot;ca var ssha&quot;) at the end of loop, 
</tt><tt>but:
</tt><pre style="margin: 0em;">

***ERROR: invalid command: can only CANCEL variables you DEFINE SSHA
ca var ssha*

</pre><tt>then I tried to cancel the dataset at the end of loop (&quot;ca da/all&quot; or 
</tt><tt>&quot;ca da 1&quot;), but it keep asking for the old variable (SSHA),
</tt><tt>and I'm unabled to use the new variable with the overlappings 
</tt><tt>(sobrepoe_ssha):
</tt><pre style="margin: 0em;">

*!-&gt; REPEAT: I=1
 !-&gt; list 1
             VARIABLE : constant
          1.000
</pre><tt> !-&gt; SET DATA/EZ/var=ndata 
</tt><tt>&quot;/home/paula/Ressurgencia/JASON/c334/ndata_1.txt&quot;
</tt><pre style="margin: 0em;">
 !-&gt; define axis/x=1:2350:1 iaxis
Replacing definition of axis IAXIS
</pre><tt> !-&gt; DEFINE VARIABLE arq= 
</tt><tt>&quot;/home/paula/Ressurgencia/JASON/c334/JASON_1.dat&quot;
</tt><tt> !-&gt; SET 
</tt><tt>DATA/EZ/format=unformatted/grid=gridTRIPA/var=lon,lat,ssha/col=3 
</tt><tt>&quot;/home/paula/Ressurgencia/JASON/c334/JASON_1.dat&quot;
</tt><pre style="margin: 0em;">
 !-&gt; DEFINE VARIABLE sshaJASON1 = missing(sshaJASON,0)
</pre><tt> !-&gt; DEFINE VARIABLE sobrepoe1_ssha=if (sshaJASON NE 0) then 
</tt><tt>(sshaJASON) else (sobrepoe0_ssha[l=1])
</tt><pre style="margin: 0em;">

let sobrepoe_ssha=sobrepoe($cont2)_ssha[l=1]
 !-&gt; DEFINE VARIABLE sobrepoe_ssha=sobrepoe1_ssha[l=1]
set variable/bad=0 sobrepoe_ssha[l=1]

shade sobrepoe_ssha
 **ERROR: variable unknown or not in data set: SSHA
shade sobrepoe_ssha
Command file, command group, or REPEAT execution aborted*

</pre><tt>Is there any way to clear the datasets so I'm able to handle with new 
</tt><tt>variables?
</tt><pre style="margin: 0em;">

Thanks,
Paula Lamosa Nunes
</pre></blockquote><pre style="margin: 0em;">


</pre>
<!--X-Body-of-Message-End-->
<!--X-MsgBody-End-->
<!--X-Follow-Ups-->
<hr>
<!--X-Follow-Ups-End-->
<!--X-References-->
<ul><li><strong>References</strong>:
<ul>
<li><strong><a name="00096" href="msg00096.html">[ferret_users] Announcing Ferret v6.6.7, a bug-fix release</a></strong>
<ul><li><em>From:</em> Ansley Manke</li></ul></li>
<li><strong><a name="00097" href="msg00097.html">Re: [ferret_users] Announcing Ferret v6.6.7, a bug-fix release</a></strong>
<ul><li><em>From:</em> Martin Schmidt</li></ul></li>
<li><strong><a name="00098" href="msg00098.html">Re: [ferret_users] Announcing Ferret v6.6.7, a bug-fix release</a></strong>
<ul><li><em>From:</em> Ansley Manke</li></ul></li>
<li><strong><a name="00119" href="msg00119.html">[ferret_users] plotting and interpolating data given on curvilinear grids</a></strong>
<ul><li><em>From:</em> Martin Schmidt</li></ul></li>
<li><strong><a name="00120" href="msg00120.html">Re: [ferret_users] plotting and interpolating data given on curvilinear grids</a></strong>
<ul><li><em>From:</em> Ansley Manke</li></ul></li>
<li><strong><a name="00206" href="msg00206.html">RE: [ferret_users] plotting and interpolating data given on curvilinear grids</a></strong>
<ul><li><em>From:</em> PaulaOCN Nunes</li></ul></li>
<li><strong><a name="00215" href="msg00215.html">[ferret_users] Jason Images</a></strong>
<ul><li><em>From:</em> PaulaOCN Nunes</li></ul></li>
</ul></li></ul>
<!--X-References-End-->
<!--X-BotPNI-->
<UL>
<li>Previous by thread:
<strong><a href="msg00215.html">[ferret_users] Jason Images</a></strong>
</li>
<li>Next by thread:
<strong><a href="msg00219.html">Re: [ferret_users] Jason Images</a></strong>
</li>

</UL>
<center>[<a href="msg00215.html">Thread Prev</a>][<a href="msg00219.html">Thread Next</a>][<A HREF="threads.html#00217">Index</A>]</center>

<!--X-BotPNI-End-->
<!--X-User-Footer-->
<A HREF="http://ferret.pmel.noaa.gov/Ferret/contact-us">Contact Us</A>
<br>
<font size=-1>
<address>
<a href="http://www.doc.gov">Dept of Commerce</a> /
<a href="http://www.noaa.gov">NOAA</a> /
<a href="http://www.oar.noaa.gov">OAR</a> /
<a href="http://www.pmel.noaa.gov">PMEL</a> /
<a href="http://ferret.pmel.noaa.gov">Ferret</a>
</address>

<br>
 <a href="http://www.noaa.gov/privacy.html">Privacy Policy</a> | <a href="http://www.noaa.gov/disclaimer.html">Disclaimer</a> | <a href="accessibility.html">Accessibility Statement</a> 

</font>
<!--X-User-Footer-End-->
</body>
</html>
