<!-- MHonArc v2.5.13 -->
<!--X-Subject: Re: [ferret_users] Sverdrup Streamfunction &#45; indefinite integral withirregular boarders -->
<!--X-From-R13: "Ivyyvnz E. Yrffyre" <Ivyyvnz.E.YrffyreNabnn.tbi> -->
<!--X-Date: Mon, 3 Apr 2006 10:04:55 &#45;0700 -->
<!--X-Message-Id: 5B9D79C3&#45;0F25&#45;4684&#45;AE91&#45;89D58304DD67@noaa.gov -->
<!--X-Content-Type: multipart/mixed -->
<!--X-Reference: 442D3F11.4020000@ifm.zmaw.de -->
<!--X-Reference: 442DB699.3050406@noaa.gov -->
<!--X-Reference: 4430EEBB.2020008@ifm.zmaw.de -->
<!--X-Derived: gif00014.gif -->
<!--X-Head-End-->
<!doctype html public "-//W3C//DTD HTML//EN">
<html>
<head>
<title>Re: [ferret_users] Sverdrup Streamfunction - indefinite integral withirregular boarders</title>
</head>
<body>
<!--X-Body-Begin-->
<!--X-User-Header-->
<!--X-User-Header-End-->
<!--X-TopPNI-->
<HR>
<center>[<a href="msg00224.html">Thread Prev</a>][<a href="msg00222.html">Thread Next</a>][<A HREF="threads.html#00226">Index</A>]</center>

<!--X-TopPNI-End-->
<!--X-MsgBody-->
<!--X-Subject-Header-Begin-->
<h1>Re: [ferret_users] Sverdrup Streamfunction - indefinite integral withirregular boarders</h1>
<hr>
<!--X-Subject-Header-End-->
<!--X-Head-of-Message-->
<ul>
<li><strong>To</strong>: <strong>&quot;Dr. Theodor Yemenis&quot; &lt;<a href="mailto:yemenis@DOMAIN.HIDDEN">yemenis@xxxxxxxxxxxxxxxxxx</a>&gt;</strong></li>
<li><strong>Subject</strong>: <strong>Re: [ferret_users] Sverdrup Streamfunction - indefinite integral withirregular boarders</strong></li>
<li><strong>From</strong>: <strong>&quot;William S. Kessler&quot; &lt;<a href="mailto:William.S.Kessler@DOMAIN.HIDDEN">William.S.Kessler@xxxxxxxx</a>&gt;</strong></li>
<li>Date: Mon, 03 Apr 2006 10:04:49 -0700</li>
<li>Cc: William Kessler &lt;<a href="mailto:William.S.Kessler@DOMAIN.HIDDEN">William.S.Kessler@xxxxxxxx</a>&gt;,       Ansley Manke &lt;<a href="mailto:Ansley.B.Manke@DOMAIN.HIDDEN">Ansley.B.Manke@xxxxxxxx</a>&gt;,       ferret_users &lt;<a href="mailto:oar.pmel.ferret_users@DOMAIN.HIDDEN">oar.pmel.ferret_users@xxxxxxxx</a>&gt;</li>
<li>In-reply-to: &lt;<a href="msg00224.html">4430EEBB.2020008@ifm.zmaw.de</a>&gt;</li>
<li>References: &lt;<a href="msg00221.html">442D3F11.4020000@ifm.zmaw.de</a>&gt; &lt;<a href="msg00223.html">442DB699.3050406@noaa.gov</a>&gt;&lt;<a href="msg00224.html">4430EEBB.2020008@ifm.zmaw.de</a>&gt;</li>
<li>Sender: <a href="mailto:owner-ferret_users@DOMAIN.HIDDEN">owner-ferret_users@xxxxxxxxxxxxx</a></li>
</ul>
<!--X-Head-of-Message-End-->
<!--X-Head-Body-Sep-Begin-->
<hr>
<!--X-Head-Body-Sep-End-->
<!--X-Body-of-Message-->
The Sverdrup relation (Beta*V=Curl[tau]) only describes the interior  
circulation of an ocean, integrated west from the eastern boundary to  
just inside the western boundary. It explicitly does not encompass  
the western boundary currents, because as a westward integral it does  
not include the physics of the boundary layer, which must involve  
some other dynamics (in various models lateral friction,  
nonlinearity, eastward-propagating short Rossby waves). The  
calculation you are attempting does not make sense physically.<br>
<br>
This problem was solved by Stuart Godfrey, in what I think is one of  
the most elegant results of dynamical oceanography, the &quot;Island  
Rule&quot; (Godfrey, J.S., 1989: A Sverdrup model of the depth-integrated  
flow for the world ocean allowing for island circulations.  
Geophys.Astrophys.Fluid Dyn., 45, 89-112; also see subsequent papers  
by Roxana Wajsowicz).<br>
<br>
Physically, the requirement is that the streamfunction is constant  
along a land boundary. That means transport across a closed ocean  
basin (say the northern Indian Ocean) must be zero. The western  
boundary current must exactly balance the interior transport from the  
Sverdrup relation. If Bering Strait is considered closed, and a  
starting point (just to pick a constant of integration) is chosen at  
Cape Horn, then the streamfunction is zero along the west coast of  
the Americas, continuing entirely around East and South Asia (i.e.  
through the Indonesian Throughflow), around Africa and Europe, around  
the Arctic Ocean if it is included, and down the east coast of the  
Americas back to Cape Horn. Notably omitted from this requirement are  
Australia, New Zealand and Madagascar.<br>
<br>
Some parts of this CAN be found in Ferret: start from zero along the  
west coast of the Americas north of the equator (so as not to involve  
Australia/New Guinea), integrate the curl westward to Asia. Or start  
from Africa-Europe, integrate to the Americas. The Sverdrup relation  
gives the interior transport, and the assumption that the  
streamfunction is zero along those western boundaries completes the  
solution. Note that this does not say anything about the details of  
the western boundary layer, just its total transport, which in steady  
state must exactly balance the interior (Sverdrup) transport.<br>
<br>
The above does not give the solution in the South Pacific or the  
Indian Ocean south of the Throughflow. That is the problem Godfrey  
solved. Elegantly, and with no information but the wind. It is a  
little too involved to write in an e-mail, but I urge you to read his  
paper (perhaps more clearly explained in Wajsowicz (1993 JPO,  
1470-1484)). Godfrey realized that the vertically-integrated pressure  
difference between the south and north tips of an island can be found  
two ways from the momentum eqns: One, integrating the stress along a  
path from the south point (e.g. Tasmania) east to South America,  
north along the coast to the equator, and west along the equator to  
New Guinea; Two, integrating the stress along the west coast of  
Australia from Tasmania to New Guinea. These two integrals must give  
the same value, and the constant that resolves this is the net  
meridional transport through the South Pacific (or equivalently  
through the Indonesian Throughflow). That gives the streamfunction  
value at Australia, which is not zero. Spectacularly, that gives the  
transport of the ITF, which conforms well to the observed value.  
Knowing the value of the streamfunction along the coast of Australia,  
one can then integrate west across the Indian Ocean, do the same  
procedure for Madagascar, and have a complete Sverdrup streamfunction  
for the world ocean north of Drake Passage. (Refinements are to  
include New Zealand and some of the larger islands of the Pacific,  
which provide important details).<br>
<br>
See the attached figure for an example (or many details at http:// 
www.pmel.noaa.gov/~kessler/sverdrup/islandrule/islandrule.html). The  
values in the subtitle give the streamfunction values at the various  
islands.<br>
<br>
As far as I can tell this calculation must be done in fortran,  
because it requires working north along coasts to specified points,  
then west, then restarting again at the south points of islands. It  
is something of a pain! The algorithm is described in Godfrey (1989).<br>
<br>
This method does not deal with the Southern Ocean, for which the  
Sverdrup streamfunction is not defined because there is no eastern  
boundary; some other dynamics must be involved, and this remains a  
subject of debate (see papers by Steve Rintoul, among others).<br>
<br>
A further refinement is to include non-linear terms in a Sverdrup- 
like solution, which makes important improvements in the equatorial  
current systems  (see Kessler et al, 2003, available at http:// 
www.pmel.noaa.gov/~kessler/kjm01-abstract.html).<br>
<br>
Billy K<br>
<br>
<p><a href="gif00014.gif" ><img src="gif00014.gif" alt="GIF image"></a></p>
<pre>

On Apr 3, 2006, at 2:45 AM, Dr. Theodor Yemenis wrote:

</pre>
<blockquote style="border-left: #0000FF solid 0.1em; margin-left: 0.0em; padding-left: 1.0em">Hi Ansley,<br>
<br>
thanks for your  answer but something doesnt  work properly.<br>
<br>
my curl_tau is missing over land, so I don't need the land-mask.<br>
<br>
if I define PSI  like:<br>
<br>
    LET PSI = IF curl_tau[x=150E:0] THEN (1/(beta*rho_ocean))*( (-1) 
*curl_tau[x=150E:0@iin] + curl_tau[x=150E:0@din] )/1E06<br>
<br>
the result looks like in the attached image.<br>
<br>
The calculation breaks at the boundaries and behind missing values  
(islands).<br>
I think  @iin doesnt like missing values but I dont know how to  
filter them out<br>
so that  the integration would be executed only over non-missing  
values.<br>
<br>
<br>
best regards<br>
Theodor<br>
<br>
Ansley Manke wrote:<br>
<br>
<br>
<blockquote style="border-left: #0000FF solid 0.1em; margin-left: 0.0em; padding-left: 1.0em">Hi Theodor,<br>
I admit to looking at this just briefly, so I may be missing  
something. Is your variable curl_tau missing over land? In that  
case, in your definition of psi you should leave off the ELSE 0.   
The result will be missing wherever  the expresssion  curl_tau 
[x=160E:0@iin]  is false. On this kind of definition there is an  
implied &quot;ELSE missing&quot;<br>
<br>
Otherwise you need to apply a mask to the data as outlined in this  
FAQ about doing integration or averaging over irregular fields by  
applying a mask;<br>
<a  href="http://www.ferret.noaa.gov/Ferret/FAQ/analysis/avg_integ_irreg.html">http://www.ferret.noaa.gov/Ferret/FAQ/analysis/avg_integ_irreg.html</a><br>
<br>
For your case the mask would be a field which is 1 over water and  
missing over land.You could make such a variable from one of the  
topography data sets, choosing one which has a resolution similar  
to the grid your data is on<br>
<br>
  yes? use etopo20   yes? let mask = IF rose[d=etopo20,gxy=curl_tau 
[d=1]] LT 0 then 1<br>
  yes? shade mask  ! Look at the plot to check the definition<br>
<br>
Dr. Theodor Yemenis wrote:<br>
<br>
<br>
<blockquote style="border-left: #0000FF solid 0.1em; margin-left: 0.0em; padding-left: 1.0em">I am trying to calculate and plot with FERRET the Sverdrup  
Streamfunction from the wind stress curl  curl_tau<br>
<br>
acording to the formel:<br>
<br>
Psi = 1/beta Int_xlim(y) ^x curl(tau)dx,   xlim (y) is the   
longitude of the boundary at each latitude.<br>
<br>
I use the following definition (for the pacific ocean):<br>
<br>
  LET PSI = IF curl_tau[x=160E:0@iin] THEN (1/(beta*rho_ocean))* 
( (-1)*curl_tau[x=160E:0@iin] + curl_tau[x=160E:0@din] )/1E06 ELSE 0<br>
<br>
  fill PSI ; go land<br>
<br>
the result is as in the attached GIF-image, but it is not  
sutisfing. I have the following problem:<br>
<br>
- the islands(Hawaii, New Zeland, ...) and the Continent  
(Australia) disdurb the calculation (no streamfunction behind the  
land-boarders).<br>
The problem is computing an indefinite integral in an area with  
irregular boundaries.<br>
How can I solve this? Can someone help?<br>
<br>
best regards<br>
Theodor<br>
<br>
<br>
<br>
<br>
-------------------------------------------------------------------- 
----<br>
<br>
<br>
<br>
</blockquote></blockquote><pre>


--
--------------------------------------
Dr. Theodoros Yemenis
Center for Marine and Atmospheric Research
University of Hamburg
Institute of Oceanography
Bundesstrasse 53
D-20146 Hamburg
Germany
---------------------------------------

phone:   +49 40 42838 6104
 fax:   +49 40 42838 7063
        +49 40 36 801 801
email:   yemenis@ifm.zmaw.de   ---------------------------------------



&lt;Streamfunction.test.gif&gt;

</pre>
</blockquote><pre>
</pre>

<!--X-Body-of-Message-End-->
<!--X-MsgBody-End-->
<!--X-Follow-Ups-->
<hr>
<!--X-Follow-Ups-End-->
<!--X-References-->
<ul><li><strong>References</strong>:
<ul>
<li><strong><a name="00221" href="msg00221.html">[ferret_users] Sverdrup Streamfunction - indefinite integral with irregular boarders</a></strong>
<ul><li><em>From:</em> Dr. Theodor Yemenis</li></ul></li>
<li><strong><a name="00223" href="msg00223.html">Re: [ferret_users] Sverdrup Streamfunction - indefinite integral withirregular boarders</a></strong>
<ul><li><em>From:</em> Ansley Manke</li></ul></li>
<li><strong><a name="00224" href="msg00224.html">Re: [ferret_users] Sverdrup Streamfunction - indefinite integral withirregular boarders</a></strong>
<ul><li><em>From:</em> Dr. Theodor Yemenis</li></ul></li>
</ul></li></ul>
<!--X-References-End-->
<!--X-BotPNI-->
<UL>
<li>Previous by thread:
<strong><a href="msg00224.html">Re: [ferret_users] Sverdrup Streamfunction - indefinite integral withirregular boarders</a></strong>
</li>
<li>Next by thread:
<strong><a href="msg00222.html">[ferret_users] Ferret 5.81 Linux LET</a></strong>
</li>

</UL>
<center>[<a href="msg00224.html">Thread Prev</a>][<a href="msg00222.html">Thread Next</a>][<A HREF="threads.html#00226">Index</A>]</center>

<!--X-BotPNI-End-->
<!--X-User-Footer-->
<hr>
<font size=-1>
<address>
<a href="http://www.doc.gov">Dept of Commerce</a> / 
<a href="http://www.noaa.gov">NOAA</a> /
<a href="http://www.oar.noaa.gov">OAR</a> /
<a href="http://www.pmel.noaa.gov">PMEL</a> /
<a href="http://tmap.pmel.noaa.gov">TMAP</a>
</address> <br> <a href="http://ferret.pmel.noaa.gov/Ferret/ferret_contact_us.html">Contact Us</a> | <a href="http://www.noaa.gov/privacy.html">Privacy Policy</a> | <a href="http://www.noaa.gov/disclaimer.html">Disclaimer</a> | <a href="accessibility.html">Accessibility Statement</a> 
</font>
<!--X-User-Footer-End-->
</body>
</html>
