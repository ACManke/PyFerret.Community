<!-- MHonArc v2.6.18 -->
<!--X-Subject: Issue with sortl: [ferret_users] Percentile along time axis for gridded data -->
<!--X-From-R13: Ur Brat &#45; @AOO Ossvyvngr <tr.cratNabnn.tbi> -->
<!--X-Date: Mon, 4 Feb 2019 11:23:25 &#45;0800 -->
<!--X-Message-Id: CAOs80Nwqf+8Btc3T5JcyBvxNtA6m_1qjNxfqrN_xwPA3xDsq+A@mail.gmail.com -->
<!--X-Content-Type: multipart/alternative -->
<!--X-Reference: CAOs80NxHO=P0JV8V3E3KSsVVZ3ipdLx7f&#45;oTDqqtBjEAp2Y3RQ@mail.gmail.com -->
<!--X-Reference: 56FB2F57.2020603@csiro.au -->
<!--X-Head-End-->
<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN"
        "http://www.w3.org/TR/html4/loose.dtd">
<html>
<head>
<title>Issue with sortl: [ferret_users] Percentile along time axis for gridded data</title>
</head>
<body>
<!--X-Body-Begin-->
<!--X-User-Header-->
<!--X-User-Header-End-->
<!--X-TopPNI-->
<HR>
<center>[<a href="msg00017.html">Thread Prev</a>][<a href="msg00019.html">Thread Next</a>][<A HREF="threads.html#00018">Index</A>]</center>

<!--X-TopPNI-End-->
<!--X-MsgBody-->
<!--X-Subject-Header-Begin-->
<h1>Issue with sortl: [ferret_users] Percentile along time axis for gridded data</h1>
<hr>
<!--X-Subject-Header-End-->
<!--X-Head-of-Message-->
<ul>
<li><strong>To</strong>: <strong>ferret users &lt;<a href="mailto:ferret_users@DOMAIN.HIDDEN">ferret_users@xxxxxxxx</a>&gt;, <a href="mailto:russell.fiedler@DOMAIN.HIDDEN">russell.fiedler@xxxxxxxx</a></strong></li>
<li><strong>Subject</strong>: <strong>Issue with sortl: [ferret_users] Percentile along time axis for gridded data</strong></li>
<li><strong>From</strong>: <strong>Ge Peng - NOAA Affiliate &lt;<a href="mailto:ge.peng@DOMAIN.HIDDEN">ge.peng@xxxxxxxx</a>&gt;</strong></li>
<li>Date: Mon, 4 Feb 2019 14:23:12 -0500</li>
<li>Arc-authentication-results: i=2; mx.google.com;       dkim=pass header.i=@noaa.gov header.s=google header.b=kYrGz3NS;       spf=pass (google.com: domain of <a href="mailto:ge.peng@DOMAIN.HIDDEN">ge.peng@xxxxxxxx</a> designates 209.85.220.41 as permitted sender) smtp.mailfrom=<a href="mailto:ge.peng@DOMAIN.HIDDEN">ge.peng@xxxxxxxx</a>;       dmarc=pass (p=REJECT sp=NONE dis=NONE) header.from=noaa.gov</li>
<li>Arc-authentication-results: i=1; mx.google.com;       dkim=pass header.i=@noaa.gov header.s=google header.b=kYrGz3NS;       spf=pass (google.com: domain of <a href="mailto:ge.peng@DOMAIN.HIDDEN">ge.peng@xxxxxxxx</a> designates 209.85.220.41 as permitted sender) smtp.mailfrom=<a href="mailto:ge.peng@DOMAIN.HIDDEN">ge.peng@xxxxxxxx</a>;       dmarc=pass (p=REJECT sp=NONE dis=NONE) header.from=noaa.gov</li>
<li>Arc-message-signature: i=2; a=rsa-sha256; c=relaxed/relaxed; d=google.com; s=arc-20160816;        h=list-archive:list-help:list-post:list-id:mailing-list:precedence:cc         :to:subject:message-id:date:from:in-reply-to:references:mime-version         :dkim-signature;        bh=8q9Fp6jUXdyOmLj7IC68h4Huk+VVZqiuKMn5/fi+10w=;        b=FJQhTEZMq0KuCnKlsONn4d5KUwBCmK/C1vZDIxvkn+2gZuQjHVL8PDYJk+bTp2R+JF         mCA+wksMVN5kotRtWdf+MGHK4XSlPjiQ1e9Py8dNWyrMDgrXfHt9VknUjaCTIkLdQ5AO         som4OugUsGw5yhUf6ud/6pVxTk2J2VqArRHOOyQQ0SCZlPwVB4XD9rUdOZln7Ms7d/aD         3Dur2xhEIlYWfWJFX/510WYjiR+2uq/ueDg1v+DqWM82i+fDjHdkZU9wHU7VQpsCuI3D         +PgQMzzaDY1mgMV8+Se1CQL6sJGJfp495EESlUsa/WHY9rYnqJetbzXhqd+1zCxq/OYo         +bIQ==</li>
<li>Arc-message-signature: i=1; a=rsa-sha256; c=relaxed/relaxed; d=google.com; s=arc-20160816;        h=cc:to:subject:message-id:date:from:in-reply-to:references         :mime-version:dkim-signature;        bh=8q9Fp6jUXdyOmLj7IC68h4Huk+VVZqiuKMn5/fi+10w=;        b=IGrTNdBb5T93fSCNQNRwHAf5iaTncG7ZGb2kfOkgYAJuz+j3BjtminF4jdXrvysp3m         ls6qblYl5GNH+lKAo0ynbCKdgbXncaAswM0l/iWyUYehROH8j0qCFWBOEz1YBf8FquTH         v+YcEqnrtkOGmBmiaL7T8yW4bYouL7pdE71+B7d5PPhs2VcfRGgGypcA8ZEkSWPHy7JG         D8sWWfwunZ/F6oLgBJLtjmSKMtBoe4J+3IeYBgiZZduBdDQOrqh2IfnJe2M2eP8C3ACE         hsrUCZzlaJqFZBkaxypsYP3PN/Dd/FsZyXZlmHSd4pdy0juWsX2ZL5F2ln1VaIAyM07R         7bgQ==</li>
<li>Arc-seal: i=2; a=rsa-sha256; t=1549308204; cv=pass;        d=google.com; s=arc-20160816;        b=dU+H8lkYXg+l1eCxfm+folmSdgoYvr2ATRuv4GrGvlSqwmrWH6CLSZPRqU5nUakqEv         eCTYV7HBz4gl8IJgfkYYvusWJjl5CWD63ULev+iumaMVO55kRRxTwpQj4lpH8xpZj1lL         hLsqNkDATvgo6wDcXz2RvDUKKtLP/NmdnbBW2R3hD6+yqqsE2Dd9xdNuBPysgA1dMHSi         tlMeNle0AIHejII4JEn+8adwSxehOQJPGWNzPWQwmX6XlxS4DSzUdAAJZuA6lBfUodtW         anJFcfkTDro4v348sslcq0dz7XiSK/FX4nVDpvhcH4T14hAzqjXnWznhBO3572VXApAT         xsPw==</li>
<li>Arc-seal: i=1; a=rsa-sha256; t=1549308203; cv=none;        d=google.com; s=arc-20160816;        b=Gu6IXVXvT9aLMYD5jDZVFes7IEjEbyXF8MnDQAhSVVYWerfP+5svbhIDOgaVU66iHu         l4nRDvZbTM14b2Q/aWmMDBpxHBLlGvXDGHxgg3UBihrrt/Z55L2Y79ogC2HgxtRklAmW         1UIyZ7vjGiLlLpJIla5190DlUzFGGQJyVLnzrMh2FCDhMsiXfqafSL0Jablsi35O+Idv         pcJqpAsi3WicWOOh6CQQcOInjx0UukJEVqy6U8QgrnYBv5xqMQ69o/xaXUESS/PEhBHq         vz1Nf1wvOI5flS+d6DAVMyrnJU4NeIVcvb1a6uG/ZZKHtYGc5l7+yS9m1J4qpvu1qhiC         0y/A==</li>
<li>Cc: Ge Peng &lt;<a href="mailto:gpeng@DOMAIN.HIDDEN">gpeng@xxxxxxxx</a>&gt;</li>
<li>Dkim-signature: v=1; a=rsa-sha256; c=relaxed/relaxed;        d=noaa.gov; s=google;        h=mime-version:references:in-reply-to:from:date:message-id:subject:to         :cc:x-original-sender:x-original-authentication-results:precedence         :mailing-list:list-id:list-post:list-help:list-archive;        bh=8q9Fp6jUXdyOmLj7IC68h4Huk+VVZqiuKMn5/fi+10w=;        b=cPaC7LT0DVgOhqBMVzqAAPdg+6UkBz7rzw/TNEFLUGSmqA3wqgQ4Fy24DIhpeL4A0d         sFRtlQnCO3WJ5Yq2rYhfE1s5S2OgdSzTZrXeqPvzfSZZTUW6DqsTAW38KHOvw0W2YGSy         0tuGplICmPWLepYf2OzfR2YYMjRyqej/3aAml0Qg/0oUq6Q2xQUzEXPcWQNUhMtGz6xt         OIczPLieNVcRk9xWiEDblljnMKk5qRHMK5GZRIBuVkilpZu3Jtpmg/t4dbWunjxkS16c         trxggmva8UcM6ySwT/9wzIYWQCUKgZkqfDLp0lm0S7yk09ndBclpe+U4CSQgoSdSZHhi         LEUQ==</li>
<li>In-reply-to: &lt;56FB2F57.2020603@csiro.au&gt;</li>
<li>List-archive: &lt;<a href="https://groups.google.com/a/noaa.gov/group/ferret_users/">https://groups.google.com/a/noaa.gov/group/ferret_users/</a>&gt;</li>
<li>List-help: &lt;<a href="https://support.google.com/a/noaa.gov/bin/topic.py?topic=25838">https://support.google.com/a/noaa.gov/bin/topic.py?topic=25838</a>&gt;, &lt;<a href="mailto:ferret_users+help@noaa.gov">mailto:ferret_users+help@noaa.gov</a>&gt;</li>
<li>List-id: &lt;ferret_users.noaa.gov&gt;</li>
<li>List-post: &lt;<a href="https://groups.google.com/a/noaa.gov/group/ferret_users/post">https://groups.google.com/a/noaa.gov/group/ferret_users/post</a>&gt;, &lt;<a href="mailto:ferret_users@noaa.gov">mailto:ferret_users@noaa.gov</a>&gt;</li>
<li>Mailing-list: list <a href="mailto:ferret_users@DOMAIN.HIDDEN">ferret_users@xxxxxxxx</a>; contact <a href="mailto:ferret_users%2Bowners@DOMAIN.HIDDEN">ferret_users+owners@xxxxxxxx</a></li>
<li>References: &lt;CAOs80NxHO=P0JV8V3E3KSsVVZ3ipdLx7f-oTDqqtBjEAp2Y3RQ@mail.gmail.com&gt; &lt;56FB2F57.2020603@csiro.au&gt;</li>
<li>Sender: <a href="mailto:owner-ferret_users@DOMAIN.HIDDEN">owner-ferret_users@xxxxxxxx</a></li>
</ul>
<!--X-Head-of-Message-End-->
<!--X-Head-Body-Sep-Begin-->
<hr>
<!--X-Head-Body-Sep-End-->
<!--X-Body-of-Message-->
<div dir="ltr"><div dir="ltr"><div class="gmail_default" style=""><p class="MsoNormal" style="font-size:12pt;margin:0in 0in 0.0001pt;font-family:Calibri,sans-serif"><a rel="nofollow" name="_GoBack"></a><br></p>

<p class="MsoNormal" style="margin:0in 0in 0.0001pt"><font face="Calibri, sans-serif" style="font-size:12pt">&#xA0;</font><font face="arial, helvetica, sans-serif" style="">I am using the method provided by Russ a couple of years ago
to compute percentile along time axis for gridded data of sea ice
concentrations.</font></p>

<p class="MsoNormal" style="margin:0in 0in 0.0001pt"><font face="arial, helvetica, sans-serif">&#xA0;</font></p>

<p class="MsoNormal" style="margin:0in 0in 0.0001pt"><font face="arial, helvetica, sans-serif">The resultant Q-tiles are a bit of too scattered in the seasonal
varying ice zone. I have worked with Russ directly during the shutdown &#x2013; Thank
you, Russ, for your helpful suggestions. &#xA0;</font></p>

<p class="MsoNormal" style="margin:0in 0in 0.0001pt"><font face="arial, helvetica, sans-serif">&#xA0;</font></p>

<p class="MsoNormal" style="margin:0in 0in 0.0001pt"><font face="arial, helvetica, sans-serif">looking into it in more details, I am a bit of confused by
the behavior of function sortl which does not seem to sort correctly in ldim at
each I,j grid cell in the sense that the largest value should be sorted as the last.
It can be demonstrated by the following ferret output. (I was using a much
earlier version but have reinstalled the latest per Russ&#x2019;s suggestion. The results are the same.)</font></p>

<p class="MsoNormal" style="margin:0in 0in 0.0001pt"><font face="arial, helvetica, sans-serif">&#xA0;</font></p>

<p class="MsoNormal" style="margin:0in 0in 0.0001pt"><font face="arial, helvetica, sans-serif">Is this correct?</font></p>

<p class="MsoNormal" style="margin:0in 0in 0.0001pt"><font face="arial, helvetica, sans-serif">&#xA0;</font></p>

<p class="MsoNormal" style="margin:0in 0in 0.0001pt"><font face="arial, helvetica, sans-serif">Thanks,</font></p>

<p class="MsoNormal" style="margin:0in 0in 0.0001pt"><font face="arial, helvetica, sans-serif">&#xA0;</font></p>

<p class="MsoNormal" style="margin:0in 0in 0.0001pt"><font face="arial, helvetica, sans-serif" style="">--- Peng</font></p>

<p class="MsoNormal" style="font-size:12pt;margin:0in 0in 0.0001pt;font-family:Calibri,sans-serif">&#xA0;</p>

<p class="MsoNormal" style="font-size:12pt;margin:0in 0in 0.0001pt;font-family:Calibri,sans-serif">$ ferret</p>

<p class="MsoNormal" style="font-size:12pt;margin:0in 0in 0.0001pt;font-family:Calibri,sans-serif">&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0; NOAA/PMEL TMAP</p>

<p class="MsoNormal" style="font-size:12pt;margin:0in 0in 0.0001pt;font-family:Calibri,sans-serif">&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0; FERRET v7.44 (optimized)</p>

<p class="MsoNormal" style="font-size:12pt;margin:0in 0in 0.0001pt;font-family:Calibri,sans-serif">&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0; Linux 3.10.0-957.1.3.el7.x86_64
64-bit - 12/07/18</p>

<p class="MsoNormal" style="font-size:12pt;margin:0in 0in 0.0001pt;font-family:Calibri,sans-serif">&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0; &#xA0;4-Feb-19 14:01</p>

<p class="MsoNormal" style="font-size:12pt;margin:0in 0in 0.0001pt;font-family:Calibri,sans-serif">&#xA0;</p>

<p class="MsoNormal" style="font-size:12pt;margin:0in 0in 0.0001pt;font-family:Calibri,sans-serif">yes? use coads_climatology</p>

<p class="MsoNormal" style="font-size:12pt;margin:0in 0in 0.0001pt;font-family:Calibri,sans-serif">yes? let numpoints=`sst,return=lend`</p>

<p class="MsoNormal" style="font-size:12pt;margin:0in 0in 0.0001pt;font-family:Calibri,sans-serif">&#xA0;!-&gt; DEFINE
VARIABLE numpoints=12</p>

<p class="MsoNormal" style="font-size:12pt;margin:0in 0in 0.0001pt;font-family:Calibri,sans-serif">yes? let numlats=`sst,return=jend]`</p>

<p class="MsoNormal" style="font-size:12pt;margin:0in 0in 0.0001pt;font-family:Calibri,sans-serif">&#xA0;!-&gt; DEFINE
VARIABLE numlats=90</p>

<p class="MsoNormal" style="font-size:12pt;margin:0in 0in 0.0001pt;font-family:Calibri,sans-serif">yes? let/title=&quot;sorted indices&quot;
sorted_by_time=sortl(sst[l=1:`numpoints`])</p>

<p class="MsoNormal" style="font-size:12pt;margin:0in 0in 0.0001pt;font-family:Calibri,sans-serif">&#xA0;!-&gt; DEFINE
VARIABLE/title=&quot;sorted indices&quot; sorted_by_time=sortl(sst[l=1:12])</p>

<p class="MsoNormal" style="font-size:12pt;margin:0in 0in 0.0001pt;font-family:Calibri,sans-serif">yes? list sst[i=90,j=45],sorted_by_time[i=90,j=45]</p>

<p class="MsoNormal" style="font-size:12pt;margin:0in 0in 0.0001pt;font-family:Calibri,sans-serif">&#xA0;WARNING: Listed
variables have ambiguous coordinates on axes: T</p>

<p class="MsoNormal" style="font-size:12pt;margin:0in 0in 0.0001pt;font-family:Calibri,sans-serif">&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0; DATA SET:
/snfs1/users/gpeng/myFerret/fer_dsets/FerretDatasets-7.4/data/coads_climatology.cdf</p>

<p class="MsoNormal" style="font-size:12pt;margin:0in 0in 0.0001pt;font-family:Calibri,sans-serif">&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;
LONGITUDE: 161W</p>

<p class="MsoNormal" style="font-size:12pt;margin:0in 0in 0.0001pt;font-family:Calibri,sans-serif">&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0; LATITUDE:
1S</p>

<p class="MsoNormal" style="font-size:12pt;margin:0in 0in 0.0001pt;font-family:Calibri,sans-serif">&#xA0;Column&#xA0; 1: SST[T=01-JAN 00:45:31-DEC 06:34] is SEA
SURFACE TEMPERATURE (Deg C)</p>

<p class="MsoNormal" style="font-size:12pt;margin:0in 0in 0.0001pt;font-family:Calibri,sans-serif">&#xA0;Column&#xA0; 2: SORTED_BY_TIME[T=0.5:12.5] is sorted
indices</p>

<p class="MsoNormal" style="font-size:12pt;margin:0in 0in 0.0001pt;font-family:Calibri,sans-serif">&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0; SST&#xA0; SORTED_BY_TIME</p>

<p class="MsoNormal" style="font-size:12pt;margin:0in 0in 0.0001pt;font-family:Calibri,sans-serif">L /&#xA0; 1:&#xA0; 26.82&#xA0;&#xA0;&#xA0;
1.00</p>

<p class="MsoNormal" style="font-size:12pt;margin:0in 0in 0.0001pt;font-family:Calibri,sans-serif">L /&#xA0; 2: &#xA0;26.99&#xA0;&#xA0;&#xA0;
2.00</p>

<p class="MsoNormal" style="font-size:12pt;margin:0in 0in 0.0001pt;font-family:Calibri,sans-serif">L /&#xA0; 3:&#xA0; 27.47&#xA0;&#xA0;
12.00</p>

<p class="MsoNormal" style="font-size:12pt;margin:0in 0in 0.0001pt;font-family:Calibri,sans-serif">L /&#xA0; 4:&#xA0; 27.83&#xA0;&#xA0;
11.00</p>

<p class="MsoNormal" style="font-size:12pt;margin:0in 0in 0.0001pt;font-family:Calibri,sans-serif">L /&#xA0; 5:&#xA0; 27.96&#xA0;&#xA0;&#xA0;
9.00</p>

<p class="MsoNormal" style="font-size:12pt;margin:0in 0in 0.0001pt;font-family:Calibri,sans-serif"><b>L /&#xA0; 6:&#xA0;
28.22&#xA0;&#xA0;&#xA0; 8.00</b></p>

<p class="MsoNormal" style="font-size:12pt;margin:0in 0in 0.0001pt;font-family:Calibri,sans-serif">L /&#xA0; 7:&#xA0; 27.96&#xA0;&#xA0;&#xA0;
3.00</p>

<p class="MsoNormal" style="font-size:12pt;margin:0in 0in 0.0001pt;font-family:Calibri,sans-serif">L /&#xA0; 8:&#xA0; 27.42&#xA0;&#xA0;
10.00</p>

<p class="MsoNormal" style="font-size:12pt;margin:0in 0in 0.0001pt;font-family:Calibri,sans-serif">L /&#xA0; 9:&#xA0; 27.33&#xA0;&#xA0;&#xA0;
4.00</p>

<p class="MsoNormal" style="font-size:12pt;margin:0in 0in 0.0001pt;font-family:Calibri,sans-serif">L / 10:&#xA0; 27.55&#xA0;&#xA0;&#xA0; 5.00</p>

<p class="MsoNormal" style="font-size:12pt;margin:0in 0in 0.0001pt;font-family:Calibri,sans-serif">L / 11:&#xA0; 27.22&#xA0;&#xA0;&#xA0; 7.00</p>

<p class="MsoNormal" style="font-size:12pt;margin:0in 0in 0.0001pt;font-family:Calibri,sans-serif">L / 12:&#xA0; 27.02&#xA0;&#xA0;&#xA0; 6.00</p>

<p class="MsoNormal" style="font-size:12pt;margin:0in 0in 0.0001pt;font-family:Calibri,sans-serif">&#xA0;</p></div></div><br><div class="gmail_quote"><div dir="ltr" class="gmail_attr">On Tue, Mar 29, 2016 at 10:16 PM Russ Fiedler &lt;russell.fiedler@xxxxxxxx&gt; wrote:<br></div><blockquote class="gmail_quote" style="margin:0px 0px 0px 0.8ex;border-left:1px solid rgb(204,204,204);padding-left:1ex">
  
    
  
  <div bgcolor="#FFFFFF">
    <div class="gmail-m_-3865166786425923335moz-cite-prefix"><br>
      Hi Peng,<br>
      <br>
      I did this in the dim distant past by saving the sorted data to a
      file and then picked the appropriate values out.<br>
      <br>
      use coads_climatology<br>
      let numpoints=`sst,return=lend`<br>
      let numlats=`sst,return=jend]`<br>
      let/title=&quot;sorted indices&quot;
      sorted_by_time=sortl(sst[l=1:`numpoints`])<br>
      <br>
      ! I found that I ran out of memory if I tried to sort too much for
      some GB sized datasets. It depends on the size of your dataset.<br>
      ! You might be able to make larger windows or even do it in one
      go.<br>
      <br>
      save/j=1/jlimits=1:`numlats`/clob/file=<a rel="nofollow" href="http://sorted.nc" target="_blank">sorted.nc</a> sorted_by_time<br>
      repeat/j=2:`numlats` save/app/file=<a rel="nofollow" href="http://sorted.nc" target="_blank">sorted.nc</a> sorted_by_time<br>
      <br>
      can var sorted_by_time<br>
      use sorted<br>
      <br>
      ! Make a variable with time indices<br>
      <br>
      let index_2d=0*x[g=sorted_by_time] + 0*y[g=sorted_by_time] +
      l[g=sorted_by_time]<br>
      <br>
      ! Create an integrating kernel for the percentile wanted 1 for the
      limit we want and missing elsewhere. <br>
      <br>
      !25 percentile say. Make sure at least 1 valid point is used<br>
      <br>
      let k25 = if l[g=index_2d] eq
      max(int(0.25*ignore0(sorted_by_time[l=1:`numpoints`@ngd])),1) then
      1<br>
      <br>
      ! Show the indices used in the sorted data. Note that missing
      values are accounted for.<br>
      <br>
      <br>
      shade k25[l=@loc:1]<br>
      <br>
      ! Multiply by SST and sum&#xA0; up<br>
      <br>
      let sst_k25 =
      k25[gl=sst[d=coads_climatology]@asn]*sst[d=coads_climatology]<br>
      <br>
      let/title=&quot;sst at 25 percentile&quot;
      sst25=sst_k25[l=1:`numpoints`@sum]<br>
      <br>
      shade sst25<br>
      <br>
      <br>
      Cheers,<br>
      Russ<br>
      <br>
      <br>
      On 30/03/16 05:32, Ge Peng - NOAA Affiliate wrote:<br>
    </div>
    <blockquote type="cite">
      
      <div dir="ltr">
        <div>
          <p class="MsoNormal">Found this message showing how to find
            percentiles for 2-dimensional
            gridded data:</p>
          <p class="MsoNormal"><span style="line-height:115%"><a rel="nofollow" href="http://ferret.pmel.noaa.gov/Ferret/Mail_Archives/fu_2004/msg00632.html" target="_blank"></a><a rel="nofollow" class="gmail-m_-3865166786425923335moz-txt-link-freetext" href="http://ferret.pmel.noaa.gov/Ferret/Mail_Archives/fu_2004/msg00632.html" target="_blank">http://ferret.pmel.noaa.gov/Ferret/Mail_Archives/fu_2004/msg00632.html</a></span></p>
          <p class="MsoNormal"><br>
          </p>
          <p class="MsoNormal">However, I would like to compute
            quantiles/percentiles along
            my time axis at each grid cell of the 2-dimensional gridded
            data. I.e., for
            each x and y, the percentiles are done along the time axis
            with valid data
            points. (We can ignore the z dimension for now.)</p>
          <p class="MsoNormal"><br>
          </p>
          <p class="MsoNormal">I could take the time series at each grid
            cell using nested
            repeat loop in x and y dimensions, following the above
            example to sort the data
            and place the ordered data onto the tiled axis. </p>
          <p class="MsoNormal"><br>
          </p>
          <p class="MsoNormal">It does not sound very efficient to me.
            Has anyone done
            something similar in ferret? Is there a better way to do
            this, perhaps without nested repeat
            loops in both x and y directions? </p>
          <p class="MsoNormal"><br>
          </p>
          <p class="MsoNormal">Appreciate any help.</p>
          <span style="line-height:115%;font-family:Calibri,sans-serif">
            <div><span style="line-height:115%;font-family:Calibri,sans-serif"><br>
              </span></div>
            --- Peng</span><br clear="all">
        </div>
        <div><br>
        </div>
        -- <br>
        <div class="gmail-m_-3865166786425923335gmail_signature">
          <div dir="ltr">
            <div>
              <div dir="ltr">
                <div>
                  <div dir="ltr">
                    <div><span style="color:rgb(51,51,51);font-family:Times;line-height:11.9886px;font-size:11px"><span style="font-family:arial,helvetica,sans-serif"><b>Ge
                            Peng, Ph.D</b><br>
                          <b>Research Scholar</b><br>
                        </span></span>
                      <p style="margin-bottom:0.0001pt"><font face="arial, helvetica, sans-serif" size="2">Cooperative
Institute
                          for Climate and Satellites,&#xA0;NC (CICS-NC)</font></p>
                      <p style="margin-bottom:0.0001pt"><font face="arial, helvetica, sans-serif" size="2">North
Carolina
                          State University (NCSU) and</font></p>
                      <p style="margin-bottom:0.0001pt"><font face="arial, helvetica, sans-serif" size="2">NOAA&#x2019;s
National
                          Centers for Environmental Information (NCEI)</font></p>
                      <p style="margin-bottom:0.0001pt"><font face="arial, helvetica, sans-serif" size="2">Center
for
                          Weather and Climate (CWC)</font></p>
                      <p style="margin-bottom:0.0001pt"><font face="arial, helvetica, sans-serif" size="2"><br>
                        </font></p>
                      <span style="color:rgb(51,51,51);line-height:11.9886px"><font face="arial, helvetica, sans-serif" size="2">151
                          Patton Ave, Asheville, NC 28801<br>
                          <a rel="nofollow" href="mailto:ge.peng@xxxxxxxx" target="_blank">ge.peng@xxxxxxxx</a><br>
                          o: +1 828 257 3009<br>
                          f: &#xA0;+1 828 257 3002</font><br>
                      </span>
                      <p style="color:rgb(51,51,51);font-family:Times;font-size:13.6364px;margin-bottom:0.0001pt;background-color:white"><span style="font-family:arial,helvetica,sans-serif;font-size:10.9091px;line-height:11.9886px;text-align:-webkit-center">Following
                          CICS-NC on&#xA0;</span><a rel="nofollow" href="http://www.facebook.com/cicsnc" style="font-family:arial,helvetica,sans-serif;font-size:10.9091px;line-height:11.9886px;text-align:-webkit-center;color:rgb(38,58,143);text-decoration:none;font-weight:bold" target="_blank">Facebook</a></p>
                      <table style="max-width:100%;border-collapse:collapse;border-spacing:0px;color:rgb(51,51,51);font-size:14px;font-family:Times;line-height:12px" border="0" width="500" cellpadding="2" cellspacing="2">
                        <tbody>
                          <tr>
                            <td align="center" height="71" width="71"><br>
                            </td>
                            <td valign="top"><br>
                            </td>
                          </tr>
                        </tbody>
                      </table>
                    </div>
                  </div>
                </div>
              </div>
            </div>
          </div>
        </div>
      </div>
    </blockquote>
    <br>
  </div>

</blockquote></div><br clear="all"><div><br></div>-- <br><div dir="ltr" class="gmail_signature"><div dir="ltr"><div><div dir="ltr"><div><div dir="ltr"><div><div dir="ltr"><div dir="ltr"><div dir="ltr"><p><b><span style="font-size:9pt;font-family:Arial;color:rgb(51,51,51);background:white">Ge
Peng, PhD</span></b><span style="font-size:9pt;font-family:Arial;color:rgb(51,51,51);background:white"><br>
<b>Research Scholar</b><br>
</span><span style="font-size:9pt;font-family:Arial;color:rgb(34,34,34)">Cooperative
Institute for Climate and Satellites - NC (CICS-NC)/NCSU at</span><span style="font-size:9pt;font-family:Times"></span></p><p><span style="font-size:9pt;font-family:Arial;color:rgb(34,34,34)">NOAA&#x2019;s
National Centers for Environmental Information (NCEI)</span><span style="font-size:9pt;font-family:Times"></span></p><p><span style="font-size:9pt;font-family:Arial;color:rgb(34,34,34)">Center
for Weather and Climate (CWC)</span><span style="font-size:9pt;font-family:Times"></span></p><p><span style="font-size:9pt;font-family:Arial;color:rgb(51,51,51);background:white">151 Patton Ave, Asheville, NC
28801<br>
<a rel="nofollow"><span style="color:rgb(17,85,204)">+1 828 257 3009</span></a>; <span style="color:rgb(17,85,204)"><a rel="nofollow" href="mailto:ge.peng@xxxxxxxx" target="_blank">ge.peng@xxxxxxxx</a></span></span></p><p><span style="font-size:9pt;font-family:Arial">ORCID: http://</span><span style="font-size:9pt;font-family:Arial;color:rgb(73,74,76);background-image:initial;background-position:initial;background-repeat:initial"><a rel="nofollow" href="http://orcid.org/0000-0002-1986-9115" target="_blank">orcid.org/0000-0002-1986-9115</a></span></p><p style="color:rgb(51,51,51);font-family:Times;font-size:13.6364px;margin-bottom:0.0001pt;background-color:white"><span style="font-family:arial,helvetica,sans-serif;font-size:10.9091px;line-height:11.9886px;text-align:-webkit-center">Following CICS-NC on&#xA0;</span><a rel="nofollow" href="http://www.facebook.com/cicsnc" style="font-family:arial,helvetica,sans-serif;font-size:10.9091px;line-height:11.9886px;text-align:-webkit-center;color:rgb(38,58,143);text-decoration:none;font-weight:bold" target="_blank">Facebook</a></p><table border="0" cellpadding="2" cellspacing="2" width="500" style="max-width:100%;border-collapse:collapse;border-spacing:0px;color:rgb(51,51,51);font-size:14px;font-family:Times;line-height:12px"><tbody><tr><td align="center" height="71" width="71"><br></td><td valign="top"><br></td></tr></tbody></table></div></div></div></div></div></div></div></div></div></div></div>

<!--X-Body-of-Message-End-->
<!--X-MsgBody-End-->
<!--X-Follow-Ups-->
<hr>
<ul><li><strong>Follow-Ups</strong>:
<ul>
<li><strong><a name="00019" href="msg00019.html">Re: Issue with sortl: [ferret_users] Percentile along time axis for gridded data</a></strong>
<ul><li><em>From:</em> Ansley C. Manke</li></ul></li>
</ul></li></ul>
<!--X-Follow-Ups-End-->
<!--X-References-->
<!--X-References-End-->
<!--X-BotPNI-->
<UL>
<li>Previous by thread:
<strong><a href="msg00017.html">[ferret_users] how to overlay South Hemisphere latitude on North Hemisphere latitude</a></strong>
</li>
<li>Next by thread:
<strong><a href="msg00019.html">Re: Issue with sortl: [ferret_users] Percentile along time axis for gridded data</a></strong>
</li>

</UL>
<center>[<a href="msg00017.html">Thread Prev</a>][<a href="msg00019.html">Thread Next</a>][<A HREF="threads.html#00018">Index</A>]</center>

<!--X-BotPNI-End-->
<!--X-User-Footer-->
<A HREF="http://ferret.pmel.noaa.gov/Ferret/contact-us">Contact Us</A>
<br>
<font size=-1>
<address>
<a href="http://www.doc.gov">Dept of Commerce</a> /
<a href="http://www.noaa.gov">NOAA</a> /
<a href="http://www.oar.noaa.gov">OAR</a> /
<a href="http://www.pmel.noaa.gov">PMEL</a> /
<a href="http://ferret.pmel.noaa.gov">Ferret</a>
</address>

<br>
 <a href="http://www.noaa.gov/privacy.html">Privacy Policy</a> | <a href="http://www.noaa.gov/disclaimer.html">Disclaimer</a> | <a href="accessibility.html">Accessibility Statement</a> 

</font>
<!--X-User-Footer-End-->
</body>
</html>
