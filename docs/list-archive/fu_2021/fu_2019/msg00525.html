<!-- MHonArc v2.6.18 -->
<!--X-Subject: Re: [ferret_users] reusing information from variable definitions -->
<!--X-From-R13: [nepb ina Vhygra <[nepb.VhygraNhvo.ab> -->
<!--X-Date: Tue, 11 Feb 2020 02:31:01 &#45;0800 -->
<!--X-Message-Id: 20200211113050.5de12d52@gfi063209.klientdrift.uib.no -->
<!--X-Content-Type: text/plain -->
<!--X-Reference: 20200127153619.0a19cf13@gfi063209.klientdrift.uib.no -->
<!--X-Reference: d00080bd&#45;a43e&#45;66d1&#45;fd55&#45;de6ccab4a0b0@noaa.gov -->
<!--X-Reference: 20200210174651.41f8eccb@gfi063209.klientdrift.uib.no -->
<!--X-Reference: ME2PR01MB322055FFCCAA90D3A015AB8C9D180@ME2PR01MB3220.ausprd01.prod.outlook.com -->
<!--X-Head-End-->
<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN"
        "http://www.w3.org/TR/html4/loose.dtd">
<html>
<head>
<title>Re: [ferret_users] reusing information from variable definitions</title>
</head>
<body>
<!--X-Body-Begin-->
<!--X-User-Header-->
<!--X-User-Header-End-->
<!--X-TopPNI-->
<HR>
<center>[<a href="msg00524.html">Thread Prev</a>][<a href="msg00526.html">Thread Next</a>][<A HREF="threads.html#00525">Index</A>]</center>

<!--X-TopPNI-End-->
<!--X-MsgBody-->
<!--X-Subject-Header-Begin-->
<h1>Re: [ferret_users] reusing information from variable definitions</h1>
<hr>
<!--X-Subject-Header-End-->
<!--X-Head-of-Message-->
<ul>
<li><strong>To</strong>: <strong><a href="mailto:ferret_users@DOMAIN.HIDDEN">ferret_users@xxxxxxxx</a></strong></li>
<li><strong>Subject</strong>: <strong>Re: [ferret_users] reusing information from variable definitions</strong></li>
<li><strong>From</strong>: <strong>Marco van Hulten &lt;<a href="mailto:Marco.Hulten@DOMAIN.HIDDEN">Marco.Hulten@xxxxxx</a>&gt;</strong></li>
<li>Date: Tue, 11 Feb 2020 11:30:50 +0100</li>
<li>Arc-authentication-results: i=4; mx.google.com;       dkim=pass header.i=@uib.no header.s=20160927 header.b=qK8Ny+Q+;       arc=pass (i=2 dkim=pass dkdomain=uib.no);       spf=softfail (google.com: domain of transitioning <a href="mailto:marco.hulten@DOMAIN.HIDDEN">marco.hulten@xxxxxx</a> does not designate 209.85.160.200 as permitted sender) smtp.mailfrom=<a href="mailto:marco.hulten@DOMAIN.HIDDEN">marco.hulten@xxxxxx</a></li>
<li>Arc-authentication-results: i=3; mx.google.com;       dkim=pass header.i=@uib.no header.s=20160927 header.b=qK8Ny+Q+;       arc=pass (i=2 dkim=pass dkdomain=uib.no);       spf=softfail (google.com: domain of transitioning <a href="mailto:marco.hulten@DOMAIN.HIDDEN">marco.hulten@xxxxxx</a> does not designate 209.85.160.200 as permitted sender) smtp.mailfrom=<a href="mailto:marco.hulten@DOMAIN.HIDDEN">marco.hulten@xxxxxx</a></li>
<li>Arc-authentication-results: i=2; mx.google.com;       dkim=pass header.i=@uib.no header.s=20160927 header.b=qK8Ny+Q+;       arc=pass (i=1 spf=pass spfdomain=uib.no dkim=pass dkdomain=uib.no dmarc=pass fromdomain=uib.no);       spf=softfail (google.com: domain of transitioning <a href="mailto:marco.hulten@DOMAIN.HIDDEN">marco.hulten@xxxxxx</a> does not designate 65.153.203.176 as permitted sender) smtp.mailfrom=<a href="mailto:Marco.Hulten@DOMAIN.HIDDEN">Marco.Hulten@xxxxxx</a></li>
<li>Arc-authentication-results: i=1; mx.google.com;       dkim=pass header.i=@uib.no header.s=20160927 header.b=qK8Ny+Q+;       spf=pass (google.com: domain of <a href="mailto:marco.hulten@DOMAIN.HIDDEN">marco.hulten@xxxxxx</a> designates 2001:700:200:30::141 as permitted sender) smtp.mailfrom=<a href="mailto:Marco.Hulten@DOMAIN.HIDDEN">Marco.Hulten@xxxxxx</a>;       dmarc=pass (p=NONE sp=NONE dis=NONE) header.from=uib.no</li>
<li>Arc-message-signature: i=4; a=rsa-sha256; c=relaxed/relaxed; d=google.com; s=arc-20160816;        h=list-archive:list-help:list-post:list-id:mailing-list:precedence         :message-id:content-transfer-encoding:mime-version:organization         :references:in-reply-to:subject:to:from:date:sender:dkim-signature;        bh=tbDnSmBedXM7hz8e1bNo7HKREl9yTe+cTBkz6N71Cuc=;        b=dt3FPanKbk7tPGVa9T5gS3DG9qUF/C+jog75CGh3yB536yb96jPY2B2fR0kHtWjEDD         oK+zpcQClYH9JmIJugLj4Z4I4HYJamn2owoBiKEhw5ANfkMJIYuT5dls3T445x+3MZz5         udes7rWUuJROTr/bVaw5gVeBlKEHQaZhIfx2ApP5n2WyF2yvI6z9VYMdNd2q21JLJ8kj         SYwsVdOcmuzY89/nTYm7L6K8itX1u2rJr1ezLPUG5XwH0VhYDvwFTK3SXBPwjHW2iY/A         t5w9m5oz0xx4HWpO7fOBtfgp7cPxkA/Adtx++XQwyY/vQdTCGkFi6dK94fXo6UoBt8jR         9sWQ==</li>
<li>Arc-message-signature: i=3; a=rsa-sha256; c=relaxed/relaxed; d=google.com; s=arc-20160816;        h=message-id:content-transfer-encoding:mime-version:organization         :references:in-reply-to:subject:to:from:date:dkim-signature;        bh=tbDnSmBedXM7hz8e1bNo7HKREl9yTe+cTBkz6N71Cuc=;        b=G2uljSh2+FX8U9AWHAGUZkrFd9t0QvxVdUfTnftyqT7uNvaid+M8ugIJc+mzExfWTU         PxD51PlT7Qaq+ZB2G0bh2Bk0DEal8K7TwD79GXjbaLD4OKcTj+4YTKU5nL3jvLS8WiJ2         gC2ITEoUivl+fQoe1i2y4Fg91vIdOuF3wHCsN4McfSFSAfb8n2+PmcUJv8v62+VQrTKg         cOHDUg15nQQjji1gIdgqcNDefJ7UXhyOKH28m4apKNzHjBNbmqqm6TM10XAotRN7a21j         +kKLnOdcAVipkmNVH0GQdI7j3tZW4riQKbzpQLquzDSd4CXQTFnqmf4WJjz8XE5Yj8LE         tCaw==</li>
<li>Arc-message-signature: i=2; a=rsa-sha256; c=relaxed/relaxed; d=google.com; s=arc-20160816;        h=content-transfer-encoding:mime-version:organization:references         :in-reply-to:message-id:subject:to:from:date:dkim-signature;        bh=tbDnSmBedXM7hz8e1bNo7HKREl9yTe+cTBkz6N71Cuc=;        b=HVCK8X/dFQgtMTV9ZJUPl0su8IA4dQm+ZeI/xQmG7fvygSI3zAcDh1qAXqLe2XLbeC         0BtTMVSPtZTS94vlgPbrQxePtL/+1fOzPY9rO+/sHyLArMeNi6JTCInBx4bhx+kQ2KLx         OICElIbpG0nM3lURfXCFEXVzLdpUnYd6SJjzP6BhNhH/uz/DdZwvEruaLevSxTyCfUyC         g76E0T9AyOw39T9M2pKnokvOdZMWRaZ1cZuH0soFnEyHZIHY7LJ3LWzboWMInLoPWX0B         KAckb7fCz5tlTUkHnY0goYhdJSLDNfkpmzfbAWbZceOQL/M5eNaje5aEvzfHFBtFUK6h         y9mw==</li>
<li>Arc-message-signature: i=1; a=rsa-sha256; c=relaxed/relaxed; d=google.com; s=arc-20160816;        h=content-transfer-encoding:mime-version:organization:references         :in-reply-to:message-id:subject:to:from:date:dkim-signature;        bh=tbDnSmBedXM7hz8e1bNo7HKREl9yTe+cTBkz6N71Cuc=;        b=ZWYYGB/w+QCXVZzYxUGykUkcYELalX5mW/DzHpeZxW1FQQQrsEPXX8ulYgLIwHizYb         SEqjrdUnyy9GG109qfdrO2BBh7m7oniK7eEo/gIT3JCrrZumR8l1s5T7aJjJiFMh/SlT         SgybkI5ghu2fL4mXVvWK5nIXo/9cNamS7OMOA0B6kaqAPYVJuMNBv/vvSrc4ON4xH/Bo         lK1+69EReW+ug4YBrYyEpKjakcW6N9HTeG2wqaM0XBefeuyHY5wiWDpxh9rQDz9aDi3p         4YUHQz9qvbSolG8mlBNDr1QEyj9a7ed8YjFPjLWsCIyW6ODBRrubvLm4UFYyLCDD6+Ds         4mFg==</li>
<li>Arc-seal: i=4; a=rsa-sha256; t=1581417060; cv=pass;        d=google.com; s=arc-20160816;        b=bK+6U6FVkbfp+kqMWplBOSaWcIjS+d0ZPIdAvQmE2HdEChAdyUzTIYk1+7yKorcZsr         E5swZnUDaSAMpORUqo2+69UEC1Wl1I1C2Ats1q0MQzXsWFMu4da5Ld3Ux9fGqq+TOYjP         WgaZWhRfBlzK6omxjkIWOAV2gfo3sn2jdPVIo3k869IpSqPttFPSuViBU/2OJBAQ/9LF         K9gInyk9tPcOS7pwiLyiJbA7Yt2WPSOVi7Sy9Tuuqwh/7N3DYdBzkpWaDo3rTtLM0mfd         RxVc7HNPklVs62R4s5EMwlDBKhyxYtTh25A4jjg1GSy9j/LbupOEFBSXvwk+gPjC9SCh         OUPA==</li>
<li>Arc-seal: i=3; a=rsa-sha256; t=1581417059; cv=pass;        d=google.com; s=arc-20160816;        b=y3VJNIKPJhW2eOsdDas/L7p6i6HblevfByUKtL5epb+pz8yU6Nf3NQzPsGepwQfOCA         tJuGTWbrYCZerHHs8nxDC0doXYn1qVzSFtwSYeKHvfo/tmSTn0aEJzrw22AIBB+YqnJO         QIL7FmKJH7a+vAjLqhP5Z7ojr+kYy31K39sfJCtj2FaTBoZDN4EPCwz3f30Oqlihuwbx         Ae/CFTL5DByDNVYF4yXOxyTw3C+5NxKhWA/uQHBThkLWmX1MKjyU5bQKXa5Ptx8kOEJj         lFnB9NChcxs0EsP3Rthaz0f9/J0JVaSSzp9PoSXAYPARLBxu0t9RscydIkfL+/xVsTFN         Cspg==</li>
<li>Arc-seal: i=2; a=rsa-sha256; t=1581417055; cv=pass;        d=google.com; s=arc-20160816;        b=qW/lnTkkqPEQFIofVcOCsh1TH5sq25C7ZNtovhjmxGOzxInVDN4E7k7L9wklhK/f2v         R3QdOx3rfFX1b65ylHniVz3liMLtNK0poDcPJQ5miaqJ8Zsnot3HhUbopEuIKqicYKNs         ppKQd8Ma2Rv05SMTsGjVQZ+N+Mhvz8AVzn8KXLOXE1BP25dVkS492eBsy+F/FoQI6xMT         S/swN+Vsc9yr8hwJHfRH+dYamCQrPWYzKsj2BL7RqagwtVat6HAkVyliN1hUGJ17iIC0         Wn4uTzmk7ImJECa5VXjMewPi1HCe06KrVL7nU/IUvebkd/41PkY38OBCYAN5u0mMq1hZ         Xa9A==</li>
<li>Arc-seal: i=1; a=rsa-sha256; t=1581417053; cv=none;        d=google.com; s=arc-20160816;        b=M5Q1SS+qQM2g9QtV98tSU8FexgBSm2JBu+0bwb1IxCFRSbTd2TW96mRZWaLK2TKPib         TTvigGc3E7DP/+BjGYIxQU4KPl8AUjmrlY+ojQ3Dlx3a77dGZ2eIGgTpItoEZ9d/EQiS         VwSXTHy4ZPijqnfmpd9NkWteMeP/K7btBd4BrLJe1IsEXMVSZxWCmdGMSI7tgWWBunHr         XCh0RN0bQi9wMFSqHCH0NZ2JEeL8b2kfQl+PwvK9ycLolD7xwy2TGkxWtfkostuznb85         Z5KcvHOgcAbUmtpLu6Y2tQJCL+1KLa8wnT+aUQ9L382YjsTRxhzlmM2IyQ4PoQOK/kTH         c/mA==</li>
<li>Dkim-signature: v=1; a=rsa-sha256; c=relaxed/relaxed;        d=noaa.gov; s=google;        h=sender:date:from:to:subject:in-reply-to:references:organization         :mime-version:content-transfer-encoding:message-id:x-original-sender         :x-original-authentication-results:precedence:mailing-list:list-id         :list-post:list-help:list-archive;        bh=tbDnSmBedXM7hz8e1bNo7HKREl9yTe+cTBkz6N71Cuc=;        b=MaCrPGxSAOeHm/abszrd2itXmuDehHnQS25r1hriKPAeP4M+bz2lZq8o7vO4c28fqw         VihnDQzXp5wA5y308KO25CWwU4qRDeEauNz4zVD0EWF1ArRZXHYvHy7JYKl3B92DYkgV         X6oYOJt0wa9plQibms5PYV0G4JHbIu7EOMKEWVJQ7ojrfhV5yhw773lOY5sE55/ai4GB         8qkgvC6OadPAdt8s62IqgcIV6BH5sJM/nryJaVB8kchQTat2cSIifayS105Xq8I+eCJ2         m+kPVV7a/w0qSkYe7IRyavZoZb5vG/T2bdLgQmGe/Wz0O7by6M0HTfPxVld3KoyxC6Qv         wP3Q==</li>
<li>In-reply-to: &lt;<a href="msg00524.html">ME2PR01MB322055FFCCAA90D3A015AB8C9D180@ME2PR01MB3220.ausprd01.prod.outlook.com</a>&gt;</li>
<li>List-archive: &lt;<a href="https://groups.google.com/a/noaa.gov/group/ferret_users/">https://groups.google.com/a/noaa.gov/group/ferret_users/</a>&gt;</li>
<li>List-help: &lt;<a href="https://support.google.com/a/noaa.gov/bin/topic.py?topic=25838">https://support.google.com/a/noaa.gov/bin/topic.py?topic=25838</a>&gt;, &lt;<a href="mailto:ferret_users+help@noaa.gov">mailto:ferret_users+help@noaa.gov</a>&gt;</li>
<li>List-id: &lt;ferret_users.noaa.gov&gt;</li>
<li>List-post: &lt;<a href="https://groups.google.com/a/noaa.gov/group/ferret_users/post">https://groups.google.com/a/noaa.gov/group/ferret_users/post</a>&gt;, &lt;<a href="mailto:ferret_users@noaa.gov">mailto:ferret_users@noaa.gov</a>&gt;</li>
<li>Mailing-list: list <a href="mailto:ferret_users@DOMAIN.HIDDEN">ferret_users@xxxxxxxx</a>; contact <a href="mailto:ferret_users%2Bowners@DOMAIN.HIDDEN">ferret_users+owners@xxxxxxxx</a></li>
<li>Organization: University of Bergen</li>
<li>References: &lt;<a href="msg00502.html">20200127153619.0a19cf13@gfi063209.klientdrift.uib.no</a>&gt;	&lt;<a href="msg00509.html">d00080bd-a43e-66d1-fd55-de6ccab4a0b0@noaa.gov</a>&gt;	&lt;<a href="msg00523.html">20200210174651.41f8eccb@gfi063209.klientdrift.uib.no</a>&gt;	&lt;<a href="msg00524.html">ME2PR01MB322055FFCCAA90D3A015AB8C9D180@ME2PR01MB3220.ausprd01.prod.outlook.com</a>&gt;</li>
<li>Sender: <a href="mailto:owner-ferret_users@DOMAIN.HIDDEN">owner-ferret_users@xxxxxxxx</a></li>
</ul>
<!--X-Head-of-Message-End-->
<!--X-Head-Body-Sep-Begin-->
<hr>
<!--X-Head-Body-Sep-End-->
<!--X-Body-of-Message-->
<pre>Hello&#x2014;

On 11 Feb 03:09 Fiedler, Russell (O&amp;A, Hobart) wrote:
&gt; It looks like the /LIKE qualifier could be what you're after.
&gt; 
&gt; <a  rel="nofollow" href="https://ferret.pmel.noaa.gov/Ferret/documentation/users-guide/commands-reference/DEFINE#_VPINDEXENTRY_1348">https://ferret.pmel.noaa.gov/Ferret/documentation/users-guide/commands-reference/DEFINE#_VPINDEXENTRY_1348</a>
&gt; 
&gt; All attributes are inherited (apart from missing_value, scaling and offset). You can override some if you want.
&gt; 
&gt; e.g. (From the examples)
&gt; 
&gt; 
&gt; 
&gt; yes? let/like=temperature/title=&quot;Surface Temperature&quot; sst = temperature[z=0:5@MAX]
&gt; 
&gt; so
&gt; 
&gt; let/like=aa bb=aa+666
&gt; let/like=bb/title=&quot;`bb,return=original_definition`&quot; cc = bb
&gt; 
&gt; which should be the same as
&gt; 
&gt; let/like=aa/title=&quot;`bb,return=original_definition`&quot; cc = bb

Yes, this would be the solution to the problem that I stated.  The
/LIKE functionality is very useful.  But I forgot to mention something
that complicates the issue.  I will try to state the issue correctly
now.

Several datasets are loaded.  It is known that AA is in one of the
datasets but not in which one.  First, Tr is set as a function of AA:

    let Tr = AA + 123.

If I were to do

    let/like=AA Tr = AA + 123.

this would often result in failure as the current dataset may not be
containing AA.  This 'Tr' is a general variable that I refer to in
later scripts, but AA's name is only known at the stage of this command.

The next thing I do is check in which dataset Tr is available, so

    repeat/i=1:`ndsets` ( if `Tr,return=isReady` then ;\
        let ndset = `i` ;\
        exit/loop \
    )
    set data `ndset`

Note that I cannot determine 'ndsets' before defining Tr.  Only after
ndsets is determined, I can set attributes, e.g. like

    def attr Tr.units = &quot;`AA.units`&quot;

or, if not depending on current default dataset,

    def symb Ndset = `ndset`  ! avoid embedded ````
    def attr Tr.units = &quot;`AA.units[d=($Ndset)]`&quot;

or by redefining

    set data `ndset`
    let/like=AA Tr = AA + 123.

or, again not depending on current dataset (apparently both in the
/LIKE and the expression I must say what the right dataset is, which is
somewhat inconsistent as let Tr=AA; set data `ndset` works fine, i.e.,
without specifying the dataset in the expression):

    let/like=AA[d=`ndset`] Tr = AA[d=`ndset`] + 123.

But none of this would work, because I need to know the name of AA
(whether I set an attribute of Tr or redefine Tr with /LIKE).


I think the above is a MWE equivalent to what I try to accomplish in a
more complicated setting.  For further rationale of my challenge, I
explain it below concretely (see <a  rel="nofollow" href="http://complot.nongnu.org/">http://complot.nongnu.org/</a> for full
context).

One may ask why I want to refer to AA only once (let Tr = AA + 123.).
This is not just an issue of inelegant code duplication.  My main user
script is called with a tracer name argument, so in short this happens:

    def symb Tr = ($1)  ! user may have given &quot;GbSi&quot; as an argument
    
    let GbSi = GSi ! variable expected in one of the datasets
    let SbSi = BSi
    let TPoC = POC
    ...
    ! Here we determine where ($Tr) is in (ndset).
    ! And then we do the proper initialisation:
    set data `ndset`
    let/like=GSi Tr = ($Tr)
    !        ^^^
    !        this we don't know

Am I overlooking something obvious?

&#x2014;Marco

</pre>
<!--X-Body-of-Message-End-->
<!--X-MsgBody-End-->
<!--X-Follow-Ups-->
<hr>
<ul><li><strong>Follow-Ups</strong>:
<ul>
<li><strong><a name="00526" href="msg00526.html">Re: [ferret_users] reusing information from variable definitions</a></strong>
<ul><li><em>From:</em> Ansley C. Manke</li></ul></li>
</ul></li></ul>
<!--X-Follow-Ups-End-->
<!--X-References-->
<ul><li><strong>References</strong>:
<ul>
<li><strong><a name="00502" href="msg00502.html">[ferret_users] printing filename and line number at error</a></strong>
<ul><li><em>From:</em> Marco van Hulten</li></ul></li>
<li><strong><a name="00509" href="msg00509.html">Re: [ferret_users] printing filename and line number at error</a></strong>
<ul><li><em>From:</em> Ansley C. Manke</li></ul></li>
<li><strong><a name="00523" href="msg00523.html">[ferret_users] reusing information from variable definitions</a></strong>
<ul><li><em>From:</em> Marco van Hulten</li></ul></li>
<li><strong><a name="00524" href="msg00524.html">Re: [ferret_users] reusing information from variable definitions</a></strong>
<ul><li><em>From:</em> Fiedler, Russell (O&amp;A, Hobart)</li></ul></li>
</ul></li></ul>
<!--X-References-End-->
<!--X-BotPNI-->
<UL>
<li>Previous by thread:
<strong><a href="msg00524.html">Re: [ferret_users] reusing information from variable definitions</a></strong>
</li>
<li>Next by thread:
<strong><a href="msg00526.html">Re: [ferret_users] reusing information from variable definitions</a></strong>
</li>

</UL>
<center>[<a href="msg00524.html">Thread Prev</a>][<a href="msg00526.html">Thread Next</a>][<A HREF="threads.html#00525">Index</A>]</center>

<!--X-BotPNI-End-->
<!--X-User-Footer-->
<A HREF="http://ferret.pmel.noaa.gov/Ferret/contact-us">Contact Us</A>
<br>
<font size=-1>
<address>
<a href="http://www.doc.gov">Dept of Commerce</a> /
<a href="http://www.noaa.gov">NOAA</a> /
<a href="http://www.oar.noaa.gov">OAR</a> /
<a href="http://www.pmel.noaa.gov">PMEL</a> /
<a href="http://ferret.pmel.noaa.gov">Ferret</a>
</address>

<br>
 <a href="http://www.noaa.gov/privacy.html">Privacy Policy</a> | <a href="http://www.noaa.gov/disclaimer.html">Disclaimer</a> | <a href="accessibility.html">Accessibility Statement</a> 

</font>
<!--X-User-Footer-End-->
</body>
</html>
