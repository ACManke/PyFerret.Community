<!-- MHonArc v2.6.18 -->
<!--X-Subject: Re: [ferret_users] memory problem with large file when regredding -->
<!--X-From-R13: fnhenou enguber <ebuvgfeo2020Ntznvy.pbz> -->
<!--X-Date: Thu, 23 May 2019 13:01:14 &#45;0700 -->
<!--X-Message-Id: CAFXLzPjj+r1q8VKj_1iFc_ke7wOxwAF4bxzdHAdvvymcvABS&#45;w@mail.gmail.com -->
<!--X-Content-Type: multipart/alternative -->
<!--X-Reference: 788501546.326051.1558357404559.JavaMail.zimbra@lsce.ipsl.fr -->
<!--X-Reference: CALC=m4qjDaoxTmXDT=5XiDKKeLmX4P1SNEfKmPdPnxkUMSQQzg@mail.gmail.com -->
<!--X-Reference: 1140635445.377976.1558361636977.JavaMail.zimbra@lsce.ipsl.fr -->
<!--X-Reference: c3eae976&#45;a3cf&#45;85b6&#45;356c&#45;da4041df6fca@noaa.gov -->
<!--X-Reference: SYCPR01MB51039E76042C3FDF580E5A159D000@SYCPR01MB5103.ausprd01.prod.outlook.com -->
<!--X-Head-End-->
<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN"
        "http://www.w3.org/TR/html4/loose.dtd">
<html>
<head>
<title>Re: [ferret_users] memory problem with large file when regredding</title>
</head>
<body>
<!--X-Body-Begin-->
<!--X-User-Header-->
<!--X-User-Header-End-->
<!--X-TopPNI-->
<HR>
<center>[<a href="msg00179.html">Thread Prev</a>][<a href="msg00175.html">Thread Next</a>][<A HREF="threads.html#00186">Index</A>]</center>

<!--X-TopPNI-End-->
<!--X-MsgBody-->
<!--X-Subject-Header-Begin-->
<h1>Re: [ferret_users] memory problem with large file when regredding</h1>
<hr>
<!--X-Subject-Header-End-->
<!--X-Head-of-Message-->
<ul>
<li><strong>To</strong>: <strong>&quot;Fiedler, Russell (O&amp;A, Hobart)&quot; &lt;<a href="mailto:Russell.Fiedler@DOMAIN.HIDDEN">Russell.Fiedler@xxxxxxxx</a>&gt;</strong></li>
<li><strong>Subject</strong>: <strong>Re: [ferret_users] memory problem with large file when regredding</strong></li>
<li><strong>From</strong>: <strong>saurabh rathore &lt;<a href="mailto:rohitsrb2020@DOMAIN.HIDDEN">rohitsrb2020@xxxxxxxxx</a>&gt;</strong></li>
<li>Date: Thu, 23 May 2019 16:00:44 -0400</li>
<li>Arc-authentication-results: i=4; mx.google.com;       dkim=pass header.i=@gmail.com header.s=20161025 header.b=t70nICcL;       arc=pass (i=2 dkim=pass dkdomain=gmail.com);       spf=softfail (google.com: domain of transitioning <a href="mailto:rohitsrb2020@DOMAIN.HIDDEN">rohitsrb2020@xxxxxxxxx</a> does not designate 52.222.5.176 as permitted sender) smtp.mailfrom=<a href="mailto:rohitsrb2020@DOMAIN.HIDDEN">rohitsrb2020@xxxxxxxxx</a>;       dmarc=pass (p=NONE sp=QUARANTINE dis=NONE) header.from=gmail.com</li>
<li>Arc-authentication-results: i=3; mx.google.com;       dkim=pass header.i=@gmail.com header.s=20161025 header.b=t70nICcL;       arc=pass (i=2 dkim=pass dkdomain=gmail.com);       spf=softfail (google.com: domain of transitioning <a href="mailto:rohitsrb2020@DOMAIN.HIDDEN">rohitsrb2020@xxxxxxxxx</a> does not designate 52.222.5.176 as permitted sender) smtp.mailfrom=<a href="mailto:rohitsrb2020@DOMAIN.HIDDEN">rohitsrb2020@xxxxxxxxx</a>;       dmarc=pass (p=NONE sp=QUARANTINE dis=NONE) header.from=gmail.com</li>
<li>Arc-authentication-results: i=2; mx.google.com;       dkim=pass header.i=@gmail.com header.s=20161025 header.b=t70nICcL;       arc=pass (i=1 spf=pass spfdomain=gmail.com dkim=pass dkdomain=gmail.com dmarc=pass fromdomain=gmail.com);       spf=softfail (google.com: domain of transitioning <a href="mailto:rohitsrb2020@DOMAIN.HIDDEN">rohitsrb2020@xxxxxxxxx</a> does not designate 65.127.216.226 as permitted sender) smtp.mailfrom=<a href="mailto:rohitsrb2020@DOMAIN.HIDDEN">rohitsrb2020@xxxxxxxxx</a></li>
<li>Arc-authentication-results: i=1; mx.google.com;       dkim=pass header.i=@gmail.com header.s=20161025 header.b=t70nICcL;       spf=pass (google.com: domain of <a href="mailto:rohitsrb2020@DOMAIN.HIDDEN">rohitsrb2020@xxxxxxxxx</a> designates 209.85.220.41 as permitted sender) smtp.mailfrom=<a href="mailto:rohitsrb2020@DOMAIN.HIDDEN">rohitsrb2020@xxxxxxxxx</a>;       dmarc=pass (p=NONE sp=QUARANTINE dis=NONE) header.from=gmail.com</li>
<li>Arc-message-signature: i=4; a=rsa-sha256; c=relaxed/relaxed; d=google.com; s=arc-20160816;        h=list-archive:list-help:list-post:list-id:mailing-list:precedence         :message-id:cc:to:subject:date:from:in-reply-to:references         :mime-version:sender:dkim-signature;        bh=M4M/IwewzRC++yuSQqktGvMDJCxUGgErMMxiA+obBww=;        b=si3G3uFlyTRog/YbE4KZL4o+kP3lFfROCMwPBi7FtCUcT9NX49S+b0JqEIvceOqp2+         Rd22kiD6OPlTQEYaz1iybV8wPAuFqaxphkg0TkNM3jkly3VAhlawzXrwRHekssVq/tMH         gI6jdUg9th5/MyjxPslBewYvRGcH7GEsZ2EqtQN0Ub6jLl1cwkuWf3fLj/nWegVK/4AP         rSVgSrn3uwLTOSOH8sH7wJBh0ANjRu4MzeI/CQtQ0ruLhzzDX6uFg11QGKc9Kiugf1no         5VK1oojUvIcxqp8QcokPhJzlLATEK777EpYbWt7X4G1LcSd5PlDCmbZ4XOzIoArjeTbW         kP5A==</li>
<li>Arc-message-signature: i=3; a=rsa-sha256; c=relaxed/relaxed; d=google.com; s=arc-20160816;        h=message-id:cc:to:subject:date:from:in-reply-to:references         :mime-version:dkim-signature;        bh=M4M/IwewzRC++yuSQqktGvMDJCxUGgErMMxiA+obBww=;        b=M1N7EjczzOiAOUMbGZROLUygbsSAdkC9qlgxXCFFhI6mU3y+y35sQoXlS36fHk3wG1         rp2vAziRWMnELCXyupxF+A654I88bM19Cq1XhQYxagzza7nSuzPcYHlh3B8oQp+6CDUr         /8GzxcmGY3DfsG60YsbtWiPwy0k4KUi2NIZq7snNZrwHg/rnGvagsz7nVlFCHBmcpB9P         H1fy0hL8MQZFHUpPi2hqQHVQQpLMM6tje7avQHDVUYwKFu1UZ22+HQJI595zS12BISz6         NzFHCRea/jkM3JBLhXVPRCcMTB91m+VZw1Cf2a/BzIyAyr6qRpeOfbMrxvQNmQw7bcM1         vE+g==</li>
<li>Arc-message-signature: i=2; a=rsa-sha256; c=relaxed/relaxed; d=google.com; s=arc-20160816;        h=cc:to:subject:message-id:date:from:in-reply-to:references         :mime-version:dkim-signature;        bh=M4M/IwewzRC++yuSQqktGvMDJCxUGgErMMxiA+obBww=;        b=eX4X1gXvYMvJsk10CmGusPa+iMz0z28HA3VQoPmWtpdYenQ5XSj9RJZkziM3LbaDHq         stoXM7me8sH9/LPpOlKkt2c5QMzieF0UkR5S3G4GA/uGqlGAn+uBFNyS3Drw5onBGCO3         uU4dG7WHfF2vMV0A8WMEZxpc9g09Ui6nHZl15xbwWpSCohQZf6datqLfEGz2GVBqtbHH         7T5qFREkxWd1vyJZ3cBo/tBvyyzhYhXibFDjZceiErvEy24LxSBzsGf7/i2Ycx3Julcn         0kZRMoJgRd5TEWt0MgltGooj6YuZWZisQl9ASE7XC34J5iJybA03QmV10y+M6SZBlpob         3tWQ==</li>
<li>Arc-message-signature: i=1; a=rsa-sha256; c=relaxed/relaxed; d=google.com; s=arc-20160816;        h=cc:to:subject:message-id:date:from:in-reply-to:references         :mime-version:dkim-signature;        bh=M4M/IwewzRC++yuSQqktGvMDJCxUGgErMMxiA+obBww=;        b=oDaYMiQzPeu7hh6h2hwKFRJYxpLgmDMTGvo3rgPgEEwrQg3ml3B4nbQRJliAXITy0x         a6T71WXRo9Mnno0Z88y0kNFsWPzFjcOgblhaYh4V2COx4Gg6XNVb54yVD1UU08wjpZA0         1dq2799lS3j5fR2VftrA6+0Tj94olhKEl43fJSOtjyMHJGn+SoJe2UbIHSO08vB7elKm         o+CmdqZ5D5Rm88dF2QaAk8Oki8C2a1iquVq66TcXyPEsoeJuJq7iiZORp9FePWuZQbnh         AUJ+sw+0O42yqt2ajvor9AyuxNV2xralyXfAF6mcMGhX8fY8Ultk8DIGElcf17dm/0GK         yzIQ==</li>
<li>Arc-seal: i=4; a=rsa-sha256; t=1558641673; cv=pass;        d=google.com; s=arc-20160816;        b=SoelTuU3nEnx9TkSFvT2z8u0sDBUxO98VBKd1oaK+4OvJtz1obNGTwxAQKly5tuWnh         qtuEOq/+rlcbSR9Tk3QDIxghQKBi7A4NyKqJ7H9OrU+0eRgumXDeu2OFi5U49cZeQPUI         loWJ4c2y05oIKjEf+OSMapXhGsTjtLM4Pj79t7WTsWQBRTBG0ky0nJAphbWxUo/M1fWS         xizZ7+nqIpCvNeYZeTgkpHLLC4jRy7oZ+MgYO0uG2Kf6yEG6bgscN6ItI/VpONOfzs6z         Rf3IlOSoIzqn0Xuops9kXYn5U0IKsz8MbNG3ePHQbdHKLJPPzCM1AUFViUCPEPbuQ14U         Clxw==</li>
<li>Arc-seal: i=3; a=rsa-sha256; t=1558641672; cv=pass;        d=google.com; s=arc-20160816;        b=eD+yYALyGf7Z5GzXliGzT5JjWNeq84xSXb/cg+d7tAarRyDwiTJ4TesvKJ5D4QmkLV         9RgZ7IPTOnwDxzks2L2BmRyMT8Kkam4ROyUJqQYMR6ytqg3dYFKkYGMO00j5W9mFuWqs         hYI0DugZd824NGbYBkhzuD9yYburwksJbU0gtFBo0DhZ+UHMXcwIIK69IBLvc2RpktQa         s/4GJhGnh0JxvkeMAOXCPbtr+NMaC9KJCd+HB7Nd7tVmKA8dJPgjDhb2LIBXRv3vnhMp         fDAD4r4v6xnDNeAUtOZf85dNo48eArWXLhTgWakBFprxQO5UF+qd1o5cL9xuP+bo/kTd         Wzxg==</li>
<li>Arc-seal: i=2; a=rsa-sha256; t=1558641666; cv=pass;        d=google.com; s=arc-20160816;        b=XjI1Qw52szpFWA5R4tX7VOEsHTvScnOpajCPR9w8ANp97qaiBDwxjx+hdr4dlxNk9l         38hLchnp6N6/GUuSNo+qvKyZpYvBzMyULuYMfkytxuhx7W2hHz2qI21DT0WykEixbajB         CRftipbwK3T+02zZ8dLmMLfOwPDWtSSWJAfAy9n/KoPeDcI6wyALCvtXiFEIoS0yKzih         FCya4xEXJ4FQ0nhzAz37JqL/ErAiO4/NsQK51JPTEGjnoBb0Wh1YUZNpcsCLxIuj+yqk         mcaD0Wqm+OhWXHxFd5Wd8Eo5Do8GuAId5RDT44XzjtIfuY/ch9ERLaKChb3wxSb82hRJ         DL2g==</li>
<li>Arc-seal: i=1; a=rsa-sha256; t=1558641655; cv=none;        d=google.com; s=arc-20160816;        b=YOKK2RveTGyMZQb1xw86VfliYFQgj2nnC444Mmf98Xfs7W4win4+VA78wuwqspbUQW         nRIy9QJrRrout0pB5uvgE5XNBwGS82JZz17TKKPMa0OFSqazUyrtzueqrNxvFp6dLzyL         77IJP9KWltmHiPEXbLCoD9OSbBL3HVDrZxCcmEV/Dfiba9T+Y7d6LhbUX7SzoPGhvl92         g+ZOalsNReLNS24f/XlIiq+1ct0Lzo29lS+gCq1RhF99IfnNqrOrfPwjXn5/FaEjLpmd         cuachH8PzUVrrK9ZwTY67PrPgyBXx2KZEWI7qHBGs0gUDSyOUlVf0Dn+qOUxi7fAh7pF         qzGA==</li>
<li>Cc: &quot;<a href="mailto:ferret_users@DOMAIN.HIDDEN">ferret_users@xxxxxxxx</a>&quot; &lt;<a href="mailto:ferret_users@DOMAIN.HIDDEN">ferret_users@xxxxxxxx</a>&gt;,        Patrick Brockmann &lt;<a href="mailto:patrick.brockmann@DOMAIN.HIDDEN">patrick.brockmann@xxxxxxxxxxxx</a>&gt;</li>
<li>Dkim-signature: v=1; a=rsa-sha256; c=relaxed/relaxed;        d=noaa.gov; s=google;        h=sender:mime-version:references:in-reply-to:from:date:subject:to:cc         :message-id:x-original-sender:x-original-authentication-results         :precedence:mailing-list:list-id:list-post:list-help:list-archive;        bh=M4M/IwewzRC++yuSQqktGvMDJCxUGgErMMxiA+obBww=;        b=cHIFR/R+c4Yj0nyCJhgof2MQ4dwJw2vWOJKWT7fP7W3pWpJsBOEM9GqV2vXFkFFMWW         AIQEJdwjXUIKNrroOP7DLCy57Hlu/F0uiYubB7xDZiOZ4F3xyhBf+mjW9xgLn3y3Ys+T         euoJcTJjrvw6f6YIUb2C9qDK/Zti4FSEofGaUb7/Gap40F2IrtHoeD+W9ZfbFJJzQy8E         IOu/Nz+0dRw6RLGC1UMM2wwYSyJRNRBoD1PLyjns1q14L+O6xF4Gxojmq+6K8d959l22         XaOIwlGa8oyRdtuwJo/DMRMfHBk/+NYGKPnwtttvh8Z7ZnsNeYEBfP5Z7ZPUuIi6j8Kl         1eUw==</li>
<li>In-reply-to: &lt;<a href="msg00179.html">SYCPR01MB51039E76042C3FDF580E5A159D000@SYCPR01MB5103.ausprd01.prod.outlook.com</a>&gt;</li>
<li>List-archive: &lt;<a href="https://groups.google.com/a/noaa.gov/group/ferret_users/">https://groups.google.com/a/noaa.gov/group/ferret_users/</a>&gt;</li>
<li>List-help: &lt;<a href="https://support.google.com/a/noaa.gov/bin/topic.py?topic=25838">https://support.google.com/a/noaa.gov/bin/topic.py?topic=25838</a>&gt;, &lt;<a href="mailto:ferret_users+help@noaa.gov">mailto:ferret_users+help@noaa.gov</a>&gt;</li>
<li>List-id: &lt;ferret_users.noaa.gov&gt;</li>
<li>List-post: &lt;<a href="https://groups.google.com/a/noaa.gov/group/ferret_users/post">https://groups.google.com/a/noaa.gov/group/ferret_users/post</a>&gt;, &lt;<a href="mailto:ferret_users@noaa.gov">mailto:ferret_users@noaa.gov</a>&gt;</li>
<li>Mailing-list: list <a href="mailto:ferret_users@DOMAIN.HIDDEN">ferret_users@xxxxxxxx</a>; contact <a href="mailto:ferret_users%2Bowners@DOMAIN.HIDDEN">ferret_users+owners@xxxxxxxx</a></li>
<li>References: &lt;<a href="msg00173.html">788501546.326051.1558357404559.JavaMail.zimbra@lsce.ipsl.fr</a>&gt; &lt;CALC=m4qjDaoxTmXDT=5XiDKKeLmX4P1SNEfKmPdPnxkUMSQQzg@mail.gmail.com&gt; &lt;<a href="msg00176.html">1140635445.377976.1558361636977.JavaMail.zimbra@lsce.ipsl.fr</a>&gt; &lt;<a href="msg00178.html">c3eae976-a3cf-85b6-356c-da4041df6fca@noaa.gov</a>&gt; &lt;<a href="msg00179.html">SYCPR01MB51039E76042C3FDF580E5A159D000@SYCPR01MB5103.ausprd01.prod.outlook.com</a>&gt;</li>
<li>Sender: <a href="mailto:owner-ferret_users@DOMAIN.HIDDEN">owner-ferret_users@xxxxxxxx</a></li>
</ul>
<!--X-Head-of-Message-End-->
<!--X-Head-Body-Sep-Begin-->
<hr>
<!--X-Head-Body-Sep-End-->
<!--X-Body-of-Message-->
<div dir="ltr"><div class="gmail_default" style="color:#000000">Hi Patrick,</div><div class="gmail_default" style="color:#000000">I would like to to know chunking of data sets that would be very helpful when you want to save a huge data set. <br></div><div class="gmail_default" style="color:#000000"><br></div><div class="gmail_default" style="color:#000000">I am using it frequently in my work too, might be helpful for you as well. <br></div><div class="gmail_default" style="color:#000000"><br></div><div class="gmail_default" style="color:#000000">So for example I have a variable which is a 4-D global variable , i=1:360, j=1:145, k=1:34. l=1:444. So I chunked it as you can see in bold line and then I append it into a file in a nested repeat loop. you can put a suitable chunk that work for you to store high resolution multiple variables also in the same file.</div><div class="gmail_default" style="color:#000000"><br></div><div class="gmail_default" style="color:#000000">Or you can try using CDO operator as &quot;cdo remapbil,r360*180 <a rel="nofollow" href="http://your_variable_file.nc">your_variable_file.nc</a> <a rel="nofollow" href="http://output.nc">output.nc</a>&quot;. it might work fast (i hope)<br></div><div class="gmail_default" style="color:#000000"><br></div><div class="gmail_default" style="color:#000000">cancel mem/all<br>cancel data/all<br>cancel list/all<br>set mode verify<br><br>use /data/soda/<a rel="nofollow" href="http://sodamat.nc">sodamat.nc</a><br><br>define axis/edges/t/units=months/t0=1-dec-1979/t=1-jan-1980:1-jan-2017:1/calendar=360_days tmonthly<br><br>let ptemp=theta_fo(soso[gt=tmonthly@asn],sotm[gt=tmonthly@asn],z[g=sotm],0)<br>let pdens=rho_un(soso[gt=tmonthly@asn],ptemp[gt=tmonthly@asn],0)<br><br>let cp=3992<br>let heat=pdens*cp*ptemp<br><br>set mem/size=4000<br><br><b>set list/xchunk=120/ychunk=29/zchunk=17/tchunk=74/deflate=5/shuffle/ncformat=4</b><br><br>set mem/size=3000<br><br>save/i=1/j=1/l=1/ilimits=1:360/jlimits=1:145/klimits=1:34/llimits=1:444/file=<a rel="nofollow" href="http://ohc.nc/clob">ohc.nc/clob</a> heat<br><br>repeat/range=1:360:120/name=ii (repeat/range=1:145:29/name=jj (repeat/range=1:34:17/name=kk (repeat/range=1:444:74/name=ll save/append/file=<a rel="nofollow" href="http://ohc.nc/i=`ii`:`ii+119`/j=`jj`:`jj+28`/k=`kk`:`kk+16`/l=`ll`:`ll+73`">ohc.nc/i=`ii`:`ii+119`/j=`jj`:`jj+28`/k=`kk`:`kk+16`/l=`ll`:`ll+73`</a> heat;set mem/size=3000;can mem/all);can mem/all);can mem/all);can mem/all<br><br>can mem/all<br>can mode verify<br><br>exit</div></div><br><div class="gmail_quote"><div dir="ltr" class="gmail_attr">On Tue, May 21, 2019 at 8:51 PM Fiedler, Russell (O&amp;A, Hobart) &lt;Russell.Fiedler@xxxxxxxx&gt; wrote:<br></div><blockquote class="gmail_quote" style="margin:0px 0px 0px 0.8ex;border-left:1px solid rgb(204,204,204);padding-left:1ex">




<div dir="ltr">
<div id="gmail-m_-4955213417746203919gmail-m_8404329085727099564divtagdefaultwrapper" style="font-size:12pt;color:rgb(0,0,0);font-family:Calibri,Helvetica,sans-serif" dir="ltr">
<p style="margin-top:0px;margin-bottom:0px">Hi,</p>
<p style="margin-top:0px;margin-bottom:0px"><br>
</p>
<p style="margin-top:0px;margin-bottom:0px">I normally do this by writing out just one point/row and then set up a loop to do the appending. You can either&#xA0; do single rows or batches depending on how much memory you are willing to use. If using chunked data, double
 loops can be used to minimize I/O</p>
<p style="margin-top:0px;margin-bottom:0px"><br>
</p>
<p style="margin-top:0px;margin-bottom:0px">e.g.<br>
</p>
<p style="margin-top:0px;margin-bottom:0px"><br>
</p>
<p style="margin-top:0px;margin-bottom:0px">let jpts=`mask,return=jend`</p>
<p style="margin-top:0px;margin-bottom:0px">let block=5<br>
</p>
<p style="margin-top:0px;margin-bottom:0px">save/clobber/file=&quot;($03)&quot;/jlimits=1:`jpts`/j=1 mask</p>
<p style="margin-top:0px;margin-bottom:0px">repeat/range=2:`jpts`:`block`/name=s save/file=&quot;($03)&quot;/app mask[j=`s`:`s+block-1`]</p>
<p style="margin-top:0px;margin-bottom:0px"><br>
</p>
<p style="margin-top:0px;margin-bottom:0px">Russ<br>
</p>
</div>
<hr style="display:inline-block;width:98%">
<div id="gmail-m_-4955213417746203919gmail-m_8404329085727099564divRplyFwdMsg" dir="ltr"><font style="font-size:11pt" face="Calibri, sans-serif" color="#000000"><b>From:</b> <a rel="nofollow" href="mailto:owner-ferret_users@xxxxxxxx" target="_blank">owner-ferret_users@xxxxxxxx</a> &lt;<a rel="nofollow" href="mailto:owner-ferret_users@xxxxxxxx" target="_blank">owner-ferret_users@xxxxxxxx</a>&gt; on behalf of Ansley C. Manke &lt;<a rel="nofollow" href="mailto:ansley.b.manke@xxxxxxxx" target="_blank">ansley.b.manke@xxxxxxxx</a>&gt;<br>
<b>Sent:</b> Tuesday, 21 May 2019 2:50:01 AM<br>
<b>To:</b> <a rel="nofollow" href="mailto:ferret_users@xxxxxxxx" target="_blank">ferret_users@xxxxxxxx</a><br>
<b>Subject:</b> Re: [ferret_users] memory problem with large file when regredding</font>
<div>&#xA0;</div>
</div>
<div style="background-color:rgb(255,255,255)">
<p>Hi Patrick</p>
<p>The /JLIMITS qualifier refers to the indices of the grid you&#xA0; are writing out.&#xA0; It is used to will create the full-size output file to begin with, so it refers to the grid you&#39;re writing.&#xA0; The output grid in your example is J=1:180.</p>
<p>So, something like this should work -- with the /JLIMITS and the [j= ] referring to the output grid not the source grid.&#xA0; You&#39;ll need to find the range of mask[j=j1:j2] to use for your input data.<br>
</p>
<p><tt><br>
</tt><tt>save/clobber/file=&quot;($03)&quot;/JLIMITS=1:180 mask[j=1:60]</tt><tt><br>
</tt><tt>save/append/file=&quot;($03)&quot; mask[j=61:120]</tt><tt><br>
</tt><tt>save/append/file=&quot;($03)&quot; mask[j=121:180]</tt></p>
<p><tt>...</tt><br>
</p>
<p><br>
</p>
<p>The first command computes mask for a subset of the result grid, but writes it to a file with the full range; then the rest of the commands fill in more data.</p>
<p><br>
</p>
<p>-Ansley<br>
</p>
<p><br>
</p>
<div class="gmail-m_-4955213417746203919gmail-m_8404329085727099564x_moz-cite-prefix">On 5/20/2019 7:13 AM, Patrick Brockmann wrote:<br>
</div>
<blockquote type="cite">
<div style="font-family:arial,helvetica,sans-serif;font-size:12pt;color:rgb(0,0,0)">
<div>
<div style="font-family:arial,helvetica,sans-serif;font-size:12pt;color:rgb(0,0,0)">
<div>Re,<br>
</div>
<br>
<div>Thank you Satyesh for your answer.<br>
</div>
<br>
<div>Unfortunatelly, my variable does not have a time dimension.<br>
</div>
<div>So spread the work into parts on L dimension won&#39;t help.<br>
</div>
</div>
<div style="font-family:arial,helvetica,sans-serif;font-size:12pt;color:rgb(0,0,0)">
My variable is defined as follows:<br>
<div>dimensions:<br>
&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0; lon = 36000 ;<br>
&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0; lat = 18000 ;<br>
</div>
<br>
<div>If I&#xA0; use JLIMITS then I get this error message:<br>
</div>
<br>
<div>save/clobber/file=&quot;($03)&quot;/JLIMITS=1:300 mask<br>
&#xA0;!-&gt; LIST/FORMAT=CDF/clobber/file=&quot;<a rel="nofollow" href="http://tyty.nc" target="_blank">tyty.nc</a>&quot;/JLIMITS=1:300 mask<br>
&#xA0;LISTing to file <a rel="nofollow" href="http://tyty.nc" target="_blank">tyty.nc</a><br>
&#xA0;**ERROR: invalid command: Does not encompass data to be written: JLIMITS=1:300<br>
&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0; Variable: MASK<br>
<br>
</div>
<br>
<div>The complete test is:<br>
</div>
<br>
<div>wget <a rel="nofollow" href="https://www.ngdc.noaa.gov/mgg/shorelines/data/gshhg/latest/gshhg-shp-2.3.7.zip" target="_blank">
https://www.ngdc.noaa.gov/mgg/shorelines/data/gshhg/latest/gshhg-shp-2.3.7.zip</a><br>
</div>
<div>unzip <a rel="nofollow" href="https://www.ngdc.noaa.gov/mgg/shorelines/data/gshhg/latest/gshhg-shp-2.3.7.zip" target="_blank">
gshhg-shp-2.3.7.zi</a>p<br>
</div>
gdal_rasterize -a area -te -180 -90 180 90 -tr 0.01 0.01 i/GSHHS_i_L1.shp <a rel="nofollow" href="http://mask_i_L1_0.01.nc" target="_blank">mask_i_L1_0.01.nc</a></div>
<div style="font-family:arial,helvetica,sans-serif;font-size:12pt;color:rgb(0,0,0)">
---&gt; Rasterize the vectors shorelines into a 0.01&#xB0; gridded land/water variable (4.9Go).<br>
</div>
<div style="font-family:arial,helvetica,sans-serif;font-size:12pt;color:rgb(0,0,0)">
<br>
</div>
<div style="font-family:arial,helvetica,sans-serif;font-size:12pt;color:rgb(0,0,0)">
Now my purpose is to create coarser resolutions (0.05, 0.25, 0.5) of this variable with percent of land/water occupation.<br>
</div>
<div style="font-family:arial,helvetica,sans-serif;font-size:12pt;color:rgb(0,0,0)">
It can be nicelly done with ferret regridding transformations such as: [G=MYGRID@AVE]</div>
<div style="font-family:arial,helvetica,sans-serif;font-size:12pt;color:rgb(0,0,0)">
The script runs with a region but not for the entire globe.<br>
</div>
<div style="font-family:arial,helvetica,sans-serif;font-size:12pt;color:rgb(0,0,0)">
<br>
</div>
<div style="font-family:arial,helvetica,sans-serif;font-size:12pt;color:rgb(0,0,0)">
use <a rel="nofollow" href="http://mask_i_L1_0.01.nc" target="_blank">mask_i_L1_0.01.nc</a><br>
</div>
<div style="font-family:arial,helvetica,sans-serif;font-size:12pt;color:rgb(0,0,0)">
let mask1 = if band gt 1 then 1 else 0</div>
<div style="font-family:arial,helvetica,sans-serif;font-size:12pt;color:rgb(0,0,0)">
def axis/x=-180:180:0.50/edges/units=degrees_east myxaxis<br>
def axis/y=-90:90:0.50/edges/units=degrees_north myyaxis<br>
def grid/x=myxaxis/y=myyaxis mygrid<br>
let mask = mask1[G=MYGRID@AVE]<br>
save/clobber/file=<a rel="nofollow" href="http://LandWater_0.50.nc" target="_blank">LandWater_0.50.nc</a> mask</div>
<div style="font-family:arial,helvetica,sans-serif;font-size:12pt;color:rgb(0,0,0)">
<br>
</div>
<div style="font-family:arial,helvetica,sans-serif;font-size:12pt;color:rgb(0,0,0)">
Patrick<br>
</div>
<div style="font-family:arial,helvetica,sans-serif;font-size:12pt;color:rgb(0,0,0)">
<br>
<div>--<br>
Data Analysis and Visualization Engineer / Project Manager<br>
LSCE/IPSL, CEA-CNRS-UVSQ laboratory<br>
LSCE - Climate and Environment Sciences Laboratory<br>
IPSL - Institut Pierre Simon Laplace<br>
--</div>
<br>
<hr id="gmail-m_-4955213417746203919gmail-m_8404329085727099564x_zwchr">
<div><b>De: </b>&quot;Satyesh Ghetiya&quot; <a rel="nofollow" class="gmail-m_-4955213417746203919gmail-m_8404329085727099564x_moz-txt-link-rfc2396E" href="mailto:satyeshghetiya@xxxxxxxxx" target="_blank">
&lt;satyeshghetiya@xxxxxxxxx&gt;</a><br>
<b>&#xC0;: </b>&quot;Patrick Brockmann&quot; <a rel="nofollow" class="gmail-m_-4955213417746203919gmail-m_8404329085727099564x_moz-txt-link-rfc2396E" href="mailto:patrick.brockmann@xxxxxxxxxxxx" target="_blank">
&lt;patrick.brockmann@xxxxxxxxxxxx&gt;</a><br>
<b>Cc: </b>&quot;ferret users&quot; <a rel="nofollow" class="gmail-m_-4955213417746203919gmail-m_8404329085727099564x_moz-txt-link-rfc2396E" href="mailto:ferret_users@xxxxxxxx" target="_blank">
&lt;ferret_users@xxxxxxxx&gt;</a><br>
<b>Envoy&#xE9;: </b>Lundi 20 Mai 2019 15:33:42<br>
<b>Objet: </b>Re: [ferret_users] memory problem with large file when regredding<br>
</div>
<br>
<div>
<div dir="ltr">Dividing data with many indeces (e.g. L or I or J or K) is good method to handle saving of large files.
<div>I don&#39;t know how many L values are there, but suppose you have total values of L = Lmax (i.e. L=1:Lmax), then you may try following:</div>
<div>
<div style="color:rgb(0,0,0);font-family:arial,helvetica,sans-serif;font-size:16px">
<br>
</div>
<div style="color:rgb(0,0,0);font-family:arial,helvetica,sans-serif;font-size:16px">
save/clobber/file=<a rel="nofollow" href="http://file_0.1.nc/" target="_blank">file_0.1.nc</a>/llimit=Lmax/l=1&#xA0;mask&#xA0; &#xA0;! put Lmax as a number say 365 or something .....<br>
</div>
<div style="color:rgb(0,0,0);font-family:arial,helvetica,sans-serif;font-size:16px">
repeat/range=2:Lmax/name=aa (save/append/file=<a rel="nofollow" href="http://file_0.1.nc/" target="_blank">file_0.1.nc</a>&#xA0;mask[=`aa`])</div>
</div>
<div style="color:rgb(0,0,0);font-family:arial,helvetica,sans-serif;font-size:16px">
<br>
</div>
<div style="color:rgb(0,0,0);font-family:arial,helvetica,sans-serif;font-size:16px">
Hope it works. (LLIMITS can be used for I also, for e.g. ILIMIT)</div>
</div>
<br>
<div class="gmail-m_-4955213417746203919gmail-m_8404329085727099564x_gmail_quote">
<div dir="ltr" class="gmail-m_-4955213417746203919gmail-m_8404329085727099564x_gmail_attr">On Mon, May 20, 2019 at 6:35 PM Patrick Brockmann &lt;<a rel="nofollow" href="mailto:patrick.brockmann@xxxxxxxxxxxx" target="_blank">patrick.brockmann@xxxxxxxxxxxx</a>&gt; wrote:<br>
</div>
<blockquote class="gmail-m_-4955213417746203919gmail-m_8404329085727099564x_gmail_quote" style="margin:0px 0px 0px 0.8ex;border-left:1px solid rgb(204,204,204);padding-left:1ex">
<div>
<div style="font-family:arial,helvetica,sans-serif;font-size:12pt;color:rgb(0,0,0)">
<div>Hi all,<br>
</div>
<br>
<div>I have a 5Go variable at 0.01x0.01 resolution and I would like to save it at a coarser resolution.<br>
</div>
<div>My regridding script cannot be run because it requires too much memory.<br>
</div>
<br>
<div>Is there a strategy to run it ?<br>
</div>
<div>I have tried to save it with different /append calls but cannot figure out<br>
</div>
<div>because anunlimited dimension seems to be possible only for time dimension (L).<br>
</div>
<br>
<div>Here are the simplified lines from my script for a regredding from 0.01 to 0.1&#xB0;<br>
</div>
<br>
<div>!============================<br>
</div>
<div>use <a rel="nofollow" href="http://file_0.01.nc" target="_blank">file_0.01.nc</a>&#xA0;&#xA0;&#xA0;&#xA0; ! mask1 is the variable to regrid<br>
</div>
<br>
<div>def axis/x=-180:180:0.1/edges/units=degrees_east myxaxis <br>
def axis/y=-90:90:0.1/edges/units=degrees_north myyaxis&#xA0; <br>
def grid/x=myxaxis/y=myyaxis mygrid<br>
let mask = mask1[G=MYGRID@AVE]&#xA0; <br>
<br>
</div>
<div>save/clobber/file=<a rel="nofollow" href="http://file_0.1.nc" target="_blank">file_0.1.nc</a> mask<br>
</div>
<div>!============================</div>
<br>
<div>Any help would be appreciated.<br>
</div>
<div>Regards<br>
</div>
<br>
<div>Patrick</div>
<br>
<div>--<br>
Data Analysis and Visualization Engineer / Project Manager<br>
LSCE/IPSL, CEA-CNRS-UVSQ laboratory<br>
LSCE - Climate and Environment Sciences Laboratory<br>
IPSL - Institut Pierre Simon Laplace<br>
--</div>
</div>
</div>
</blockquote>
</div>
<br clear="all">
<br>
-- <br>
<div dir="ltr" class="gmail-m_-4955213417746203919gmail-m_8404329085727099564x_gmail_signature">
<div dir="ltr">
<div>
<div dir="ltr">
<div>
<div dir="ltr">
<div>
<div>
<div>
<div>G Satyesh<br>
</div>
</div>
</div>
</div>
</div>
</div>
</div>
</div>
</div>
</div>
</div>
</div>
<br>
</div>
</div>
</blockquote>
<div class="gmail-m_-4955213417746203919gmail-m_8404329085727099564x_moz-signature">-- <br>
<i>Ansley Manke<br>
NOAA/PMEL Science Data Integration Group<br>
7600 Sand Point Way NE<br>
206-526-6246</i></div>
</div>
</div>

</blockquote></div><br clear="all"><br>-- <br><div dir="ltr" class="gmail-m_-4955213417746203919gmail_signature"><div dir="ltr"><div><div dir="ltr"><div><font size="4" color="#0000ff"><b><br></b></font></div><div><font size="4" color="#0000ff"><b><br></b></font></div><font size="4" face="times new roman, serif" color="#0000ff"><b>REGARDS</b></font><div><font size="4" face="times new roman, serif" color="#0000ff"><b><br></b></font><div><font size="4" face="times new roman, serif" color="#0000ff"><b>Saurabh Rathore</b></font></div><div><font size="4" face="times new roman, serif" color="#0000ff"><b>Research Scholar (PhD.)</b></font></div><div><font size="4" face="times new roman, serif" color="#0000ff"><b>Centre For Oceans, Rivers, Atmosphere &amp; Land Science Technology</b></font></div><div><font size="4" face="times new roman, serif" color="#0000ff"><b>Indian Institute Of Technology, Kharagpur</b></font></div><div><font size="4" face="times new roman, serif" color="#0000ff"><b>contact :- 91- 8345984434</b></font></div></div></div></div></div></div>

<!--X-Body-of-Message-End-->
<!--X-MsgBody-End-->
<!--X-Follow-Ups-->
<hr>
<!--X-Follow-Ups-End-->
<!--X-References-->
<ul><li><strong>References</strong>:
<ul>
<li><strong><a name="00173" href="msg00173.html">[ferret_users] memory problem with large file when regredding</a></strong>
<ul><li><em>From:</em> Patrick Brockmann</li></ul></li>
<li><strong><a name="00174" href="msg00174.html">Re: [ferret_users] memory problem with large file when regredding</a></strong>
<ul><li><em>From:</em> Satyesh Ghetiya</li></ul></li>
<li><strong><a name="00176" href="msg00176.html">Re: [ferret_users] memory problem with large file when regredding</a></strong>
<ul><li><em>From:</em> Patrick Brockmann</li></ul></li>
<li><strong><a name="00178" href="msg00178.html">Re: [ferret_users] memory problem with large file when regredding</a></strong>
<ul><li><em>From:</em> Ansley C. Manke</li></ul></li>
<li><strong><a name="00179" href="msg00179.html">Re: [ferret_users] memory problem with large file when regredding</a></strong>
<ul><li><em>From:</em> Fiedler, Russell (O&amp;A, Hobart)</li></ul></li>
</ul></li></ul>
<!--X-References-End-->
<!--X-BotPNI-->
<UL>
<li>Previous by thread:
<strong><a href="msg00179.html">Re: [ferret_users] memory problem with large file when regredding</a></strong>
</li>
<li>Next by thread:
<strong><a href="msg00175.html">Re: [ferret_users] memory problem with large file when regredding</a></strong>
</li>

</UL>
<center>[<a href="msg00179.html">Thread Prev</a>][<a href="msg00175.html">Thread Next</a>][<A HREF="threads.html#00186">Index</A>]</center>

<!--X-BotPNI-End-->
<!--X-User-Footer-->
<A HREF="http://ferret.pmel.noaa.gov/Ferret/contact-us">Contact Us</A>
<br>
<font size=-1>
<address>
<a href="http://www.doc.gov">Dept of Commerce</a> /
<a href="http://www.noaa.gov">NOAA</a> /
<a href="http://www.oar.noaa.gov">OAR</a> /
<a href="http://www.pmel.noaa.gov">PMEL</a> /
<a href="http://ferret.pmel.noaa.gov">Ferret</a>
</address>

<br>
 <a href="http://www.noaa.gov/privacy.html">Privacy Policy</a> | <a href="http://www.noaa.gov/disclaimer.html">Disclaimer</a> | <a href="accessibility.html">Accessibility Statement</a> 

</font>
<!--X-User-Footer-End-->
</body>
</html>
