<!-- MHonArc v2.6.18 -->
<!--X-Subject: Re: [EXTERNAL] [ferret_users] minimum range for @DIN ? -->
<!--X-From-R13: Jvnblh Pnv <konv1Nhapp.rqh> -->
<!--X-Date: Fri, 23 Jul 2021 13:08:07 &#45;0700 -->
<!--X-Message-Id: CAKE4FWpXrXb+&#45;+amjF8jeu2q0WrWG0zwYtWj5NndW5ZCx_fSxQ@mail.gmail.com -->
<!--X-Content-Type: multipart/related -->
<!--X-Reference: CAEwQpaLJEzvabe=7h=NRgSjJ1&#45;Pgb=JxRDq4YXY70NBYLQus1g@mail.gmail.com -->
<!--X-Reference: CAKE4FWp+gb+XdFBkxgLuE5ZJsQWsEWw1yrbckHVgv3Mz4DcJyw@mail.gmail.com -->
<!--X-Reference: CAEwQpa+hssedHNFfPuAcR0ZHej7WW9Pb8TKKDhdhh+gfCXENtQ@mail.gmail.com -->
<!--X-Reference: CAKE4FWp&#45;EyT_tzNwTVbxOz+1YpNKO9Kj2mfkmps49WKzuq4Gnw@mail.gmail.com -->
<!--X-Reference: CAEwQpaKLP0LuiVqHiYtt3&#45;mEmNrg2OZV&#45;7+X9i9vF9TwxbLXwQ@mail.gmail.com -->
<!--X-Derived: pngXTUreeSMdT.png -->
<!--X-Head-End-->
<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN"
        "http://www.w3.org/TR/html4/loose.dtd">
<html>
<head>
<title>Re: [EXTERNAL] [ferret_users] minimum range for @DIN ?</title>
</head>
<body>
<!--X-Body-Begin-->
<!--X-User-Header-->
<!--X-User-Header-End-->
<!--X-TopPNI-->
<HR>
<center>[<a href="msg00982.html">Thread Prev</a>][<a href="msg00975.html">Thread Next</a>][<A HREF="threads.html#00983">Index</A>]</center>

<!--X-TopPNI-End-->
<!--X-MsgBody-->
<!--X-Subject-Header-Begin-->
<h1>Re: [EXTERNAL] [ferret_users] minimum range for @DIN ?</h1>
<hr>
<!--X-Subject-Header-End-->
<!--X-Head-of-Message-->
<ul>
<li><strong>To</strong>: <strong>Ryo Furue &lt;<a href="mailto:furue@DOMAIN.HIDDEN">furue@xxxxxxxxxx</a>&gt;</strong></li>
<li><strong>Subject</strong>: <strong>Re: [EXTERNAL] [ferret_users] minimum range for @DIN ?</strong></li>
<li><strong>From</strong>: <strong>Xiaoyu Bai &lt;<a href="mailto:xbai1@DOMAIN.HIDDEN">xbai1@xxxxxxxx</a>&gt;</strong></li>
<li>Date: Fri, 23 Jul 2021 16:07:21 -0400</li>
<li>Arc-authentication-results: i=4; mx.google.com;       dkim=pass header.i=@uncc.edu header.s=google header.b=AesCZyeR;       arc=pass (i=2 dkim=pass dkdomain=uncc.edu);       spf=pass (google.com: domain of <a href="mailto:xbai1@DOMAIN.HIDDEN">xbai1@xxxxxxxx</a> designates 209.85.222.199 as permitted sender) smtp.mailfrom=<a href="mailto:xbai1@DOMAIN.HIDDEN">xbai1@xxxxxxxx</a></li>
<li>Arc-authentication-results: i=3; mx.google.com;       dkim=pass header.i=@uncc.edu header.s=google header.b=AesCZyeR;       arc=pass (i=2 dkim=pass dkdomain=uncc.edu);       spf=pass (google.com: domain of <a href="mailto:xbai1@DOMAIN.HIDDEN">xbai1@xxxxxxxx</a> designates 209.85.222.199 as permitted sender) smtp.mailfrom=<a href="mailto:xbai1@DOMAIN.HIDDEN">xbai1@xxxxxxxx</a></li>
<li>Arc-authentication-results: i=2; mx.google.com;       dkim=pass header.i=@uncc.edu header.s=google header.b=AesCZyeR;       arc=pass (i=1 spf=pass spfdomain=uncc.edu dkim=pass dkdomain=uncc.edu dmarc=pass fromdomain=uncc.edu);       spf=softfail (google.com: domain of transitioning <a href="mailto:xbai1@DOMAIN.HIDDEN">xbai1@xxxxxxxx</a> does not designate 65.153.203.169 as permitted sender) smtp.mailfrom=<a href="mailto:xbai1@DOMAIN.HIDDEN">xbai1@xxxxxxxx</a></li>
<li>Arc-authentication-results: i=1; mx.google.com;       dkim=pass header.i=@uncc.edu header.s=google header.b=AesCZyeR;       spf=pass (google.com: domain of <a href="mailto:xbai1@DOMAIN.HIDDEN">xbai1@xxxxxxxx</a> designates 209.85.220.41 as permitted sender) smtp.mailfrom=<a href="mailto:xbai1@DOMAIN.HIDDEN">xbai1@xxxxxxxx</a>;       dmarc=pass (p=NONE sp=NONE dis=NONE) header.from=uncc.edu</li>
<li>Arc-message-signature: i=4; a=rsa-sha256; c=relaxed/relaxed; d=google.com; s=arc-20160816;        h=list-archive:list-help:list-post:list-id:mailing-list:precedence         :message-id:cc:to:subject:date:from:in-reply-to:references         :mime-version:sender:dkim-signature;        bh=cRgTB6NLF5F2SVpLiEUxBmx/M1/FBLfVwVu9MSK8J0s=;        b=jkIJS+L+DTbiC7JWtWk/qeqFe2FlPcj6pVXk7+208w5cTGMGSMiWWV5d5MnIFIXpsi         wGP3M1eYDyEkTa7nmeSevPRmq9j4uPNhlQ/bDTN9mpKk9mXHKaJGg4Mj+8cdVnaMCyPo         QnDSYBAk2d190uEeNNqMONGvpCR/gApraMhD04yuFZNNsYRJFWEjy6NZE4xqIFqidvEj         7AX1crB9wGUQTzGGgXKT8mffVCnfH6E5HnqCwA3e71UZ5jeyUszit6qVpxCInVy9RteF         q6JjS4a2Pvq8L47K/XEwP1Ll5NB1PsEEOcV1z84QL+yThseTPBOxsRFVW0QTILn5hMhE         QI0g==</li>
<li>Arc-message-signature: i=3; a=rsa-sha256; c=relaxed/relaxed; d=google.com; s=arc-20160816;        h=message-id:cc:to:subject:date:from:in-reply-to:references         :mime-version:dkim-signature;        bh=cRgTB6NLF5F2SVpLiEUxBmx/M1/FBLfVwVu9MSK8J0s=;        b=FWJIHGvPUzEm553mk8doZQ7aBccHeTEMOwmrDb/8K6689cF24Pk3CTnXvDEkg08InA         ggTBLAf8RzvY1KSM7/syOhmHMHn/0D2fo5/+WfNW3Yx3QA3sHmBCIquqUIZeW69dc/ap         /72Ws7UYfUb354OZo5zvILsOi0NcmgCE6SCm63f/OWq/cPPWF09Ld8ZCdTCEWtqFMkKy         aggibz1P8vNZGWx0knfmlmeffpyDwWhlPoAcHKxNcRmFRzlK9WBOSg0wPf92rEqciMwX         hNHGgHOzGuuC08y+Yukxt/hto2HeQSg3ThPBmu7oUPJxAQBzhpKcUuq8Yzv+BK9v9V5t         1MTw==</li>
<li>Arc-message-signature: i=2; a=rsa-sha256; c=relaxed/relaxed; d=google.com; s=arc-20160816;        h=cc:to:subject:message-id:date:from:in-reply-to:references         :mime-version:dkim-signature;        bh=cRgTB6NLF5F2SVpLiEUxBmx/M1/FBLfVwVu9MSK8J0s=;        b=LnbQINk/ehhn0nPGaMFiV52mUnG0K9aVUGtIAN7BT0+idG1m9c843smVAMv1Z8CpCX         Pu1p6gkIxXdbtMhkaFE4eO/A4vpWLk/SY7A7n4/K2s0Ty4HJPTO6doiu6Kn+hd5DdYUv         jOk+4Ev6xbFAUTFcGpnwazb4JlGMcraCYhfsihAILTZrr4Df/X8318W1S0caUyUluWWI         mXJBaFVdv/131FI5VLUfT1qYTLIe8pmAGVu5/Fmq7jwOR1CZEuK5XcwZtNaR08dJVpUx         HYobT1b3eYNbIFE/NQ1wxfUbmpmytuPa+rymK83j+tkNus8vgQmKx/XMlEPohW/fjhvg         arQw==</li>
<li>Arc-message-signature: i=1; a=rsa-sha256; c=relaxed/relaxed; d=google.com; s=arc-20160816;        h=cc:to:subject:message-id:date:from:in-reply-to:references         :mime-version:dkim-signature;        bh=cRgTB6NLF5F2SVpLiEUxBmx/M1/FBLfVwVu9MSK8J0s=;        b=BtJOmJ9K9G3WihTyo/sD0Wf6ILmpFZMxDHzFOAClowPA4Sq7S128SluwAeQBPz3bnT         vbE34SL/vRqyPEK7Bxm6q32Nzzn+ZCsx+O4m5WLd+ncPsmPne33QIrPbkjXNjAtaUdTl         uIs1K2GA0pgRmjHBHi9xDSme7l1WL6BKovnXT6EkZtG/w0Ugqow5k2FZQDKRL1jT4oDn         hhcOzZWidtvZeiH3cPtensdvzD+SJ3BuS+3Gthz3s31fB5TrSyQQpwAW/fIFYhJ4i8ki         J290H+wDUjIq+e5unVRNwfYLVRE+AiPL97gRrAOwM5Pdc2TrU8PwoYTmKXG3moPtEHIw         6Oqw==</li>
<li>Arc-seal: i=4; a=rsa-sha256; t=1627070886; cv=pass;        d=google.com; s=arc-20160816;        b=LfgmYNa7OzWj9/SAGES3m+t73rYt40EraA6WXUVKpqLMbB3IaSiNownDQ4iK/4s0Q0         bSO/OzNO434Zj7ktkqhiBFsQbMgrk86JwDPv0dYYcAlvbxYIORfAsN/n8NFWQL7XEDzx         Z2jp1pcv3xEYGl4id+4mZSvxQ9Bf7+bnkQsd91vObaDf5ffFkhOm79lkQGzWJiORbhun         tu5YqzMqTkoTKyXHhgiq0cTwzIWoVnhFn7pGdlOt3UYlMhen80QKosUe30N7xDrVFgVA         uuH8BTE7HN9RM0J/OOmL71nO3TMLlz7mlfi4Bf94NM6c+vjHULWagjirB15iyfv25apo         toTg==</li>
<li>Arc-seal: i=3; a=rsa-sha256; t=1627070884; cv=pass;        d=google.com; s=arc-20160816;        b=Anrcx+N6X1Tq+7QsJYD4VgxvMigqpVtzHoV68DXE76F/gpLeIQNMvbqN7QuJBbnD8v         oNSbg60Vv1c7xg3JNQnKWPi5x1CqJBJVSYGqFVr1pMBcqciFhcj3CgKoLDLckAzqIqwx         W8KpJ5WKBoLaLctCBU28byL4XZuJx590R5AYRWGR/no+mUEO1c8+bfn9tOYEC9B2Y1yj         pFLYVjjTF7/jchmVwmwr1dCxRLvv6zy8qmXyh6uG83Eh46Ztaw252QyTmv5V5YlgY1v8         U30MeCr7oATpqBg36fEiCbFLiZA9Veqf48GrknRRhosScTrUXagud1Ia2+swpzwcF/RM         VAUw==</li>
<li>Arc-seal: i=2; a=rsa-sha256; t=1627070882; cv=pass;        d=google.com; s=arc-20160816;        b=kLz8Ga5aEMF/54XBcg4HiC03BNIAEZBmIM5XHueZDAIs0y0Il67Zvqegue+52BmTAO         PWMgr16AKfxWz/Yqxve53bavgYkC6Vplph6iDou4Rp8KgWemYl/YsSKeTs6wWQ5z9ZAC         okjvzqd8/3WZKhbr5cIudgO/ADMqCClnPMHIzWVNEke0FxP7YLz6DVifQKYgihIc4zbn         mM2EX6+R3AAkyM/1yEps1AV3C/NIT8p4vMm45fWx7xcTfZUGpBI3KNdxfaf0/IYrfL7B         8vEmKT1glZ5o8RdP6t1wRP25rqhkUPiJxqLgM9U8EmvE8Q+8m5DcEEKWHj578eqJvYZh         BPLQ==</li>
<li>Arc-seal: i=1; a=rsa-sha256; t=1627070879; cv=none;        d=google.com; s=arc-20160816;        b=jj0YjAtB3sLMEmdaSRC48KaLQQBqq2TRWg7jsld+u8Kwp/Kdx6i0jCtTZN6RuKKweL         ZRx7VuFjBU8MwIZQYo6HRsnBCvtUArflQkB1yqoHlxwwuAQj5JpL3vBTJBmaMa2lGaNt         DaphSxGLuZPvY5eEfY0TVaIdeBwuGwPtlBwcNT6bIqHdYfAM1yl6AeNJ5PX6+z6GH1jt         UVjcmvgMBLkkhceLtUmd+xk6XrUFCcf/tpZFSKHTYqjbOk1druvlajdx2FHaKypdrd0+         NWXQ91qYd25EN2XfBL0iuvouqQ9vcWd+wq+LLhtWm3ReyaPIkKQHHrr6/wNXR1butVLi         k7SA==</li>
<li>Cc: ferret users &lt;<a href="mailto:ferret_users@DOMAIN.HIDDEN">ferret_users@xxxxxxxx</a>&gt;</li>
<li>Dkim-signature: v=1; a=rsa-sha256; c=relaxed/relaxed;        d=noaa.gov; s=google;        h=sender:mime-version:references:in-reply-to:from:date:subject:to:cc         :message-id:x-original-sender:x-original-authentication-results         :precedence:mailing-list:list-id:list-post:list-help:list-archive;        bh=cRgTB6NLF5F2SVpLiEUxBmx/M1/FBLfVwVu9MSK8J0s=;        b=fmwcUX69FFomWtsWA//dMm/T73/9khBRZ9Gi+tJ8OLNJdhWtl1DVX0DeqSFmIJuaBC         16N2v+E+BFMhEzmSuQ1doyDXND88WLfdys+n/4hWG5RmVn0kUtugiZmRpC2Wfy6GaB1m         WsJwnM8UvzPMubQHglOjKcG8I+9pTPrGm0t29W5CnJNla02mhLtGlStwPJQEbpYqgnyA         lNeYfVzWEMD9Yq3VoPgOxug/SlGxBqkewKAgWPfJ1iVLspPoGiLa+yJZf2Mg3NY2bx+U         qv4DWinxEB2FZodevIebUa1SscPSU2WwTuhoi1D6RyJz1zN2J+a1L901OW/U4VPhnEF3         HUIA==</li>
<li>In-reply-to: &lt;<a href="msg00982.html">CAEwQpaKLP0LuiVqHiYtt3-mEmNrg2OZV-7+X9i9vF9TwxbLXwQ@mail.gmail.com</a>&gt;</li>
<li>List-archive: &lt;<a href="https://groups.google.com/a/noaa.gov/group/ferret_users/">https://groups.google.com/a/noaa.gov/group/ferret_users/</a>&gt;</li>
<li>List-help: &lt;<a href="https://support.google.com/a/noaa.gov/bin/topic.py?topic=25838">https://support.google.com/a/noaa.gov/bin/topic.py?topic=25838</a>&gt;, &lt;<a href="mailto:ferret_users+help@noaa.gov">mailto:ferret_users+help@noaa.gov</a>&gt;</li>
<li>List-id: &lt;ferret_users.noaa.gov&gt;</li>
<li>List-post: &lt;<a href="https://groups.google.com/a/noaa.gov/group/ferret_users/post">https://groups.google.com/a/noaa.gov/group/ferret_users/post</a>&gt;, &lt;<a href="mailto:ferret_users@noaa.gov">mailto:ferret_users@noaa.gov</a>&gt;</li>
<li>Mailing-list: list <a href="mailto:ferret_users@DOMAIN.HIDDEN">ferret_users@xxxxxxxx</a>; contact <a href="mailto:ferret_users%2Bowners@DOMAIN.HIDDEN">ferret_users+owners@xxxxxxxx</a></li>
<li>References: &lt;CAEwQpaLJEzvabe=7h=NRgSjJ1-Pgb=JxRDq4YXY70NBYLQus1g@mail.gmail.com&gt; &lt;<a href="msg00979.html">CAKE4FWp+gb+XdFBkxgLuE5ZJsQWsEWw1yrbckHVgv3Mz4DcJyw@mail.gmail.com</a>&gt; &lt;<a href="msg00980.html">CAEwQpa+hssedHNFfPuAcR0ZHej7WW9Pb8TKKDhdhh+gfCXENtQ@mail.gmail.com</a>&gt; &lt;<a href="msg00981.html">CAKE4FWp-EyT_tzNwTVbxOz+1YpNKO9Kj2mfkmps49WKzuq4Gnw@mail.gmail.com</a>&gt; &lt;<a href="msg00982.html">CAEwQpaKLP0LuiVqHiYtt3-mEmNrg2OZV-7+X9i9vF9TwxbLXwQ@mail.gmail.com</a>&gt;</li>
<li>Sender: <a href="mailto:owner-ferret_users@DOMAIN.HIDDEN">owner-ferret_users@xxxxxxxx</a></li>
</ul>
<!--X-Head-of-Message-End-->
<!--X-Head-Body-Sep-Begin-->
<hr>
<!--X-Head-Body-Sep-End-->
<!--X-Body-of-Message-->
<div dir="ltr"><div><font face="arial, sans-serif">Dear&#xA0;Ryo san,</font></div><div><font face="arial, sans-serif"><br></font></div><div><font face="monospace" color="#0000ff">ave(q) = din(q) / A,</font></div><div><font face="monospace" color="#0000ff"><br></font></div><div><font face="monospace" color="#0000ff">where A is the area of the integration and average.&#xA0; Therefore</font></div><div><font face="monospace" color="#0000ff"><br></font></div><div><font face="monospace" color="#0000ff">din(q - ave(q)) = din(q) - A ave(q) = din(q) - din(q) = 0.</font></div><div><br></div><div>This makes sense to me.&#xA0;</div><div><br></div><div><font face="monospace" color="#0000ff">integral on I and J instead of x and y as in &quot;x=0:360@DIN, y=90S:90N@DIN&quot;</font><br></div><div><br></div><div>It does brought down the value a little bit:</div><div><br></div><div><font face="monospace">list test_din<br>&#xA0; &#xA0; &#xA0; &#xA0; &#xA0; &#xA0; &#xA0;VARIABLE : COMP3[X=0:360@DIN,Y=90S:90N@DIN]<br>&#xA0; &#xA0; &#xA0; &#xA0; &#xA0; &#xA0; &#xA0;FILENAME : coads_climatology.cdf<br>&#xA0; &#xA0; &#xA0; &#xA0; &#xA0; &#xA0; &#xA0;FILEPATH : /home/xbai1/miniconda2/envs/FERRET/share/fer_dsets/data/<br>&#xA0; &#xA0; &#xA0; &#xA0; &#xA0; &#xA0; &#xA0;LONGITUDE: 0E to 0E(360)<br>&#xA0; &#xA0; &#xA0; &#xA0; &#xA0; &#xA0; &#xA0;LATITUDE : 90S to 90N<br>&#xA0; &#xA0; &#xA0; &#xA0; &#xA0; &#xA0; &#xA0;TIME &#xA0; &#xA0; : 16-AUG 07:23<br>&#xA0; &#xA0; &#xA0; &#xA0; &#xA0;-90.20</font><br></div><div><br></div><div>I will definitely&#xA0;pay more attention to the difference between IJ and XY in the future.</div><div><br></div><div>Thank you very much and stay healthy,</div><div><br></div><div>Xiaoyu&#xA0;</div></div><br><div class="gmail_quote"><div dir="ltr" class="gmail_attr">On Fri, Jul 23, 2021 at 2:35 PM Ryo Furue &lt;<a rel="nofollow" href="mailto:furue@xxxxxxxxxx">furue@xxxxxxxxxx</a>&gt; wrote:<br></div><blockquote class="gmail_quote" style="margin:0px 0px 0px 0.8ex;border-left:1px solid rgb(204,204,204);padding-left:1ex"><div dir="ltr"><div dir="ltr">Hi&#xA0;&#xA0;Xiaoyu,</div><br><div class="gmail_quote"><div dir="ltr" class="gmail_attr">On Fri, Jul 23, 2021 at 7:35 AM Xiaoyu Bai &lt;<a rel="nofollow" href="mailto:xbai1@xxxxxxxx" target="_blank">xbai1@xxxxxxxx</a>&gt; wrote:<br></div><blockquote class="gmail_quote" style="margin:0px 0px 0px 0.8ex;border-left:1px solid rgb(204,204,204);padding-left:1ex"><div dir="ltr">I see! By the way, do you know how to fix the&#xA0;@DIN cannot be applied correctly after you subtract your data from&#xA0;@AVE?</div></blockquote><div><br></div><div><blockquote class="gmail_quote" style="margin:0px 0px 0px 0.8ex;border-left:1px solid rgb(204,204,204);padding-left:1ex"><font face="monospace">let comp1=test-mean<br>let comp2=test<font color="#ff0000">-21.16</font><br>let bad_din=comp1[I=@DIN,J=@DIN]<br>let good_din=comp2[I=@DIN,J=@DIN]</font><br>&#xA0;</blockquote><div>&#xA0;</div></div><div>It seems to me that what you see is normal (to be expected).&#xA0; Let &quot;ave&quot; be an area average and &quot;din&quot; be the corresponding area integral.&#xA0; Then</div><div><br></div><div>ave(q) = din(q) / A,</div><div><br></div><div>where A is the area of the integration and average.&#xA0; Therefore</div><div><br></div><div>din(q - ave(q)) = din(q) - A ave(q) = din(q) - din(q) = 0.</div><div><br></div><div>So, you expect zero for the answer.&#xA0; good_din is very large only because <font color="#ff0000">mean&#xA0; &#x2260; 21.16</font> !&#xA0; If you replaced the definition of comp2 with</div><div><br></div><div><font face="monospace">let comp2 = test - `mean`</font></div><div><br></div><div>then, &quot;bad_din&quot; and &quot;good_din&quot; are much closer.</div><div><br></div><div>So, why aren&#39;t they zero?&#xA0; Probably because you calculate the average and integral on I and J instead of x and y as in &quot;x=0:360@DIN, y=90S:90N@DIN&quot; but I&#39;m not sure.</div><div><br></div><div>Regards,</div><div><br></div><div>Ryo</div><div><br></div><div><br></div><div><br></div><div><br></div><blockquote class="gmail_quote" style="margin:0px 0px 0px 0.8ex;border-left:1px solid rgb(204,204,204);padding-left:1ex"><div dir="ltr">&#xA0;<br><div><br></div><div>I need to calculate the mass transported by Hadley cells. So my v-wind must be zero when integrating through the whole column. Usually, it can be solved by subtracting the average value of v-wind. During my process of&#xA0;subtracting the average&#xA0;values, I found if you subtract the average value, pyferret does NOT treat your new values as &quot;spatial data&quot; (I don&#39;t know how to describe&#xA0;it). For example,&#xA0;</div><div><br></div><div><font face="monospace">set data coads_climatology</font></div><div><font face="monospace">let test=SST[L=8]&#xA0; &#xA0; &#xA0; &#xA0; ! just a random month<br></font></div><div><font face="monospace">let mean=test[I=@AVE,J=@AVE]<br></font></div><div><font face="monospace">list mean<br>&#xA0; &#xA0; &#xA0; &#xA0; &#xA0; &#xA0; &#xA0;VARIABLE : TEST[I=@AVE,J=@AVE]<br>&#xA0; &#xA0; &#xA0; &#xA0; &#xA0; &#xA0; &#xA0;FILENAME : coads_climatology.cdf<br>&#xA0; &#xA0; &#xA0; &#xA0; &#xA0; &#xA0; &#xA0;FILEPATH : /home/xbai1/miniconda2/envs/FERRET/share/fer_dsets/data/<br>&#xA0; &#xA0; &#xA0; &#xA0; &#xA0; &#xA0; &#xA0;LONGITUDE: 20E to 20E(380)<br>&#xA0; &#xA0; &#xA0; &#xA0; &#xA0; &#xA0; &#xA0;LATITUDE : 90S to 90N<br>&#xA0; &#xA0; &#xA0; &#xA0; &#xA0; &#xA0; &#xA0;TIME &#xA0; &#xA0; : 16-AUG 07:23<br>&#xA0; &#xA0; &#xA0; &#xA0; &#xA0; 21.16</font><br></div><div><br></div><div>which means the average value is 21.16 Celsius. Then I do:</div><div><br></div><div><font face="monospace">let comp1=test-mean<br></font></div><div><font face="monospace">let comp2=test-21.16<br></font></div><div><font face="monospace">let bad_din=comp1[I=@DIN,J=@DIN]<br></font></div><div><font face="monospace">let good_din=comp2[I=@DIN,J=@DIN]<br></font></div><div><font face="monospace">list bad_din, good_din<br>&#xA0; &#xA0; &#xA0; &#xA0; &#xA0; &#xA0; &#xA0;DATA SET: /home/xbai1/miniconda2/envs/FERRET/share/fer_dsets/data/coads_climatology.cdf<br>&#xA0; &#xA0; &#xA0; &#xA0; &#xA0; &#xA0; &#xA0;LONGITUDE: 20E to 20E(380)<br>&#xA0; &#xA0; &#xA0; &#xA0; &#xA0; &#xA0; &#xA0;LATITUDE: 90S to 90N<br>&#xA0; &#xA0; &#xA0; &#xA0; &#xA0; &#xA0; &#xA0;TIME: 16-AUG 07:23<br>&#xA0;Column &#xA0;1: BAD_DIN is COMP1[I=@DIN,J=@DIN]<br>&#xA0;Column &#xA0;2: GOOD_DIN is COMP2[I=@DIN,J=@DIN]<br>&#xA0; &#xA0; &#xA0; &#xA0; &#xA0;BAD_DIN &#xA0; GOOD_DIN<br>I / *: &#xA0; &#xA0; <span style="background-color:rgb(0,255,0)">-91.65</span> <span style="background-color:rgb(0,255,255)">-2.954E+11</span></font><br></div><div><br></div><div>To me, the E+11 value makes more sense considering we are integrating over a large area. Earlier, we thought this problem was a bug in Show Grid and it was fixed. (<a rel="nofollow" href="https://www.pmel.noaa.gov/maillists/tmap/ferret_users/fu_2019/msg00495.html" target="_blank">https://www.pmel.noaa.gov/maillists/tmap/ferret_users/fu_2019/msg00495.html</a>). However, this problem was not solved after the show grid bug was fixed:</div><div><br></div><div>&#xA0;<font face="monospace">show grid comp1, comp2<br>&#xA0; &#xA0; GRID GSQ1<br>&#xA0;name &#xA0; &#xA0; &#xA0; axis &#xA0; &#xA0; &#xA0; &#xA0; &#xA0; &#xA0; &#xA0;# pts &#xA0; start &#xA0; &#xA0; &#xA0; &#xA0; &#xA0; &#xA0; &#xA0; &#xA0;end &#xA0; &#xA0; &#xA0; &#xA0; &#xA0; &#xA0; &#xA0; &#xA0; subset<br>&#xA0;COADSX &#xA0; &#xA0;LONGITUDE &#xA0; &#xA0; &#xA0; &#xA0; &#xA0;180mr &#xA0; 21E &#xA0; &#xA0; &#xA0; &#xA0; &#xA0; &#xA0; &#xA0; &#xA0; &#xA0;19E(379) &#xA0; &#xA0; &#xA0; &#xA0; &#xA0; &#xA0;full<br>&#xA0;COADSY &#xA0; &#xA0;LATITUDE &#xA0; &#xA0; &#xA0; &#xA0; &#xA0; &#xA0;90 r &#xA0; 89S &#xA0; &#xA0; &#xA0; &#xA0; &#xA0; &#xA0; &#xA0; &#xA0; &#xA0;89N &#xA0; &#xA0; &#xA0; &#xA0; &#xA0; &#xA0; &#xA0; &#xA0; full<br>&#xA0;normal &#xA0; &#xA0;Z<br>&#xA0;TIME &#xA0; &#xA0; &#xA0;TIME &#xA0; &#xA0; &#xA0; &#xA0; &#xA0; &#xA0; &#xA0; &#xA0;12mr &#xA0; 16-JAN 06:00 &#xA0; &#xA0; &#xA0; &#xA0; 16-DEC 01:20 &#xA0; &#xA0; &#xA0; &#xA0;1 pt<br>&#xA0; &#xA0; GRID GSQ1<br>&#xA0;name &#xA0; &#xA0; &#xA0; axis &#xA0; &#xA0; &#xA0; &#xA0; &#xA0; &#xA0; &#xA0;# pts &#xA0; start &#xA0; &#xA0; &#xA0; &#xA0; &#xA0; &#xA0; &#xA0; &#xA0;end &#xA0; &#xA0; &#xA0; &#xA0; &#xA0; &#xA0; &#xA0; &#xA0; subset<br>&#xA0;COADSX &#xA0; &#xA0;LONGITUDE &#xA0; &#xA0; &#xA0; &#xA0; &#xA0;180mr &#xA0; 21E &#xA0; &#xA0; &#xA0; &#xA0; &#xA0; &#xA0; &#xA0; &#xA0; &#xA0;19E(379) &#xA0; &#xA0; &#xA0; &#xA0; &#xA0; &#xA0;full<br>&#xA0;COADSY &#xA0; &#xA0;LATITUDE &#xA0; &#xA0; &#xA0; &#xA0; &#xA0; &#xA0;90 r &#xA0; 89S &#xA0; &#xA0; &#xA0; &#xA0; &#xA0; &#xA0; &#xA0; &#xA0; &#xA0;89N &#xA0; &#xA0; &#xA0; &#xA0; &#xA0; &#xA0; &#xA0; &#xA0; full<br>&#xA0;normal &#xA0; &#xA0;Z<br>&#xA0;TIME &#xA0; &#xA0; &#xA0;TIME &#xA0; &#xA0; &#xA0; &#xA0; &#xA0; &#xA0; &#xA0; &#xA0;12mr &#xA0; 16-JAN 06:00 &#xA0; &#xA0; &#xA0; &#xA0; 16-DEC 01:20 &#xA0; &#xA0; &#xA0; &#xA0;1 pt</font><br></div><div><br></div><div>Looks like to me, the new value after subtracting&#xA0;@AVE was treated like pure numeric values. But it&#39;s not&#xA0;@SUM type of calculation.&#xA0;</div><div><br></div><div><font face="monospace">list comp1[I=@SUM,J=@SUM], comp2[I=@SUM,J=@SUM]<br>&#xA0; &#xA0; &#xA0; &#xA0; &#xA0; &#xA0; &#xA0;DATA SET: /home/xbai1/miniconda2/envs/FERRET/share/fer_dsets/data/coads_climatology.cdf<br>&#xA0; &#xA0; &#xA0; &#xA0; &#xA0; &#xA0; &#xA0;LONGITUDE: 20E to 20E(380) (XY summed)<br>&#xA0; &#xA0; &#xA0; &#xA0; &#xA0; &#xA0; &#xA0;LATITUDE: 90S to 90N (XY summed)<br>&#xA0; &#xA0; &#xA0; &#xA0; &#xA0; &#xA0; &#xA0;TIME: 16-AUG 07:23<br>&#xA0;Column &#xA0;1: COMP1 is TEST-MEAN<br>&#xA0;Column &#xA0;2: COMP2 is TEST-21.16<br>&#xA0; &#xA0; &#xA0; &#xA0; &#xA0; &#xA0;COMP1 &#xA0; COMP2<br>I / *: &#xA0; &#xA0;-17139. -17147.</font><br></div><div><br></div><div>I am puzzled by this issue.</div><div><br></div><div>Thank you very much and stay healthy,</div><div><br></div><div>Xiaoyu</div><div>&#xA0;</div><div><br></div><div>&#xA0;&#xA0;</div></div><br><div class="gmail_quote"><div dir="ltr" class="gmail_attr">On Tue, Jul 20, 2021 at 11:06 PM Ryo Furue &lt;<a rel="nofollow" href="mailto:furue@xxxxxxxxxx" target="_blank">furue@xxxxxxxxxx</a>&gt; wrote:<br></div><blockquote class="gmail_quote" style="margin:0px 0px 0px 0.8ex;border-left:1px solid rgb(204,204,204);padding-left:1ex"><div dir="ltr"><div>Hi Xiayu,</div><br><div class="gmail_quote"><div dir="ltr" class="gmail_attr">On Wed, Jul 21, 2021 at 6:42 AM Xiaoyu Bai &lt;<a rel="nofollow" href="mailto:xbai1@xxxxxxxx" target="_blank">xbai1@xxxxxxxx</a>&gt; wrote:<br></div><blockquote class="gmail_quote" style="margin:0px 0px 0px 0.8ex;border-left:1px solid rgb(204,204,204);padding-left:1ex"><div dir="ltr">I usually use at least two grids. My understanding is that&#xA0;@DDN [<font color="#ff0000">@DIN</font>] needs to apply a weight, most of the time is the cosine effect. If there is only one grid, pyferret will possibly only consider the one grid&#39;s value only.</div></blockquote><div><br></div><div>Yes, but the point is that the weight is continuous.&#xA0; Suppose that our SST is defined at lat = 1&#xB0;, 3&#xB0;, 5&#xB0;, . . . at an interval of 2&#xB0; .&#xA0; Then,</div><div><br></div><div>SST[y=0:yhi@DIN]</div><div><br></div><div>is a continuous function of yhi.&#xA0; Below is a figure showing this function (when SST is uniformly 1). The horizontal axis of the plot is yhi.&#xA0; If you increase yhi slightly, the integral increases slightly because Ferret adjusts the weight.</div><div><br></div><div>The problem is that Ferret seems to stop adjusting the weight when yhi &lt; 2&#xB0; as the figure shows.&#xA0; In particular, one would expect that SST[y=<font color="#ff0000">0:0</font>@DIN] is zero.</div><div><br></div><div>This can be a source of error when you use Ferret programmatically&#xA0;to calculate integrals.&#xA0; For example, I can imagine a calculation like this</div><div><br></div><div>repeat/range=1:`iend`/name=ii (</div><div>&#xA0; &#xA0;let yhi = curvey[i=`ii`]<br></div><div>&#xA0; &#xA0;let xx = xvals[i=`ii`]</div><div>&#xA0; &#xA0;list/append/nohead/file=integral.txt/format=(G0,1X,G0) xx, SST[i=`ii`, y=0:`yhi`@DIN]<br></div><div>)</div><div><br></div><div>to calculate the integral of SST from the equator to a curve&#xA0; (x, curvey(x) ) as a function of x.</div><div><br></div><div>Regards,</div><div><br></div><div>Ryo</div><div><br></div><div>-------------------------------------------------</div><div>! --- script to generate the data for the plot below ---</div>set data coads_climatology &#xA0;! grid spacing is 2&#xB0;<br><div>let _ones_ = 1 + 0*y[gy=SST]</div><div>repeat/range=0:40/name=yy (let yhi=`yy/4`; let val = ones[y=0:`yhi`@DIN]; say/quiet `yhi` `val`)<br></div><div><br></div><img src="pngXTUreeSMdT.png" alt="ferret-din.png" width="472" height="283"><br><div>&#xA0;</div><div><br></div><div><br></div><blockquote class="gmail_quote" style="margin:0px 0px 0px 0.8ex;border-left:1px solid rgb(204,204,204);padding-left:1ex"><div dir="ltr">&#xA0;&#xA0;<div><br></div><div>Stay healthy,</div><div><br></div><div>Xiaoyu</div></div><br><div class="gmail_quote"><div dir="ltr" class="gmail_attr">On Thu, Jul 15, 2021 at 10:02 PM Ryo Furue &lt;<a rel="nofollow" href="mailto:furue@xxxxxxxxxx" target="_blank">furue@xxxxxxxxxx</a>&gt; wrote:<br></div><blockquote class="gmail_quote" style="margin:0px 0px 0px 0.8ex;border-left:1px solid rgb(204,204,204);padding-left:1ex">[<strong><font color="red">Caution</font></strong>: Email from External Sender. Do not click or open links or attachments unless you know this sender.]<br><span>&#xA0;</span><div dir="ltr">Dear Ferreters,<div><br></div><div>Does @DIN have a minimum range?&#xA0; It seems that it stops shrinking when the integration range shrinks below the gridsize.</div><div><br></div><div>For a test, I define a variable which is always one and print the values of the integration over y=0:ylim, where ylim = 0, 0.5, 1, 1.5, . . . .</div><div><br></div><div><font face="monospace">set data coads_climatology&#xA0; ! grid spacing is 2&#xB0;<br>let _ones_ = 1 + 0*y[gy=SST]<br></font></div><div><font face="monospace">repeat/range=0:8/name=yy (let val = ones[y=0:`yy/2`@DIN]; say `val`)<br></font></div><div><br></div><div>I find that the value of the integral is constant when ylim &lt;=&#xA0;dely and then it starts to linearly grow after that.</div><div><br></div><div>Perhaps this isn&#39;t intended?</div><div><br></div><div>Best regards,</div><div><br></div><div>Ryo</div></div>
</blockquote></div><br clear="all"><div><br></div>-- <br><div dir="ltr"><div dir="ltr">Xiaoyu</div></div>
</blockquote></div></div>
</blockquote></div><br clear="all"><div><br></div>-- <br><div dir="ltr"><div dir="ltr">Xiaoyu</div></div>
</blockquote></div></div>
</blockquote></div><br clear="all"><div><br></div>-- <br><div dir="ltr" class="gmail_signature"><div dir="ltr">Xiaoyu</div></div>

<!--X-Body-of-Message-End-->
<!--X-MsgBody-End-->
<!--X-Follow-Ups-->
<hr>
<!--X-Follow-Ups-End-->
<!--X-References-->
<ul><li><strong>References</strong>:
<ul>
<li><strong><a name="00974" href="msg00974.html">[ferret_users] minimum range for @DIN ?</a></strong>
<ul><li><em>From:</em> Ryo Furue</li></ul></li>
<li><strong><a name="00979" href="msg00979.html">Re: [EXTERNAL] [ferret_users] minimum range for @DIN ?</a></strong>
<ul><li><em>From:</em> Xiaoyu Bai</li></ul></li>
<li><strong><a name="00980" href="msg00980.html">Re: [EXTERNAL] [ferret_users] minimum range for @DIN ?</a></strong>
<ul><li><em>From:</em> Ryo Furue</li></ul></li>
<li><strong><a name="00981" href="msg00981.html">Re: [EXTERNAL] [ferret_users] minimum range for @DIN ?</a></strong>
<ul><li><em>From:</em> Xiaoyu Bai</li></ul></li>
<li><strong><a name="00982" href="msg00982.html">Re: [EXTERNAL] [ferret_users] minimum range for @DIN ?</a></strong>
<ul><li><em>From:</em> Ryo Furue</li></ul></li>
</ul></li></ul>
<!--X-References-End-->
<!--X-BotPNI-->
<UL>
<li>Previous by thread:
<strong><a href="msg00982.html">Re: [EXTERNAL] [ferret_users] minimum range for @DIN ?</a></strong>
</li>
<li>Next by thread:
<strong><a href="msg00975.html">[ferret_users] Mac, PyFerret, FRAME, image is cropped</a></strong>
</li>

</UL>
<center>[<a href="msg00982.html">Thread Prev</a>][<a href="msg00975.html">Thread Next</a>][<A HREF="threads.html#00983">Index</A>]</center>

<!--X-BotPNI-End-->
<!--X-User-Footer-->
<A HREF="http://ferret.pmel.noaa.gov/Ferret/contact-us">Contact Us</A>
<br>
<font size=-1>
<address>
<a href="http://www.doc.gov">Dept of Commerce</a> /
<a href="http://www.noaa.gov">NOAA</a> /
<a href="http://www.oar.noaa.gov">OAR</a> /
<a href="http://www.pmel.noaa.gov">PMEL</a> /
<a href="http://ferret.pmel.noaa.gov">Ferret</a>
</address>

<br>
 <a href="http://www.noaa.gov/privacy.html">Privacy Policy</a> | <a href="http://www.noaa.gov/disclaimer.html">Disclaimer</a> | <a href="accessibility.html">Accessibility Statement</a> 

</font>
<!--X-User-Footer-End-->
</body>
</html>
