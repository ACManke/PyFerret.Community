<!-- MHonArc v2.6.18 -->
<!--X-Subject: Re: [ferret_users] maximum size of variable (again) -->
<!--X-From-R13: Oafyrl [naxr <n.p.znaxrNtznvy.pbz> -->
<!--X-Date: Mon, 28 Jun 2021 11:40:59 &#45;0700 -->
<!--X-Message-Id: 85ef56bc&#45;e851&#45;fc81&#45;8651&#45;ee46edf6d8f9@gmail.com -->
<!--X-Content-Type: multipart/alternative -->
<!--X-Reference: CAEwQpaJ522S8Dkb28Ci+2xUcPWpyachqd3s78YNcpksgfoqypw@mail.gmail.com -->
<!--X-Head-End-->
<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN"
        "http://www.w3.org/TR/html4/loose.dtd">
<html>
<head>
<title>Re: [ferret_users] maximum size of variable (again)</title>
</head>
<body>
<!--X-Body-Begin-->
<!--X-User-Header-->
<!--X-User-Header-End-->
<!--X-TopPNI-->
<HR>
<center>[<a href="msg00967.html">Thread Prev</a>][<a href="msg00972.html">Thread Next</a>][<A HREF="threads.html#00968">Index</A>]</center>

<!--X-TopPNI-End-->
<!--X-MsgBody-->
<!--X-Subject-Header-Begin-->
<h1>Re: [ferret_users] maximum size of variable (again)</h1>
<hr>
<!--X-Subject-Header-End-->
<!--X-Head-of-Message-->
<ul>
<li><strong>To</strong>: <strong><a href="mailto:ferret_users@DOMAIN.HIDDEN">ferret_users@xxxxxxxx</a></strong></li>
<li><strong>Subject</strong>: <strong>Re: [ferret_users] maximum size of variable (again)</strong></li>
<li><strong>From</strong>: <strong>Ansley Manke &lt;<a href="mailto:a.c.manke@DOMAIN.HIDDEN">a.c.manke@xxxxxxxxx</a>&gt;</strong></li>
<li>Date: Mon, 28 Jun 2021 11:40:53 -0700</li>
<li>Arc-authentication-results: i=4; mx.google.com;       dkim=pass header.i=@gmail.com header.s=20161025 header.b=HVP2tJvB;       arc=pass (i=2 dkim=pass dkdomain=gmail.com);       spf=pass (google.com: domain of <a href="mailto:a.c.manke@DOMAIN.HIDDEN">a.c.manke@xxxxxxxxx</a> designates 209.85.219.72 as permitted sender) smtp.mailfrom=<a href="mailto:a.c.manke@DOMAIN.HIDDEN">a.c.manke@xxxxxxxxx</a></li>
<li>Arc-authentication-results: i=3; mx.google.com;       dkim=pass header.i=@gmail.com header.s=20161025 header.b=HVP2tJvB;       arc=pass (i=2 dkim=pass dkdomain=gmail.com);       spf=pass (google.com: domain of <a href="mailto:a.c.manke@DOMAIN.HIDDEN">a.c.manke@xxxxxxxxx</a> designates 209.85.219.72 as permitted sender) smtp.mailfrom=<a href="mailto:a.c.manke@DOMAIN.HIDDEN">a.c.manke@xxxxxxxxx</a></li>
<li>Arc-authentication-results: i=2; mx.google.com;       dkim=pass header.i=@gmail.com header.s=20161025 header.b=HVP2tJvB;       arc=pass (i=1 spf=pass spfdomain=gmail.com dkim=pass dkdomain=gmail.com dmarc=pass fromdomain=gmail.com);       spf=softfail (google.com: domain of transitioning <a href="mailto:a.c.manke@DOMAIN.HIDDEN">a.c.manke@xxxxxxxxx</a> does not designate 65.153.203.167 as permitted sender) smtp.mailfrom=<a href="mailto:a.c.manke@DOMAIN.HIDDEN">a.c.manke@xxxxxxxxx</a></li>
<li>Arc-authentication-results: i=1; mx.google.com;       dkim=pass header.i=@gmail.com header.s=20161025 header.b=HVP2tJvB;       spf=pass (google.com: domain of <a href="mailto:a.c.manke@DOMAIN.HIDDEN">a.c.manke@xxxxxxxxx</a> designates 209.85.220.41 as permitted sender) smtp.mailfrom=<a href="mailto:a.c.manke@DOMAIN.HIDDEN">a.c.manke@xxxxxxxxx</a>;       dmarc=pass (p=NONE sp=QUARANTINE dis=NONE) header.from=gmail.com</li>
<li>Arc-message-signature: i=4; a=rsa-sha256; c=relaxed/relaxed; d=google.com; s=arc-20160816;        h=list-archive:list-help:list-post:list-id:mailing-list:precedence         :message-id:content-language:in-reply-to:mime-version:user-agent         :date:from:references:to:subject:sender:dkim-signature;        bh=S8c1Cd5/cDgATHDy6TqHYYiwlcufVgvjn9ikyKWgUFU=;        b=TYUk4rSMLIL17JDJMo92yBRv+ZTASpfIUvbPDFjDYbZFsQNZV7JBgY2HGDdEYcZIp3         r0eTVqqRu2MLHoR5YhxFNBAjq0w2jprk+03ttWju2kt2FYOtQbyO103cs8MvpTSNQFs9         pf3JjWGgX4sfUlhBMmENhlyjfQ/gYWZu/7xakq6cnGvgGbB07c8HUGxurSM95AAhtyTt         Q1hspepr3H73eXAy8vTQ8GQm1Oue/mewydSJzltk/zafrgUqtVN5FfXXJbkZ16hFjb4P         qDArwWCotsQj9f8opyYNnDy/UK/aHCJIqOkdOLLmt6xBe7bAStwJ8CWugYiShwycH4P6         YKdg==</li>
<li>Arc-message-signature: i=3; a=rsa-sha256; c=relaxed/relaxed; d=google.com; s=arc-20160816;        h=message-id:content-language:in-reply-to:mime-version:user-agent         :date:from:references:to:subject:dkim-signature;        bh=S8c1Cd5/cDgATHDy6TqHYYiwlcufVgvjn9ikyKWgUFU=;        b=hJK/ga24fXPKoaUe5sHGkHp6whLOQCFdSTVj6ZyGse+4YTsgamO+6r86DPpzA2sRv1         zffHFIqO1dCrQz+Nl6J+vjFQ9MvHpta76gjZdu4UEuUA3IGtlqMakaEyBxxCbX04GRcO         3Vh+y8e+3ND9NcRsKpMIHJ6DlQOPSVYwfdXffr5ofrqyXUApDGA7OfVOlQ1vwXifwQhr         hknmciotd9rh1Y3ikrYoNyZ70STouYsid5L146ZyCKOtkn84jzjKzdvGjjRPEvPVu+e2         JQlhUxyxofZHqWv2Z3g45Regyrn1HYrD3YU5gyZzZ5r9svoENBen2NzhvMDjdsILRlYK         uoiQ==</li>
<li>Arc-message-signature: i=2; a=rsa-sha256; c=relaxed/relaxed; d=google.com; s=arc-20160816;        h=content-language:in-reply-to:mime-version:user-agent:date         :message-id:from:references:to:subject:dkim-signature;        bh=S8c1Cd5/cDgATHDy6TqHYYiwlcufVgvjn9ikyKWgUFU=;        b=e62f/LhrEOtzLFzVsV9468dePva5/VSImHNDV9Qd1QBn7J+4nHgxNqYBGp13PD//eJ         jlyrFRMxALcM84P2GOkxmcYBjKB8bpUMn5E9elP0pPYV901KBSYhHb59vILiPKDSUFfr         h4IJimBz4UybqCu7WPUeyV1t/ZzdPxYe8nsmgO0dzwgX5PbNi6+AGWraVP8/jZUCbBwu         TYTOVCiXKaauP/1zUntkD8/ehEWwxFSp1Nai84lfTI3C/waK12PVBryTfY1ofo2negt/         +fM3vHSmEid/p7qnuaxJY2N0RVXEk0x/QEZ+K+tkb+a2eo6fwI9T7k7ijpnVlWo2TEQt         DIfQ==</li>
<li>Arc-message-signature: i=1; a=rsa-sha256; c=relaxed/relaxed; d=google.com; s=arc-20160816;        h=content-language:in-reply-to:mime-version:user-agent:date         :message-id:from:references:to:subject:dkim-signature;        bh=S8c1Cd5/cDgATHDy6TqHYYiwlcufVgvjn9ikyKWgUFU=;        b=PBfq6ZRlfGBsSmQQQWUYt7Eydspaxu3IwQvfYlyjIKnUBh2xHZ1eN72meZtoP1ypnq         1+z5i7JlWK+K1f/CtSRoVOlkz5RnQoL/EXYWTiqnyDuphVFS580fsxuyMSjySnQUKW/n         3dq5kxyWJCUNOFDjWOwmHlGwPuMjMO1uGDnco68iRPGFd0x6Y7u8DGsKROT/LwDASVaR         X5UY9SEzW+doOySPdk3rf3Lf7cNHFaosaiLzjX3AAISjtWgkBLzNMbDbefppp7NXdzJY         tI7i/ZdPQ0QSeBLGQ8fBu2ddXsO0oityetXrF6x1iV7HkdyeifTSWEQn0aQG0vYcjRFA         UmFQ==</li>
<li>Arc-seal: i=4; a=rsa-sha256; t=1624905658; cv=pass;        d=google.com; s=arc-20160816;        b=eYFuQzeGuAygjdAguMS/l4scVZEH9xQggEQvxX7cDMp8fOmXrX68/VRzNlSLynxH5J         CZI2ZA5Tr0z0LimQbdlbxCF8m0+jEw1R66rLTeT8jJr/CwxVPS8FrytzIs3ZlwB0pyA7         ICnH4zpuBjUvaHH93126GviF8LQAlsYNEjlFfdAys+TlKYyAVE89oqh9HdtLVJvufDa+         +PQIm5N/9heGmc3/f4cy5c6Yjx/ssvkUItKyrULOQFTcEXESP7D7abWQmXq/5G/XUOfw         hRV7ZK7ZYH6ctko6gEoF2MLFn0TavLqEOprcxg6M+BDGNx2Lz6P4Jpe+ogB+lpplWMjU         gxUA==</li>
<li>Arc-seal: i=3; a=rsa-sha256; t=1624905657; cv=pass;        d=google.com; s=arc-20160816;        b=l2CG8Q2MnKls56Pnnti3B6lLYVjdTDhzyS6cS3taDoMrYTvumlBLtgC+ACgkacvyY4         zBm9AoOKnanPwO/9xfTlNG/KlNzeAHdg4hFtdRHTuivefHB7T46MlKU8tAny2IEdi7fY         tg0tIeaKhT4twdbuZ6Nwo+jxhtMH9StdhjjWamhtF9ox0yHcuJQngyOh0gyFM8jKwldW         5ENfwH+d6Dt3YYYtu33fkdvebE46BcVqgrHEoqZrAR3xO6BrkhzPtpdTXcX6I9GdrDo8         C+5T2/Ck9W7J1oqdTgRGUCyiSy7Xwz5cfOC+JvJhU9Jgg+nAda/ipOJS6bwO229MvT7x         KxlA==</li>
<li>Arc-seal: i=2; a=rsa-sha256; t=1624905654; cv=pass;        d=google.com; s=arc-20160816;        b=smMrB32tjMKSHpIY8fzqHhm6NRE1Za1Vxr3Z82EHTbpiTTgfVfycH3omU/DehOsDF+         n0Fzuj/Ge/qCfErUgv75UrC455SsAhTXIgcN9BIuekaCH/9E4gltPGacRK6YoClBF59W         DG7kpU+XM+jIAAg2khJ3sVr+jXOoF0NN6EcoKH9YMQu3DgTfemB4aeGyjzbG5BsVafpE         jNDxIsoeNfVyWfCtNdUNqiqci1XdFWeOioD7pFpXsAQ+x3U/V7qJUz/R3aRQ49zeHAgC         /5ZMlbzqmFBkwzf3eMgqDpHJHvpXYjrqP/4BRQRm9SuPUjOWgw/TcVwHvh7P3s/yOAmr         0nQQ==</li>
<li>Arc-seal: i=1; a=rsa-sha256; t=1624905653; cv=none;        d=google.com; s=arc-20160816;        b=wEAchRQ/fm1tTGEwgZvz0swIZinOIR6jjWjxU/P2D6+q7Xc8sADBI7bg18EWYhV5WY         ffCj8GP44oCPOnmGLvc62JrnNkN/x7cO+oEoBVy2jCCmrksX20l1Bwu1MkgsfO8PxttR         FQQtNvfNYBKSdJkX6gdObGUYpZZroYDjuv9Xd9f/OjRDFvGAl924INYiv6BUY3tOTMpK         z1wIPHtx0WlqXsjC1hztYC2b9lTC8tU4+V1fP+p070UJkn5lAt6KMr616XiaFaDyk2si         dOFKVRHXnNAXCy+9oqk1NKq98mXTqKckqv9Bed3dACYI/t1yUptQspSjiy8JfbgfhbHG         rb2w==</li>
<li>Dkim-signature: v=1; a=rsa-sha256; c=relaxed/relaxed;        d=noaa.gov; s=google;        h=sender:subject:to:references:from:date:user-agent:mime-version         :in-reply-to:content-language:message-id:x-original-sender         :x-original-authentication-results:precedence:mailing-list:list-id         :list-post:list-help:list-archive;        bh=S8c1Cd5/cDgATHDy6TqHYYiwlcufVgvjn9ikyKWgUFU=;        b=e9MncOdenJSVAZTzQvp9C+LJmnoV/o+O/cdewQY2VcUXp4e/EaOJadJpHO2RsnbD7y         QhwIPd/aIrzaUgLguXakKmcIshYyPxJWm3QzAX/JIhIJAgL/1VWIijpEanQQ238ngyLX         12ANokY13f+1N97fuxk0+EdzjKPjhP3pRCShAc+ZDANeN6bthEDCWeAmmK9UqFekHGV8         Ao0m2OSrgpf7ZS7GAGhKTs95qGnpI/zXHDSlO8o06DhKiJ60sYot1KZhbMmk5rA/7TUy         KzxasOuaorF8fMy5vMxyoRIVDs9gC4Hdamvvohf83ph5TknxSGEUr8JbyC9PjzEolyMT         kaQQ==</li>
<li>In-reply-to: &lt;<a href="msg00967.html">CAEwQpaJ522S8Dkb28Ci+2xUcPWpyachqd3s78YNcpksgfoqypw@mail.gmail.com</a>&gt;</li>
<li>List-archive: &lt;<a href="https://groups.google.com/a/noaa.gov/group/ferret_users/">https://groups.google.com/a/noaa.gov/group/ferret_users/</a>&gt;</li>
<li>List-help: &lt;<a href="https://support.google.com/a/noaa.gov/bin/topic.py?topic=25838">https://support.google.com/a/noaa.gov/bin/topic.py?topic=25838</a>&gt;, &lt;<a href="mailto:ferret_users+help@noaa.gov">mailto:ferret_users+help@noaa.gov</a>&gt;</li>
<li>List-id: &lt;ferret_users.noaa.gov&gt;</li>
<li>List-post: &lt;<a href="https://groups.google.com/a/noaa.gov/group/ferret_users/post">https://groups.google.com/a/noaa.gov/group/ferret_users/post</a>&gt;, &lt;<a href="mailto:ferret_users@noaa.gov">mailto:ferret_users@noaa.gov</a>&gt;</li>
<li>Mailing-list: list <a href="mailto:ferret_users@DOMAIN.HIDDEN">ferret_users@xxxxxxxx</a>; contact <a href="mailto:ferret_users%2Bowners@DOMAIN.HIDDEN">ferret_users+owners@xxxxxxxx</a></li>
<li>References: &lt;<a href="msg00967.html">CAEwQpaJ522S8Dkb28Ci+2xUcPWpyachqd3s78YNcpksgfoqypw@mail.gmail.com</a>&gt;</li>
<li>Sender: <a href="mailto:owner-ferret_users@DOMAIN.HIDDEN">owner-ferret_users@xxxxxxxx</a></li>
<li>User-agent: Mozilla/5.0 (Windows NT 10.0; Win64; x64; rv:78.0) Gecko/20100101 Thunderbird/78.11.0</li>
</ul>
<!--X-Head-of-Message-End-->
<!--X-Head-Body-Sep-Begin-->
<hr>
<!--X-Head-Body-Sep-End-->
<!--X-Body-of-Message-->

  
  
    <p>Hi Ryo,<br>
    </p>
    <p>I don't think this is a variable-size error on writing to the
      file; that limitation has long-since been handled with updates to
      the netCDF libraries.&#xA0; Maybe this has something to with the grids
      of the variables as defined by pyferret as it initializes the
      file. When you open your files and check SHOW GRID var1 etc, does
      the grid have the dimension of length 36 in the m direction?&#xA0; <br>
      <br>
      If the grid does have the shape you expect, then I think that the
      repeat loop should not have the/mlimits inside it.&#xA0; Assuming var1
      and var2 have an m axis of length 36, I would do this:<br>
      <br>
      <font face="monospace">&#xA0; save/clobber/mlimits=36/m=1 var1[d=1],
        var2[d=1]</font><font face="monospace"><br>
        &#xA0; repeat/m=2:36 (save/append var1[d=1], var2[d=2])</font></p>
    <div>which SHOULD automatically write first the data at m=2, then
      m=3 etc.&#xA0; Or try, <br>
    </div>
    <div><br>
      <font face="monospace">&#xA0; save/clobber/mlimits=36/m=1 var1[d=1],
        var2[d=1]</font><font face="monospace"><br>
      </font></div>
    <div><font face="monospace">&#xA0; repeat/m=2:36 (save/append
        var1[d=1,m=`_m`], var2[d=2,m=`_m`])</font></div>
    <div><font face="monospace"><br>
      </font></div>
    <div><font face="monospace"><br>
      </font></div>
    <div>The syntax here is <font size="+1"><b>_m</b> </font>when we
      are evaluating the pseudo-variable, index on an axis in the e
      direction.&#xA0; The command qualifier <font size="+1"><b>/m=</b></font>&#xA0;
      uses just m, as does the <font size="+1"><b>m=</b></font> in <font
        size="+1"><b>var2[d=2,m= ]</b></font>.&#xA0; Those uses are not the
      values of pseudo-variables.</div>
    <div><br>
    </div>
    <div><br>
    </div>
    <div>-Ansley<br>
    </div>
    <div><br>
    </div>
    8/2021 3:22 AM, Ryo Furue wrote:<br>
    <blockquote type="cite"
cite="">
      
      <div dir="ltr">Dear Ferreters,
        <div><br>
        </div>
        <div>I found a discussion in the mailing list (from 2001), which
          seems to be saying that the maximum size of a single variable
          which doesn't include a record dimension is 2 GiB.</div>
        <div><br>
        </div>
        <div>Then I'm puzzled.&#xA0; My variables all have I, J, K, and M
          dimensions with I=1:500, J=1:400, K=1:67, and M=1:36.&#xA0; All
          double precision.&#xA0; So each variable is 3.6 GiB.</div>
        <div><br>
        </div>
        <div>I managed to create netCDF files that each include a single
          variable via</div>
        <div><br>
        </div>
        <div><font face="monospace">repeat/k=1:67
            (save/append/klimits=1:67/k=`k` myvar)</font></div>
        <div><br>
        </div>
        <div>The k-size of myvar is 1.</div>
        <div><br>
        </div>
        <div><font face="monospace">ncdump -h</font> says</div>
        <div><br>
        </div>
        <div><font face="monospace">dimensions:<br>
            XU = 500 ;<br>
            YV = 400 ;<br>
            ZT = 67 ;<br>
            bnds = 2 ;<br>
            FREQ_AX = 36 ;</font><br>
        </div>
        <div><font face="monospace"><br>
          </font></div>
        <div><font face="arial, sans-serif">(freq_ax is the name of my
            ensemble dimension.)&#xA0; As you can see, there is no record
            dimension.&#xA0; If the last dimension were a record dimension,
            the listing would say</font></div>
        <div><font face="arial, sans-serif"><br>
          </font></div>
        <div><font face="monospace">FREQ_AX = UNLIMITED ; // (36
            currently)</font><font face="arial, sans-serif"><br>
          </font></div>
        <div><br>
        </div>
        <div>So, somehow I managed to create such datasets as this.</div>
        <div><br>
        </div>
        <div>But then, I wanted to put two such variables into one file:</div>
        <div><br>
        </div>
        <div><font face="monospace">set data <a rel="nofollow" href="http://myvar1.nc"
              moz-do-not-send="true">myvar1.nc</a></font></div>
        <div><font face="monospace">set data <a rel="nofollow" href="http://myvar2.nc"
              moz-do-not-send="true">myvar2.nc</a></font></div>
        <div><font face="monospace">SPAWN rm <a rel="nofollow" href="http://result.nc"
              moz-do-not-send="true">result.nc</a></font></div>
        <div><font face="monospace">repeat/m=1:36
            (save/append/mlimits=1:36 var1[d=1], var2[d=2])</font></div>
        <div><br>
        </div>
        <div>This program fails with</div>
        <div><br>
        </div>
        <div><font face="monospace">NetCDF: One or more variable sizes
            violate format constraints (OPeNDAP/netCDF Error code -62)</font><br>
        </div>
        <div><font face="monospace"><br>
          </font></div>
        <div><font face="arial, sans-serif">When I limit the size by </font><font
            face="monospace">var1[d=1,k=1:37], var2[d=2,k=1:37]</font><font
            face="arial, sans-serif">, the above program works.&#xA0; If you
            calculate the size, then you'll find that k=1:37 just puts
            each of var1 and var2 just below 2 GiB.</font></div>
        <div><font face="arial, sans-serif"><br>
          </font></div>
        <div><font face="arial, sans-serif">So, I guess, in the REPEAT
            loop above, the fact </font><font face="monospace"
            color="#ff0000">m</font><font face="arial, sans-serif">
            takes a single value is somehow missed.</font></div>
        <div><font face="arial, sans-serif"><br>
          </font></div>
        <div><font face="arial, sans-serif">Also, I wasn't able to add </font><font
            face="monospace" color="#ff0000">m=`m`</font><font
            face="arial, sans-serif"> to the SAVE statement because that
            results in "</font>**ERROR: variable unknown or not in data
          set: M".&#xA0; I also tried to use <font face="monospace"
            color="#ff0000">_m</font> , but <font face="monospace">repeat/_m=1:36</font>
          results in a syntax error.</div>
        <div><br>
        </div>
        <div>So, I'm stuck.</div>
        <div><br>
        </div>
        <div>Ryo</div>
        <div><br>
        </div>
      </div>
    </blockquote>
  


<!--X-Body-of-Message-End-->
<!--X-MsgBody-End-->
<!--X-Follow-Ups-->
<hr>
<ul><li><strong>Follow-Ups</strong>:
<ul>
<li><strong><a name="00972" href="msg00972.html">Re: [ferret_users] maximum size of variable (again)</a></strong>
<ul><li><em>From:</em> Ryo Furue</li></ul></li>
</ul></li></ul>
<!--X-Follow-Ups-End-->
<!--X-References-->
<ul><li><strong>References</strong>:
<ul>
<li><strong><a name="00967" href="msg00967.html">[ferret_users] maximum size of variable (again)</a></strong>
<ul><li><em>From:</em> Ryo Furue</li></ul></li>
</ul></li></ul>
<!--X-References-End-->
<!--X-BotPNI-->
<UL>
<li>Previous by thread:
<strong><a href="msg00967.html">[ferret_users] maximum size of variable (again)</a></strong>
</li>
<li>Next by thread:
<strong><a href="msg00972.html">Re: [ferret_users] maximum size of variable (again)</a></strong>
</li>

</UL>
<center>[<a href="msg00967.html">Thread Prev</a>][<a href="msg00972.html">Thread Next</a>][<A HREF="threads.html#00968">Index</A>]</center>

<!--X-BotPNI-End-->
<!--X-User-Footer-->
<A HREF="http://ferret.pmel.noaa.gov/Ferret/contact-us">Contact Us</A>
<br>
<font size=-1>
<address>
<a href="http://www.doc.gov">Dept of Commerce</a> /
<a href="http://www.noaa.gov">NOAA</a> /
<a href="http://www.oar.noaa.gov">OAR</a> /
<a href="http://www.pmel.noaa.gov">PMEL</a> /
<a href="http://ferret.pmel.noaa.gov">Ferret</a>
</address>

<br>
 <a href="http://www.noaa.gov/privacy.html">Privacy Policy</a> | <a href="http://www.noaa.gov/disclaimer.html">Disclaimer</a> | <a href="accessibility.html">Accessibility Statement</a> 

</font>
<!--X-User-Footer-End-->
</body>
</html>
