<!-- MHonArc v2.6.16 -->
<!--X-Subject: Re: [ferret_users] Re: Analysis on Irregular Regions -->
<!--X-From-R13: Oafyrl [naxr <nafyrl.o.znaxrNabnn.tbi> -->
<!--X-Date: Thu, 3 Jan 2008 10:52:08 &#45;0800 -->
<!--X-Message-Id: 477D2ED8.9060106@noaa.gov -->
<!--X-Content-Type: multipart/alternative -->
<!--X-Reference: d7fac9de0712200441r107a9f2ar41019c85f422213f@mail.gmail.com -->
<!--X-Reference: 477BD386.9090909@noaa.gov -->
<!--X-Reference: 477C05C3.6030900@noaa.gov -->
<!--X-Reference: d7fac9de0801030846l2b5a735fveacd4c39a0d974a3@mail.gmail.com -->
<!--X-Derived: gifKQJ6gDKlVn.gif -->
<!--X-Head-End-->
<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN"
        "http://www.w3.org/TR/html4/loose.dtd">
<html>
<head>
<title>Re: [ferret_users] Re: Analysis on Irregular Regions</title>
</head>
<body>
<!--X-Body-Begin-->
<!--X-User-Header-->
<!--X-User-Header-End-->
<!--X-TopPNI-->
<HR>
<center>[<a href="msg00011.html">Thread Prev</a>][<a href="msg00007.html">Thread Next</a>][<A HREF="threads.html#00014">Index</A>]</center>

<!--X-TopPNI-End-->
<!--X-MsgBody-->
<!--X-Subject-Header-Begin-->
<h1>Re: [ferret_users] Re: Analysis on Irregular Regions</h1>
<hr>
<!--X-Subject-Header-End-->
<!--X-Head-of-Message-->
<ul>
<li><strong>To</strong>: <strong>IMRAN NADEEM &lt;<a href="mailto:qphoton@DOMAIN.HIDDEN">qphoton@xxxxxxxxx</a>&gt;</strong></li>
<li><strong>Subject</strong>: <strong>Re: [ferret_users] Re: Analysis on Irregular Regions</strong></li>
<li><strong>From</strong>: <strong>Ansley Manke &lt;<a href="mailto:ansley.b.manke@DOMAIN.HIDDEN">ansley.b.manke@xxxxxxxx</a>&gt;</strong></li>
<li>Date: Thu, 03 Jan 2008 10:52:08 -0800</li>
<li>Cc: <a href="mailto:oar.pmel.ferret_users@DOMAIN.HIDDEN">oar.pmel.ferret_users@xxxxxxxx</a></li>
<li>In-reply-to: &lt;<a href="mailto:d7fac9de0801030846l2b5a735fveacd4c39a0d974a3@DOMAIN.HIDDEN">d7fac9de0801030846l2b5a735fveacd4c39a0d974a3@xxxxxxxxxxxxxx</a>&gt;</li>
<li>References: &lt;<a href="mailto:d7fac9de0712200441r107a9f2ar41019c85f422213f@DOMAIN.HIDDEN">d7fac9de0712200441r107a9f2ar41019c85f422213f@xxxxxxxxxxxxxx</a>&gt; &lt;<a href="mailto:477BD386.9090909@DOMAIN.HIDDEN">477BD386.9090909@xxxxxxxx</a>&gt; &lt;<a href="mailto:477C05C3.6030900@DOMAIN.HIDDEN">477C05C3.6030900@xxxxxxxx</a>&gt; &lt;<a href="mailto:d7fac9de0801030846l2b5a735fveacd4c39a0d974a3@DOMAIN.HIDDEN">d7fac9de0801030846l2b5a735fveacd4c39a0d974a3@xxxxxxxxxxxxxx</a>&gt;</li>
<li>Sender: <a href="mailto:owner-ferret_users@DOMAIN.HIDDEN">owner-ferret_users@xxxxxxxx</a></li>
<li>User-agent: Thunderbird 2.0.0.9 (Windows/20071031)</li>
</ul>
<!--X-Head-of-Message-End-->
<!--X-Head-Body-Sep-Begin-->
<hr>
<!--X-Head-Body-Sep-End-->
<!--X-Body-of-Message-->
<table width="100%"><tr><td bgcolor="#ffffff" style="background-color: #ffffff; color: #000000; "><font color="#000000">



Hi -<br>
We're working on a new function for Ferret which will compute a flag,
based for whether points are within a polygon defined by a set of
vertices. This has come up before, and there are good algorithms for
solving it, for instance a search in Wikipedia or Google code-search
for "Point in Polygon" turns up a number of good discussions.<br>
<br>
Ansley<br>
<br>
IMRAN NADEEM wrote:
<blockquote
 cite=""
 type="cite">Hi Ansley, Jaison and Mick,<br>
  <br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; I really appreciate your help on my problem. I did
some analysis on a catchment (irregular region) shown in the attached
figure. I used the method as suggested by<br>
&nbsp;Ansley and Jaison. I prepared mask of the region by "visual editing"
but this method requires lot of if-statements. For single region
"visual editing" is not a bad option but <br>
for mulitple regions the method described by Mick is better and it also
requires less work.<br>
  <br>
Once again thanks for your help<br>
Imran<br>
  <br>
  <br>
  <br>
  <br>
  <br>
  <br>
  <br>
  <br>
  <br>
  <br>
  <div class="gmail_quote">On Jan 2, 2008 10:44 PM, mick spillane &lt;
  <a rel="nofollow" moz-do-not-send="true" href="mailto:Mick.Spillane@xxxxxxxx">Mick.Spillane@xxxxxxxx</a>&gt;
wrote:<br>
  <blockquote class="gmail_quote"
 style="border-left: 1px solid rgb(204, 204, 204); margin: 0pt 0pt 0pt 0.8ex; padding-left: 1ex;">Hi
Imran,<br>
&nbsp; &nbsp;It looks like the colored region in your image is a 40x15 regular<br>
grid. &nbsp;If the data you want to analyze are on the same grid then you<br>
have a problem similar to one I looked at some time ago.<br>
    <br>
Step 1: Using vi or some other editor make a text file matching your
    <br>
domain, and with 0,1,2,3,4,5 representing missing, &nbsp;blue, orange,<br>
yellow, red, green. &nbsp;I get something like this, but you ought to check
it:<br>
3333333333334444444444444444455555555555<br>
3333333333344444444444444444455555555555
    <br>
3333333333344444444444444444445555555555<br>
3333333333344444444444444444444555555555<br>
3333333333333444444444444111111555522222<br>
3333333333333333444444111111111511122222<br>
3333333333333311111111111111111111122222<br>
3333333333331111111111111111111111222222<br>
3333333331111111111111111111111112222222<br>
3333333111111111111111111111111122222222<br>
0333311111111111111111111111122222222222<br>
0033111111111111111111111111122222222222<br>
0011111111111111111111110001122222222222
    <br>
0111111111111111111111100000002222222222<br>
0111111111100000011110000000000222222222<br>
    <br>
Step 2: Ferret likes to read data from south to north, so you need to<br>
reverse the order of this file "nadeem.step1"
    <br>
On my Mac I can do this with<br>
tail -r nadeem.step1 &gt; nadeem.mask<br>
and the file nadeem.mask then looks like<br>
0111111111100000011110000000000222222222<br>
0111111111111111111111100000002222222222<br>
0011111111111111111111110001122222222222
    <br>
0033111111111111111111111111122222222222<br>
0333311111111111111111111111122222222222<br>
3333333111111111111111111111111122222222<br>
3333333331111111111111111111111112222222<br>
3333333333331111111111111111111111222222<br>
3333333333333311111111111111111111122222<br>
3333333333333333444444111111111511122222<br>
3333333333333444444444444111111555522222<br>
3333333333344444444444444444444555555555<br>
3333333333344444444444444444445555555555<br>
3333333333344444444444444444455555555555
    <br>
3333333333334444444444444444455555555555<br>
    <br>
Step 3: &nbsp;Read this mask file into Ferret<br>
def axis/x=1:40:1 xin ; def axis/y=1:15:1 yin ; def grid/x=xin/y=yin gin<br>
file/form=(40f1.0)/col=40/var=mask/g=gin nadeem.mask
    <br>
    <br>
Step 4:<br>
If your data are on a 40x15 grid "grd" but with actual lon,lat axis<br>
values you need to "regrid with assignment" the mask read in above to<br>
match the data grid:<br>
let msk=mask[g=grd,gx=@asn,gy=@asn]
    <br>
This "assigns" the mask we created on-to-one to the data grid. &nbsp;If the<br>
data grid is bigger than the colored region, you should add a margin of<br>
"0" values around the ASCII file and adjust the values (40 and 15)
    <br>
appropriately. &nbsp;The zero value will be used as missing value.<br>
shade msk ; frame/file=nadeem1.gif<br>
    <br>
Step 5: &nbsp;Evaluating statistics in the colored regions. &nbsp;If you have a<br>
variable v and need its average over the blue region for example then
    <br>
you might define:<br>
let pick=if(msk eq 1)then v<br>
list pick[x=@ave,y=@ave]<br>
and likewise for the other regions 2,3,4,5 in turn.<br>
Since I don't have your data, and don't know exactly what your data grid<br>
is, here is a demo with a fake variable v<br>
let v=sin(x[g=gin]/5)*cos(y[g=gin]/3)<br>
shade v ; frame/file=nadeem2.gif<br>
Then<br>
repeat/k=1:5 (let pick=if(mask eq `k`)then v ; list/nohead/form=(f10.4)<br>
pick[x=@ave,y=@ave] ; message )
    <br>
gives the following averages in regions 1-5: &nbsp; &nbsp; 0.1776 &nbsp; -0.1108<br>
-0.3975 &nbsp; &nbsp;0.1717 &nbsp; -0.1398<br>
    <br>
Attached find images of the mask, the demo variable, and the variable<br>
masked for region "A" in your image.
    <br>
    <br>
Hope this helps but, in any case, happy ferreting in 2008.<br>
    <font color="#888888">Mick Spillane<br>
    </font>
    <div>
    <div class="Wj3C7c"><br>
    <br>
    <br>
    <br>
    <br>
    <br>
Ansley Manke wrote:<br>
&gt; Hi Imran,<br>
&gt; If you can come up with a way to define your region with a
variable
    <br>
&gt; that's 1 inside the region and 0 outside the region, then you can
use<br>
&gt; a MASK to do analysis on data in that region. Here is an FAQ with
some<br>
&gt; examples of this.<br>
&gt;<br>
&gt;<br>
&gt; <a rel="nofollow" moz-do-not-send="true"
 href="http://ferret.pmel.noaa.gov/FERRET_17sep07/FAQ/analysis/avg_integ_irreg.html"
 target="_blank">
http://ferret.pmel.noaa.gov/FERRET_17sep07/FAQ/analysis/avg_integ_irreg.html</a><br>
&gt;<br>
&gt; Ansley<br>
&gt;<br>
&gt; IMRAN NADEEM wrote:<br>
&gt;&gt; Hi all,<br>
&gt;&gt;<br>
&gt;&gt; &nbsp; &nbsp; &nbsp;I want to do some analysis on irregular regions shown in
the
    <br>
&gt;&gt; figure. Can anybody help me to make mask for such irregular
regions.<br>
&gt;&gt;<br>
&gt;&gt; Regards<br>
&gt;&gt; Imran<br>
&gt;&gt;<br>
&gt;&gt;<br>
&gt;&gt;<br>
&gt;&gt;<br>
&gt;&gt;<br>
    </div>
    </div>
&gt;&gt;
------------------------------------------------------------------------
    <br>
&gt;&gt;<br>
    <br>
  </blockquote>
  </div>
  <br>
  <br>
  <hr size="4" width="90%"><br>
  <center><img src="gifKQJ6gDKlVn.gif"></center>
</blockquote>


</font></td></tr></table>
<!--X-Body-of-Message-End-->
<!--X-MsgBody-End-->
<!--X-Follow-Ups-->
<hr>
<!--X-Follow-Ups-End-->
<!--X-References-->
<ul><li><strong>References</strong>:
<ul>
<li><strong><a name="00003" href="msg00003.html">Re: [ferret_users] Analysis on Irregular Regions</a></strong>
<ul><li><em>From:</em> Ansley Manke</li></ul></li>
<li><strong><a name="00011" href="msg00011.html">[ferret_users] Re: Analysis on Irregular Regions</a></strong>
<ul><li><em>From:</em> IMRAN NADEEM</li></ul></li>
</ul></li></ul>
<!--X-References-End-->
<!--X-BotPNI-->
<UL>
<li>Previous by thread:
<strong><a href="msg00011.html">[ferret_users] Re: Analysis on Irregular Regions</a></strong>
</li>
<li>Next by thread:
<strong><a href="msg00007.html">[ferret_users] Vertical axis correction</a></strong>
</li>

</UL>
<center>[<a href="msg00011.html">Thread Prev</a>][<a href="msg00007.html">Thread Next</a>][<A HREF="threads.html#00014">Index</A>]</center>

<!--X-BotPNI-End-->
<!--X-User-Footer-->
<hr>
<A HREF="ferret_contact_us.html">Contact Us</A>
<br>
<font size=-1>
<address>
<a href="http://www.doc.gov">Dept of Commerce</a> / 
<a href="http://www.noaa.gov">NOAA</a> /
<a href="http://www.oar.noaa.gov">OAR</a> /
<a href="http://www.pmel.noaa.gov">PMEL</a> /
<a href="http://tmap.pmel.noaa.gov">TMAP</a>
</address>
<br>
 <a href="http://www.noaa.gov/privacy.html">Privacy Policy</a> | <a href="http://www.noaa.gov/disclaimer.html">Disclaimer</a> | <a href="accessibility.html">Accessibility Statement</a> 
</font>
<!--X-User-Footer-End-->
</body>
</html>
