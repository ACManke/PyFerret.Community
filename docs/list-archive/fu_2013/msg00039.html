<!-- MHonArc v2.6.18 -->
<!--X-Subject: RE: [ferret_users] How to modify time axis -->
<!--X-From-R13: Egne Bulfvpvfg <pbhentrgbxabjtpNubgznvy.pbz> -->
<!--X-Date: Sat, 12 Jan 2013 03:55:10 &#45;0800 -->
<!--X-Message-Id: BAY170&#45;W720E518BA777E0FDBB57C1A5280@phx.gbl -->
<!--X-Content-Type: multipart/alternative -->
<!--X-Reference: BAY170&#45;W1287B1C76C6344CA27C5B3DA52B0@phx.gbl -->
<!--X-Reference: 50EE0D4A.40805@noaa.gov -->
<!--X-Reference: BAY170&#45;W31117335E433703E7E9B06A5290@phx.gbl -->
<!--X-Reference: 50F07A0C.70408@noaa.gov -->
<!--X-Head-End-->
<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN"
        "http://www.w3.org/TR/html4/loose.dtd">
<html>
<head>
<title>RE: [ferret_users] How to modify time axis</title>
</head>
<body>
<!--X-Body-Begin-->
<!--X-User-Header-->
<!--X-User-Header-End-->
<!--X-TopPNI-->
<HR>
<center>[<a href="msg00035.html">Thread Prev</a>][<a href="msg00033.html">Thread Next</a>][<A HREF="threads.html#00039">Index</A>]</center>

<!--X-TopPNI-End-->
<!--X-MsgBody-->
<!--X-Subject-Header-Begin-->
<h1>RE: [ferret_users] How to modify time axis</h1>
<hr>
<!--X-Subject-Header-End-->
<!--X-Head-of-Message-->
<ul>
<li><strong>To</strong>: <strong>&lt;<a href="mailto:ansley.b.manke@DOMAIN.HIDDEN">ansley.b.manke@xxxxxxxx</a>&gt;, &quot;<a href="mailto:ferret_users@DOMAIN.HIDDEN">ferret_users@xxxxxxxx</a>&quot; &lt;<a href="mailto:ferret_users@DOMAIN.HIDDEN">ferret_users@xxxxxxxx</a>&gt;</strong></li>
<li><strong>Subject</strong>: <strong>RE: [ferret_users] How to modify time axis</strong></li>
<li><strong>From</strong>: <strong>Star Physicist &lt;<a href="mailto:couragetoknowgc@DOMAIN.HIDDEN">couragetoknowgc@xxxxxxxxxxx</a>&gt;</strong></li>
<li>Date: Sat, 12 Jan 2013 11:55:07 +0000</li>
<li>Importance: Normal</li>
<li>In-reply-to: &lt;50F07A0C.70408@noaa.gov&gt;</li>
<li>List-archive: &lt;<a href="http://groups.google.com/a/noaa.gov/group/ferret_users/?hl=en_US">http://groups.google.com/a/noaa.gov/group/ferret_users/?hl=en_US</a>&gt;</li>
<li>List-help: &lt;<a href="http://support.google.com/a/noaa.gov/bin/topic.py?hl=en_US&topic=25838">http://support.google.com/a/noaa.gov/bin/topic.py?hl=en_US&topic=25838</a>&gt;, &lt;<a href="mailto:ferret_users+help@noaa.gov">mailto:ferret_users+help@noaa.gov</a>&gt;</li>
<li>List-id: &lt;ferret_users.noaa.gov&gt;</li>
<li>List-post: &lt;<a href="http://groups.google.com/a/noaa.gov/group/ferret_users/post?hl=en_US">http://groups.google.com/a/noaa.gov/group/ferret_users/post?hl=en_US</a>&gt;, &lt;<a href="mailto:ferret_users@noaa.gov">mailto:ferret_users@noaa.gov</a>&gt;</li>
<li>List-unsubscribe: &lt;<a href="http://groups.google.com/a/noaa.gov/group/ferret_users/subscribe?hl=en_US">http://groups.google.com/a/noaa.gov/group/ferret_users/subscribe?hl=en_US</a>&gt;, &lt;<a href="mailto:googlegroups-manage+809428289204+unsubscribe@googlegroups.com">mailto:googlegroups-manage+809428289204+unsubscribe@googlegroups.com</a>&gt;</li>
<li>Mailing-list: list <a href="mailto:ferret_users@DOMAIN.HIDDEN">ferret_users@xxxxxxxx</a>; contact <a href="mailto:ferret_users%2Bowners@DOMAIN.HIDDEN">ferret_users+owners@xxxxxxxx</a></li>
<li>References: &lt;<a href="msg00029.html">BAY170-W1287B1C76C6344CA27C5B3DA52B0@phx.gbl</a>&gt;,&lt;<a href="msg00030.html">50EE0D4A.40805@noaa.gov</a>&gt;,&lt;BAY170-W31117335E433703E7E9B06A5290@phx.gbl&gt;,&lt;50F07A0C.70408@noaa.gov&gt;</li>
<li>Sender: <a href="mailto:owner-ferret_users@DOMAIN.HIDDEN">owner-ferret_users@xxxxxxxx</a></li>
</ul>
<!--X-Head-of-Message-End-->
<!--X-Head-Body-Sep-Begin-->
<hr>
<!--X-Head-Body-Sep-End-->
<!--X-Body-of-Message-->
<table width="100%"><tr><td style="">

<div dir='ltr'>


<div dir="ltr">Dear Ansley,<br><br>It is perfect and thanks for the solution. I have another question:<br><br>If I have around 10 files, each contains 12 months data for same variables (ocean.19900101.nc, ocean.19910101.nc upto ocean.19990101.nc). These files have noleap calender. I want to handle their entire time period and work with some particular variable and plot its time series. I don't want first to save particular variable in one file and then open this new file to work with (It will take longer time). Actually my intention is to open all the input files and define their entire time period and then change this entire time axes to a newer time axis which you explained in you last email. <br>Regarding merging all files, I could use cdo or nco but I don't want to work this way because the resultant merged file is very big in size (around 70 GB). Actually this question is continuation of last question regarding changing time axes.<br><br>In short I just wanted to open all these files in Ferret and wanted to use their entire time and bring my required variable on new time axis as we you explained it already.<br><br><br><div><div id="SkyDrivePlaceholder"></div><hr id="stopSpelling">Date: Fri, 11 Jan 2013 12:46:04 -0800<br>From: ansley.b.manke@xxxxxxxx<br>To: couragetoknowgc@xxxxxxxxxxx<br>Subject: Re: [ferret_users] How to modify time axis<br><br>
  
    
  
  
    Hi,<br>
    To do what I suggested, you would add the /NOLEAP qualifier to the
    DEFINE AXIS command.<br>
    <br>
    We can get information about this axis using the unix tool
    "ncdump".&nbsp; This command will list the netcdf header and the
    variables time and time_bnds.<br>
    <br>
    /home/users/ansley&gt; ncdump -v time,time_bnds temp.nc<br>
    <br>
    The header shows the attributes of the time axis are <tt>these, so
      you can see the calendar attribute and the units and origin of the
      axis.<br>
      <br>
    </tt><tt>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; double time(time) ;</tt><tt><br>
    </tt><tt>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; time:standard_name = "time" ;</tt><tt><br>
    </tt><tt>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; time:bounds = "time_bnds" ;</tt><tt><br>
    </tt><tt>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; time:units = "days since 1990-01-01
      00:00:00" ;</tt><tt><br>
    </tt><tt>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; time:calendar = "365_day" ;</tt><br>
    <br>
    In the data section of the listing are the time coordinates and the
    time bounds:<br>
    <tt><br>
    </tt><tt>&nbsp;time = 31, 59, 90, 120, 151, 181, 212, 243, 273, 304, 334,
      365, 396, 424, </tt><tt><br>
    </tt><tt>&nbsp;&nbsp;&nbsp; 455, 485, 516, 546, 577, 608, 638, 669, 699, 730 ;</tt><tt><br>
    </tt><tt><br>
    </tt><tt>&nbsp;time_bnds =</tt><tt><br>
    </tt><tt>&nbsp; 0, 31,</tt><tt><br>
    </tt><tt>&nbsp; 31, 59,</tt><tt><br>
    </tt><tt>&nbsp; 59, 90,</tt><tt><br>
    </tt><tt>&nbsp; 90, 120,</tt><tt><br>
    </tt><tt>&nbsp; 120, 151,</tt><tt><br>
    </tt><tt>&nbsp; 151, 181,</tt><tt><br>
    </tt><tt>&nbsp; 181, 212,</tt><tt><br>
    </tt><tt>&nbsp; 212, 243,</tt><tt><br>
    </tt><tt>&nbsp; 243, 273,&nbsp; ...</tt><br>
    <br>
    So, the first coordinate value on the time axis is 31 days since
    1-jan-1990, and that's Feb 1.&nbsp; This is an unusual definition, having
    the time coordinates at the end of each grid cell.&nbsp; More typically,
    the time coordinate would be in the middle of each grid cell.&nbsp; So
    more often a time axis would have something like time = 15.5, 45,
    ...<br>
    <br>
    If you want to change this, you could use the bounds to redefine the
    axis, using the coordinate data from the file. Monthly axes are
    always tricky because the months are not the same length.&nbsp; To put
    the time coordinate in the middle of the grid cell, you could use
    the /edges qualifier on the define command,<br>
    <br>
    yes? use temp.nc<br>
    yes? define axis/edges/t0=1-jan-2000/units=days time =
    tboxlo[gt=temp]<br>
    <br>
    Although this isn't quite everything we need.&nbsp; It doesn't give us
    the upper limit of the last grid cell.&nbsp; So, try this script. Does it
    give you what you want?<br>
    <br>
    yes? use temp<br>
    &nbsp;<br>
    ! variables with the lower and higher limits of each month<br>
    yes? let tlo =&nbsp; tboxlo[gt=temp]<br>
    yes? let thi = tboxhi[gt=temp]<br>
    yes? list tlo,thi<br>
    <br>
    ! variable with just the upper limit of the last grid cell<br>
    yes? let highest = thi[t=@max]<br>
    <br>
    ! variable with the edges of all the months in the data<br>
    yes? let box_edges = tcat(tlo, highest)<br>
    yes? list box_edges<br>
    <br>
    ! Define an axis starting in jan 2000, with these numbers as the
    edges of the month.<br>
    ! the coordinates of the time axis will be in mid-month.<br>
    <br>
    yes? define axis/noleap/edges/t0=1-jan-2000/units=days time =
    box_edges<br>
    <br>
    I can help with more ideas if you want.<br>
    <br>
    <div class="ecxmoz-cite-prefix">On 1/11/2013 1:24 AM, Star Physicist
      wrote:<br>
    </div>
    <blockquote cite="">
      
      <div dir="ltr">
        Dear Ansley,<br>
        <br>
        Thanks very much for such a nice demonstration. There is one one
        issue in my data set. It is CM2.1 model output which uses noleap
        calender. 2ndly I don't know why FERRET displays first time step
        as 01 Feb instead of 01 Jan month. I am attaching a netcdf file
        for monthly potential temperature for two years. Please have a
        look on this file and guide me if I want to shift this time axis
        to some new time axes along with managing these edges of the
        months. <br>
        <br>
        Thanks,<br>
        <br>
        Mubashar<br>
        <br>
        <br>
        <br>
        Date: Wed, 9 Jan 2013 16:37:30 -0800<br>
        <div>From: <a rel="nofollow" class="ecxmoz-txt-link-abbreviated" href="mailto:ansley.b.manke@xxxxxxxx">ansley.b.manke@xxxxxxxx</a><br>
          To: <a rel="nofollow" class="ecxmoz-txt-link-abbreviated" href="mailto:couragetoknowgc@xxxxxxxxxxx">couragetoknowgc@xxxxxxxxxxx</a><br>
          CC: <a rel="nofollow" class="ecxmoz-txt-link-abbreviated" href="mailto:ferret_users@xxxxxxxx">ferret_users@xxxxxxxx</a><br>
          Subject: Re: [ferret_users] How to modify time axis<br>
          <br>
          Hi Mubashar<br>
          You can change the definition of the time axis with a DEFINE
          AXIS command, using the name of the time axis from the file.
          Then the data will be used as if it were on the new time
          axis.&nbsp; What happens is that the data in the file will be
          interpreted using the time information in the new time axis.&nbsp;
          The old definition is lost to Ferret during that session, but
          the input file you are reading is unchanged.&nbsp; So, let's make
          an example:<br>
          <tt><br>
          </tt>
          <blockquote><tt>! define a time axis and set up a variable on
              that axis</tt><tt><br>
              ! Write it to an example file<br>
              <br>
            </tt><tt>yes? define
              axis/t=1-jan-1990:31-dec-1999:1/units=days time</tt><tt><br>
            </tt><tt>yes? let var = sin(t[gt=time]/100)</tt><tt><br>
            </tt><tt>yes? plot var</tt><tt><br>
            </tt><tt>yes? save/clobber/file=timevar.nc var</tt><tt><br>
            </tt><tt><br>
            </tt><tt>yes? cancel variable/all</tt><tt><br>
            </tt><tt>yes? cancel axis time</tt><tt><br>
            </tt><tt><br>
            </tt><tt>! Now open the file, as if we are in a new Ferret
              session.</tt><tt><br>
              <br>
            </tt><tt>yes? use timevar.nc</tt><tt><br>
            </tt><tt>yes? plot var&nbsp; ! it's on the 1990-1999 time axis</tt><tt><br>
            </tt><tt><br>
            </tt><tt>! redefine the time axis.&nbsp; The last bit of syntax
              gets the name <br>
              ! of the time axis for the variable "var".</tt><tt><br>
              <br>
            </tt><tt>yes? define
              axis/t=1-jan-2000:31-dec-2009:1/units=days
              `var,return=taxis`</tt><tt><br>
            </tt><tt>Replacing definition of axis TIME</tt><tt><br>
            </tt><tt>&nbsp;*** NOTE: grid&nbsp; used by data set timevar</tt><tt><br>
            </tt><tt>&nbsp;*** NOTE: Redefinition may alter apparent contents
              of data set</tt><tt><br>
            </tt><tt><br>
            </tt><tt> </tt><tt>yes? plot var&nbsp; ! it's on the 2000-20</tt><tt>09</tt><tt>
              time axis</tt><tt><br>
            </tt><tt><br>
            </tt><tt>yes?
              save/clobber/file=timevar2000.nc/t=1-jan-2008:31-dec-20</tt><tt>09

              var</tt><br>
          </blockquote>
          Try some more experiments. What if you redefine the axis like
          this (an axis with a lot more coordinate points)?&nbsp; The data
          will be read onto the first part of the axis<br>
          <blockquote><tt>yes? cancel data/all </tt><br>
            <tt>yes? use timevar.nc</tt><br>
            <tt>yes? define
              axis/t=1-jan-2000:31-jan-2001:1/units=minutes
              `var,return=taxis`</tt><br>
            <tt>yes? plot var</tt><br>
          </blockquote>
          <tt>How about this one:</tt><tt><br>
          </tt>
          <blockquote><tt>yes? cancel data/all </tt><br>
            <tt>yes? use timevar.nc</tt><br>
            <tt>yes? define axis/t=1-jan-2000:1-jan-2002:1/units=days
              `var,return=taxis`</tt><br>
            <tt>yes? plot var</tt></blockquote>
          <div class="ecxmoz-cite-prefix">On 1/9/2013 2:37 PM, Star
            Physicist wrote:<br>
          </div>
          <blockquote cite="">
            
            <div dir="ltr"> Dear Ferret users,<br>
              <br>
              I am new to FERRET and wanted to modify time axis in my
              netcdf file. I have a netcdf file (with many variables)
              containing monthly data from jan1990 to dec1999. Can I
              create a netcdf file using FERRET (having all variables)
              after modifying the time axis to jan2000 till dec2009
              instead of jan1990 to dec1999. <br>
              <br>
              Thanks,<br>
              <br>
              Mubashar<br>
            </div>
          </blockquote>
          <br>
        </div>
      </div>
    </blockquote>
    <br></div></div> 		 	   		  </div>
</td></tr></table>
<!--X-Body-of-Message-End-->
<!--X-MsgBody-End-->
<!--X-Follow-Ups-->
<hr>
<!--X-Follow-Ups-End-->
<!--X-References-->
<ul><li><strong>References</strong>:
<ul>
<li><strong><a name="00029" href="msg00029.html">[ferret_users] How to modify time axis</a></strong>
<ul><li><em>From:</em> Star Physicist</li></ul></li>
<li><strong><a name="00030" href="msg00030.html">Re: [ferret_users] How to modify time axis</a></strong>
<ul><li><em>From:</em> Ansley Manke</li></ul></li>
</ul></li></ul>
<!--X-References-End-->
<!--X-BotPNI-->
<UL>
<li>Previous by thread:
<strong><a href="msg00035.html">Re: [ferret_users] strange arrows for wind direction</a></strong>
</li>
<li>Next by thread:
<strong><a href="msg00033.html">[ferret_users] SIGDIG hysteresis!</a></strong>
</li>

</UL>
<center>[<a href="msg00035.html">Thread Prev</a>][<a href="msg00033.html">Thread Next</a>][<A HREF="threads.html#00039">Index</A>]</center>

<!--X-BotPNI-End-->
<!--X-User-Footer-->
<A HREF="http://ferret.pmel.noaa.gov/Ferret/contact-us">Contact Us</A>
<br>
<font size=-1>
<address>
<a href="http://www.doc.gov">Dept of Commerce</a> /
<a href="http://www.noaa.gov">NOAA</a> /
<a href="http://www.oar.noaa.gov">OAR</a> /
<a href="http://www.pmel.noaa.gov">PMEL</a> /
<a href="http://ferret.pmel.noaa.gov">Ferret</a>
</address>

<br>
 <a href="http://www.noaa.gov/privacy.html">Privacy Policy</a> | <a href="http://www.noaa.gov/disclaimer.html">Disclaimer</a> | <a href="accessibility.html">Accessibility Statement</a> 

</font>
<!--X-User-Footer-End-->
</body>
</html>
