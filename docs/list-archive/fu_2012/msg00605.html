<!-- MHonArc v2.6.18 -->
<!--X-Subject: [ferret_users] Re: Pls help... -->
<!--X-From-R13: Oafyrl [naxr <nafyrl.o.znaxrNabnn.tbi> -->
<!--X-Date: Thu, 15 Nov 2012 10:26:20 &#45;0800 -->
<!--X-Message-Id: 50A533C8.4010001@noaa.gov -->
<!--X-Content-Type: multipart/alternative -->
<!--X-Reference: CAH1tzCTA5c5xGPQq3L9O&#45;ZdAJYqkw28WkoAfgGsP6RPTAVWseQ@mail.gmail.com -->
<!--X-Head-End-->
<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN"
        "http://www.w3.org/TR/html4/loose.dtd">
<html>
<head>
<title>[ferret_users] Re: Pls help...</title>
</head>
<body>
<!--X-Body-Begin-->
<!--X-User-Header-->
<!--X-User-Header-End-->
<!--X-TopPNI-->
<HR>
<center>[<a href="msg00604.html">Thread Prev</a>][<a href="msg00606.html">Thread Next</a>][<A HREF="threads.html#00605">Index</A>]</center>

<!--X-TopPNI-End-->
<!--X-MsgBody-->
<!--X-Subject-Header-Begin-->
<h1>[ferret_users] Re: Pls help...</h1>
<hr>
<!--X-Subject-Header-End-->
<!--X-Head-of-Message-->
<ul>
<li><strong>To</strong>: <strong>Akshay Hegde &lt;<a href="mailto:akshay.k.hegde@DOMAIN.HIDDEN">akshay.k.hegde@xxxxxxxxx</a>&gt;</strong></li>
<li><strong>Subject</strong>: <strong>[ferret_users] Re: Pls help...</strong></li>
<li><strong>From</strong>: <strong>Ansley Manke &lt;<a href="mailto:ansley.b.manke@DOMAIN.HIDDEN">ansley.b.manke@xxxxxxxx</a>&gt;</strong></li>
<li>Date: Thu, 15 Nov 2012 10:26:16 -0800</li>
<li>Cc: <a href="mailto:ferret_users@DOMAIN.HIDDEN">ferret_users@xxxxxxxx</a></li>
<li>In-reply-to: &lt;<a href="msg00604.html">CAH1tzCTA5c5xGPQq3L9O-ZdAJYqkw28WkoAfgGsP6RPTAVWseQ@mail.gmail.com</a>&gt;</li>
<li>List-archive: &lt;<a href="http://groups.google.com/a/noaa.gov/group/ferret_users/?hl=en_US">http://groups.google.com/a/noaa.gov/group/ferret_users/?hl=en_US</a>&gt;</li>
<li>List-help: &lt;<a href="http://support.google.com/a/noaa.gov/bin/topic.py?hl=en_US&topic=25838">http://support.google.com/a/noaa.gov/bin/topic.py?hl=en_US&topic=25838</a>&gt;, &lt;<a href="mailto:ferret_users+help@noaa.gov">mailto:ferret_users+help@noaa.gov</a>&gt;</li>
<li>List-id: &lt;ferret_users.noaa.gov&gt;</li>
<li>List-post: &lt;<a href="http://groups.google.com/a/noaa.gov/group/ferret_users/post?hl=en_US">http://groups.google.com/a/noaa.gov/group/ferret_users/post?hl=en_US</a>&gt;, &lt;<a href="mailto:ferret_users@noaa.gov">mailto:ferret_users@noaa.gov</a>&gt;</li>
<li>List-unsubscribe: &lt;<a href="http://groups.google.com/a/noaa.gov/group/ferret_users/subscribe?hl=en_US">http://groups.google.com/a/noaa.gov/group/ferret_users/subscribe?hl=en_US</a>&gt;, &lt;<a href="mailto:googlegroups-manage+809428289204+unsubscribe@googlegroups.com">mailto:googlegroups-manage+809428289204+unsubscribe@googlegroups.com</a>&gt;</li>
<li>Mailing-list: list <a href="mailto:ferret_users@DOMAIN.HIDDEN">ferret_users@xxxxxxxx</a>; contact <a href="mailto:ferret_users%2Bowners@DOMAIN.HIDDEN">ferret_users+owners@xxxxxxxx</a></li>
<li>References: &lt;<a href="msg00604.html">CAH1tzCTA5c5xGPQq3L9O-ZdAJYqkw28WkoAfgGsP6RPTAVWseQ@mail.gmail.com</a>&gt;</li>
<li>Sender: <a href="mailto:owner-ferret_users@DOMAIN.HIDDEN">owner-ferret_users@xxxxxxxx</a></li>
<li>User-agent: Mozilla/5.0 (Windows NT 6.1; WOW64; rv:16.0) Gecko/20121026 Thunderbird/16.0.2</li>
</ul>
<!--X-Head-of-Message-End-->
<!--X-Head-Body-Sep-Begin-->
<hr>
<!--X-Head-Body-Sep-End-->
<!--X-Body-of-Message-->
<table width="100%"><tr><td bgcolor="#FFFFFF" style="background-color: #FFFFFF; color: #000000; "><font color="#000000">
  
  
    Hi,<br>
    Here are some general suggestions for asking questions on this list,
    and for debugging Ferret scripts. Then I do have a couple of
    suggestions for your script. It's often quite complex to read ascii
    data. This is a really useful technique that I don't think we've
    really developed before.&nbsp; We'll gather this into an FAQ to add to
    the documentation.<br>
    <br>
    <br>
    &nbsp;- First, when asking a question, make the subject line something
    that relates to the question. For instance, "reading station data
    from an ascii file" is more likely to get answers than "ferret
    question" or "please help". <br>
    &nbsp;<br>
    &nbsp;- If you see error messages, tell us what those messages say.&nbsp; In
    general people don't want to start by downloading your data and your
    script and run it, but they will look at an error message and tell
    you what it's about.&nbsp; It's not a bad idea to include your data and
    script, but your description of what's happening and why the results
    don't seem right, is where the list members start when answering
    questions.<br>
    <br>
    - We're already doing some of this but when working on a script, at
    various stages along the way, use Ferret to check what the variables
    look like. I think you've done the first steps correctly, but any
    time I read a new data source, particularly ascii data, I plot some
    of it to make sure the read I've got the right fields:<br>
    <blockquote>
      yes? plot/vs lon, lat&nbsp; ! shows the locations of the&nbsp; stations<br>
      yes? plot depth&nbsp; ! shows all the depth profiles<br>
      yes? plot salt&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; ! check that they look like salinity values<br>
    </blockquote>
    Or use the STAT command to see what the range of data for variables
    looks like.<br>
    <br>
    After defining sal_xz, you could visualize it:<br>
    <blockquote>
      yes? shade sal_xz<br>
    </blockquote>
    Using Ferret to list or plot your variables will often suggest to
    you the changes you need.<br>
    <br>
    As you said, and as you see from the SHADE command above, the
    max_profile_len is larger than it needed to be.&nbsp; Now that the
    profiles have been split up, Ferret can tell you what the longest
    profile was.&nbsp; The @NGD transformation tells you how many valid data
    there are for a variable on an axis. Try this:<br>
    <blockquote>
      yes? list sal_xz[k=@ngd]<br>
    </blockquote>
    That's the number of valid data in each profile. So,&nbsp; in the script,
    define sal_xz and so forth as you're doing, then redefine
    max_profile_len.<br>
    <blockquote><tt>let max_profile_len = 9999</tt><br>
      <tt>
        let sal_xz = expndi_by_z(salt, mask, n_profiles,
        max_profile_len)</tt><br>
      <br>
      <tt>let proflen = sal_xz[k=@ngd]</tt><br>
      <tt>let max_profile_len = `</tt><tt><tt>proflen </tt>[i=@max]`</tt><br>
    </blockquote>
    Now you do not need to re-define sal_xz and temp_xz - they are
    defined in terms of the variable max_profile_len, so changing
    max_profile_len is all that's needed.&nbsp; Have a look at this again:<br>
    <br>
    &nbsp;&nbsp; yes? shade sal_xz<br>
    <br>
    To define the depth axis, you could define a variable "depth_xz"
    with expndi_by, and then find the longest profile, and use the
    depths listed there to define the z axis.<br>
    <blockquote>
      <tt>let depth_xz = expndi_by_z(salt, mask, n_profiles,
        max_profile_len</tt><tt><br>
      </tt><tt><br>
      </tt><tt>
        ! at which X is the variable proflen largest?&nbsp;&nbsp; </tt><tt><br>
      </tt><tt>let deepest_p_loc =
        proflen[i=1:`n_profiles`@LOC:`max_profile_len`]</tt><tt><br>
      </tt><tt><br>
      </tt><tt>! define the z axis from that set of depth?</tt><tt><br>
      </tt><tt>define axis/depth/units=meters/z&nbsp; zdepth =
        depth_z[i=`deepest_p_loc`]</tt><tt><br>
      </tt><tt><br>
      </tt></blockquote>
    <div class="moz-cite-prefix">The definition of the X and Y axes in
      longitude look fine to me, but you might try different values for
      the delta-x and delta y, perhaps making a coarser grid.&nbsp; The range
      should cover the range of the longitudes and latitudes in your
      data and ideally the grid cells would contain multiple stations.<br>
      <br>
      In the documentation of SCAT2GRIDGAUSS_XY, there is a discussion
      of the scale and cutoff parameters for the scat2gridgauss
      functions.&nbsp; If you make these numbers larger, or define a coarser
      grid, the interpolation to the grid will cover more area because
      you are bringing in more data to fill each grid cell.<br>
      <br>
      Ansley<br>
      <br>
      On 11/15/2012 4:53 AM, Akshay Hegde wrote:<br>
    </div>
    <blockquote
cite=""
      type="cite">Kindly help...not able to get right output<br>
      <br>
      <br>
      columns/skip=1/delim="\t,\b,-"/type="numeric,numeric,numeric,numeric,numeric,text,numeric,time,text,latitude,longitude,text,numeric,numeric,numeric"
      748phy.csv<br>
      list v13 <br>
      show d<br>
      ! consisting 14801 lines<br>
      define axis/x=1:14801:1 xin<br>
      define grid/x=xin input_grid<br>
      columns/skip=1/delim="\t,\b,-"/type="numeric,numeric,numeric,numeric,numeric,text,numeric,time,text,latitude,longitude,text,numeric,numeric,numeric"/grid=input_grid
      748phy.csv<br>
      <br>
      let stn = v2<br>
      let depth = v13<br>
      let temp = v14<br>
      let salt = v15<br>
      let lon = v11<br>
      let lat = v10<br>
      <br>
      list depth, temp, salt<br>
      let mask = if depth[i=@ddb] LT 1 then 1<br>
      list depth, mask, stn<br>
      let n_profiles = `1 + mask[i=@ngd]`<br>
      <br>
      ! Have confusion here...how to find max profile length ?<br>
      let max_profile_len = 9999<br>
      let sal_xz = expndi_by_z(salt, mask, n_profiles, max_profile_len)<br>
      let temp_xz = expndi_by_z(temp, mask, n_profiles, max_profile_len)<br>
      list sal_xz<br>
      list temp_xz<br>
      <br>
      let sal_xz = expndi_by_z(salt, mask, n_profiles, max_profile_len)<br>
      <br>
      ! Is there any other way to define depth ? it takes time to define
      manually, my max depth is more than 4000 meter<br>
      <br>
      define axis/depth/units=meters/z&nbsp; zdepth
={0,5,10,15,20,25,30,35,40,45,50,55,60,65,70,75,80,85,90,95,100,105,110,115,120,125,130,135,140,145,150,155,160,165,170,175,180,185,190,195,200}<br>
      let sal_z = sal_xz[gz=zdepth@asn]<br>
      let temp_z = temp_xz[gz=zdepth@asn]<br>
      let lon_xz = expndi_by_z(lon, mask, n_profiles, max_profile_len)<br>
      let lon_z = lon_xz[gz=zdepth@asn]<br>
      let lat_xz = expndi_by_z(lat, mask, n_profiles, max_profile_len)<br>
      let lat_z = lat_xz[gz=zdepth@asn]<br>
      <br>
      ! I have confusion here in defining latitude and longitude<br>
      <br>
      define axis/x=10:20:1/units=degrees_east xlon<br>
      define axis/y=40:75:1/units=degrees_north ylat<br>
      let xpts = x[gx=xlon]<br>
      let ypts = y[gy=ylat]<br>
      <br>
      ! why 10,10,10,0 at the end of function declaration ?<br>
      let salinity_xyz = scat2gridgauss_xy(lon_z[k=1], lat_z[k=1],
      sal_z, xpts,ypts, 10,10,10, 0)<br>
      let temp_xyz = scat2gridgauss_xy(lon_z[k=1], lat_z[k=1], temp_z,
      xpts,ypts, 10,10,10, 0)<br>
      <br>
      ! sometimes error comes here<br>
      <br>
      list/file=<a rel="nofollow" moz-do-not-send="true"
        href="http://phy.nc/format=cdf/clobber">phy.nc/format=cdf/clobber</a>
      temp_xyz,salinity_xyz<br>
      <br>
      <br>
      -Akshay Hegde<br>
    </blockquote>
    <br>
  

</font></td></tr></table>
<!--X-Body-of-Message-End-->
<!--X-MsgBody-End-->
<!--X-Follow-Ups-->
<hr>
<!--X-Follow-Ups-End-->
<!--X-References-->
<ul><li><strong>References</strong>:
<ul>
<li><strong><a name="00604" href="msg00604.html">[ferret_users] Pls help...</a></strong>
<ul><li><em>From:</em> Akshay Hegde</li></ul></li>
</ul></li></ul>
<!--X-References-End-->
<!--X-BotPNI-->
<UL>
<li>Previous by thread:
<strong><a href="msg00604.html">[ferret_users] Pls help...</a></strong>
</li>
<li>Next by thread:
<strong><a href="msg00606.html">[ferret_users] Ferret calendar error when plotting</a></strong>
</li>

</UL>
<center>[<a href="msg00604.html">Thread Prev</a>][<a href="msg00606.html">Thread Next</a>][<A HREF="threads.html#00605">Index</A>]</center>

<!--X-BotPNI-End-->
<!--X-User-Footer-->
<A HREF="http://ferret.pmel.noaa.gov/Ferret/contact-us">Contact Us</A>
<br>
<font size=-1>
<address>
<a href="http://www.doc.gov">Dept of Commerce</a> /
<a href="http://www.noaa.gov">NOAA</a> /
<a href="http://www.oar.noaa.gov">OAR</a> /
<a href="http://www.pmel.noaa.gov">PMEL</a> /
<a href="http://ferret.pmel.noaa.gov">Ferret</a>
</address>

<br>
 <a href="http://www.noaa.gov/privacy.html">Privacy Policy</a> | <a href="http://www.noaa.gov/disclaimer.html">Disclaimer</a> | <a href="accessibility.html">Accessibility Statement</a> 

</font>
<!--X-User-Footer-End-->
</body>
</html>
