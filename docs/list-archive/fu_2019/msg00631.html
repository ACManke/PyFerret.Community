<!-- MHonArc v2.6.18 -->
<!--X-Subject: Re: [ferret_users] converting binary to netCDF: memory insufficient? -->
<!--X-From-R13: "Oafyrl Q. [naxr" <nafyrl.o.znaxrNabnn.tbi> -->
<!--X-Date: Tue, 5 May 2020 09:32:01 &#45;0700 -->
<!--X-Message-Id: 84cb5aaa&#45;99c1&#45;4239&#45;0f08&#45;d541e245784d@noaa.gov -->
<!--X-Content-Type: multipart/alternative -->
<!--X-Reference: CAEwQpaJABM4SntxwkDD&#45;wLg8FAGqg2R&#45;YdFamyJYBfwv0NO19w@mail.gmail.com -->
<!--X-Head-End-->
<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN"
        "http://www.w3.org/TR/html4/loose.dtd">
<html>
<head>
<title>Re: [ferret_users] converting binary to netCDF: memory insufficient?</title>
</head>
<body>
<!--X-Body-Begin-->
<!--X-User-Header-->
<!--X-User-Header-End-->
<!--X-TopPNI-->
<HR>
<center>[<a href="msg00628.html">Thread Prev</a>][<a href="msg00632.html">Thread Next</a>][<A HREF="threads.html#00631">Index</A>]</center>

<!--X-TopPNI-End-->
<!--X-MsgBody-->
<!--X-Subject-Header-Begin-->
<h1>Re: [ferret_users] converting binary to netCDF: memory insufficient?</h1>
<hr>
<!--X-Subject-Header-End-->
<!--X-Head-of-Message-->
<ul>
<li><strong>To</strong>: <strong><a href="mailto:ferret_users@DOMAIN.HIDDEN">ferret_users@xxxxxxxx</a></strong></li>
<li><strong>Subject</strong>: <strong>Re: [ferret_users] converting binary to netCDF: memory insufficient?</strong></li>
<li><strong>From</strong>: <strong>&quot;Ansley C. Manke&quot; &lt;<a href="mailto:ansley.b.manke@DOMAIN.HIDDEN">ansley.b.manke@xxxxxxxx</a>&gt;</strong></li>
<li>Date: Tue, 5 May 2020 09:31:50 -0700</li>
<li>Arc-authentication-results: i=2; mx.google.com;       dkim=pass header.i=@noaa.gov header.s=google header.b=n4hmdn08;       spf=pass (google.com: domain of <a href="mailto:ansley.b.manke@DOMAIN.HIDDEN">ansley.b.manke@xxxxxxxx</a> designates 209.85.220.41 as permitted sender) smtp.mailfrom=<a href="mailto:ansley.b.manke@DOMAIN.HIDDEN">ansley.b.manke@xxxxxxxx</a>;       dmarc=pass (p=REJECT sp=NONE dis=NONE) header.from=noaa.gov</li>
<li>Arc-authentication-results: i=1; mx.google.com;       dkim=pass header.i=@noaa.gov header.s=google header.b=n4hmdn08;       spf=pass (google.com: domain of <a href="mailto:ansley.b.manke@DOMAIN.HIDDEN">ansley.b.manke@xxxxxxxx</a> designates 209.85.220.41 as permitted sender) smtp.mailfrom=<a href="mailto:ansley.b.manke@DOMAIN.HIDDEN">ansley.b.manke@xxxxxxxx</a>;       dmarc=pass (p=REJECT sp=NONE dis=NONE) header.from=noaa.gov</li>
<li>Arc-message-signature: i=2; a=rsa-sha256; c=relaxed/relaxed; d=google.com; s=arc-20160816;        h=list-archive:list-help:list-post:list-id:mailing-list:precedence         :content-language:in-reply-to:mime-version:user-agent:date         :message-id:from:references:to:subject:dkim-signature;        bh=XsMkKo/nluucBy0R9dtTBMALcj3y74rwUeJcjgpylxw=;        b=gRgAbwy6CL7uqcrYqsyfrt3QKey3ajicCMUFIk0mNQ+OH5hFZ3OW/i81JteVU6GSdf         ABfxrgAAK3bZn4hAGZuJb+YEGFFfzd+nImwE/FphDiW50kqnFRJREk1MvBSKu1SwF+XJ         hpl4mKO2UQ1VGD3lgBsWkylzGrxYtulPa532gx9SsbQa8zTURfF9oTTeSJqLdulblXVR         aKYoXpfzgDuOcoO2WvD4O6iw7NHsnaBAcbksxIilvzibjUFkSeYHS3f607sYZX4fIz+c         438f6E3O4aG/LW+1zY77ouP7lxGebg9hM1qOmZunBdikaw6VOcowFwO8vwqMKfObwE9U         29lA==</li>
<li>Arc-message-signature: i=1; a=rsa-sha256; c=relaxed/relaxed; d=google.com; s=arc-20160816;        h=content-language:in-reply-to:mime-version:user-agent:date         :message-id:from:references:to:subject:dkim-signature;        bh=XsMkKo/nluucBy0R9dtTBMALcj3y74rwUeJcjgpylxw=;        b=bRIpK1IgRzmGHgpWYAKIXEHm98zIS08+xHmKRUXkDlgJ0Qf3oEzPvtQ2b+K9IhbJv4         teVifckwHKkVfjg9bcW1mHzWwdKM6hk39wMJHo3C5SfGKBNsUefazABoJIJQX67AGI8t         zd9tB/h8YtmWMp/itM0MInIEHg80IEE9ZZOK+Gj0wcBz5cfLaAd9bSwYcodcq9KhQKBl         nXB9kCehPqJA4KOILtI5YO1VNt8/BHK73JgjQXghmxrs1WWu2G8tIS8YJN65k1ZKVOcz         oFUIGPEZWtTbYYfNobBS8LLJcaedDKwMWiIPoXRigFPgUlHNdCN8DOdrQ8Qp8vwx2D9E         2q9Q==</li>
<li>Arc-seal: i=2; a=rsa-sha256; t=1588696320; cv=pass;        d=google.com; s=arc-20160816;        b=IPbOKRCn1siRXBTF2eRJpxarD/WvxpNpwTT5qLk7ZqLmbTIQXRX6qf6LJ5qRu405rP         z4AVPaj9xk/C7QsHZ8diDVe2DaD+ITHoCcUq43f8YBtkhPx+6Iu8o27/GaPQnigIG04G         C7O3Iu9cs6YVI6xma2UR56kX7xlGoDSnv7v+uFDyZtqWmLomqJRTmKReIqX0mQrZGe6/         gMzp4RPkAs427NWdcM7yxa6y3IpcWJHAapG8PjQpT/Jj8l3uJwYwqR8yS/Gps+ywzD9r         qJN947yJgLZfzjqgknViyPTIJtaJueQXKNsBo5Fd77EOiy3JGzHp7mPxkWbd6VNVpL4E         D1cw==</li>
<li>Arc-seal: i=1; a=rsa-sha256; t=1588696315; cv=none;        d=google.com; s=arc-20160816;        b=hgbmwEBORrsLHILGD2SC4fzBxgPmQRaXtiFhemuSCB8iVypBLDjRVRu1F4RwLD+jvF         cxdjpvXeGLzoWbeWx59dN3QI1rLrcjj42WQn2VtXI6N7k425QSsSGnv4DnxJL7dSogO5         hzr3/ARBMdRLbFgdkybTNrHNJ1aq9CurNs+6L7X//JLBKwsHFpxpqCMSvZGTtmMAanvS         LeA4AtWoIIZtGgdzu+2JKO8rTdxhyR4AUbTnaQjyieRHPKKuVtjYbI742LMWQD3qBlxr         SzJV+unInoX1GDZfOkrN95Cbk9BqIgwN2hwOLAnf3muo13G+cadWWcz4Dqui+wcnJCS3         iJCg==</li>
<li>Dkim-signature: v=1; a=rsa-sha256; c=relaxed/relaxed;        d=noaa.gov; s=google;        h=subject:to:references:from:message-id:date:user-agent:mime-version         :in-reply-to:content-language:x-original-sender         :x-original-authentication-results:precedence:mailing-list:list-id         :list-post:list-help:list-archive;        bh=XsMkKo/nluucBy0R9dtTBMALcj3y74rwUeJcjgpylxw=;        b=IBK9lSwh1gJdOuHctkMJk8ugM2LusSVu+Num15vvGyEaQGTJeV2avMi2x3LWvlxCwj         U56tVXo++AKma10D2xL1DQwaCQDjJ21nKV4Vch5e+M4uoFaq9DbSUt6e19IEQXFo246j         oUrpxgYhWAkXc2gWkOvYiB9hLTDRZJHck5TBSdZTaqBg6jmBn5LvNIrgH0IvqB65ydGV         48evlR2cN8/viHxrlut5t4ZFVOUGP3zo34ygxhD9URP4HWyApPyxFWo47ghSbGdWhN+5         frB4QKe8K9TGLlorWesqv4Q3OL9WZSrKbxeQecuWOsRveJdgIejqIxIVgSQN12oyqeev         Qr5A==</li>
<li>In-reply-to: &lt;<a href="msg00628.html">CAEwQpaJABM4SntxwkDD-wLg8FAGqg2R-YdFamyJYBfwv0NO19w@mail.gmail.com</a>&gt;</li>
<li>List-archive: &lt;<a href="https://groups.google.com/a/noaa.gov/group/ferret_users/">https://groups.google.com/a/noaa.gov/group/ferret_users/</a>&gt;</li>
<li>List-help: &lt;<a href="https://support.google.com/a/noaa.gov/bin/topic.py?topic=25838">https://support.google.com/a/noaa.gov/bin/topic.py?topic=25838</a>&gt;, &lt;<a href="mailto:ferret_users+help@noaa.gov">mailto:ferret_users+help@noaa.gov</a>&gt;</li>
<li>List-id: &lt;ferret_users.noaa.gov&gt;</li>
<li>List-post: &lt;<a href="https://groups.google.com/a/noaa.gov/group/ferret_users/post">https://groups.google.com/a/noaa.gov/group/ferret_users/post</a>&gt;, &lt;<a href="mailto:ferret_users@noaa.gov">mailto:ferret_users@noaa.gov</a>&gt;</li>
<li>Mailing-list: list <a href="mailto:ferret_users@DOMAIN.HIDDEN">ferret_users@xxxxxxxx</a>; contact <a href="mailto:ferret_users%2Bowners@DOMAIN.HIDDEN">ferret_users+owners@xxxxxxxx</a></li>
<li>References: &lt;<a href="msg00628.html">CAEwQpaJABM4SntxwkDD-wLg8FAGqg2R-YdFamyJYBfwv0NO19w@mail.gmail.com</a>&gt;</li>
<li>Sender: <a href="mailto:owner-ferret_users@DOMAIN.HIDDEN">owner-ferret_users@xxxxxxxx</a></li>
<li>User-agent: Mozilla/5.0 (Windows NT 10.0; WOW64; rv:68.0) Gecko/20100101 Thunderbird/68.7.0</li>
</ul>
<!--X-Head-of-Message-End-->
<!--X-Head-Body-Sep-Begin-->
<hr>
<!--X-Head-Body-Sep-End-->
<!--X-Body-of-Message-->

  
  
    <p>Hi Ryo,</p>
    <p>Unlike netCDF, reading binary data requires reading in the whole
      grid at once. That's one of the big advantages of netCDF. So
      you're not gaining anything with the repeat loop.&#xA0; To read it in
      segments you would need to define a smaller grid to read a subset
      of records and write that out, the do a second read, skipping
      those first records, and so on.</p>
    <p>-Ansley<br>
    </p>
    <div class="moz-cite-prefix">On 5/1/2020 1:03 AM, Ryo Furue wrote:<br>
    </div>
    <blockquote type="cite"
cite="">
      
      <div dir="ltr">Dear Ferret users,
        <div><br>
        </div>
        <div>I seem to be missing something, but I can't even list a
          single point of my 4D variable:</div>
        <div><br>
        </div>
        <div><font face="monospace">yes?
            save/clobber/i=1:1/j=1:1/k=1:1/l=1:1/file=<a rel="nofollow"
              href="http://tmp.nc" moz-do-not-send="true">tmp.nc</a>
            temp[i=1,j=1,k=1,l=1]</font></div>
        <div>. . . memory error . . .&#xA0;</div>
        <div><font face="monospace">yes? list/i=1/j=1/k=1/l=1 temp<br>
          </font></div>
        <div>. . . memory error . . .&#xA0;</div>
        <div><br>
        </div>
        <div>(Some more details are at the end of this message).</div>
        <div><br>
        </div>
        <div>Basically, I just want to convert a 4D variable in a
          raw-binary format to a netCDF file.</div>
        <div><br>
        </div>
        <div>Is there any fundamental limit to the size of the
          underlying raw binary file?</div>
        <div><br>
        </div>
        <div>The array is in the regular Fortran order of (i, j, k, l)
          and because i=1:500 and j=1:400, the x-y plane (500 x 400)
          isn't so large.&#xA0; It's just 1.5 MB in double precision.&#xA0; So, I
          thought saving by</div>
        <div><br>
        </div>
        <div><font face="monospace">repeat/L=1:73 ( \</font></div>
        <div><font face="monospace">&#xA0; &#xA0; repeat/K=1:67 ( \</font></div>
        <div><font face="monospace">&#xA0; &#xA0; &#xA0; &#xA0;
            save/append/klimits=1:67/file=<a rel="nofollow" href="http://output.nc"
              moz-do-not-send="true">output.nc</a> temp ) )</font></div>
        <div><br>
        </div>
        <div>would be manageable.</div>
        <div><br>
        </div>
        <div>Regards,</div>
        <div>Ryo</div>
        <div>---------<br>
        </div>
        &#xA0; NOAA/PMEL TMAP<br>
        &#xA0; PyFerret v7.5 (optimized)<br>
        &#xA0; Linux 4.15.0-1061-azure - 11/14/19<br>
        <div>&#xA0; &#xA0;1-May-20 16:40</div>
        <div>[. . . ]</div>
        yes? file/form=STREAM/type=r8/var=temp/grid=grid_xt_yt_zt_ctime\<br>
        &#xA0;temp-pntd.bin<br>
        <div>yes? set memory/size=300<br>
        </div>
        <div>yes? save/clobber/i=1:1/j=1:1/k=1:1/l=1:1/file=<a rel="nofollow"
            href="http://tmp.nc" moz-do-not-send="true">tmp.nc</a>
          temp[i=1,j=1,k=1,l=1]<br>
          &#xA0;**ERROR: request exceeds memory setting<br>
          &#xA0; &#xA0; To fulfill this request would exceed the current SET
          MEMORY/SIZE= limit of 300 megawords<br>
          &#xA0; &#xA0; At the moment that the memory limit was reached<br>
          &#xA0; &#xA0; memory was committed as follows:<br>
          &#xA0; &#xA0; &#xA0; &#xA0; - to objects used in computation: : 0 (0%)<br>
          &#xA0; &#xA0; The size of the requested object was: : 978200000 (326%)<br>
          yes? show grid temp<br>
          &#xA0; &#xA0; GRID GRID_XT_YT_ZT_CTIME<br>
          &#xA0;name &#xA0; &#xA0; &#xA0; axis &#xA0; &#xA0; &#xA0; &#xA0; &#xA0; &#xA0; &#xA0;# pts &#xA0; start &#xA0; &#xA0; &#xA0; &#xA0; &#xA0; &#xA0; &#xA0; &#xA0;end
          &#xA0; &#xA0; &#xA0; &#xA0; &#xA0; &#xA0; &#xA0; &#xA0; subset<br>
          &#xA0;XT &#xA0; &#xA0; &#xA0; &#xA0;LONGITUDE &#xA0; &#xA0; &#xA0; &#xA0; &#xA0;500mr &#xA0; 105.05E &#xA0; &#xA0; &#xA0; &#xA0; &#xA0; &#xA0;
          &#xA0;154.95E(154.95) &#xA0; &#xA0; full<br>
          &#xA0;YT &#xA0; &#xA0; &#xA0; &#xA0;LATITUDE &#xA0; &#xA0; &#xA0; &#xA0; &#xA0; 400 r &#xA0; 44.95S &#xA0; &#xA0; &#xA0; &#xA0; &#xA0; &#xA0; &#xA0;
          5.05S &#xA0; &#xA0; &#xA0; &#xA0; &#xA0; &#xA0; &#xA0; full<br>
          &#xA0;ZT &#xA0; &#xA0; &#xA0; &#xA0;Z (METERS) &#xA0; &#xA0; &#xA0; &#xA0; &#xA0;67 i &#xA0; 2.5 &#xA0; &#xA0; &#xA0; &#xA0; &#xA0; &#xA0; &#xA0; &#xA0;
          &#xA0;767.22 &#xA0; &#xA0; &#xA0; &#xA0; &#xA0; &#xA0; &#xA0;full<br>
          &#xA0;CTIME &#xA0; &#xA0; TIME &#xA0; &#xA0; &#xA0; &#xA0; &#xA0; &#xA0; &#xA0; &#xA0;73mr &#xA0; 06-JAN 00:00 &#xA0; &#xA0; &#xA0; &#xA0;
          01-JAN 00:00 &#xA0; &#xA0; &#xA0; &#xA0;full<br>
          yes?<br>
        </div>
      </div>
    </blockquote>
    <pre class="moz-signature" cols="72">-- 
Ansley Manke
Science Data Integration Group
NOAA Pacific Marine Environmental Laboratory
7600 Sand Point Way NE
Seattle WA 98115

I am currently teleworking and am available Tue-Wed-Thu.</pre>
  


<!--X-Body-of-Message-End-->
<!--X-MsgBody-End-->
<!--X-Follow-Ups-->
<hr>
<ul><li><strong>Follow-Ups</strong>:
<ul>
<li><strong><a name="00632" href="msg00632.html">Re: [ferret_users] converting binary to netCDF: memory insufficient?</a></strong>
<ul><li><em>From:</em> Ryo Furue</li></ul></li>
</ul></li></ul>
<!--X-Follow-Ups-End-->
<!--X-References-->
<ul><li><strong>References</strong>:
<ul>
<li><strong><a name="00628" href="msg00628.html">[ferret_users] converting binary to netCDF: memory insufficient?</a></strong>
<ul><li><em>From:</em> Ryo Furue</li></ul></li>
</ul></li></ul>
<!--X-References-End-->
<!--X-BotPNI-->
<UL>
<li>Previous by thread:
<strong><a href="msg00628.html">[ferret_users] converting binary to netCDF: memory insufficient?</a></strong>
</li>
<li>Next by thread:
<strong><a href="msg00632.html">Re: [ferret_users] converting binary to netCDF: memory insufficient?</a></strong>
</li>

</UL>
<center>[<a href="msg00628.html">Thread Prev</a>][<a href="msg00632.html">Thread Next</a>][<A HREF="threads.html#00631">Index</A>]</center>

<!--X-BotPNI-End-->
<!--X-User-Footer-->
<A HREF="http://ferret.pmel.noaa.gov/Ferret/contact-us">Contact Us</A>
<br>
<font size=-1>
<address>
<a href="http://www.doc.gov">Dept of Commerce</a> /
<a href="http://www.noaa.gov">NOAA</a> /
<a href="http://www.oar.noaa.gov">OAR</a> /
<a href="http://www.pmel.noaa.gov">PMEL</a> /
<a href="http://ferret.pmel.noaa.gov">Ferret</a>
</address>

<br>
 <a href="http://www.noaa.gov/privacy.html">Privacy Policy</a> | <a href="http://www.noaa.gov/disclaimer.html">Disclaimer</a> | <a href="accessibility.html">Accessibility Statement</a> 

</font>
<!--X-User-Footer-End-->
</body>
</html>
