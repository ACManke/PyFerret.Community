<!-- MHonArc v2.6.18 -->
<!--X-Subject: Re: [ferret_users] Problems with netcdf output and zaxreplace -->
<!--X-From-R13: "Oafyrl Q. [naxr" <nafyrl.o.znaxrNabnn.tbi> -->
<!--X-Date: Thu, 16 Apr 2020 09:44:21 &#45;0700 -->
<!--X-Message-Id: 0b22db17&#45;7f6d&#45;53cf&#45;c272&#45;fa6adc7a5336@noaa.gov -->
<!--X-Content-Type: multipart/alternative -->
<!--X-Reference: 171835bf252.g.graffino@tim.it -->
<!--X-Head-End-->
<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN"
        "http://www.w3.org/TR/html4/loose.dtd">
<html>
<head>
<title>Re: [ferret_users] Problems with netcdf output and zaxreplace</title>
</head>
<body>
<!--X-Body-Begin-->
<!--X-User-Header-->
<!--X-User-Header-End-->
<!--X-TopPNI-->
<HR>
<center>[<a href="msg00615.html">Thread Prev</a>][<a href="msg00624.html">Thread Next</a>][<A HREF="threads.html#00616">Index</A>]</center>

<!--X-TopPNI-End-->
<!--X-MsgBody-->
<!--X-Subject-Header-Begin-->
<h1>Re: [ferret_users] Problems with netcdf output and zaxreplace</h1>
<hr>
<!--X-Subject-Header-End-->
<!--X-Head-of-Message-->
<ul>
<li><strong>To</strong>: <strong><a href="mailto:ferret_users@DOMAIN.HIDDEN">ferret_users@xxxxxxxx</a></strong></li>
<li><strong>Subject</strong>: <strong>Re: [ferret_users] Problems with netcdf output and zaxreplace</strong></li>
<li><strong>From</strong>: <strong>&quot;Ansley C. Manke&quot; &lt;<a href="mailto:ansley.b.manke@DOMAIN.HIDDEN">ansley.b.manke@xxxxxxxx</a>&gt;</strong></li>
<li>Date: Thu, 16 Apr 2020 09:44:16 -0700</li>
<li>Arc-authentication-results: i=2; mx.google.com;       dkim=pass header.i=@noaa.gov header.s=google header.b=MMDQ9gYt;       spf=pass (google.com: domain of <a href="mailto:ansley.b.manke@DOMAIN.HIDDEN">ansley.b.manke@xxxxxxxx</a> designates 209.85.220.41 as permitted sender) smtp.mailfrom=<a href="mailto:ansley.b.manke@DOMAIN.HIDDEN">ansley.b.manke@xxxxxxxx</a>;       dmarc=pass (p=REJECT sp=NONE dis=NONE) header.from=noaa.gov</li>
<li>Arc-authentication-results: i=1; mx.google.com;       dkim=pass header.i=@noaa.gov header.s=google header.b=MMDQ9gYt;       spf=pass (google.com: domain of <a href="mailto:ansley.b.manke@DOMAIN.HIDDEN">ansley.b.manke@xxxxxxxx</a> designates 209.85.220.41 as permitted sender) smtp.mailfrom=<a href="mailto:ansley.b.manke@DOMAIN.HIDDEN">ansley.b.manke@xxxxxxxx</a>;       dmarc=pass (p=REJECT sp=NONE dis=NONE) header.from=noaa.gov</li>
<li>Arc-message-signature: i=2; a=rsa-sha256; c=relaxed/relaxed; d=google.com; s=arc-20160816;        h=list-archive:list-help:list-post:list-id:mailing-list:precedence         :content-language:in-reply-to:mime-version:user-agent:date         :message-id:from:references:to:subject:dkim-signature;        bh=fWIcXN3tPn0mzoCMZ1VVpjtA/p77VXGDhhxsfHahqWw=;        b=xpjSwEYJDrmpFvjRPs8PcQIrQVn4X4idKjGMnP5bgSNM8ULWlovveQVEaMYJvrf6+m         0hwDvK1X+jaBsQNt2kPpenHSxwv7KxcHwqyNzSQ30FLTc/bvd/mmWtHtq+lenV4sv5XJ         QVtIM/ffhnxyL/0LSEmaWq/aNm3te8kflYjOIsOJpA3WUeyZlsvmsFwly4R60rvBZs8T         Sk7x6uOmV+rzyolRNq+rYYsdaT3HhwUv8BwVA6zJYUmb3lu7tWu+5+KJj9jbygWEzF1W         l8cHexY1bWIZvrBAF8P4zoUA/k8cjO/oE6AZk+yJMlu0g4LXFXLRs82Gi0YaL8pMh8dg         CvpQ==</li>
<li>Arc-message-signature: i=1; a=rsa-sha256; c=relaxed/relaxed; d=google.com; s=arc-20160816;        h=content-language:in-reply-to:mime-version:user-agent:date         :message-id:from:references:to:subject:dkim-signature;        bh=fWIcXN3tPn0mzoCMZ1VVpjtA/p77VXGDhhxsfHahqWw=;        b=IWwcjMyWjtsyhGlt533LekLfny28SrZD0BzsWk3XMMX4AtsPx/R0NYcOo/l/K30F/+         /6EdaqVPrlMnlzPGaoqE5QqSWR3GxQOlO55Q3qc3ifC+ydKDXwuQTnhyF2nYzFqoSZPg         f0/qZ4nwdSteY/iwXJMnnlZyH83g/xoXNNGrDBvF2IZjE4f1jv9eMm6zSAsx39dyccDY         h4sJ+yJ5Yc/hTJh9Aza6R1Ua59PfqVxM335o4Rl0HcTyyMX3UAVqGk5GITCZaEtj0/TZ         zvo10stDrhEC0ppoT0nucLhZJVi8TVyHwLNiOoYQSF9Kzeevxsa+4ukLrh/xCtvi4Yj4         fTCg==</li>
<li>Arc-seal: i=2; a=rsa-sha256; t=1587055460; cv=pass;        d=google.com; s=arc-20160816;        b=f4VyRwYyzc0X7iypYI9APP1TTUXriU1ILeP0ZhqRzNkerQ2Z9vq2PyClrcDACpNYI1         SxuHX7hCOjeSuaQkUfFBklZCI7QF6t3k6qNQON+2b36eJvHkHEa8xjMDgcwr/MKrKLrq         En7aq6tg2IJuYj4pgFryuAhulJqJf7CJqDgRZWv93qGE7cR+vXFQuegyfniCedopFOjE         CJ5Opa7qKFCWVLifGVPiB8TFN2MgB32jRxbdc3IRfiDCVY+Grae+uQws83PiGQHc1Rd+         aOyn167TthmBqos6sEPwbwqTYRlUk+xqF8SO6bfl5dne+duE/6TLUVnFMTF8D3ghhwES         QR7w==</li>
<li>Arc-seal: i=1; a=rsa-sha256; t=1587055459; cv=none;        d=google.com; s=arc-20160816;        b=Zr/gi+h5CyGuNrPPsSYtYSwP0tXp9rFIbju8N8DWT/RB7xU+lm9gc3t9C+wW3UYIIo         MTTLKKFyi1NIk/JkVQBRlJswhtf49vvEdiGCdmZNr7A3Fybn3xhIiwluP9cQlrF7kJ8X         ATlMigw9W1VVsrSpIJIr4OvJT94H5ziwZBlUYrraRA7A0g97Ii+pZdZH/WM2rlsYXM4V         VLs163mcyRjta3w/1Y/QZvJGT4U5beOgRwqGP6KknpJ2Mi67/RdHI/+U5Ni2go0iRYYm         oMy/JFrngO8bMfkIPEApHtKpw3C1FKMVCvLzQaITPFDeT/S3H7O8eZX8KldeexXomFrn         KLYA==</li>
<li>Dkim-signature: v=1; a=rsa-sha256; c=relaxed/relaxed;        d=noaa.gov; s=google;        h=subject:to:references:from:message-id:date:user-agent:mime-version         :in-reply-to:content-language:x-original-sender         :x-original-authentication-results:precedence:mailing-list:list-id         :list-post:list-help:list-archive;        bh=fWIcXN3tPn0mzoCMZ1VVpjtA/p77VXGDhhxsfHahqWw=;        b=bbndKaltWFUIaytvZ1GjQK0K7cCs436cC8riiHGAw3TePKr+WAFgdbqCCZRUBD2YGw         q0990Rr13zlmMk6novj/5zNcHVHvBM0UStns+XYt1N6Mw0tw0D8SUwN/18/Y1JtFDTga         BqiF5lidijitSD7vYsUj9KUBTOzRUyhlAat77S2yeEt0oGsblOvCh6JhZAMRKGacNVvj         DSsuqNH5bLHK1/ZWLoKtTIFyex+6iE+5VJVJlyFTdDoX+0xY8dIsnr/VSEZx84MrryZm         gnQrunvpYfCkBsrEXWIZBrs765PhA7Q5rzljtgWklKTY/rsbjJgmOL2ZN1iwcp17tZGT         zlTQ==</li>
<li>In-reply-to: &lt;<a href="msg00614.html">171835bf252.g.graffino@tim.it</a>&gt;</li>
<li>List-archive: &lt;<a href="https://groups.google.com/a/noaa.gov/group/ferret_users/">https://groups.google.com/a/noaa.gov/group/ferret_users/</a>&gt;</li>
<li>List-help: &lt;<a href="https://support.google.com/a/noaa.gov/bin/topic.py?topic=25838">https://support.google.com/a/noaa.gov/bin/topic.py?topic=25838</a>&gt;, &lt;<a href="mailto:ferret_users+help@noaa.gov">mailto:ferret_users+help@noaa.gov</a>&gt;</li>
<li>List-id: &lt;ferret_users.noaa.gov&gt;</li>
<li>List-post: &lt;<a href="https://groups.google.com/a/noaa.gov/group/ferret_users/post">https://groups.google.com/a/noaa.gov/group/ferret_users/post</a>&gt;, &lt;<a href="mailto:ferret_users@noaa.gov">mailto:ferret_users@noaa.gov</a>&gt;</li>
<li>Mailing-list: list <a href="mailto:ferret_users@DOMAIN.HIDDEN">ferret_users@xxxxxxxx</a>; contact <a href="mailto:ferret_users%2Bowners@DOMAIN.HIDDEN">ferret_users+owners@xxxxxxxx</a></li>
<li>References: &lt;<a href="msg00614.html">171835bf252.g.graffino@tim.it</a>&gt;</li>
<li>Sender: <a href="mailto:owner-ferret_users@DOMAIN.HIDDEN">owner-ferret_users@xxxxxxxx</a></li>
<li>User-agent: Mozilla/5.0 (Windows NT 10.0; WOW64; rv:68.0) Gecko/20100101 Thunderbird/68.7.0</li>
</ul>
<!--X-Head-of-Message-End-->
<!--X-Head-Body-Sep-Begin-->
<hr>
<!--X-Head-Body-Sep-End-->
<!--X-Body-of-Message-->

  
  
    <p>I think Billy's on the right track with his answer, but here's
      some more explanation and another idea or two.<br>
    </p>
    <p>The axes with names such as LAT153_153 are Ferret-generated
      names, created when you save a subset of data in that direction.&#xA0;
      If you have data on a grid with an axis LAT and you save data at
      one location, for instance "SAVE/Y=35.5 myvar"&#xA0; then the one-point
      latitude axis is named with the index range based on the original
      axis - here the y=35.5 corresponds index J=153.&#xA0; A range such as
      "SAVE/y=35.5:42" would name the axis something like LAT153_162<br>
    </p>
    <p>Then it sounds as if you are trying to append more data which has
      a different coordinate in the Y direction, and so the coordinates
      in the grid don't match up, hence the error message about
      coordinates. If you are doing SAVE/APPEND with a variable name
      that is already in the file, then the coordinates of the variable
      being saved must match what's in the file, except for time, where
      one can append new timesteps along the time axis.&#xA0; The
      characteristics of the time axis of the variable being written
      must match the time axis in the file, that is, it must have the
      same time origin and time units, and the calendar must match.&#xA0; To
      append in directions other than time you'd need to pre-define the
      output grid when the file is first created, as discussed here <a rel="nofollow"
        moz-do-not-send="true"
href="https://ferret.pmel.noaa.gov/Ferret/documentation/users-guide/converting-to-netcdf/SIMPLE-CONVERSIONS-USING-FERRET#_VPINDEXENTRY_1071">in
        the documentation</a>.<br>
    </p>
    <p>-Ansley<br>
    </p>
    <div class="moz-cite-prefix">On 4/16/2020 7:19 AM, Giorgio Graffino
      wrote:<br>
    </div>
    <blockquote type="cite" cite="">
      
      <div>Dear Ferreters,</div>
      <div>hope you can help me with this. <br>
      </div>
      <div><br>
      </div>
      <div>I'm using Ferret (v6.842) on a cluster machine. My purpose is
        to regrid the meridional mass transport (time depth lat lon)
        into density space (time density lat lon) to compute the
        transport between some density layers. I'm writing a script
        based on this
(<a rel="nofollow" class="moz-txt-link-freetext" href="https://github.com/NOAA-PMEL/Ferret/blob/master/jnls/examples/depth_to_density_demo.jnl">https://github.com/NOAA-PMEL/Ferret/blob/master/jnls/examples/depth_to_density_demo.jnl</a>),
        which is using zaxreplace. I also found something about
        auxiliary regridding
        (<a rel="nofollow" class="moz-txt-link-freetext" href="https://ferret.pmel.noaa.gov/Ferret/faq/depth-axis-to-density-axis">https://ferret.pmel.noaa.gov/Ferret/faq/depth-axis-to-density-axis</a>),
        but it requires a newer version of Ferret.</div>
      <div><br>
      </div>
      <div>I'm using the script on several CMIP6 models, and saving the
        resulting time series as netcdf files for further analysis. I'm
        including as attachments the script and one of the output files,
        not the input files being too big. I'm facing two problems, and
        I can't find anything useful on the archives.</div>
      <div><br>
      </div>
      <div>1) First problem: for most models Ferret isn't producing any
        useful output files, because of error messages like this one:<br>
      </div>
      <div><br>
      </div>
      <div>TMAP ERR: error in line definition<br>
        &#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0; file coords dont match variable coords on axis
        LAT153_153</div>
      <div><br>
      </div>
      <div>As a result, I'm left with empty files. The point is that no
        LAT153_153 should exist, the variable being a time series. There
        is nothing special about 153, since other models produce
        different errors (LAT122_122, LAT124_124, LAT156_156, and so
        on). What is even more puzzling is that the computed variables
        are alright, because I can plot them with Ferret. I'm just not
        able to attach them as netcdf variables, and the resulting file
        is empty. Why is Ferret defining such axis for a time series?<br>
      </div>
      <div><br>
      </div>
      <div>2) Second problem: for other models Ferret is complaining
        about the axis transformation. The error in this case is:</div>
      <div><br>
      </div>
      <div>**ERROR: regridding: only @ASN regridding between calendar
        and<br>
        &#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0; non-calendar axes: DENS</div>
      <div><br>
      </div>
      <div>No variable is produced after using zaxreplace. I'm puzzled
        here because I'm defining a vertical axis, and I don't
        understand why calendars should matter. Is it a problem with
        zaxreplace? In case, could you provide me the relevant code?</div>
      <div><br>
      </div>
      <div>Thanks in advance.</div>
      <div><br>
      </div>
      <div>Giorgio<br>
      </div>
      <div><br>
      </div>
      <div><br>
      </div>
    </blockquote>
    <pre class="moz-signature" cols="72">-- 
Ansley Manke
Science Data Integration Group
NOAA Pacific Marine Environmental Laboratory
7600 Sand Point Way NE
Seattle WA 98115

I am currently teleworking and am available Tue-Wed-Thu.</pre>
  


<!--X-Body-of-Message-End-->
<!--X-MsgBody-End-->
<!--X-Follow-Ups-->
<hr>
<!--X-Follow-Ups-End-->
<!--X-References-->
<ul><li><strong>References</strong>:
<ul>
<li><strong><a name="00614" href="msg00614.html">[ferret_users] Problems with netcdf output and zaxreplace</a></strong>
<ul><li><em>From:</em> Giorgio Graffino</li></ul></li>
</ul></li></ul>
<!--X-References-End-->
<!--X-BotPNI-->
<UL>
<li>Previous by thread:
<strong><a href="msg00615.html">Re: [ferret_users] Problems with netcdf output and zaxreplace</a></strong>
</li>
<li>Next by thread:
<strong><a href="msg00624.html">Re: [ferret_users] Problems with netcdf output and zaxreplace</a></strong>
</li>

</UL>
<center>[<a href="msg00615.html">Thread Prev</a>][<a href="msg00624.html">Thread Next</a>][<A HREF="threads.html#00616">Index</A>]</center>

<!--X-BotPNI-End-->
<!--X-User-Footer-->
<A HREF="http://ferret.pmel.noaa.gov/Ferret/contact-us">Contact Us</A>
<br>
<font size=-1>
<address>
<a href="http://www.doc.gov">Dept of Commerce</a> /
<a href="http://www.noaa.gov">NOAA</a> /
<a href="http://www.oar.noaa.gov">OAR</a> /
<a href="http://www.pmel.noaa.gov">PMEL</a> /
<a href="http://ferret.pmel.noaa.gov">Ferret</a>
</address>

<br>
 <a href="http://www.noaa.gov/privacy.html">Privacy Policy</a> | <a href="http://www.noaa.gov/disclaimer.html">Disclaimer</a> | <a href="accessibility.html">Accessibility Statement</a> 

</font>
<!--X-User-Footer-End-->
</body>
</html>
