<!-- MHonArc v2.6.18 -->
<!--X-Subject: Re: [ferret_users] precision problem on a difference between a same variable read from 2 files with the same structure -->
<!--X-From-R13: "Oafyrl Q. [naxr" <nafyrl.o.znaxrNabnn.tbi> -->
<!--X-Date: Fri, 14 Jun 2019 17:07:17 &#45;0700 -->
<!--X-Message-Id: 6b388665&#45;563a&#45;dbcf&#45;0ccc&#45;c40f184cc3d7@noaa.gov -->
<!--X-Content-Type: multipart/alternative -->
<!--X-Reference: 3936110.315755.1560540688301.JavaMail.zimbra@lsce.ipsl.fr -->
<!--X-Head-End-->
<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN"
        "http://www.w3.org/TR/html4/loose.dtd">
<html>
<head>
<title>Re: [ferret_users] precision problem on a difference between a same variable read from 2 files with the same structure</title>
</head>
<body>
<!--X-Body-Begin-->
<!--X-User-Header-->
<!--X-User-Header-End-->
<!--X-TopPNI-->
<HR>
<center>[<a href="msg00232.html">Thread Prev</a>][<a href="msg00234.html">Thread Next</a>][<A HREF="threads.html#00233">Index</A>]</center>

<!--X-TopPNI-End-->
<!--X-MsgBody-->
<!--X-Subject-Header-Begin-->
<h1>Re: [ferret_users] precision problem on a difference between a same variable read from 2 files with the same structure</h1>
<hr>
<!--X-Subject-Header-End-->
<!--X-Head-of-Message-->
<ul>
<li><strong>To</strong>: <strong><a href="mailto:ferret_users@DOMAIN.HIDDEN">ferret_users@xxxxxxxx</a></strong></li>
<li><strong>Subject</strong>: <strong>Re: [ferret_users] precision problem on a difference between a same variable read from 2 files with the same structure</strong></li>
<li><strong>From</strong>: <strong>&quot;Ansley C. Manke&quot; &lt;<a href="mailto:ansley.b.manke@DOMAIN.HIDDEN">ansley.b.manke@xxxxxxxx</a>&gt;</strong></li>
<li>Date: Fri, 14 Jun 2019 17:07:14 -0700</li>
<li>Arc-authentication-results: i=2; mx.google.com;       dkim=pass header.i=@noaa.gov header.s=google header.b=D32UiMzS;       spf=pass (google.com: domain of <a href="mailto:ansley.b.manke@DOMAIN.HIDDEN">ansley.b.manke@xxxxxxxx</a> designates 209.85.220.41 as permitted sender) smtp.mailfrom=<a href="mailto:ansley.b.manke@DOMAIN.HIDDEN">ansley.b.manke@xxxxxxxx</a>;       dmarc=pass (p=REJECT sp=NONE dis=NONE) header.from=noaa.gov</li>
<li>Arc-authentication-results: i=1; mx.google.com;       dkim=pass header.i=@noaa.gov header.s=google header.b=D32UiMzS;       spf=pass (google.com: domain of <a href="mailto:ansley.b.manke@DOMAIN.HIDDEN">ansley.b.manke@xxxxxxxx</a> designates 209.85.220.41 as permitted sender) smtp.mailfrom=<a href="mailto:ansley.b.manke@DOMAIN.HIDDEN">ansley.b.manke@xxxxxxxx</a>;       dmarc=pass (p=REJECT sp=NONE dis=NONE) header.from=noaa.gov</li>
<li>Arc-message-signature: i=2; a=rsa-sha256; c=relaxed/relaxed; d=google.com; s=arc-20160816;        h=list-archive:list-help:list-post:list-id:mailing-list:precedence         :content-language:in-reply-to:mime-version:user-agent:date         :message-id:from:references:to:subject:dkim-signature;        bh=AAU+CkGFRQVIjP9HoLOa2R4KAsniIX3MShmV6NSbId4=;        b=kEhqu7OuVqPI+zV77T3UANMVME5WLykio59Jl5BAnVns+DwzP2/viZ+KJMMAqOgZXG         3O3JPjbz9dpljef3Yfih/NSRI4XCMPUUGtRhNNKrDxqG5YXhE4Mp160QhpHQbAn2CfJ4         ron6nzHtvZ83LIuIQ4MVMAxBM0DqRpIYt4u0KMCIFFfSmOzFBG5khH1TOoouDuKa1rQW         s3KmLjixoRGkbPIv9Uh52NapoUmRKI3rb2iZUgWY3pf9274P6TE59ruNjrzPqMcmjeWC         /DXoLCbgDRSumm0CZt1TRhkWrbo2yzqwoA6vUVfOs2qCJNUagtpsi6JeyW0Ylj7kQbvy         vEBg==</li>
<li>Arc-message-signature: i=1; a=rsa-sha256; c=relaxed/relaxed; d=google.com; s=arc-20160816;        h=content-language:in-reply-to:mime-version:user-agent:date         :message-id:from:references:to:subject:dkim-signature;        bh=AAU+CkGFRQVIjP9HoLOa2R4KAsniIX3MShmV6NSbId4=;        b=i1kg5tJ/FvQ5bYF8A2P5hqVXo6BX0OMNIBtU0WRf21X5YeHI7CZccS5Jo+x6AYzgiz         Hm2jtBkjdUS46EF0tDRKwQ2nLe1NvzvJZSfmGRmJAJraBpN8DiulHYd2ZZTmA3DjugSY         0oEVRtMcP8jbwCrf/YumkomZ2uzL1N0VWVqXl6rFcBB0jN9Hv8+eQh7VEFG+JvvH63c9         LKAwEeFwm4m+zW7yZMJap5XaYUWe4p0SJbn9FXR7YCdpI09E6uRc7hq49vZZFoQQhh9h         NF0tFw25a/uRdw5xg7J124KPFObx9hLRZjIcKfmU0MJYateH4N2sSCUZf/uOfWHKilqB         svvA==</li>
<li>Arc-seal: i=2; a=rsa-sha256; t=1560557237; cv=pass;        d=google.com; s=arc-20160816;        b=cKoiDKgiwgB6EzYwow7XBzYPO9uMVTrYlRQlKHRs5q9Fxr3HEYEnFjdVy04aLHAeIM         LI9hcaqfIGoF4PLLQDISxKTtw5uVqTVZRS1XzKUnnq88RDhfn1t7jy4nRUhaLNDXd7uw         wZHbrqTzWQ2565WFi5Mzw/kknC5ErFzW/nrBX/Y/EgkbV/Uo7im4lMBnwd7dw8hlj2Qg         KaD0c3l613pKQ6Xi2emh0KKniIQqGZY953kZ+MOlKl5d9VCo5FGhGsegUhSYucoBpg9O         2FZU9+1HEl/FhXiZjySR4w48pT8aqarUzZ2AgwgXELVkAB1dxuEYIcKwzkfRvqc3LNHi         4clw==</li>
<li>Arc-seal: i=1; a=rsa-sha256; t=1560557236; cv=none;        d=google.com; s=arc-20160816;        b=wdu1ZeaE5qXx7TtQ1td3rdsk5fHBaIGUdNgM3OugCZ1oK2ccE5iWkt/RzNuSTQh8yl         Yl0cPYy0SOyO2DhMlxtwn9M9gP/IJC1UXDHwpeqavSOFCnqHgmf4yquYslSDvINCcWu6         jj0ElVAHbRgcqKPuBPoPiinxjXfgX0MUAEfydTphW77Sgiuv6izj+xwH2Yr8aCBC/coz         6Oids/5veuSH8KHPnZN2rATcmBwHVWEji9ckn8yMNTgF3wwWEr028DTs2JONa6yHqopd         d3J7kYGnSCZi0OVk/Gq0S8YImoSLJXBJUK+d1dC3/bGoZN5VVpeFm5rX7+nFA7LKrNqW         v7RA==</li>
<li>Dkim-signature: v=1; a=rsa-sha256; c=relaxed/relaxed;        d=noaa.gov; s=google;        h=subject:to:references:from:message-id:date:user-agent:mime-version         :in-reply-to:content-language:x-original-sender         :x-original-authentication-results:precedence:mailing-list:list-id         :list-post:list-help:list-archive;        bh=AAU+CkGFRQVIjP9HoLOa2R4KAsniIX3MShmV6NSbId4=;        b=VdPpTCt6CMfBzHkXjk5U+C7x0cnBjF/wXMwR3/b1u/V9rNTr57+RQYLPqCG59NxjGT         FNkXWQE37tz3EICCeKHdGSRuOkwIG57kzrBVh+oy3Ef5fzNI2yk+ZM+lcbD15ti6BKD0         jSmbteh+RwHaBhGyFFAVZp+J/gRbZhOybrvtCPpEGRER0E2pJXkvtIR1pvrWc/1xehce         e+jaeBSNLsEotspa8C5sAvGBHW2oSKiH/qcGZDqX8tXM9BrawV0ZJvbbag5UqU1GBDXa         t0TecrsY+wKcNVoVSX7TVL7YMvny0Gr4ZVhYm+zZFbJikWROSAqmk3NkW+g/6S43aDBN         ZsAA==</li>
<li>In-reply-to: &lt;<a href="msg00232.html">3936110.315755.1560540688301.JavaMail.zimbra@lsce.ipsl.fr</a>&gt;</li>
<li>List-archive: &lt;<a href="https://groups.google.com/a/noaa.gov/group/ferret_users/">https://groups.google.com/a/noaa.gov/group/ferret_users/</a>&gt;</li>
<li>List-help: &lt;<a href="https://support.google.com/a/noaa.gov/bin/topic.py?topic=25838">https://support.google.com/a/noaa.gov/bin/topic.py?topic=25838</a>&gt;, &lt;<a href="mailto:ferret_users+help@noaa.gov">mailto:ferret_users+help@noaa.gov</a>&gt;</li>
<li>List-id: &lt;ferret_users.noaa.gov&gt;</li>
<li>List-post: &lt;<a href="https://groups.google.com/a/noaa.gov/group/ferret_users/post">https://groups.google.com/a/noaa.gov/group/ferret_users/post</a>&gt;, &lt;<a href="mailto:ferret_users@noaa.gov">mailto:ferret_users@noaa.gov</a>&gt;</li>
<li>Mailing-list: list <a href="mailto:ferret_users@DOMAIN.HIDDEN">ferret_users@xxxxxxxx</a>; contact <a href="mailto:ferret_users%2Bowners@DOMAIN.HIDDEN">ferret_users+owners@xxxxxxxx</a></li>
<li>References: &lt;<a href="msg00232.html">3936110.315755.1560540688301.JavaMail.zimbra@lsce.ipsl.fr</a>&gt;</li>
<li>Sender: <a href="mailto:owner-ferret_users@DOMAIN.HIDDEN">owner-ferret_users@xxxxxxxx</a></li>
<li>User-agent: Mozilla/5.0 (Windows NT 6.1; WOW64; rv:60.0) Gecko/20100101 Thunderbird/60.7.0</li>
</ul>
<!--X-Head-of-Message-End-->
<!--X-Head-Body-Sep-Begin-->
<hr>
<!--X-Head-Body-Sep-End-->
<!--X-Body-of-Message-->
<table width="100%"><tr><td bgcolor="#FFFFFF" style="background-color: #FFFFFF; color: #000000; "><font color="#000000">
  
  
    <p>Hi Patrick,</p>
    <p>Yes, when the second file having the same name as an axis already
      in use by another file in the session, Ferret checks whether the
      axes are the same and if so, uses it in both grids.&#xA0; I think you
      must be correct that this is the cause of the difference you're
      seeing.</p>
    <p>I think you are correct that this also has to do with the
      reversing of the axis coordinates and that for some reason this is
      done differently in the two cases.</p>
    <p>I'll look further into this.&#xA0; Thank you for sending a detailed
      example.</p>
    <p>Ansley<br>
    </p>
    <div class="moz-cite-prefix"><br>
    </div>
    <div class="moz-cite-prefix"><br>
    </div>
    <div class="moz-cite-prefix">On 6/14/2019 12:31 PM, Patrick
      Brockmann wrote:<br>
    </div>
    <blockquote type="cite"
      cite="">
      
      <div style="font-family: arial, helvetica, sans-serif; font-size:
        12pt; color: #000000">
        <div>Hi ferreters,</div>
        <div><br data-mce-bogus="1">
        </div>
        <div>I encountered a problem when I compare a variable</div>
        <div>read from 2 different files with exactly the same structure
          (same axis in particular).</div>
        <div><br data-mce-bogus="1">
        </div>
        <div>The difference calculated with ferret has the following
          range:&#xA0;</div>
        <div>
          <div>&#xA0; &#xA0;Minimum value: -2.1516798E-11</div>
          <div>&#xA0; &#xA0;Maximum value: 2.15167981E-11</div>
        </div>
        <div>but the difference calculated with ncdiff&#xA0;<span
            style="color: #000000; font-family: arial, helvetica,
            sans-serif; font-size: 16px; font-style: normal;
            font-variant-ligatures: normal; font-variant-caps: normal;
            font-weight: 400; letter-spacing: normal; orphans: 2;
            text-align: start; text-indent: 0px; text-transform: none;
            white-space: normal; widows: 2; word-spacing: 0px;
            -webkit-text-stroke-width: 0px; background-color: #ffffff;
            text-decoration-style: initial; text-decoration-color:
            initial; display: inline !important; float: none;"
            data-mce-style="color: #000000; font-family: arial,
            helvetica, sans-serif; font-size: 16px; font-style: normal;
            font-variant-ligatures: normal; font-variant-caps: normal;
            font-weight: 400; letter-spacing: normal; orphans: 2;
            text-align: start; text-indent: 0px; text-transform: none;
            white-space: normal; widows: 2; word-spacing: 0px;
            -webkit-text-stroke-width: 0px; background-color: #ffffff;
            text-decoration-style: initial; text-decoration-color:
            initial; display: inline !important; float: none;"><span
              style="color: #000000; font-family: arial, helvetica,
              sans-serif; font-size: 16px; font-style: normal;
              font-variant-ligatures: normal; font-variant-caps: normal;
              font-weight: 400; letter-spacing: normal; orphans: 2;
              text-align: start; text-indent: 0px; text-transform: none;
              white-space: normal; widows: 2; word-spacing: 0px;
              -webkit-text-stroke-width: 0px; background-color: #ffffff;
              text-decoration-style: initial; text-decoration-color:
              initial; display: inline !important; float: none;"
              data-mce-style="color: #000000; font-family: arial,
              helvetica, sans-serif; font-size: 16px; font-style:
              normal; font-variant-ligatures: normal; font-variant-caps:
              normal; font-weight: 400; letter-spacing: normal; orphans:
              2; text-align: start; text-indent: 0px; text-transform:
              none; white-space: normal; widows: 2; word-spacing: 0px;
              -webkit-text-stroke-width: 0px; background-color: #ffffff;
              text-decoration-style: initial; text-decoration-color:
              initial; display: inline !important; float: none;">has&#xA0;<span>&#xA0;</span>the
              following range:&#xA0;</span></span></div>
        <div><span style="orphans: 2; text-align: start; text-indent:
            0px; widows: 2; background-color: rgb(255, 255, 255);
            text-decoration-style: initial; text-decoration-color:
            initial; float: none; display: inline !important;"
            data-mce-style="color: #000000; font-family: arial,
            helvetica, sans-serif; font-size: 16px; font-style: normal;
            font-variant-ligatures: normal; font-variant-caps: normal;
            font-weight: 400; letter-spacing: normal; orphans: 2;
            text-align: start; text-indent: 0px; text-transform: none;
            white-space: normal; widows: 2; word-spacing: 0px;
            -webkit-text-stroke-width: 0px; background-color: #ffffff;
            text-decoration-style: initial; text-decoration-color:
            initial; display: inline !important; float: none;">
            <div style="">&#xA0; &#xA0;Minimum value: -2.79521E-20</div>
            <div style="">&#xA0; &#xA0;Maximum value: 2.87991E-20</div>
          </span></div>
        <div><br data-mce-bogus="1">
        </div>
        <div>--&gt; I was expecting the same order of magnitude with
          ferret than with ncdiff.</div>
        <div><br data-mce-bogus="1">
        </div>
        <div>More strange, if I change the name of a coordinate axis of
          one of the input file</div>
        <div>then the difference calculated with ferret and ncdiff have
          the same order</div>
        <div>of magnitude. </div>
        <div><br data-mce-bogus="1">
        </div>
        <div>--&gt; I suspect that the variable read from the 2nd file
          uses a downward axis</div>
        <div>set from the read of the 1st file.</div>
        <div><br data-mce-bogus="1">
        </div>
        <div>Attached the minimized problem with 3 small nc files and 2
          test scripts.</div>
        <div><br data-mce-bogus="1">
        </div>
        <div>Please try:</div>
        <div>$ ferret -script test1.jnl</div>
        <div><span style="color: #000000; font-family: arial, helvetica,
            sans-serif; font-size: 16px; font-style: normal;
            font-variant-ligatures: normal; font-variant-caps: normal;
            font-weight: 400; letter-spacing: normal; orphans: 2;
            text-align: start; text-indent: 0px; text-transform: none;
            white-space: normal; widows: 2; word-spacing: 0px;
            -webkit-text-stroke-width: 0px; background-color: #ffffff;
            text-decoration-style: initial; text-decoration-color:
            initial; display: inline !important; float: none;"
            data-mce-style="color: #000000; font-family: arial,
            helvetica, sans-serif; font-size: 16px; font-style: normal;
            font-variant-ligatures: normal; font-variant-caps: normal;
            font-weight: 400; letter-spacing: normal; orphans: 2;
            text-align: start; text-indent: 0px; text-transform: none;
            white-space: normal; widows: 2; word-spacing: 0px;
            -webkit-text-stroke-width: 0px; background-color: #ffffff;
            text-decoration-style: initial; text-decoration-color:
            initial; display: inline !important; float: none;">$ ferret
            -script test2.jnl</span></div>
        <div><br data-mce-bogus="1">
        </div>
        <div>Tested with ferret 7.44 and 7.50</div>
        <div>Any help welcome.</div>
        <div><br data-mce-bogus="1">
        </div>
        <div>Regards</div>
        <div>Patrick</div>
        <div><br data-mce-bogus="1">
        </div>
        <div data-marker="__SIG_PRE__">--<br>
          Data Analysis and Visualization Engineer / Project Manager<br>
          LSCE/IPSL, CEA-CNRS-UVSQ laboratory<br>
          LSCE - Climate and Environment Sciences Laboratory<br>
          IPSL - Institut Pierre Simon Laplace<br>
          --</div>
      </div>
    </blockquote>
    <div class="moz-signature">-- <br>
      <i>Ansley Manke<br>
        NOAA/PMEL Science Data Integration Group<br>
        7600 Sand Point Way NE<br>
        206-526-6246</i></div>
  

</font></td></tr></table>
<!--X-Body-of-Message-End-->
<!--X-MsgBody-End-->
<!--X-Follow-Ups-->
<hr>
<ul><li><strong>Follow-Ups</strong>:
<ul>
<li><strong><a name="00234" href="msg00234.html">Re: [ferret_users] precision problem on a difference between a same variable read from 2 files with the same structure</a></strong>
<ul><li><em>From:</em> Patrick Brockmann</li></ul></li>
</ul></li></ul>
<!--X-Follow-Ups-End-->
<!--X-References-->
<ul><li><strong>References</strong>:
<ul>
<li><strong><a name="00232" href="msg00232.html">[ferret_users] precision problem on a difference between a same variable read from 2 files with the same structure</a></strong>
<ul><li><em>From:</em> Patrick Brockmann</li></ul></li>
</ul></li></ul>
<!--X-References-End-->
<!--X-BotPNI-->
<UL>
<li>Previous by thread:
<strong><a href="msg00232.html">[ferret_users] precision problem on a difference between a same variable read from 2 files with the same structure</a></strong>
</li>
<li>Next by thread:
<strong><a href="msg00234.html">Re: [ferret_users] precision problem on a difference between a same variable read from 2 files with the same structure</a></strong>
</li>

</UL>
<center>[<a href="msg00232.html">Thread Prev</a>][<a href="msg00234.html">Thread Next</a>][<A HREF="threads.html#00233">Index</A>]</center>

<!--X-BotPNI-End-->
<!--X-User-Footer-->
<A HREF="http://ferret.pmel.noaa.gov/Ferret/contact-us">Contact Us</A>
<br>
<font size=-1>
<address>
<a href="http://www.doc.gov">Dept of Commerce</a> /
<a href="http://www.noaa.gov">NOAA</a> /
<a href="http://www.oar.noaa.gov">OAR</a> /
<a href="http://www.pmel.noaa.gov">PMEL</a> /
<a href="http://ferret.pmel.noaa.gov">Ferret</a>
</address>

<br>
 <a href="http://www.noaa.gov/privacy.html">Privacy Policy</a> | <a href="http://www.noaa.gov/disclaimer.html">Disclaimer</a> | <a href="accessibility.html">Accessibility Statement</a> 

</font>
<!--X-User-Footer-End-->
</body>
</html>
