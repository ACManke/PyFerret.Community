<!-- MHonArc v2.6.18 -->
<!--X-Subject: Re: [ferret_users] inconsistent data grids: File needs axis attributes on coordinate variables indicating correct direction -->
<!--X-From-R13: Oafyrl [naxr <n.p.znaxrNtznvy.pbz> -->
<!--X-Date: Wed, 29 Sep 2021 15:48:00 &#45;0700 -->
<!--X-Message-Id: 3aa1189b&#45;317a&#45;1f2d&#45;f672&#45;411c19c8baaa@gmail.com -->
<!--X-Content-Type: multipart/alternative -->
<!--X-Reference: 931333798.462866.1632754107286.JavaMail.zimbra@lsce.ipsl.fr -->
<!--X-Reference: 692792214.1528520.1632916840765.JavaMail.zimbra@lsce.ipsl.fr -->
<!--X-Head-End-->
<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN"
        "http://www.w3.org/TR/html4/loose.dtd">
<html>
<head>
<title>Re: [ferret_users] inconsistent data grids: File needs axis attributes on coordinate variables indicating correct direction</title>
</head>
<body>
<!--X-Body-Begin-->
<!--X-User-Header-->
<!--X-User-Header-End-->
<!--X-TopPNI-->
<HR>
<center>[<a href="msg01012.html">Thread Prev</a>][<a href="msg01014.html">Thread Next</a>][<A HREF="threads.html#01013">Index</A>]</center>

<!--X-TopPNI-End-->
<!--X-MsgBody-->
<!--X-Subject-Header-Begin-->
<h1>Re: [ferret_users] inconsistent data grids: File needs axis attributes on coordinate variables indicating correct direction</h1>
<hr>
<!--X-Subject-Header-End-->
<!--X-Head-of-Message-->
<ul>
<li><strong>To</strong>: <strong><a href="mailto:ferret_users@DOMAIN.HIDDEN">ferret_users@xxxxxxxx</a></strong></li>
<li><strong>Subject</strong>: <strong>Re: [ferret_users] inconsistent data grids: File needs axis attributes on coordinate variables indicating correct direction</strong></li>
<li><strong>From</strong>: <strong>Ansley Manke &lt;<a href="mailto:a.c.manke@DOMAIN.HIDDEN">a.c.manke@xxxxxxxxx</a>&gt;</strong></li>
<li>Date: Wed, 29 Sep 2021 15:47:51 -0700</li>
<li>Arc-authentication-results: i=4; mx.google.com;       dkim=pass header.i=@gmail.com header.s=20210112 header.b=nq80ntrc;       arc=pass (i=2 dkim=pass dkdomain=gmail.com);       spf=pass (google.com: domain of <a href="mailto:a.c.manke@DOMAIN.HIDDEN">a.c.manke@xxxxxxxxx</a> designates 209.85.222.199 as permitted sender) smtp.mailfrom=<a href="mailto:a.c.manke@DOMAIN.HIDDEN">a.c.manke@xxxxxxxxx</a></li>
<li>Arc-authentication-results: i=3; mx.google.com;       dkim=pass header.i=@gmail.com header.s=20210112 header.b=nq80ntrc;       arc=pass (i=2 dkim=pass dkdomain=gmail.com);       spf=pass (google.com: domain of <a href="mailto:a.c.manke@DOMAIN.HIDDEN">a.c.manke@xxxxxxxxx</a> designates 209.85.222.199 as permitted sender) smtp.mailfrom=<a href="mailto:a.c.manke@DOMAIN.HIDDEN">a.c.manke@xxxxxxxxx</a></li>
<li>Arc-authentication-results: i=2; mx.google.com;       dkim=pass header.i=@gmail.com header.s=20210112 header.b=nq80ntrc;       arc=pass (i=1 spf=pass spfdomain=gmail.com dkim=pass dkdomain=gmail.com dmarc=pass fromdomain=gmail.com);       spf=softfail (google.com: domain of transitioning <a href="mailto:a.c.manke@DOMAIN.HIDDEN">a.c.manke@xxxxxxxxx</a> does not designate 65.153.203.167 as permitted sender) smtp.mailfrom=<a href="mailto:a.c.manke@DOMAIN.HIDDEN">a.c.manke@xxxxxxxxx</a></li>
<li>Arc-authentication-results: i=1; mx.google.com;       dkim=pass header.i=@gmail.com header.s=20210112 header.b=nq80ntrc;       spf=pass (google.com: domain of <a href="mailto:a.c.manke@DOMAIN.HIDDEN">a.c.manke@xxxxxxxxx</a> designates 209.85.220.41 as permitted sender) smtp.mailfrom=<a href="mailto:a.c.manke@DOMAIN.HIDDEN">a.c.manke@xxxxxxxxx</a>;       dmarc=pass (p=NONE sp=QUARANTINE dis=NONE) header.from=gmail.com</li>
<li>Arc-message-signature: i=4; a=rsa-sha256; c=relaxed/relaxed; d=google.com; s=arc-20160816;        h=list-archive:list-help:list-post:list-id:mailing-list:precedence         :content-language:in-reply-to:mime-version:user-agent:date         :message-id:references:to:subject:from:sender:dkim-signature;        bh=CFFdZTMveSZ2aXXceUI+WQvZiCr6rKjCkBQBU6Ew20Y=;        b=Tvix9SxcNKb4t+VOQtEJSmjdl1ueqwYFDtqPrN85rzOvPCJMuGsqgAWtBG+/JJIbLQ         u0khAoHujW100yGaM/ARom54Un3kZSSfCmUQh5/POuCkUvGG5isbr8jiDxBT8uH2mQIt         5Q2AAq7k4IWn03EmncXWDELwu5BqKaERw6cUrq4CvAk88fSYahWX7BtTqj0z0gY6auka         N2lQXmyO6tBV9Rnia1Vlt0Qr8SIE5FQ9c9PRgi3qRLb2jj+uotf3dH8Yqw8HpKNoWouS         DrMB7kgL4hphVLzidzswg8VGNv4aTncIfR4vcRY1ujDmrnNhIFoR/UwIQQV+eCp+Sa3k         Fkrg==</li>
<li>Arc-message-signature: i=3; a=rsa-sha256; c=relaxed/relaxed; d=google.com; s=arc-20160816;        h=content-language:in-reply-to:mime-version:user-agent:date         :message-id:references:to:subject:from:dkim-signature;        bh=CFFdZTMveSZ2aXXceUI+WQvZiCr6rKjCkBQBU6Ew20Y=;        b=EEL+uhR4CtNEJvJGA1JbvAdYIM6XEZHdZMRFs7/gIiXp9x8HJAF09svInDxuCjSV1a         +HGPaw8UPxFHFhRHCm9e/LEskl17yK7e3NmuG7Pc2xtzC7UjuEpa6w80qvM7LFa0O9lP         uQhuPxAFxZ4ks4I3+HH65Inr+uYJib9m3hvjOHvmC79mDVbUnd5IFDxkXt/1qY+6vCpT         ye+ZHkOD2UsoXPb7mWpSDeGsWY8KIMVElBXQUksHK8mldCet0nEx4yPvcUNiUzbTTebR         41UOD13a8BdiE1tqsv/aNIurDJRN4whPjD3AW8O7fOq85on/UVYLXQfpsHEHAaXbuECt         2iIA==</li>
<li>Arc-message-signature: i=2; a=rsa-sha256; c=relaxed/relaxed; d=google.com; s=arc-20160816;        h=content-language:in-reply-to:mime-version:user-agent:date         :message-id:references:to:subject:from:dkim-signature;        bh=CFFdZTMveSZ2aXXceUI+WQvZiCr6rKjCkBQBU6Ew20Y=;        b=eG91K6tgYxiMFxTS2gnDRzKsM7VJ+jgqwk5n4DAwQqpGGwpgV+ustI93fUIIT72mWi         iWSdw8dNjN/K5SOnoKy8XdTUEob5FM8Tk2YVqGUdFGYN0SVJQvHQIhxUt1Xw/HNql7Rp         O5d5afDclORvfvnB0DPeaKKPo2/uqV2sqBhEOmymWuVR3RoIu8PRcBOXoD7aWITSpHkv         SNVld08aOFgzXTR8jkNNeWG0zRGayD4SwRo/5YJRBfVnfP3cP9bKVl8SrCqbHMfdv5kp         CFiW18zFVuKvHhrsiUnB4g+fdwt1L1DrZIqcxza2+FtCceyg1tmhGv4r+vl1r8z7ZOTY         9xyg==</li>
<li>Arc-message-signature: i=1; a=rsa-sha256; c=relaxed/relaxed; d=google.com; s=arc-20160816;        h=content-language:in-reply-to:mime-version:user-agent:date         :message-id:references:to:subject:from:dkim-signature;        bh=CFFdZTMveSZ2aXXceUI+WQvZiCr6rKjCkBQBU6Ew20Y=;        b=m1sTDBOhKhjvV0CorvOW7O+fDByVRUkyhjn8gkTX3M9Qh4f4DispuqC90QC34DOou5         9xePJyU2vLIuncadtkJ3dSZbYbOo/tLMsJvkMwASmGifsFRZNqKI9JRcommTgjs6gu+N         GjOmwyAT0zv3jRc9+RBonPH1bSTg0D3jOkL1UH1zSnc9e8RcvUv7b0kmNJ0qQy4AX8FQ         plwd9oSvLsgZOi1UB4tbuVTyL6vqBqbWO34QqzzYZXZ0oHCFp58gj0JArTb2HPYr8g4r         A/oWkyDZIkuKKXpzqZRbErEd2vPf2BYoBfAr4BsQycO3nXOBm6X3Y9sJDQM30wq6+yv4         BozA==</li>
<li>Arc-seal: i=4; a=rsa-sha256; t=1632955679; cv=pass;        d=google.com; s=arc-20160816;        b=CZwcPYNWYgRd3CindJ7uMYVAL9XG7p8j42yD7pVxAdP9mO/LfN0n/Zp2NgWwyVs9we         i90ur6Vby8kybyC/JxRX7uVr/hW69jEvd8iGqlsIGhUCkLRCjjAK/BPayOF2eRD/GyBD         EAvGK2mbb4koVWXF6sA63bKBxQdm6NsM26J4Gw7c9iGxauA+06fsjfoxctvnTdwV0NRT         Dje4QckibToNrzyLl/qMw96lpPrUZKrducaiQug/nZxzrStiH/9Af7Dt+Qu0i+0yE/cg         ZfTaoCFniF9QWlvWy+Q8hfvksgWIUsBNnpfw+MxvUka2VOHxTaFyaa9IOAR/dWEloMNh         xhfw==</li>
<li>Arc-seal: i=3; a=rsa-sha256; t=1632955678; cv=pass;        d=google.com; s=arc-20160816;        b=a3zL8pgHc0pdx+FiglOkrLgdBfSR1k6DCJ2I2zF3X8igLJWmx5EWRR5jONTnwf5JwN         aK6IK8JHWJeg0iV1KgSThbyjdYwWSnZTp0y5rz3McMPNdzAnGeHRBuDsET5RQt1+6soy         ZUfi7vHSZbDw2shiCV8c3190uofttIJeGbl9FBgIjK8Kcc3QScVK9+mJSLhISRhceonm         SBWy0Jvlu8mj2g4vlUWgOP6ixhAlSuDhZCralbVI0wvAEHlTw2/w9ocar77sHf9GApML         bWjGTTEbosaPKvLRvWTVG9sngicu4P7Ubh5rdzhn0aB4faP4ZTAuy+tSLxlKR+vLm02R         kcDg==</li>
<li>Arc-seal: i=2; a=rsa-sha256; t=1632955674; cv=pass;        d=google.com; s=arc-20160816;        b=bHtW/mFvygizyT2bu3TYmrZR95g7L53PsBcndZ5kI8IwI6pvoYDYtYmsVgukKLDiov         YYYu46KHvTOpLfo/7FSrIyQ36F94NESBgt9wzH9+c22f2szKq44iBWnmAalBfwuW/wqe         Jnwnvt7Ch/Z/nvtvKRHJFtRA32QUdV6liiPOtyiYd7fc3YgRZzLpqwJXVU0m/vRDMv51         lkECpdBy9RHSoBGsPzXuYcf9FR+eAPNewlLSfW7i4Y580T/8RONIqYW7BPmTjpTPxga6         mBEm8p03JvwhwTbbENnIp4kV6yQFX2gCTJ+iVh0FOUjHUogsi1q0b02UX3wh/ta9mkxX         qmRg==</li>
<li>Arc-seal: i=1; a=rsa-sha256; t=1632955672; cv=none;        d=google.com; s=arc-20160816;        b=uTKbeQ3wtz0BRN6cIIur9hmM6BCh8xyF2QfHwq7p+E4TKdvZGc6RHRiMLYFEu61RVF         /KCIApF8VlNyjH6MGEHeNH0AqQXOIZ4ni+W/JcnTUwTaWavmjveyKaGrsqWSZMvJaX8A         VSEsHYYf75Gud/sz8CtTASS0Q3WFrE0jWsGZM5MO8vcQh2G8d5Uzaa16KLIfa3aOpBVh         yIwlz6q4Otwj/LrYDBUl3fsJ+c4ikMl2O11GlCzv3toz2wniqb9K+1knV+WvE6AOpuP2         PcEkMUqSNChipjs8IiLEUCMaBkcrjOJhZr6aXC4QBzhrtbdqcRC3sH/ulUBNlHfZ6Sgu         blAQ==</li>
<li>Dkim-signature: v=1; a=rsa-sha256; c=relaxed/relaxed;        d=noaa.gov; s=google;        h=sender:from:subject:to:references:message-id:date:user-agent         :mime-version:in-reply-to:content-language:x-original-sender         :x-original-authentication-results:precedence:mailing-list:list-id         :list-post:list-help:list-archive;        bh=CFFdZTMveSZ2aXXceUI+WQvZiCr6rKjCkBQBU6Ew20Y=;        b=GB/TGHOStMF06mlnZJY1oHOCop5wwUQbqeQp/DuZhDw6LnpobUtAeH5DPJxaPJwCgF         VwcqKYNRxxnfLTq8KmeSFsSadP1xZTG+ZxPHITQEjWmm0/PpAkDiYy3YNhFUiCkvFcnd         M2daADBaSDRKkHhEfbVQiRoRz6WL6n09pmqelN9B80zoPTwTd7vW28XsUwRhmDg8QuL3         /KFKkS4U+HL7PDZJsfGgENPL3cVVR1TPL4XYPgMMTvM6qafDy+6+ubsvMw3H5/YtZe5X         87ML2um++YtHMaHlsoQsXSPlKYW93P61xfNhCk/1wPRx08vUCIwYjjmLhW3f93ha/A7o         EO5w==</li>
<li>In-reply-to: &lt;<a href="msg01012.html">692792214.1528520.1632916840765.JavaMail.zimbra@lsce.ipsl.fr</a>&gt;</li>
<li>List-archive: &lt;<a href="https://groups.google.com/a/noaa.gov/group/ferret_users/">https://groups.google.com/a/noaa.gov/group/ferret_users/</a>&gt;</li>
<li>List-help: &lt;<a href="https://support.google.com/a/noaa.gov/bin/topic.py?topic=25838">https://support.google.com/a/noaa.gov/bin/topic.py?topic=25838</a>&gt;, &lt;<a href="mailto:ferret_users+help@noaa.gov">mailto:ferret_users+help@noaa.gov</a>&gt;</li>
<li>List-id: &lt;ferret_users.noaa.gov&gt;</li>
<li>List-post: &lt;<a href="https://groups.google.com/a/noaa.gov/group/ferret_users/post">https://groups.google.com/a/noaa.gov/group/ferret_users/post</a>&gt;, &lt;<a href="mailto:ferret_users@noaa.gov">mailto:ferret_users@noaa.gov</a>&gt;</li>
<li>Mailing-list: list <a href="mailto:ferret_users@DOMAIN.HIDDEN">ferret_users@xxxxxxxx</a>; contact <a href="mailto:ferret_users%2Bowners@DOMAIN.HIDDEN">ferret_users+owners@xxxxxxxx</a></li>
<li>References: &lt;<a href="msg01010.html">931333798.462866.1632754107286.JavaMail.zimbra@lsce.ipsl.fr</a>&gt; &lt;<a href="msg01012.html">692792214.1528520.1632916840765.JavaMail.zimbra@lsce.ipsl.fr</a>&gt;</li>
<li>Sender: <a href="mailto:owner-ferret_users@DOMAIN.HIDDEN">owner-ferret_users@xxxxxxxx</a></li>
<li>User-agent: Mozilla/5.0 (Windows NT 10.0; Win64; x64; rv:78.0) Gecko/20100101 Thunderbird/78.14.0</li>
</ul>
<!--X-Head-of-Message-End-->
<!--X-Head-Body-Sep-Begin-->
<hr>
<!--X-Head-Body-Sep-End-->
<!--X-Body-of-Message-->

  
  
    Hi Patrick, and others on this thread,<br>
    <br>
    Maybe there needs to be an FAQ about this. It's good to have this
    example.<br>
    <br>
    PyFerret creates grids for variables as it initializes a dataset.&#xA0;
    It decides which dimensions have which direction, and as it works it
    requires that the directions are the same for all of the variables
    in the dataset. If there is any doubt about the directions of
    dimensions, it starts with the variables with the most dimensions,
    assigning the directions for their dimensions, and then works to
    create the grids for variables with fewer dimensions.<br>
    If a dimension has a coordinate variable associated with it, the
    attributes are used to determine directions, and this is the most
    direct and preferred method.&#xA0;<br>
    <br>
    If there is a coordinate variable, then direction is determined by
    looking at the coordinate variable's attributes. Once the direction
    is determined, the search stops, so for instance if we had a
    coordinate variable with an attribute <b>:axis = "x"</b> and :<b>units="days"</b>
    would be marked as an x axis.This is the order for checking
    direction information. <br>
    <br>
    1- An <b>axis </b>attribute, with value x, y, z, t.&#xA0; If there is
    no axis attribute, then<br>
    <br>
    2 - A <b>cartesian_axis </b>attribute.<br>
    <br>
    3- A <b>cf_role </b>attribute. This attribute is used in the
    discrete sampling geometries form for netCDF datasets.<br>
    <br>
    4- A <b>_CoordinateAxisType </b>attribute.<br>
    <br>
    5- If the direction is still undetermined, pyferret looks for a <b>units
    </b>attribute of the coordinate variable and checks whether those
    correspond to directions of longitude, latitude, depth/height (or
    pressure), or time.&#xA0; <br>
    <br>
    6- A <b>positive</b> attribute.&#xA0; positive=down or positive=up
    indicate a Z axis.<br>
    <p>7- A <b>standard_name</b> attribute where the standard name
      value indicates longitude, latitude, height/depth, time.</p>
    8- If the direction is still undetermined, or if the dimension does
    not correspond to a coordinate variable then a few obvious dimension
    names can indicate the direction:<br>
    <br>
    &#xA0;&#xA0;&#xA0;&#xA0; o Dimension names that are simple one-letter names X","Y", "Z",
    "T", "I", "J", "K", "L"<br>
    <br>
    &#xA0;&#xA0;&#xA0;&#xA0; o Dimension names that start with "XAX","YAX","ZAX","TAX"<br>
    <br>
    &#xA0;&#xA0;&#xA0;&#xA0; o Dimension names that start with
    "LON","LAT","TIME","DATE","DEP","ALT,"ELEV","HEI","LAYER","LEVEL"
    are assigned the appropriate direction. This last group is not
    applied if there is a units string that indicates something that is
    not a direction, in case there might be for example dimension that
    is say, "depletion", with units of "percent".<br>
    <p>9- If the axis direction is still undermined, then they will be
      assigned, starting with the largest grid, working right to left
      with the first axis an x axis, then a y axis, and so on.&#xA0; So the
      file here would look at <b><i>bounds_lat(jmax, imax, nv)&#xA0;</i></b>
      and put nv in the x direction, imax in the y direction, and jmax
      in the z direction.&#xA0; Then it cannot reconcile that with the 2-D
      grid (jmax, imax). </p>
    <br>
    In much older versions of Ferret, even more guessing was used to
    determine directions, so that any dimension name starting with T was
    put in the time direction and so forth. Probably jmax and imax would
    have been Y and X axes.&#xA0; However this led to confusion and
    inconsistencies. For instance an axis called TSTATION was put in the
    T direction but should have been a simple axis in the X direction,
    for instance.<br>
    <p><br>
    </p>
    <p>Ansley</p>
    <br>
    <div class="moz-cite-prefix">On 9/29/2021 5:00 AM, Patrick Brockmann
      wrote:<br>
    </div>
    <blockquote type="cite"
      cite="">
      
      <div style="font-family: arial, helvetica, sans-serif; font-size:
        12pt; color: #000000">
        <div>Hi all,</div>
        <div><br data-mce-bogus="1">
        </div>
        <div>I have investigated a little bit more on the internal
          ferret mechanism that leads to produce this error.&#xA0;</div>
        <div><span style="font-family: monospace;"
            data-mce-style="font-family: monospace;"><br>
            **ERROR: inconsistent data grids: File needs axis attributes
            on coordinate variables indicating correct directions<br>
          </span></div>
        <div><br>
        </div>
        <div>Starting from an example given by the CF convention
          description from the folowing paragraph</div>
        <div><a rel="nofollow"
href="https://cfconventions.org/Data/cf-conventions/cf-conventions-1.9/cf-conventions.html#cell-boundaries"
            moz-do-not-send="true">https://cfconventions.org/Data/cf-conventions/cf-conventions-1.9/cf-conventions.html#cell-boundaries</a><br
            data-mce-bogus="1">
        </div>
        <div>I have reproduced the error from a very simple exemple.</div>
        <div><br data-mce-bogus="1">
        </div>
        <div>$ cat notok.cdl</div>
        <div><span style="font-family: monospace;"
            data-mce-style="font-family: monospace;"><span style="color:
              #000000; background-color: #ffffff;"
              data-mce-style="color: #000000; background-color:
              #ffffff;">netcdf notok { </span><br>
            dimensions: <br>
            &#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;jmax = 1 ; <br>
            &#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;imax = 1 ; <br>
            &#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;nv = 4 ; <br>
            variables: <br>
            &#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;double lat(jmax, imax) ; <br>
            &#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;lat:long_name = "latitude" ; <br>
            &#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;lat:units = "degrees_north" ; <br>
            &#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;lat:bounds = "bounds_lat" ; <br>
            &#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;double lon(jmax, imax) ; <br>
            &#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;lon:long_name = "longitude" ; <br>
            &#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;lon:units = "degrees_east" ; <br>
            &#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;lon:bounds = "bounds_lon" ; <br>
            &#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;double bounds_lat(jmax, imax, nv) ; <br>
            &#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;double bounds_lon<span style="color: #000000;
              background-color: #54ffff;" data-mce-style="color:
              #000000; background-color: #54ffff;">(</span><span
              style="color: #000000; background-color: #ffffff;"
              data-mce-style="color: #000000; background-color:
              #ffffff;">jmax, imax, nv</span><span style="color:
              #000000; background-color: #54ffff;"
              data-mce-style="color: #000000; background-color:
              #54ffff;">)</span><span style="color: #000000;
              background-color: #ffffff;" data-mce-style="color:
              #000000; background-color: #ffffff;"> ; </span><br>
            &#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;double sample(jmax, imax) ; <br>
            &#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;sample:coordinates = "lon lat" ; <br>
            data: <br>
            lat = -28; <br>
            lon = 157; <br>
            bounds_lat = -29, -29, -27, -27; <br>
            bounds_lon = 156, 158, 158, 156; <br>
            sample = 1 ; <br>
            }<br>
            $ ncgen -o notok.nc notok.cdl</span></div>
        <div><span style="font-family: monospace;"
            data-mce-style="font-family: monospace;">$ ferret</span></div>
        <div><span style="font-family: monospace;"
            data-mce-style="font-family: monospace;">yes? use notok.nc</span></div>
        <div><span style="font-family: monospace;"
            data-mce-style="font-family: monospace;">&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;*** NOTE:
            <br>
            &#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;*** NOTE: Could not adjust grid for variable lat <br>
            **ERROR: inconsistent data grids: File needs axis attributes
            on coordinate variables indicating correct directions<br>
          </span></div>
        <div><span style="font-family: monospace;"
            data-mce-style="font-family: monospace;"><br
              data-mce-bogus="1">
          </span></div>
        <div><span style="font-family: monospace;"
            data-mce-style="font-family: monospace;">The same file with
            modified dimension names (jmax, imax replaced by y, x)&#xA0;</span><span
            style="font-family: monospace;" data-mce-style="font-family:
            monospace;">can be openned.</span></div>
        <div><span style="font-family: monospace;"
            data-mce-style="font-family: monospace;"><br
              data-mce-bogus="1">
          </span></div>
        <div><span style="font-family: monospace;"
            data-mce-style="font-family: monospace;">$ cat ok.cdl</span></div>
        <div><span style="font-family: monospace;"
            data-mce-style="font-family: monospace;"><span style="color:
              #000000; background-color: #ffffff;"
              data-mce-style="color: #000000; background-color:
              #ffffff;">netcdf ok { </span><br>
            dimensions: <br>
            &#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;y = 1 ; <br>
            &#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;x = 1 ; <br>
            &#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;nv = 4 ; <br>
            variables: <br>
            &#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;double lat(y, x) ; <br>
            &#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;lat:long_name = "latitude" ; <br>
            &#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;lat:units = "degrees_north" ; <br>
            &#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;lat:bounds = "bounds_lat" ; <br>
            &#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;double lon(y, x) ; <br>
            &#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;lon:long_name = "longitude" ; <br>
            &#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;lon:units = "degrees_east" ; <br>
            &#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;lon:bounds = "bounds_lon" ; <br>
            &#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;double bounds_lat(y, x, nv) ; <br>
            &#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;double bounds_lon(y, x, nv) ; <br>
            &#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;double sample(y, x) ; <br>
            &#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;sample:coordinates = "lon lat" ; <br>
            data: <br>
            lat = -28; <br>
            lon = 157; <br>
            bounds_lat = -29, -29, -27, -27; <br>
            bounds_lon = 156, 158, 158, 156; <br>
            sample = 1 ; <br>
            }<br>
            $ ncgen -o ok.nc ok.cdl</span></div>
        <div><span style="font-family: monospace;"
            data-mce-style="font-family: monospace;">$ ferret</span></div>
        <div><span style="font-family: monospace;"
            data-mce-style="font-family: monospace;">yes? use ok.nc</span></div>
        <div><span style="font-family: monospace;"
            data-mce-style="font-family: monospace;"><br
              data-mce-bogus="1">
          </span></div>
        <div><span style="font-family: monospace;"
            data-mce-style="font-family: monospace;">I would like to
            understand why ?</span></div>
        <div><br data-mce-bogus="1">
        </div>
        <div><span style="font-family: monospace;"
            data-mce-style="font-family: monospace;">Best regards</span></div>
        <div><span style="font-family: monospace;"
            data-mce-style="font-family: monospace;">Patrick</span></div>
        <div><br data-mce-bogus="1">
        </div>
        <div data-marker="__SIG_PRE__">--<br>
          Data Analytics and Visualization Engineer / Project Manager<br>
          LSCE/IPSL, CEA-CNRS-UVSQ laboratory<br>
          LSCE - Climate and Environment Sciences Laboratory<br>
          IPSL - Institut Pierre Simon Laplace<br>
          --</div>
        <div><br>
        </div>
        <hr id="zwchr" data-marker="__DIVIDER__">
        <div data-marker="__HEADERS__"><b>De: </b>"Patrick Brockmann" <a rel="nofollow"
            class="moz-txt-link-rfc2396E"
            href="mailto:patrick.brockmann@xxxxxxxxxxxx">&lt;patrick.brockmann@xxxxxxxxxxxx&gt;</a><br>
          <b>&#xC0;: </b>"ferret users" <a rel="nofollow" class="moz-txt-link-rfc2396E"
            href="mailto:ferret_users@xxxxxxxx">&lt;ferret_users@xxxxxxxx&gt;</a><br>
          <b>Cc: </b>"Thanh-Lam Nguyen" <a rel="nofollow"
            class="moz-txt-link-rfc2396E"
            href="mailto:sebastien.nguyen@xxxxxxxxxxxx">&lt;sebastien.nguyen@xxxxxxxxxxxx&gt;</a><br>
          <b>Envoy&#xE9;: </b>Lundi 27 Septembre 2021 16:48:27<br>
          <b>Objet: </b>[ferret_users] inconsistent data grids: File
          needs axis attributes on coordinate variables indicating
          correct direction<br>
        </div>
        <div><br>
        </div>
        <div data-marker="__QUOTED_TEXT__">
          <div style="font-family:'arial' , 'helvetica' ,
            sans-serif;font-size:12pt;color:#000000">
            <div>Hi ferreters,<br>
            </div>
            <br>
            <div>A colleague has encountered a strange problem as he was
              trying to<br>
            </div>
            <div>nicely respect the netCDF CF conventions to describe a
              curvilinear grid (NEMO configuration).<br>
            </div>
            <br>
            <div>ferret complains about some inconsistent data grid and
              missing axis attributes.<br>
            </div>
            <pre><span style="font-family:monospace;font-size:8pt"><span style="color:#000000;background-color:#ffffff">use notok.nc </span>
&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;*** NOTE: 
&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;*** NOTE: Could not adjust grid for variable mask_T 
**ERROR: inconsistent data grids: File needs axis attributes on coordinate variables indicating correct directions</span></pre>
            <div><span style="font-family:monospace"><br>
              </span></div>
            <div><span style="font-family:monospace">Stranger, if I
                change the name of the dimension, then the file<br>
              </span></div>
            <div><span style="font-family:monospace">is read. I have not
                been able to fix this by adding a direction attribute as
                requested.<br>
              </span></div>
            <div><span style="font-family:monospace"><br>
              </span></div>
            <div><span style="font-family:monospace">The file is simple
                as:<br>
              </span></div>
            <pre><span style="font-family:monospace"><span style="color:rgb( 0 , 0 , 0 );background-color:rgb( 255 , 255 , 255 );font-size:8pt">$ ncdump notok.nc
netcdf notok { </span>
<span style="font-size:8pt">dimensions: </span>
<span style="font-size:8pt">&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;y_grid_T = 1 ; </span>
<span style="font-size:8pt">&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;x_grid_T = 1 ; </span>
<span style="font-size:8pt">&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;nvertex_grid_T = 4 ; </span>
<span style="font-size:8pt">variables: </span>
<span style="font-size:8pt">&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;double bounds_lat_grid_T(y_grid_T, x_grid_T, nvertex_grid_T) ; </span>
<span style="font-size:8pt">&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;double bounds_lon_grid_T(y_grid_T, x_grid_T, nvertex_grid_T) ; </span>
<span style="font-size:8pt">&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;byte mask_T(y_grid_T, x_grid_T) ; </span>
<span style="font-size:8pt">&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;mask_T:cell_measures = "area: area_grid_T" ; </span>
<span style="font-size:8pt">&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;mask_T:coordinates = "nav_lat_grid_T nav_lon_grid_T" ; </span>
<span style="font-size:8pt">&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;double nav_lat_grid_T(y_grid_T, x_grid_T) ; </span>
<span style="font-size:8pt">&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;nav_lat_grid_T:standard_name = "latitude" ; </span>
<span style="font-size:8pt">&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;nav_lat_grid_T:long_name = "Latitude" ; </span>
<span style="font-size:8pt">&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;nav_lat_grid_T:units = "degrees_north" ; </span>
<span style="font-size:8pt">&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;nav_lat_grid_T:bounds = "bounds_lat_grid_T" ; </span>
<span style="font-size:8pt">&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;double nav_lon_grid_T(y_grid_T, x_grid_T) ; </span>
<span style="font-size:8pt">&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;nav_lon_grid_T:standard_name = "longitude" ; </span>
<span style="font-size:8pt">&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;nav_lon_grid_T:long_name = "Longitude" ; </span>
<span style="font-size:8pt">&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;nav_lon_grid_T:units = "degrees_east" ; </span>
<span style="font-size:8pt">&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;nav_lon_grid_T:bounds = "bounds_lon_grid_T" ; </span>
<span style="font-size:8pt">data: </span>
<span style="font-size:8pt">bounds_lat_grid_T = </span>
<span style="font-size:8pt">&#xA0;-29.5895932339965, -29.5895932339965, -27.835621888657, -27.835621888657 ; </span>
<span style="font-size:8pt">bounds_lon_grid_T = </span>
<span style="font-size:8pt">&#xA0;156.999148343641, 158.999201071309, 158.999201071309, 156.999148343641 ; </span>
<span style="font-size:8pt">mask_T = </span>
<span style="font-size:8pt">&#xA0;1 ; </span>
<span style="font-size:8pt">nav_lat_grid_T = </span>
<span style="font-size:8pt">&#xA0;-28.7162844516478 ; </span>
<span style="font-size:8pt">nav_lon_grid_T = </span>
<span style="font-size:8pt">&#xA0;157.999608915878 ; </span>
<span style="font-size:8pt">}</span>

If I remove _grid_T suffix then the file is read correctly.
<span style="color:#000000;background-color:#ffffff">$ ncgen -o notok.nc notok.cdl
$ sed -e 's/_grid_T//g' notok.cdl &gt; ok.cdl</span>
$ ncgen -o ok.nc ok.cdl


Any idea on why there is the unexpected behaviour (test on names of dimensions) ?
</span></pre>
            <div>Patrick<br>
            </div>
            <div><span style="font-family:monospace"><br>
              </span></div>
            <div>--<br>
              Data Analytics and Visualization Engineer / Project
              Manager<br>
              LSCE/IPSL, CEA-CNRS-UVSQ laboratory<br>
              LSCE - Climate and Environment Sciences Laboratory<br>
              IPSL - Institut Pierre Simon Laplace<br>
              --<span style="font-family:monospace"><span
                  style="color:#000000;background-color:#ffffff">sed -e
                  's/_grid_T//g' tyty.cdl &gt; tyty1.cdl</span></span></div>
          </div>
          <br>
        </div>
      </div>
    </blockquote>
  


<!--X-Body-of-Message-End-->
<!--X-MsgBody-End-->
<!--X-Follow-Ups-->
<hr>
<!--X-Follow-Ups-End-->
<!--X-References-->
<ul><li><strong>References</strong>:
<ul>
<li><strong><a name="01010" href="msg01010.html">[ferret_users] inconsistent data grids: File needs axis attributes on coordinate variables indicating correct direction</a></strong>
<ul><li><em>From:</em> Patrick Brockmann</li></ul></li>
<li><strong><a name="01012" href="msg01012.html">Re: [ferret_users] inconsistent data grids: File needs axis attributes on coordinate variables indicating correct direction</a></strong>
<ul><li><em>From:</em> Patrick Brockmann</li></ul></li>
</ul></li></ul>
<!--X-References-End-->
<!--X-BotPNI-->
<UL>
<li>Previous by thread:
<strong><a href="msg01012.html">Re: [ferret_users] inconsistent data grids: File needs axis attributes on coordinate variables indicating correct direction</a></strong>
</li>
<li>Next by thread:
<strong><a href="msg01014.html">Re: [ferret_users] inconsistent data grids: File needs axis attributes on coordinate variables indicating correct direction</a></strong>
</li>

</UL>
<center>[<a href="msg01012.html">Thread Prev</a>][<a href="msg01014.html">Thread Next</a>][<A HREF="threads.html#01013">Index</A>]</center>

<!--X-BotPNI-End-->
<!--X-User-Footer-->
<A HREF="http://ferret.pmel.noaa.gov/Ferret/contact-us">Contact Us</A>
<br>
<font size=-1>
<address>
<a href="http://www.doc.gov">Dept of Commerce</a> /
<a href="http://www.noaa.gov">NOAA</a> /
<a href="http://www.oar.noaa.gov">OAR</a> /
<a href="http://www.pmel.noaa.gov">PMEL</a> /
<a href="http://ferret.pmel.noaa.gov">Ferret</a>
</address>

<br>
 <a href="http://www.noaa.gov/privacy.html">Privacy Policy</a> | <a href="http://www.noaa.gov/disclaimer.html">Disclaimer</a> | <a href="accessibility.html">Accessibility Statement</a> 

</font>
<!--X-User-Footer-End-->
</body>
</html>
