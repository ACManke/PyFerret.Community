<!-- MHonArc v2.6.18 -->
<!--X-Subject: Re: [ferret_users] rho_un calculation -->
<!--X-From-R13: Ivyyvnz Yrffyre &#45; @AOO Trqreny <jvyyvnz.f.xrffyreNabnn.tbi> -->
<!--X-Date: Wed, 1 May 2019 05:14:27 &#45;0700 -->
<!--X-Message-Id: 28798782&#45;409D&#45;4D3B&#45;A3F2&#45;3702ECE981C8@noaa.gov -->
<!--X-Content-Type: multipart/alternative -->
<!--X-Reference: DM6PR03MB4348AED64DF2290C9A61261BC53A0@DM6PR03MB4348.namprd03.prod.outlook.com -->
<!--X-Head-End-->
<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN"
        "http://www.w3.org/TR/html4/loose.dtd">
<html>
<head>
<title>Re: [ferret_users] rho_un calculation</title>
</head>
<body>
<!--X-Body-Begin-->
<!--X-User-Header-->
<!--X-User-Header-End-->
<!--X-TopPNI-->
<HR>
<center>[<a href="msg00153.html">Thread Prev</a>][<a href="msg00161.html">Thread Next</a>][<A HREF="threads.html#00155">Index</A>]</center>

<!--X-TopPNI-End-->
<!--X-MsgBody-->
<!--X-Subject-Header-Begin-->
<h1>Re: [ferret_users] rho_un calculation</h1>
<hr>
<!--X-Subject-Header-End-->
<!--X-Head-of-Message-->
<ul>
<li><strong>To</strong>: <strong>&quot;<a href="mailto:JoshAB1995@DOMAIN.HIDDEN">JoshAB1995@xxxxxxxxxxx</a>&quot; &lt;<a href="mailto:JoshAB1995@DOMAIN.HIDDEN">JoshAB1995@xxxxxxxxxxx</a>&gt;</strong></li>
<li><strong>Subject</strong>: <strong>Re: [ferret_users] rho_un calculation</strong></li>
<li><strong>From</strong>: <strong>William Kessler - NOAA Federal &lt;<a href="mailto:william.s.kessler@DOMAIN.HIDDEN">william.s.kessler@xxxxxxxx</a>&gt;</strong></li>
<li>Date: Wed, 1 May 2019 08:14:22 -0400</li>
<li>Arc-authentication-results: i=2; mx.google.com;       dkim=pass header.i=@noaa.gov header.s=google header.b=VwbfyTX6;       spf=pass (google.com: domain of <a href="mailto:william.s.kessler@DOMAIN.HIDDEN">william.s.kessler@xxxxxxxx</a> designates 209.85.220.41 as permitted sender) smtp.mailfrom=<a href="mailto:william.s.kessler@DOMAIN.HIDDEN">william.s.kessler@xxxxxxxx</a>;       dmarc=pass (p=REJECT sp=NONE dis=NONE) header.from=noaa.gov</li>
<li>Arc-authentication-results: i=1; mx.google.com;       dkim=pass header.i=@noaa.gov header.s=google header.b=VwbfyTX6;       spf=pass (google.com: domain of <a href="mailto:william.s.kessler@DOMAIN.HIDDEN">william.s.kessler@xxxxxxxx</a> designates 209.85.220.41 as permitted sender) smtp.mailfrom=<a href="mailto:william.s.kessler@DOMAIN.HIDDEN">william.s.kessler@xxxxxxxx</a>;       dmarc=pass (p=REJECT sp=NONE dis=NONE) header.from=noaa.gov</li>
<li>Arc-message-signature: i=2; a=rsa-sha256; c=relaxed/relaxed; d=google.com; s=arc-20160816;        h=list-archive:list-help:list-post:list-id:mailing-list:precedence:to         :references:message-id:content-transfer-encoding:cc:date:in-reply-to         :from:subject:mime-version:dkim-signature;        bh=mnAtVkogx2ctXx9IWHX2suyP9vBsW/oDi2kAGVJ47V0=;        b=FgFGaWYIDrQ932ENvjXlqcEtxM943G+BhdiI3sVPMqEYkXfyTOfjomS3HKQ1/Fg0FF         bhoV5/MM1CX9hLtcJDtgVPnLqRkcyUC7ojviJ3ftXMsLczr/zNuynLzHDkoiIavPOGe8         9ojbmlZ4JRfRlxBcJm6BGqxkZBJ8h+ThibrAGwtoBkEyOcjgMWg0VWO7RSSvf3v4pajx         ht0t786Rg3QV3l1pm83BYGnveg2MxVMBclKTd0B9T1rwBAd0zBlnN+G5rEPyF5NjAOv4         xtmjhbEVEs3QmS0Bc8m+a2d7x47VwHhc3NDwOKh8ytOrcx4byTalUK1SecDGtlaOD2o5         4cSg==</li>
<li>Arc-message-signature: i=1; a=rsa-sha256; c=relaxed/relaxed; d=google.com; s=arc-20160816;        h=to:references:message-id:content-transfer-encoding:cc:date         :in-reply-to:from:subject:mime-version:dkim-signature;        bh=mnAtVkogx2ctXx9IWHX2suyP9vBsW/oDi2kAGVJ47V0=;        b=iPY+noWNEnHHFjqFYroD8QANVghhZHlt3lBQp8VFb14K/ffNTWfW8rYQAat/tW36EQ         RGzW4F0r8yQl7RlZNFM3N9V0lVdXA9hmUC38/lEYZPtgO78okCs7CWRXSJ1GwbcysLMR         Y2uDe4/BLM54eZLMoXt4g2S2tJczDe5jT9TbhumAaKV31hjBBAni0RrPupbVyYa5svPW         vuFRPCa+P/J7lvie7NPNuE2TgLMSUWG6Y93bARdWabSDIp1J1gJKAhp0IRkl+NWS3pVr         yKsJbSN39P42dRxjTALTtaRfPwZLv/5qwguO2nCkqiNS5mssnIhsH67Xr9cv+dT3bWiC         47hQ==</li>
<li>Arc-seal: i=2; a=rsa-sha256; t=1556712866; cv=pass;        d=google.com; s=arc-20160816;        b=nax/WEk5LvqST8bDGHGw8YQ0yXYDQ7nqGDevuzLaa3vI0J3gQmq/TypNDG1aHIpaM1         cSdeAxiGcRwF4/o+GAIkYRIvPZBkqf6QOZ1g6S9s/3y8xtb/L17ZWOOwLzxOhngZVewV         cmwpBF95BPfo9fdxuDdaFuZGn9/VRKmzg7GXqAeqMweHexK3nPdjOONCEUuChELBu+fk         RYB4pihbDAvAbe+hqhOdbnmVxnN0LXVbvAvXkOIanhuA+3C9lfCNIQpEldzrIVh9d++n         ek5uKupPv7SzNqJLPE2+peAFcs/mHINPquIVFNHEtLPuMuG9QQUUsfbaz6YUf1ehkHnI         weUA==</li>
<li>Arc-seal: i=1; a=rsa-sha256; t=1556712865; cv=none;        d=google.com; s=arc-20160816;        b=b96oynnt966Ica82OXwfZCpgF9eli0h2oAqtyMv5WFi3A0Hrtml14Wd+ZDoKyTFf0X         Omsm3ASWQfE292wQ5ZjXslVldTf0IB/L3VPaECxPK8HSotLOje7OzIYukIWJNWCf7+4g         s4n+olgS7C4bzaoVkYZAC5o+eAJTbyRqcW5U3KcLbn3g2c16U0qjwQDOdbXynnMNoKqj         dcHSCYBrwmcBP3juseQtwW1kUDfoDv94lX8vB+Y9vCd8SAVrA1HjMikZZpZGwFSbp5ej         L5Jt7Lgjc6G93J8BrhSfHulvzcIaSAy0KjiAIOpfm6iYAYVw1OzQzfWYQ6T9ZIzcw94f         KZEw==</li>
<li>Cc: &quot;<a href="mailto:ferret_users@DOMAIN.HIDDEN">ferret_users@xxxxxxxx</a>&quot; &lt;<a href="mailto:ferret_users@DOMAIN.HIDDEN">ferret_users@xxxxxxxx</a>&gt;</li>
<li>Dkim-signature: v=1; a=rsa-sha256; c=relaxed/relaxed;        d=noaa.gov; s=google;        h=mime-version:subject:from:in-reply-to:date:cc         :content-transfer-encoding:message-id:references:to         :x-original-sender:x-original-authentication-results:precedence         :mailing-list:list-id:list-post:list-help:list-archive;        bh=mnAtVkogx2ctXx9IWHX2suyP9vBsW/oDi2kAGVJ47V0=;        b=O8CH05xRN5sLGUSvX59R0eBk7k0cxRE79HJCnO7XQkTcEz9XNaB+Pi96vgBCGEqnZC         uOl16TQmwoonXsCztNG6tLgGQ5/42eh/WQZ7KM4hHPG9gsvCBQlJkS4VpzxccCjEiq5J         gLOSRZbNC0fH/bMQavXHHzyklsuVPPhZIBRPx+8E81cbuIenEd62k+i7FTgN7HaywUV4         a3/oR4NlB9AqGRpdOhbYedVq6xYyIm34kAhLnJW2IQIPfDk9/lj5qvJOl0h/CnnliwAW         yQ9Jdtuevdx6pn90hAL16GcKfuFyv7sWWkAZB8plWMSrqBO4WiePNKwjyz9525RNUCWs         /7sA==</li>
<li>In-reply-to: &lt;<a href="msg00153.html">DM6PR03MB4348AED64DF2290C9A61261BC53A0@DM6PR03MB4348.namprd03.prod.outlook.com</a>&gt;</li>
<li>List-archive: &lt;<a href="https://groups.google.com/a/noaa.gov/group/ferret_users/">https://groups.google.com/a/noaa.gov/group/ferret_users/</a>&gt;</li>
<li>List-help: &lt;<a href="https://support.google.com/a/noaa.gov/bin/topic.py?topic=25838">https://support.google.com/a/noaa.gov/bin/topic.py?topic=25838</a>&gt;, &lt;<a href="mailto:ferret_users+help@noaa.gov">mailto:ferret_users+help@noaa.gov</a>&gt;</li>
<li>List-id: &lt;ferret_users.noaa.gov&gt;</li>
<li>List-post: &lt;<a href="https://groups.google.com/a/noaa.gov/group/ferret_users/post">https://groups.google.com/a/noaa.gov/group/ferret_users/post</a>&gt;, &lt;<a href="mailto:ferret_users@noaa.gov">mailto:ferret_users@noaa.gov</a>&gt;</li>
<li>Mailing-list: list <a href="mailto:ferret_users@DOMAIN.HIDDEN">ferret_users@xxxxxxxx</a>; contact <a href="mailto:ferret_users%2Bowners@DOMAIN.HIDDEN">ferret_users+owners@xxxxxxxx</a></li>
<li>References: &lt;<a href="msg00153.html">DM6PR03MB4348AED64DF2290C9A61261BC53A0@DM6PR03MB4348.namprd03.prod.outlook.com</a>&gt;</li>
<li>Sender: <a href="mailto:owner-ferret_users@DOMAIN.HIDDEN">owner-ferret_users@xxxxxxxx</a></li>
</ul>
<!--X-Head-of-Message-End-->
<!--X-Head-Body-Sep-Begin-->
<hr>
<!--X-Head-Body-Sep-End-->
<!--X-Body-of-Message-->
<table width="100%"><tr><td style=""><div dir="ltr"></div><div dir="ltr">You second script is correct. First one is not. When comparing densities at different depths, always use a consistent reference pressure. Thus sigma-theta (what you call &#x201C;surfdens&#x201D; in your second script). That is valid for comparing depths above about 1000m:</div><div dir="ltr"><br></div><div dir="ltr">strat_0_1000db=surfdens[z=1000]-surfdens[z=0]</div><div dir="ltr"><br></div><div dir="ltr">To compare deeper, then you need to use sigma2 (your &#x201C;benthdens&#x201D; or similar). That would allow, say:</div><div dir="ltr"><br></div><div dir="ltr">strat_1500_2500=benthdens[z=2500]-benthdens[z=1500]</div><div dir="ltr"><br></div><div dir="ltr">The point here is to use THETA_FO (function of depth and reference pressure) and RHO_UN (at reference depth) to get values comparable across z-ranges. These need a consistent reference pressure.</div><div dir="ltr"><br></div><div dir="ltr">Comparing density across very wide ranges (as you are trying to do with y250strat, using two different reference pressures) is harder, and generally not done. That garbles the combined effects of P,T,S in the nonlinear eqn of state to make values that are not comparable.</div><div dir="ltr"><br></div><div dir="ltr">But try the alternatives and see how different they are! That will give you an estimate of the uncertainty of these calculations. Sigma-theta may be ok until you are getting into the abyss. I.e. how different are surfdens and benthdens at 2000db?</div><div dir="ltr"><br>On Apr 30, 2019, at 10:33 AM, "<a rel="nofollow" href="mailto:JoshAB1995@xxxxxxxxxxx">JoshAB1995@xxxxxxxxxxx</a>" &lt;<a rel="nofollow" href="mailto:JoshAB1995@xxxxxxxxxxx">JoshAB1995@xxxxxxxxxxx</a>&gt; wrote:<br><br></div><blockquote type="cite"><div dir="ltr">






<div class="WordSection1">
<p class="MsoNormal">Hi guys,</p>
<p class="MsoNormal"><o:p>&nbsp;</o:p></p>
<p class="MsoNormal">I&#x2019;m currently calculating the density differences across the open ocean and have run into a little issue...</p>
<p class="MsoNormal"><o:p>&nbsp;</o:p></p>
<p class="MsoNormal">Slightly confused myself by finding two methods for calculating density on the expressions page, am I correct in thinking that:</p>
<p class="MsoNormal"><o:p>&nbsp;</o:p></p>
<p class="MsoNormal"><i><span style="font-family:&quot;inherit&quot;,serif;color:black;background:white">yes? Use &#x201C;./ECP85_sal.nc&#x201D;<o:p></o:p></span></i></p>
<p class="MsoNormal"><i><span style="font-family:&quot;inherit&quot;,serif;color:black;background:white">yes? Use &#x201C;./ECP85_temp.nc&#x201D;<o:p></o:p></span></i></p>
<p class="MsoNormal"><i><span style="font-family:&quot;inherit&quot;,serif;color:black;background:white">yes? SET REGION/I=1:36/J=1:36<o:p></o:p></span></i></p>
<p class="MsoNormal"><i><span style="font-family:&quot;inherit&quot;,serif;color:black;background:white">yes? LET salt = ocn_sal[d=1]</span></i><i><span style="font-size:10.5pt;font-family:&quot;Arial&quot;,sans-serif;color:black"><br>
</span></i><i><span style="font-family:&quot;inherit&quot;,serif;color:black;background:white">yes? LET t68 = 1.00024 * ocn_temp[d=2]</span></i><i><span style="font-size:10.5pt;font-family:&quot;Arial&quot;,sans-serif;color:black"><br>
</span></i><i><span style="font-family:&quot;inherit&quot;,serif;color:black;background:white">yes? LET dens = rho_un (salt[K=1], t68[K=1], Z[G=temp,K=1:10])<o:p></o:p></span></i></p>
<p class="MsoNormal"><i><span style="font-family:&quot;inherit&quot;,serif;color:black;background:white">yes? LET y250strat = dens[k=1,l=250] &#x2013; dens[k=10,l=250]<o:p></o:p></span></i></p>
<p class="MsoNormal"><i><span style="font-family:&quot;inherit&quot;,serif;color:black;background:white">yes? List y250strat</span><o:p></o:p></i></p>
<p class="MsoNormal"><o:p>&nbsp;</o:p></p>
<p class="MsoNormal">Would be less accurate than calculating with the following script, because it&#x2019;s generating the density based on surface water salinity and temperature values?:
</p>
<p class="MsoNormal"><o:p>&nbsp;</o:p></p>
<p class="MsoNormal"><i>yes? use "./ECP85_sal.nc"<o:p></o:p></i></p>
<p class="MsoNormal"><i>yes? use "./ECP85_temp.nc"<o:p></o:p></i></p>
<p class="MsoNormal"><i>yes? let temp=ocn_temp[d=2]*1.00024 !convert to different temp scale for accuracy<o:p></o:p></i></p>
<p class="MsoNormal"><i>yes? let salt=ocn_sal[d=1] <o:p></o:p></i></p>
<p class="MsoNormal"><i>yes? let potemp=THETA_FO(SALT, TEMP,Z[G=TEMP],0) !Define the potential temperature for surface ocean<o:p></o:p></i></p>
<p class="MsoNormal"><i>yes? let potemp2=THETA_FO(SALT,TEMP,Z[G=TEMP],2303.5) !Define the potential temperature for benthic ocean<o:p></o:p></i></p>
<p class="MsoNormal"><i>yes? let surfdens=rho_un(salt,potemp,0) !calculate density at surface 0 = dBar pressure<o:p></o:p></i></p>
<p class="MsoNormal"><i>yes? let benthdens=rho_un(salt,potemp2,2303.5) !calculate density at 2303.5m deep, with 2303.5dBar pressure<o:p></o:p></i></p>
<p class="MsoNormal"><i>yes? let y250strat= surfdens[k=1,l=250] - benthdens[k=12,l=250]<o:p></o:p></i></p>
<p class="MsoNormal"><i>yes? list y250strat<o:p></o:p></i></p>
<p class="MsoNormal"><o:p>&nbsp;</o:p></p>
<p class="MsoNormal">Also is there anything obviously wrong with the script I&#x2019;ve made? First time calculating ocean densities!</p>
<p class="MsoNormal"><o:p>&nbsp;</o:p></p>
<p class="MsoNormal">Cheers,</p>
<p class="MsoNormal">Josh</p>
<p class="MsoNormal"><o:p>&nbsp;</o:p></p>
<p class="MsoNormal">Sent from <a rel="nofollow" href="https://go.microsoft.com/fwlink/?LinkId=550986">
Mail</a> for Windows 10</p>
<p class="MsoNormal"><o:p>&nbsp;</o:p></p>
</div>


</div></blockquote></td></tr></table>
<!--X-Body-of-Message-End-->
<!--X-MsgBody-End-->
<!--X-Follow-Ups-->
<hr>
<ul><li><strong>Follow-Ups</strong>:
<ul>
<li><strong><a name="00161" href="msg00161.html">RE: [ferret_users] rho_un calculation</a></strong>
<ul><li><em>From:</em> JoshAB1995@xxxxxxxxxxx</li></ul></li>
</ul></li></ul>
<!--X-Follow-Ups-End-->
<!--X-References-->
<ul><li><strong>References</strong>:
<ul>
<li><strong><a name="00153" href="msg00153.html">[ferret_users] rho_un calculation</a></strong>
<ul><li><em>From:</em> JoshAB1995@xxxxxxxxxxx</li></ul></li>
</ul></li></ul>
<!--X-References-End-->
<!--X-BotPNI-->
<UL>
<li>Previous by thread:
<strong><a href="msg00153.html">[ferret_users] rho_un calculation</a></strong>
</li>
<li>Next by thread:
<strong><a href="msg00161.html">RE: [ferret_users] rho_un calculation</a></strong>
</li>

</UL>
<center>[<a href="msg00153.html">Thread Prev</a>][<a href="msg00161.html">Thread Next</a>][<A HREF="threads.html#00155">Index</A>]</center>

<!--X-BotPNI-End-->
<!--X-User-Footer-->
<A HREF="http://ferret.pmel.noaa.gov/Ferret/contact-us">Contact Us</A>
<br>
<font size=-1>
<address>
<a href="http://www.doc.gov">Dept of Commerce</a> /
<a href="http://www.noaa.gov">NOAA</a> /
<a href="http://www.oar.noaa.gov">OAR</a> /
<a href="http://www.pmel.noaa.gov">PMEL</a> /
<a href="http://ferret.pmel.noaa.gov">Ferret</a>
</address>

<br>
 <a href="http://www.noaa.gov/privacy.html">Privacy Policy</a> | <a href="http://www.noaa.gov/disclaimer.html">Disclaimer</a> | <a href="accessibility.html">Accessibility Statement</a> 

</font>
<!--X-User-Footer-End-->
</body>
</html>
