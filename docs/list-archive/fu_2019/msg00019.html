<!-- MHonArc v2.6.18 -->
<!--X-Subject: Re: Issue with sortl: [ferret_users] Percentile along time axis for gridded data -->
<!--X-From-R13: "Oafyrl Q. [naxr" <nafyrl.o.znaxrNabnn.tbi> -->
<!--X-Date: Mon, 4 Feb 2019 13:44:53 &#45;0800 -->
<!--X-Message-Id: 30711013&#45;c2a7&#45;04b7&#45;52b8&#45;d45f1312101b@noaa.gov -->
<!--X-Content-Type: multipart/alternative -->
<!--X-Reference: CAOs80NxHO=P0JV8V3E3KSsVVZ3ipdLx7f&#45;oTDqqtBjEAp2Y3RQ@mail.gmail.com -->
<!--X-Reference: 56FB2F57.2020603@csiro.au -->
<!--X-Reference: CAOs80Nwqf+8Btc3T5JcyBvxNtA6m_1qjNxfqrN_xwPA3xDsq+A@mail.gmail.com -->
<!--X-Head-End-->
<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN"
        "http://www.w3.org/TR/html4/loose.dtd">
<html>
<head>
<title>Re: Issue with sortl: [ferret_users] Percentile along time axis for gridded data</title>
</head>
<body>
<!--X-Body-Begin-->
<!--X-User-Header-->
<!--X-User-Header-End-->
<!--X-TopPNI-->
<HR>
<center>[<a href="msg00018.html">Thread Prev</a>][<a href="msg00020.html">Thread Next</a>][<A HREF="threads.html#00019">Index</A>]</center>

<!--X-TopPNI-End-->
<!--X-MsgBody-->
<!--X-Subject-Header-Begin-->
<h1>Re: Issue with sortl: [ferret_users] Percentile along time axis for gridded data</h1>
<hr>
<!--X-Subject-Header-End-->
<!--X-Head-of-Message-->
<ul>
<li><strong>To</strong>: <strong><a href="mailto:ferret_users@DOMAIN.HIDDEN">ferret_users@xxxxxxxx</a></strong></li>
<li><strong>Subject</strong>: <strong>Re: Issue with sortl: [ferret_users] Percentile along time axis for gridded data</strong></li>
<li><strong>From</strong>: <strong>&quot;Ansley C. Manke&quot; &lt;<a href="mailto:ansley.b.manke@DOMAIN.HIDDEN">ansley.b.manke@xxxxxxxx</a>&gt;</strong></li>
<li>Date: Mon, 4 Feb 2019 13:44:50 -0800</li>
<li>Arc-authentication-results: i=2; mx.google.com;       dkim=pass header.i=@noaa.gov header.s=google header.b=RfpIHr6A;       spf=pass (google.com: domain of <a href="mailto:ansley.b.manke@DOMAIN.HIDDEN">ansley.b.manke@xxxxxxxx</a> designates 209.85.220.41 as permitted sender) smtp.mailfrom=<a href="mailto:ansley.b.manke@DOMAIN.HIDDEN">ansley.b.manke@xxxxxxxx</a>;       dmarc=pass (p=REJECT sp=NONE dis=NONE) header.from=noaa.gov</li>
<li>Arc-authentication-results: i=1; mx.google.com;       dkim=pass header.i=@noaa.gov header.s=google header.b=RfpIHr6A;       spf=pass (google.com: domain of <a href="mailto:ansley.b.manke@DOMAIN.HIDDEN">ansley.b.manke@xxxxxxxx</a> designates 209.85.220.41 as permitted sender) smtp.mailfrom=<a href="mailto:ansley.b.manke@DOMAIN.HIDDEN">ansley.b.manke@xxxxxxxx</a>;       dmarc=pass (p=REJECT sp=NONE dis=NONE) header.from=noaa.gov</li>
<li>Arc-message-signature: i=2; a=rsa-sha256; c=relaxed/relaxed; d=google.com; s=arc-20160816;        h=list-archive:list-help:list-post:list-id:mailing-list:precedence         :content-language:in-reply-to:mime-version:user-agent:date         :message-id:from:references:to:subject:dkim-signature;        bh=VuAHrAfUqs6fhkKLHupUfiFqUSwyqQtr/UPpFagcTN0=;        b=0+2vGkB18UBD07uM4Q7MyFHTTcoY3ziuQI9q4gOTY3OyQNZBIXpVsJKaXNfy8d1VBu         L6+nYZyR57aQdjwbagBrdgcY8zCw/Vkj8SnO7xjmTh3Kvp9zgDbIybNyEYbGJQEQaWlp         g/ORwbhR2E6RfBk0O3FgGV4gehLskstNXQ16aR61MI9COIxnGycD4e9r5/QydnGkmwB+         vdhg3xnSwNbymnqkfl5AaC3ha6f+fSM5kYTXcoBkpyrPI0y77vt9dwMUvJ7bsanRCzY3         FQ1Qh3HkgbAS5DCVJj3HffRpy/fwJsUwbeQKcIkBJPHHNTeJIzsc4x4ySqGsz7F4SjtR         jSCQ==</li>
<li>Arc-message-signature: i=1; a=rsa-sha256; c=relaxed/relaxed; d=google.com; s=arc-20160816;        h=content-language:in-reply-to:mime-version:user-agent:date         :message-id:from:references:to:subject:dkim-signature;        bh=VuAHrAfUqs6fhkKLHupUfiFqUSwyqQtr/UPpFagcTN0=;        b=b+CDTVqF3B1XOzhyc7Y+vrUp+ZvYxA6r9H9huD0C0W0t+oCDwUdV4B/zpDxfnG58ZM         FYERlZ4ycdLJ9ghsAVHfo+HvYfRN0vukGgDme6ALvOAuqb4h06jvJHvhsuFG3vCRhBM0         6EaYElqCBzjrzxv3DuIZS6hZVZAe4Vvg22npz7UwjIUChf2sYpPHBMCSq4uVNSdjVfRD         goaTk+G+ttIdnhS9TnnhkJ+eI4wdRSkKEyzDdNrv08tPtmYrgbBDBaOD+GeveL8dBSe4         QPCjwuCrTTn8SdXHaa7dYI2tQtbfMhLj2TeQdJKo/DxLC+vuktm74cZCijrIxWBt66nY         ArIg==</li>
<li>Arc-seal: i=2; a=rsa-sha256; t=1549316693; cv=pass;        d=google.com; s=arc-20160816;        b=lWI/UNqRU6SbxjGPgn8d/cVqHQMZQvIvLI5Inq3evbfoD1+U6OySq8EVlEAkuIk+I6         RKaxAtdTP3TuihsywAzi8Gxga0S55yf/fY2bHyqv2YsORx11JLhZ5xfF3xp9AcO0GvFV         EkFRafdAcftScxLqLarRnSwqQ1XxWwu3TkyvN1aUW9OuiVvwfH5d1g/YuWzHoanQ/VoY         ZhWZuZVZ5PfFtqTipWq9WoHNdDh/gczd2GVkO0yuNuP1uZx+R1v/09v9UnlUT45ylGbg         gq+nAXNkCjFr8Vg46Qq8lX9I+N4unSrgjAP4OSWVJAe1MEKQPPOewZRoxn788B1mPRGF         DoyQ==</li>
<li>Arc-seal: i=1; a=rsa-sha256; t=1549316692; cv=none;        d=google.com; s=arc-20160816;        b=EbPGLAJauJwHdiaRS/lvQIhgbXWKWVEKHM7CkPPO3znMH+mfOFJNagwP4j90a/55QK         SR+1Qi5ddUpItZK60ezQVXXfMun8LxFa1l7aG83gnHL9/c3Yj9NDWYUCt4dfzcEBrbNt         ZGHV8JNsTnuuvYJ/FbZk8bnH3yXWT98pJS8RDAO25NP8Lht1k3Y38pjS6DTCpHDoMO7a         TaVvrGTv0jLSKcD9jSNHDwDBCY0EPKNJugrxayTBgLF4GlDE3KAoMlunCSFleFza5Smz         cBqZoB8+dY8narweyLgTtxBUlGBqnoAR0wsMvDJ2PAjaG9mx1eV75Gi71fOwTdTPvQ3s         tN/A==</li>
<li>Dkim-signature: v=1; a=rsa-sha256; c=relaxed/relaxed;        d=noaa.gov; s=google;        h=subject:to:references:from:message-id:date:user-agent:mime-version         :in-reply-to:content-language:x-original-sender         :x-original-authentication-results:precedence:mailing-list:list-id         :list-post:list-help:list-archive;        bh=VuAHrAfUqs6fhkKLHupUfiFqUSwyqQtr/UPpFagcTN0=;        b=WS4e5vHivfCT9FmlJvBUVGAuVZzmUkUltbRKNeYWzFf1Tkqyiu5gE8NDG6Geq4IIzG         PNSbka94o6aZupV6St98AJsV4XTQZv699Kijk08D/v3fQQTtiL2dD+3/8LfMI23Ah4rD         DYUsM33ZujJzKFJmNBcf8D7HzjPMZNyHCL6EFzfS4CM1QtVm7YRv7asOLR4a0OJj+p8B         lADxnTajs9WJBedXxr3Ixcnj+RdSRvqrxnxw7bvWdStZdvF7gujEG0g8Py/+5hoRMTXM         ITmsCUJrZMRIf9s48yNQnSZ1cPw1zgvqjeJnO5etbfHMALK7Nc11gki4m8aeQ4pxLeID         Cf5Q==</li>
<li>In-reply-to: &lt;<a href="msg00018.html">CAOs80Nwqf+8Btc3T5JcyBvxNtA6m_1qjNxfqrN_xwPA3xDsq+A@mail.gmail.com</a>&gt;</li>
<li>List-archive: &lt;<a href="https://groups.google.com/a/noaa.gov/group/ferret_users/">https://groups.google.com/a/noaa.gov/group/ferret_users/</a>&gt;</li>
<li>List-help: &lt;<a href="https://support.google.com/a/noaa.gov/bin/topic.py?topic=25838">https://support.google.com/a/noaa.gov/bin/topic.py?topic=25838</a>&gt;, &lt;<a href="mailto:ferret_users+help@noaa.gov">mailto:ferret_users+help@noaa.gov</a>&gt;</li>
<li>List-id: &lt;ferret_users.noaa.gov&gt;</li>
<li>List-post: &lt;<a href="https://groups.google.com/a/noaa.gov/group/ferret_users/post">https://groups.google.com/a/noaa.gov/group/ferret_users/post</a>&gt;, &lt;<a href="mailto:ferret_users@noaa.gov">mailto:ferret_users@noaa.gov</a>&gt;</li>
<li>Mailing-list: list <a href="mailto:ferret_users@DOMAIN.HIDDEN">ferret_users@xxxxxxxx</a>; contact <a href="mailto:ferret_users%2Bowners@DOMAIN.HIDDEN">ferret_users+owners@xxxxxxxx</a></li>
<li>References: &lt;CAOs80NxHO=P0JV8V3E3KSsVVZ3ipdLx7f-oTDqqtBjEAp2Y3RQ@mail.gmail.com&gt; &lt;56FB2F57.2020603@csiro.au&gt; &lt;<a href="msg00018.html">CAOs80Nwqf+8Btc3T5JcyBvxNtA6m_1qjNxfqrN_xwPA3xDsq+A@mail.gmail.com</a>&gt;</li>
<li>Sender: <a href="mailto:owner-ferret_users@DOMAIN.HIDDEN">owner-ferret_users@xxxxxxxx</a></li>
<li>User-agent: Mozilla/5.0 (Windows NT 6.1; WOW64; rv:60.0) Gecko/20100101 Thunderbird/60.5.0</li>
</ul>
<!--X-Head-of-Message-End-->
<!--X-Head-Body-Sep-Begin-->
<hr>
<!--X-Head-Body-Sep-End-->
<!--X-Body-of-Message-->
<table width="100%"><tr><td bgcolor="#FFFFFF" style="background-color: #FFFFFF; color: #000000; "><font color="#000000">
  
  
    <p>Hi Peng,</p>
    <p>I want to add my thanks to those of you who conversed among
      yourselves during the time when we were shut down. We're looking
      into possibilities for making the documentation remaining
      available even when the server where it resides is off-line.<br>
    </p>
    <p>I don't see why those indices are showing up as the result of the
      sortl function.&#xA0; It seems to get the right answer when they're
      used to sample the data and sort the values themselves.&#xA0; However
      as I'm sure you noticed, the sampled result is correct!</p>
    <p>I'll look into what's happening here.<br>
    </p>
    <blockquote>
      <p><tt>yes? list sst[i=90,j=45],sorted_by_time[i=90,j=45],
          samplel(sst[i=90,j=45],sorted_by_time[i=90,j=45])</tt><br>
        <tt>&#xA0;WARNING: Listed variables have ambiguous coordinates on
          axes: T,T</tt><br>
        <tt>&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0; DATA SET:
          /home/users/tmap/ferret/linux/fer_dsets/data/coads_climatology.cdf</tt><br>
        <tt>&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0; LONGITUDE: 161W</tt><br>
        <tt>&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0; LATITUDE: 1S</tt><br>
        <tt>&#xA0;Column&#xA0; 1: SST[T=01-JAN 00:45:31-DEC 06:34] is SEA SURFACE
          TEMPERATURE (Deg C)</tt><br>
        <tt>&#xA0;Column&#xA0; 2: SORTED_BY_TIME[T=0.5:12.5] is sorted indices</tt><br>
        <tt>&#xA0;Column&#xA0; 3:
          SAMPLEL(SST[I=90,J=45],SORTED_BY_TIME[I=90,J=45])[T=0.5:12.5]
          is SAMPLEL(SST[I=90,J=45],SORTED_BY_TIME[I=90,J=45])</tt><br>
        <tt>&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0; SST&#xA0; SORTED_ (C001,V008)</tt><br>
        <tt>L /&#xA0; 1:&#xA0; 26.82&#xA0;&#xA0;&#xA0; 1.00&#xA0;&#xA0; 26.82</tt><br>
        <tt>L /&#xA0; 2:&#xA0; 26.99&#xA0;&#xA0;&#xA0; 2.00&#xA0;&#xA0; 26.99</tt><br>
        <tt>L /&#xA0; 3:&#xA0; 27.47&#xA0;&#xA0; 12.00&#xA0;&#xA0; 27.02</tt><br>
        <tt>L /&#xA0; 4:&#xA0; 27.83&#xA0;&#xA0; 11.00&#xA0;&#xA0; 27.22</tt><br>
        <tt>L /&#xA0; 5:&#xA0; 27.96&#xA0;&#xA0;&#xA0; 9.00&#xA0;&#xA0; 27.33</tt><br>
        <tt>L /&#xA0; 6:&#xA0; 28.22&#xA0;&#xA0;&#xA0; 8.00&#xA0;&#xA0; 27.42</tt><br>
        <tt>L /&#xA0; 7:&#xA0; 27.96&#xA0;&#xA0;&#xA0; 3.00&#xA0;&#xA0; 27.47</tt><br>
        <tt>L /&#xA0; 8:&#xA0; 27.42&#xA0;&#xA0; 10.00&#xA0;&#xA0; 27.55</tt><br>
        <tt>L /&#xA0; 9:&#xA0; 27.33&#xA0;&#xA0;&#xA0; 4.00&#xA0;&#xA0; 27.83</tt><br>
        <tt>L / 10:&#xA0; 27.55&#xA0;&#xA0;&#xA0; 5.00&#xA0;&#xA0; 27.96</tt><br>
        <tt>L / 11:&#xA0; 27.22&#xA0;&#xA0;&#xA0; 7.00&#xA0;&#xA0; 27.96</tt><br>
        <tt>L / 12:&#xA0; 27.02&#xA0;&#xA0;&#xA0; 6.00&#xA0;&#xA0; 28.22</tt><br>
      </p>
    </blockquote>
    <br>
    <div class="moz-cite-prefix">On 2/4/2019 11:23 AM, Ge Peng - NOAA
      Affiliate wrote:<br>
    </div>
    <blockquote type="cite"
cite="">
      
      <div dir="ltr">
        <div dir="ltr">
          <div class="gmail_default" style="">
            <p class="MsoNormal" style="font-size:12pt;margin:0in 0in
              0.0001pt;font-family:Calibri,sans-serif"><a rel="nofollow" name="_GoBack"
                moz-do-not-send="true"></a><br>
            </p>
            <p class="MsoNormal" style="margin:0in 0in 0.0001pt"><font
                style="font-size:12pt" face="Calibri, sans-serif">&#xA0;</font><font
                style="" face="arial, helvetica, sans-serif">I am using
                the method provided by Russ a couple of years ago
                to compute percentile along time axis for gridded data
                of sea ice
                concentrations.</font></p>
            <p class="MsoNormal" style="margin:0in 0in 0.0001pt"><font
                face="arial, helvetica, sans-serif">&#xA0;</font></p>
            <p class="MsoNormal" style="margin:0in 0in 0.0001pt"><font
                face="arial, helvetica, sans-serif">The resultant
                Q-tiles are a bit of too scattered in the seasonal
                varying ice zone. I have worked with Russ directly
                during the shutdown &#x2013; Thank
                you, Russ, for your helpful suggestions. &#xA0;</font></p>
            <p class="MsoNormal" style="margin:0in 0in 0.0001pt"><font
                face="arial, helvetica, sans-serif">&#xA0;</font></p>
            <p class="MsoNormal" style="margin:0in 0in 0.0001pt"><font
                face="arial, helvetica, sans-serif">looking into it in
                more details, I am a bit of confused by
                the behavior of function sortl which does not seem to
                sort correctly in ldim at
                each I,j grid cell in the sense that the largest value
                should be sorted as the last.
                It can be demonstrated by the following ferret output.
                (I was using a much
                earlier version but have reinstalled the latest per
                Russ&#x2019;s suggestion. The results are the same.)</font></p>
            <p class="MsoNormal" style="margin:0in 0in 0.0001pt"><font
                face="arial, helvetica, sans-serif">&#xA0;</font></p>
            <p class="MsoNormal" style="margin:0in 0in 0.0001pt"><font
                face="arial, helvetica, sans-serif">Is this correct?</font></p>
            <p class="MsoNormal" style="margin:0in 0in 0.0001pt"><font
                face="arial, helvetica, sans-serif">&#xA0;</font></p>
            <p class="MsoNormal" style="margin:0in 0in 0.0001pt"><font
                face="arial, helvetica, sans-serif">Thanks,</font></p>
            <p class="MsoNormal" style="margin:0in 0in 0.0001pt"><font
                face="arial, helvetica, sans-serif">&#xA0;</font></p>
            <p class="MsoNormal" style="margin:0in 0in 0.0001pt"><font
                style="" face="arial, helvetica, sans-serif">--- Peng</font></p>
            <p class="MsoNormal" style="font-size:12pt;margin:0in 0in
              0.0001pt;font-family:Calibri,sans-serif">&#xA0;</p>
            <p class="MsoNormal" style="font-size:12pt;margin:0in 0in
              0.0001pt;font-family:Calibri,sans-serif">$ ferret</p>
            <p class="MsoNormal" style="font-size:12pt;margin:0in 0in
              0.0001pt;font-family:Calibri,sans-serif">&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;
              NOAA/PMEL TMAP</p>
            <p class="MsoNormal" style="font-size:12pt;margin:0in 0in
              0.0001pt;font-family:Calibri,sans-serif">&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;
              FERRET v7.44 (optimized)</p>
            <p class="MsoNormal" style="font-size:12pt;margin:0in 0in
              0.0001pt;font-family:Calibri,sans-serif">&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0; Linux
              3.10.0-957.1.3.el7.x86_64
              64-bit - 12/07/18</p>
            <p class="MsoNormal" style="font-size:12pt;margin:0in 0in
              0.0001pt;font-family:Calibri,sans-serif">&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;
              &#xA0;4-Feb-19 14:01</p>
            <p class="MsoNormal" style="font-size:12pt;margin:0in 0in
              0.0001pt;font-family:Calibri,sans-serif">&#xA0;</p>
            <p class="MsoNormal" style="font-size:12pt;margin:0in 0in
              0.0001pt;font-family:Calibri,sans-serif">yes? use
              coads_climatology</p>
            <p class="MsoNormal" style="font-size:12pt;margin:0in 0in
              0.0001pt;font-family:Calibri,sans-serif">yes? let
              numpoints=`sst,return=lend`</p>
            <p class="MsoNormal" style="font-size:12pt;margin:0in 0in
              0.0001pt;font-family:Calibri,sans-serif">&#xA0;!-&gt; DEFINE
              VARIABLE numpoints=12</p>
            <p class="MsoNormal" style="font-size:12pt;margin:0in 0in
              0.0001pt;font-family:Calibri,sans-serif">yes? let
              numlats=`sst,return=jend]`</p>
            <p class="MsoNormal" style="font-size:12pt;margin:0in 0in
              0.0001pt;font-family:Calibri,sans-serif">&#xA0;!-&gt; DEFINE
              VARIABLE numlats=90</p>
            <p class="MsoNormal" style="font-size:12pt;margin:0in 0in
              0.0001pt;font-family:Calibri,sans-serif">yes?
              let/title="sorted indices"
              sorted_by_time=sortl(sst[l=1:`numpoints`])</p>
            <p class="MsoNormal" style="font-size:12pt;margin:0in 0in
              0.0001pt;font-family:Calibri,sans-serif">&#xA0;!-&gt; DEFINE
              VARIABLE/title="sorted indices"
              sorted_by_time=sortl(sst[l=1:12])</p>
            <p class="MsoNormal" style="font-size:12pt;margin:0in 0in
              0.0001pt;font-family:Calibri,sans-serif">yes? list
              sst[i=90,j=45],sorted_by_time[i=90,j=45]</p>
            <p class="MsoNormal" style="font-size:12pt;margin:0in 0in
              0.0001pt;font-family:Calibri,sans-serif">&#xA0;WARNING: Listed
              variables have ambiguous coordinates on axes: T</p>
            <p class="MsoNormal" style="font-size:12pt;margin:0in 0in
              0.0001pt;font-family:Calibri,sans-serif">&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0; DATA
              SET:
/snfs1/users/gpeng/myFerret/fer_dsets/FerretDatasets-7.4/data/coads_climatology.cdf</p>
            <p class="MsoNormal" style="font-size:12pt;margin:0in 0in
              0.0001pt;font-family:Calibri,sans-serif">&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;
              LONGITUDE: 161W</p>
            <p class="MsoNormal" style="font-size:12pt;margin:0in 0in
              0.0001pt;font-family:Calibri,sans-serif">&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;
              LATITUDE:
              1S</p>
            <p class="MsoNormal" style="font-size:12pt;margin:0in 0in
              0.0001pt;font-family:Calibri,sans-serif">&#xA0;Column&#xA0; 1:
              SST[T=01-JAN 00:45:31-DEC 06:34] is SEA
              SURFACE TEMPERATURE (Deg C)</p>
            <p class="MsoNormal" style="font-size:12pt;margin:0in 0in
              0.0001pt;font-family:Calibri,sans-serif">&#xA0;Column&#xA0; 2:
              SORTED_BY_TIME[T=0.5:12.5] is sorted
              indices</p>
            <p class="MsoNormal" style="font-size:12pt;margin:0in 0in
              0.0001pt;font-family:Calibri,sans-serif">&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0; SST&#xA0;
              SORTED_BY_TIME</p>
            <p class="MsoNormal" style="font-size:12pt;margin:0in 0in
              0.0001pt;font-family:Calibri,sans-serif">L /&#xA0; 1:&#xA0; 26.82&#xA0;&#xA0;&#xA0;
              1.00</p>
            <p class="MsoNormal" style="font-size:12pt;margin:0in 0in
              0.0001pt;font-family:Calibri,sans-serif">L /&#xA0; 2: &#xA0;26.99&#xA0;&#xA0;&#xA0;
              2.00</p>
            <p class="MsoNormal" style="font-size:12pt;margin:0in 0in
              0.0001pt;font-family:Calibri,sans-serif">L /&#xA0; 3:&#xA0; 27.47&#xA0;&#xA0;
              12.00</p>
            <p class="MsoNormal" style="font-size:12pt;margin:0in 0in
              0.0001pt;font-family:Calibri,sans-serif">L /&#xA0; 4:&#xA0; 27.83&#xA0;&#xA0;
              11.00</p>
            <p class="MsoNormal" style="font-size:12pt;margin:0in 0in
              0.0001pt;font-family:Calibri,sans-serif">L /&#xA0; 5:&#xA0; 27.96&#xA0;&#xA0;&#xA0;
              9.00</p>
            <p class="MsoNormal" style="font-size:12pt;margin:0in 0in
              0.0001pt;font-family:Calibri,sans-serif"><b>L /&#xA0; 6:&#xA0;
                28.22&#xA0;&#xA0;&#xA0; 8.00</b></p>
            <p class="MsoNormal" style="font-size:12pt;margin:0in 0in
              0.0001pt;font-family:Calibri,sans-serif">L /&#xA0; 7:&#xA0; 27.96&#xA0;&#xA0;&#xA0;
              3.00</p>
            <p class="MsoNormal" style="font-size:12pt;margin:0in 0in
              0.0001pt;font-family:Calibri,sans-serif">L /&#xA0; 8:&#xA0; 27.42&#xA0;&#xA0;
              10.00</p>
            <p class="MsoNormal" style="font-size:12pt;margin:0in 0in
              0.0001pt;font-family:Calibri,sans-serif">L /&#xA0; 9:&#xA0; 27.33&#xA0;&#xA0;&#xA0;
              4.00</p>
            <p class="MsoNormal" style="font-size:12pt;margin:0in 0in
              0.0001pt;font-family:Calibri,sans-serif">L / 10:&#xA0; 27.55&#xA0;&#xA0;&#xA0;
              5.00</p>
            <p class="MsoNormal" style="font-size:12pt;margin:0in 0in
              0.0001pt;font-family:Calibri,sans-serif">L / 11:&#xA0; 27.22&#xA0;&#xA0;&#xA0;
              7.00</p>
            <p class="MsoNormal" style="font-size:12pt;margin:0in 0in
              0.0001pt;font-family:Calibri,sans-serif">L / 12:&#xA0; 27.02&#xA0;&#xA0;&#xA0;
              6.00</p>
            <p class="MsoNormal" style="font-size:12pt;margin:0in 0in
              0.0001pt;font-family:Calibri,sans-serif">&#xA0;</p>
          </div>
        </div>
        <br>
        <div class="gmail_quote">
          <div dir="ltr" class="gmail_attr">On Tue, Mar 29, 2016 at
            10:16 PM Russ Fiedler <a rel="nofollow" class="moz-txt-link-rfc2396E" href="mailto:russell.fiedler@xxxxxxxx">&lt;russell.fiedler@xxxxxxxx&gt;</a>
            wrote:<br>
          </div>
          <blockquote class="gmail_quote" style="margin:0px 0px 0px
            0.8ex;border-left:1px solid
            rgb(204,204,204);padding-left:1ex">
            <div bgcolor="#FFFFFF">
              <div class="gmail-m_-3865166786425923335moz-cite-prefix"><br>
                Hi Peng,<br>
                <br>
                I did this in the dim distant past by saving the sorted
                data to a file and then picked the appropriate values
                out.<br>
                <br>
                use coads_climatology<br>
                let numpoints=`sst,return=lend`<br>
                let numlats=`sst,return=jend]`<br>
                let/title="sorted indices"
                sorted_by_time=sortl(sst[l=1:`numpoints`])<br>
                <br>
                ! I found that I ran out of memory if I tried to sort
                too much for some GB sized datasets. It depends on the
                size of your dataset.<br>
                ! You might be able to make larger windows or even do it
                in one go.<br>
                <br>
                save/j=1/jlimits=1:`numlats`/clob/file=<a rel="nofollow"
                  href="http://sorted.nc" target="_blank"
                  moz-do-not-send="true">sorted.nc</a> sorted_by_time<br>
                repeat/j=2:`numlats` save/app/file=<a rel="nofollow"
                  href="http://sorted.nc" target="_blank"
                  moz-do-not-send="true">sorted.nc</a> sorted_by_time<br>
                <br>
                can var sorted_by_time<br>
                use sorted<br>
                <br>
                ! Make a variable with time indices<br>
                <br>
                let index_2d=0*x[g=sorted_by_time] +
                0*y[g=sorted_by_time] + l[g=sorted_by_time]<br>
                <br>
                ! Create an integrating kernel for the percentile wanted
                1 for the limit we want and missing elsewhere. <br>
                <br>
                !25 percentile say. Make sure at least 1 valid point is
                used<br>
                <br>
                let k25 = if l[g=index_2d] eq
                max(int(0.25*ignore0(sorted_by_time[l=1:`numpoints`@ngd])),1)
                then 1<br>
                <br>
                ! Show the indices used in the sorted data. Note that
                missing values are accounted for.<br>
                <br>
                <br>
                shade k25[l=@loc:1]<br>
                <br>
                ! Multiply by SST and sum&#xA0; up<br>
                <br>
                let sst_k25 =
                k25[gl=sst[d=coads_climatology]@asn]*sst[d=coads_climatology]<br>
                <br>
                let/title="sst at 25 percentile"
                sst25=sst_k25[l=1:`numpoints`@sum]<br>
                <br>
                shade sst25<br>
                <br>
                <br>
                Cheers,<br>
                Russ<br>
                <br>
                <br>
                On 30/03/16 05:32, Ge Peng - NOAA Affiliate wrote:<br>
              </div>
              <blockquote type="cite">
                <div dir="ltr">
                  <div>
                    <p class="MsoNormal">Found this message showing how
                      to find percentiles for 2-dimensional gridded
                      data:</p>
                    <p class="MsoNormal"><span style="line-height:115%"><a rel="nofollow"
class="gmail-m_-3865166786425923335moz-txt-link-freetext"
href="http://ferret.pmel.noaa.gov/Ferret/Mail_Archives/fu_2004/msg00632.html"
                          target="_blank" moz-do-not-send="true">http://ferret.pmel.noaa.gov/Ferret/Mail_Archives/fu_2004/msg00632.html</a></span></p>
                    <p class="MsoNormal"><br>
                    </p>
                    <p class="MsoNormal">However, I would like to
                      compute quantiles/percentiles along my time axis
                      at each grid cell of the 2-dimensional gridded
                      data. I.e., for each x and y, the percentiles are
                      done along the time axis with valid data points.
                      (We can ignore the z dimension for now.)</p>
                    <p class="MsoNormal"><br>
                    </p>
                    <p class="MsoNormal">I could take the time series at
                      each grid cell using nested repeat loop in x and y
                      dimensions, following the above example to sort
                      the data and place the ordered data onto the tiled
                      axis. </p>
                    <p class="MsoNormal"><br>
                    </p>
                    <p class="MsoNormal">It does not sound very
                      efficient to me. Has anyone done something similar
                      in ferret? Is there a better way to do this,
                      perhaps without nested repeat loops in both x and
                      y directions? </p>
                    <p class="MsoNormal"><br>
                    </p>
                    <p class="MsoNormal">Appreciate any help.</p>
                    <span
                      style="line-height:115%;font-family:Calibri,sans-serif">
                      <div><span
                          style="line-height:115%;font-family:Calibri,sans-serif"><br>
                        </span></div>
                      --- Peng</span><br clear="all">
                  </div>
                  <div><br>
                  </div>
                  -- <br>
                  <div
                    class="gmail-m_-3865166786425923335gmail_signature">
                    <div dir="ltr">
                      <div>
                        <div dir="ltr">
                          <div>
                            <div dir="ltr">
                              <div><span
style="color:rgb(51,51,51);font-family:Times;line-height:11.9886px;font-size:11px"><span
style="font-family:arial,helvetica,sans-serif"><b>Ge Peng, Ph.D</b><br>
                                    <b>Research Scholar</b><br>
                                  </span></span>
                                <p style="margin-bottom:0.0001pt"><font
                                    size="2" face="arial, helvetica,
                                    sans-serif">Cooperative
                                    Institute for Climate and
                                    Satellites,&#xA0;NC (CICS-NC)</font></p>
                                <p style="margin-bottom:0.0001pt"><font
                                    size="2" face="arial, helvetica,
                                    sans-serif">North
                                    Carolina State University (NCSU) and</font></p>
                                <p style="margin-bottom:0.0001pt"><font
                                    size="2" face="arial, helvetica,
                                    sans-serif">NOAA&#x2019;s
                                    National Centers for Environmental
                                    Information (NCEI)</font></p>
                                <p style="margin-bottom:0.0001pt"><font
                                    size="2" face="arial, helvetica,
                                    sans-serif">Center
                                    for Weather and Climate (CWC)</font></p>
                                <p style="margin-bottom:0.0001pt"><font
                                    size="2" face="arial, helvetica,
                                    sans-serif"><br>
                                  </font></p>
                                <span
                                  style="color:rgb(51,51,51);line-height:11.9886px"><font
                                    size="2" face="arial, helvetica,
                                    sans-serif">151 Patton Ave,
                                    Asheville, NC 28801<br>
                                    <a rel="nofollow" href="mailto:ge.peng@xxxxxxxx"
                                      target="_blank"
                                      moz-do-not-send="true">ge.peng@xxxxxxxx</a><br>
                                    o: +1 828 257 3009<br>
                                    f: &#xA0;+1 828 257 3002</font><br>
                                </span>
                                <p
style="color:rgb(51,51,51);font-family:Times;font-size:13.6364px;margin-bottom:0.0001pt;background-color:white"><span
style="font-family:arial,helvetica,sans-serif;font-size:10.9091px;line-height:11.9886px;text-align:-webkit-center">Following
                                    CICS-NC on&#xA0;</span><a rel="nofollow"
                                    href="http://www.facebook.com/cicsnc"
style="font-family:arial,helvetica,sans-serif;font-size:10.9091px;line-height:11.9886px;text-align:-webkit-center;color:rgb(38,58,143);text-decoration:none;font-weight:bold"
                                    target="_blank"
                                    moz-do-not-send="true">Facebook</a></p>
                                <table
style="max-width:100%;border-collapse:collapse;border-spacing:0px;color:rgb(51,51,51);font-size:14px;font-family:Times;line-height:12px"
                                  width="500" cellspacing="2"
                                  cellpadding="2" border="0">
                                  <tbody>
                                    <tr>
                                      <td width="71" height="71"
                                        align="center"><br>
                                      </td>
                                      <td valign="top"><br>
                                      </td>
                                    </tr>
                                  </tbody>
                                </table>
                              </div>
                            </div>
                          </div>
                        </div>
                      </div>
                    </div>
                  </div>
                </div>
              </blockquote>
              <br>
            </div>
          </blockquote>
        </div>
        <br clear="all">
        <div><br>
        </div>
        -- <br>
        <div dir="ltr" class="gmail_signature">
          <div dir="ltr">
            <div>
              <div dir="ltr">
                <div>
                  <div dir="ltr">
                    <div>
                      <div dir="ltr">
                        <div dir="ltr">
                          <div dir="ltr">
                            <p><b><span
style="font-size:9pt;font-family:Arial;color:rgb(51,51,51);background:white">Ge
                                  Peng, PhD</span></b><span
style="font-size:9pt;font-family:Arial;color:rgb(51,51,51);background:white"><br>
                                <b>Research Scholar</b><br>
                              </span><span
                                style="font-size:9pt;font-family:Arial;color:rgb(34,34,34)">Cooperative
                                Institute for Climate and Satellites -
                                NC (CICS-NC)/NCSU at</span><span
                                style="font-size:9pt;font-family:Times"></span></p>
                            <p><span
                                style="font-size:9pt;font-family:Arial;color:rgb(34,34,34)">NOAA&#x2019;s
                                National Centers for Environmental
                                Information (NCEI)</span><span
                                style="font-size:9pt;font-family:Times"></span></p>
                            <p><span
                                style="font-size:9pt;font-family:Arial;color:rgb(34,34,34)">Center
                                for Weather and Climate (CWC)</span><span
                                style="font-size:9pt;font-family:Times"></span></p>
                            <p><span
style="font-size:9pt;font-family:Arial;color:rgb(51,51,51);background:white">151
                                Patton Ave, Asheville, NC
                                28801<br>
                                <a rel="nofollow" moz-do-not-send="true"><span
                                    style="color:rgb(17,85,204)">+1 828
                                    257 3009</span></a>; <span
                                  style="color:rgb(17,85,204)"><a rel="nofollow"
                                    href="mailto:ge.peng@xxxxxxxx"
                                    target="_blank"
                                    moz-do-not-send="true">ge.peng@xxxxxxxx</a></span></span></p>
                            <p><span
                                style="font-size:9pt;font-family:Arial">ORCID:
                                http://</span><span
style="font-size:9pt;font-family:Arial;color:rgb(73,74,76);background-image:initial;background-position:initial;background-repeat:initial"><a rel="nofollow"
href="http://orcid.org/0000-0002-1986-9115" target="_blank"
                                  moz-do-not-send="true">orcid.org/0000-0002-1986-9115</a></span></p>
                            <p
style="color:rgb(51,51,51);font-family:Times;font-size:13.6364px;margin-bottom:0.0001pt;background-color:white"><span
style="font-family:arial,helvetica,sans-serif;font-size:10.9091px;line-height:11.9886px;text-align:-webkit-center">Following
                                CICS-NC on&#xA0;</span><a rel="nofollow"
                                href="http://www.facebook.com/cicsnc"
style="font-family:arial,helvetica,sans-serif;font-size:10.9091px;line-height:11.9886px;text-align:-webkit-center;color:rgb(38,58,143);text-decoration:none;font-weight:bold"
                                target="_blank" moz-do-not-send="true">Facebook</a></p>
                            <table
style="max-width:100%;border-collapse:collapse;border-spacing:0px;color:rgb(51,51,51);font-size:14px;font-family:Times;line-height:12px"
                              width="500" cellspacing="2"
                              cellpadding="2" border="0">
                              <tbody>
                                <tr>
                                  <td width="71" height="71"
                                    align="center"><br>
                                  </td>
                                  <td valign="top"><br>
                                  </td>
                                </tr>
                              </tbody>
                            </table>
                          </div>
                        </div>
                      </div>
                    </div>
                  </div>
                </div>
              </div>
            </div>
          </div>
        </div>
      </div>
    </blockquote>
  

</font></td></tr></table>
<!--X-Body-of-Message-End-->
<!--X-MsgBody-End-->
<!--X-Follow-Ups-->
<hr>
<ul><li><strong>Follow-Ups</strong>:
<ul>
<li><strong><a name="00020" href="msg00020.html">Re: Issue with sortl: [ferret_users] Percentile along time axis for gridded data</a></strong>
<ul><li><em>From:</em> Ansley C. Manke</li></ul></li>
</ul></li></ul>
<!--X-Follow-Ups-End-->
<!--X-References-->
<ul><li><strong>References</strong>:
<ul>
<li><strong><a name="00018" href="msg00018.html">Issue with sortl: [ferret_users] Percentile along time axis for gridded data</a></strong>
<ul><li><em>From:</em> Ge Peng - NOAA Affiliate</li></ul></li>
</ul></li></ul>
<!--X-References-End-->
<!--X-BotPNI-->
<UL>
<li>Previous by thread:
<strong><a href="msg00018.html">Issue with sortl: [ferret_users] Percentile along time axis for gridded data</a></strong>
</li>
<li>Next by thread:
<strong><a href="msg00020.html">Re: Issue with sortl: [ferret_users] Percentile along time axis for gridded data</a></strong>
</li>

</UL>
<center>[<a href="msg00018.html">Thread Prev</a>][<a href="msg00020.html">Thread Next</a>][<A HREF="threads.html#00019">Index</A>]</center>

<!--X-BotPNI-End-->
<!--X-User-Footer-->
<A HREF="http://ferret.pmel.noaa.gov/Ferret/contact-us">Contact Us</A>
<br>
<font size=-1>
<address>
<a href="http://www.doc.gov">Dept of Commerce</a> /
<a href="http://www.noaa.gov">NOAA</a> /
<a href="http://www.oar.noaa.gov">OAR</a> /
<a href="http://www.pmel.noaa.gov">PMEL</a> /
<a href="http://ferret.pmel.noaa.gov">Ferret</a>
</address>

<br>
 <a href="http://www.noaa.gov/privacy.html">Privacy Policy</a> | <a href="http://www.noaa.gov/disclaimer.html">Disclaimer</a> | <a href="accessibility.html">Accessibility Statement</a> 

</font>
<!--X-User-Footer-End-->
</body>
</html>
