<!-- MHonArc v2.6.18 -->
<!--X-Subject: Re: [ferret_users] printing filename and line number at error -->
<!--X-From-R13: "Oafyrl Q. [naxr" <nafyrl.o.znaxrNabnn.tbi> -->
<!--X-Date: Tue, 28 Jan 2020 11:00:35 &#45;0800 -->
<!--X-Message-Id: 0be56b79&#45;977c&#45;17ff&#45;f348&#45;a3e39d8b9d42@noaa.gov -->
<!--X-Content-Type: multipart/alternative -->
<!--X-Reference: 20200127153619.0a19cf13@gfi063209.klientdrift.uib.no -->
<!--X-Reference: CAEwQpaKMGfsm8L9atbnFA83o7kuq5ADe=vykH7PTf68D4g_VrA@mail.gmail.com -->
<!--X-Reference: 20200128100921.0314b5f3@gfi063209.klientdrift.uib.no -->
<!--X-Reference: 88e9ffce&#45;8354&#45;18b0&#45;6293&#45;358668f42710@noaa.gov -->
<!--X-Reference: CAKoe08TP9trvz13nB0EuaTyeuFVKA0fveFLEG6o5dtcV0FfCdQ@mail.gmail.com -->
<!--X-Head-End-->
<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN"
        "http://www.w3.org/TR/html4/loose.dtd">
<html>
<head>
<title>Re: [ferret_users] printing filename and line number at error</title>
</head>
<body>
<!--X-Body-Begin-->
<!--X-User-Header-->
<!--X-User-Header-End-->
<!--X-TopPNI-->
<HR>
<center>[<a href="msg00507.html">Thread Prev</a>][<a href="msg00509.html">Thread Next</a>][<A HREF="threads.html#00508">Index</A>]</center>

<!--X-TopPNI-End-->
<!--X-MsgBody-->
<!--X-Subject-Header-Begin-->
<h1>Re: [ferret_users] printing filename and line number at error</h1>
<hr>
<!--X-Subject-Header-End-->
<!--X-Head-of-Message-->
<ul>
<li><strong>To</strong>: <strong>Andrew Wittenberg - NOAA Federal &lt;<a href="mailto:andrew.wittenberg@DOMAIN.HIDDEN">andrew.wittenberg@xxxxxxxx</a>&gt;</strong></li>
<li><strong>Subject</strong>: <strong>Re: [ferret_users] printing filename and line number at error</strong></li>
<li><strong>From</strong>: <strong>&quot;Ansley C. Manke&quot; &lt;<a href="mailto:ansley.b.manke@DOMAIN.HIDDEN">ansley.b.manke@xxxxxxxx</a>&gt;</strong></li>
<li>Date: Tue, 28 Jan 2020 11:00:29 -0800</li>
<li>Arc-authentication-results: i=2; mx.google.com;       dkim=pass header.i=@noaa.gov header.s=google header.b=KR2ngEOL;       spf=pass (google.com: domain of <a href="mailto:ansley.b.manke@DOMAIN.HIDDEN">ansley.b.manke@xxxxxxxx</a> designates 209.85.220.41 as permitted sender) smtp.mailfrom=<a href="mailto:ansley.b.manke@DOMAIN.HIDDEN">ansley.b.manke@xxxxxxxx</a>;       dmarc=pass (p=REJECT sp=NONE dis=NONE) header.from=noaa.gov</li>
<li>Arc-authentication-results: i=1; mx.google.com;       dkim=pass header.i=@noaa.gov header.s=google header.b=KR2ngEOL;       spf=pass (google.com: domain of <a href="mailto:ansley.b.manke@DOMAIN.HIDDEN">ansley.b.manke@xxxxxxxx</a> designates 209.85.220.41 as permitted sender) smtp.mailfrom=<a href="mailto:ansley.b.manke@DOMAIN.HIDDEN">ansley.b.manke@xxxxxxxx</a>;       dmarc=pass (p=REJECT sp=NONE dis=NONE) header.from=noaa.gov</li>
<li>Arc-message-signature: i=2; a=rsa-sha256; c=relaxed/relaxed; d=google.com; s=arc-20160816;        h=list-archive:list-help:list-post:list-id:mailing-list:precedence         :content-language:in-reply-to:mime-version:user-agent:date         :message-id:from:references:cc:to:subject:dkim-signature;        bh=+1f38cqtNm51gq2GjPhX6a18XnOGyCgRmhb6N3sXzc8=;        b=0F6YG98vLqXpBOFWJCXTxMmzFc6jgTfsnmEjbNif4c1lWhCZdEhSewyPVmusERjwQT         dE7RDLEvSqRB9pai2B43iAjuRDe7NQ65YI7CVLLUqaYuRaHWFzerjbBZb09Ygaciwq7U         Kb4MGTFgT3eZFLBXQoiXrndOGJPG/IB+y9P7QwiN0pYRctgmT/17LaBhElqs41CVIqpJ         icLxe5UEWjaQN/Furf5J1vBpK7YrA7ICE9yJVwizYXmIuev8Cqo17a+g0JkL1Hos/Vpg         dgSg9Ppd9ggCR/ozRrxrMPaQQVAaEmdEGpZ6hZnQ9Y59pWhVkZW3gP6zduQ7dedtkGcD         WXWg==</li>
<li>Arc-message-signature: i=1; a=rsa-sha256; c=relaxed/relaxed; d=google.com; s=arc-20160816;        h=content-language:in-reply-to:mime-version:user-agent:date         :message-id:from:references:cc:to:subject:dkim-signature;        bh=+1f38cqtNm51gq2GjPhX6a18XnOGyCgRmhb6N3sXzc8=;        b=m9SZnRQnCbQAH6rTkFQ264Tt7388E1kr6SbhoLeyXVE4rGxGpZUj5SlhwWImvlBQKw         Dfqk9pxrp8BdUJu8GuJ/eul0ooJITckIRvtr0fAV5IpcGKBNqZOcJqeOx2DFUTpPh8Zu         9sE2RzmC+YQZN220f5C6x0ZZocnuXj2lGPbGiisPjScjABsBoFTDfMGD/KJu7zeBvlbQ         3nmfWTgwSdjf9h5PdlCJyagxmEW/bzl2PKnnyvFUeL6wUxxTMdXBL0IUy84vEVHa0jkg         pFD5ViTl+VDov/323djjfo1p+Ko51c76oX01oi2wo+2qFs3Mn9cBkiNPuPsXV3dzsIwV         4LWg==</li>
<li>Arc-seal: i=2; a=rsa-sha256; t=1580238034; cv=pass;        d=google.com; s=arc-20160816;        b=OByDow5oeJ7qySMcMlophOZnVuecDaToqGAD4zHBLM78Aq2BTiMTiKCWZodU2ktWkz         4G5z2euCyucgxxP2HpSmYj16SbTHWIBt4on8bG2CBbjpFidRt+btWAYcZpMxZzpcsVVH         XSpBntpEc5KfQ69HfG1ZkutFe+0ygUXQ/0FhsqEUEyr9jMnrrb0479hNqLWQ84jiUty9         1I3+baD6eIRrN17kv7a2111lpo/rc3lPo+JzaRbqFd04xA+3ZgbLSecHnQ0bPfGZvhOP         Xt5wG6Q1sbcw47mtbuJL6vAcOChePvO+SoTw87Qp0MMHdLrqZVSWUK76nJTc/TmwubWM         E2LQ==</li>
<li>Arc-seal: i=1; a=rsa-sha256; t=1580238033; cv=none;        d=google.com; s=arc-20160816;        b=lJ2M4WICg20w5RtJ7ivN/W4uRZYplZky9wOW8j8lHUE8GFqN27It/fBW68n2pFAJ7L         tKvIZmNOLKQ872eL1p9npHUwh3F5n5k2UktDvVf4XcjSiORscFIvfc+wys9R8j3KF+4l         7UAJ3k9TJnY/iZ+LlsXd/AZyc0DSE001sUMHAqWqgef+0wZvmaEh7qoYTlsHOz67R8T/         vpP8PH/4YopDT2mx2mBURkV4kD2bd24aSqxDqA9OgmiFhGPFFj3UYJV+d6l0Lc7aS/yH         VKKruiWIiwSyjfaOgRz0ItasLEBp28/8q4sF+uzwPQwYNwd4svmK/nRUw/gLKTebK0iF         ev9A==</li>
<li>Cc: <a href="mailto:ferret_users@DOMAIN.HIDDEN">ferret_users@xxxxxxxx</a></li>
<li>Dkim-signature: v=1; a=rsa-sha256; c=relaxed/relaxed;        d=noaa.gov; s=google;        h=subject:to:cc:references:from:message-id:date:user-agent         :mime-version:in-reply-to:content-language:x-original-sender         :x-original-authentication-results:precedence:mailing-list:list-id         :list-post:list-help:list-archive;        bh=+1f38cqtNm51gq2GjPhX6a18XnOGyCgRmhb6N3sXzc8=;        b=HqNL/086hip8FUG7j1xIGMExm7SC3B6hxwJl6uz2WJZQbR7+i9kXk4h9QXxSBtQbJX         VSdUD+7Ygz0L122polU7raTCjDeTgK5PzMP7vU1fiX9g9yOdSOCqSztiuRsTg/vFjrrg         lzIxgwqHYQGtfIGSLM/kRL/rxi/K5/uUlIwUIXrDi9nZAbJhhVOd9AltpGaFsXDwsvu0         /KOSd8GtwgOm1Bw2lIWW9+/lCmalfJloD8kEJ1+wizAlTSx790pttkUjaM0vWl22LITD         40x/wwWYp/pdqY+Z7e6TQXUdX1JtxK4/hUXJ6BDZ4XOvWk2AF+TNk4qgPgiNZRqYF3Rm         1gMA==</li>
<li>In-reply-to: &lt;<a href="msg00507.html">CAKoe08TP9trvz13nB0EuaTyeuFVKA0fveFLEG6o5dtcV0FfCdQ@mail.gmail.com</a>&gt;</li>
<li>List-archive: &lt;<a href="https://groups.google.com/a/noaa.gov/group/ferret_users/">https://groups.google.com/a/noaa.gov/group/ferret_users/</a>&gt;</li>
<li>List-help: &lt;<a href="https://support.google.com/a/noaa.gov/bin/topic.py?topic=25838">https://support.google.com/a/noaa.gov/bin/topic.py?topic=25838</a>&gt;, &lt;<a href="mailto:ferret_users+help@noaa.gov">mailto:ferret_users+help@noaa.gov</a>&gt;</li>
<li>List-id: &lt;ferret_users.noaa.gov&gt;</li>
<li>List-post: &lt;<a href="https://groups.google.com/a/noaa.gov/group/ferret_users/post">https://groups.google.com/a/noaa.gov/group/ferret_users/post</a>&gt;, &lt;<a href="mailto:ferret_users@noaa.gov">mailto:ferret_users@noaa.gov</a>&gt;</li>
<li>Mailing-list: list <a href="mailto:ferret_users@DOMAIN.HIDDEN">ferret_users@xxxxxxxx</a>; contact <a href="mailto:ferret_users%2Bowners@DOMAIN.HIDDEN">ferret_users+owners@xxxxxxxx</a></li>
<li>References: &lt;<a href="msg00502.html">20200127153619.0a19cf13@gfi063209.klientdrift.uib.no</a>&gt; &lt;CAEwQpaKMGfsm8L9atbnFA83o7kuq5ADe=vykH7PTf68D4g_VrA@mail.gmail.com&gt; &lt;<a href="msg00504.html">20200128100921.0314b5f3@gfi063209.klientdrift.uib.no</a>&gt; &lt;<a href="msg00506.html">88e9ffce-8354-18b0-6293-358668f42710@noaa.gov</a>&gt; &lt;<a href="msg00507.html">CAKoe08TP9trvz13nB0EuaTyeuFVKA0fveFLEG6o5dtcV0FfCdQ@mail.gmail.com</a>&gt;</li>
<li>Sender: <a href="mailto:owner-ferret_users@DOMAIN.HIDDEN">owner-ferret_users@xxxxxxxx</a></li>
<li>User-agent: Mozilla/5.0 (Windows NT 10.0; WOW64; rv:68.0) Gecko/20100101 Thunderbird/68.3.1</li>
</ul>
<!--X-Head-of-Message-End-->
<!--X-Head-Body-Sep-Begin-->
<hr>
<!--X-Head-Body-Sep-End-->
<!--X-Body-of-Message-->

  
  
    Hi Andrew,<br>
    <p>In general the text of the line is already reported, as executed,
      that is after parsing for symbol and grave-accent evaluations.&#xA0;
      So, for instance if I have a script</p>
    <blockquote><tt>! define_variable.jnl</tt><br>
      <tt>cancel mode verify</tt><br>
      <br>
      <tt>let ($varname) = 12</tt><br>
    </blockquote>
    <p>and I call it with a symbol value that will cause an error</p>
    <blockquote><tt>yes? set redirect/tee/clobber/file=run_script.log</tt><br>
      <br>
      <tt>yes? define symbol varname = 400</tt><br>
      <tt>yes? go define_variable </tt><br>
      <tt>! Enter_GO define_variable</tt><br>
      <tt>cancel mode verify</tt><br>
      <tt>&#xA0;**ERROR: command syntax: illegal name: 400</tt><br>
      <tt>DEFINE VARIABLE 400 = 12</tt><br>
      <tt>! Exit_GO</tt><br>
    </blockquote>
    <tt><br>
    </tt>
    <p>The result of the error-handling is the lines:<br>
      <br>
      <tt>&#xA0;**ERROR: command syntax: illegal name: 400</tt><br>
      <tt>DEFINE VARIABLE 400 = 12</tt></p>
    <p>And the "SET REDIRECT" at the start of the session has added the
      lines starting with ! Enter_GO and&#xA0;&#xA0; ! Exit_GO.<br>
    </p>
    <p>so we're proposing here, to amend this to something like</p>
    <p><tt>&#xA0;**ERROR: command syntax: illegal name: 400</tt><br>
      <tt>DEFINE VARIABLE 400 = 12<br>
        Running script define_variable.jnl</tt></p>
    <p>Or maybe that could coach us to go back and make use of SET
      REDIRECT.</p>
    <p><tt><br>
        &#xA0;
      </tt><tt><tt>**ERROR: </tt>...<br>
        Running script define_variable.jnl.&#xA0; Start session with SET
        REDIRECT for a complete log<br>
      </tt></p>
    <p>I'm not sure that any of this adds much more than the output of
      the SET REDIRECT log.&#xA0; Some ideas:<br>
    </p>
    <p>-- Maybe some options on FshowGO to list some more context on the
      GO commands? <br>
    </p>
    <p>-- The error listing shows the parsed command; also include the
      un-parsed command?</p>
    <p>-- A separate idea which is that when running interactively it'd
      be nice to be able to get at the name of the current script being
      run, for purposes of debugging a big tree of scripts.<br>
    </p>
    <p>-Ansley<br>
    </p>
    <div class="moz-cite-prefix">On 1/28/2020 9:52 AM, Andrew Wittenberg
      - NOAA Federal wrote:<br>
    </div>
    <blockquote type="cite"
cite="">
      
      <div dir="ltr">
        <div dir="ltr">
          <div class="gmail_default"
            style="font-family:arial,helvetica,sans-serif">Thanks
            Ansley!</div>
          <div class="gmail_default"
            style="font-family:arial,helvetica,sans-serif"><br>
          </div>
          <div class="gmail_default"
            style="font-family:arial,helvetica,sans-serif">I agree that
            (optionally) providing some context for error messages would
            be very helpful.&#xA0; Perhaps could be implemented as a MODE
            TRACEBACK.&#xA0; It could start with the name of the script, but
            could also be extended into a full hierarchical traceback
            showing the entire stack of calling scripts and the
            last-executed lines within them.</div>
          <div class="gmail_default"
            style="font-family:arial,helvetica,sans-serif"><br>
          </div>
          <div class="gmail_default"
            style="font-family:arial,helvetica,sans-serif">If printing
            out the line number isn't easy to do,&#xA0;then just as good
            would be to print out the text of the most recent line or
            command that was parsed.&#xA0; Presumably that text exists in
            some stack in Ferret?&#xA0; Then the user could easily grep
            through their script to locate that line.</div>
          <div class="gmail_default"
            style="font-family:arial,helvetica,sans-serif"><br>
          </div>
          <div class="gmail_default"
            style="font-family:arial,helvetica,sans-serif">Andrew</div>
        </div>
        <br>
        <div class="gmail_quote">
          <div dir="ltr" class="gmail_attr">On Tue, Jan 28, 2020 at
            12:19 PM Ansley C. Manke &lt;<a rel="nofollow"
              href="mailto:ansley.b.manke@xxxxxxxx"
              moz-do-not-send="true">ansley.b.manke@xxxxxxxx</a>&gt;
            wrote:<br>
          </div>
          <blockquote class="gmail_quote" style="margin:0px 0px 0px
            0.8ex;border-left:1px solid
            rgb(204,204,204);padding-left:1ex">Hi Marco<br>
            <br>
            I like the idea of including the name of the script in error
            messages.&#xA0; <br>
            I would make use of that.&#xA0; I'm not sure whether also
            including the <br>
            line-number would be easy to implement but we'll have a look
            at these ideas.<br>
            <br>
            Meanwhile a further tool is available for debugging.&#xA0;
            Starting with <br>
            Ferret v6.9, redirect the output to a log file using SET
            REDIRECT.&#xA0; Then <br>
            that log output includes lines that list entry and exit from
            scripts, <br>
            and the Unix tool FshowGO makes a listing of the go-script
            calls.&#xA0; This <br>
            is discussed here:<br>
            <br>
            <a rel="nofollow"
href="https://ferret.pmel.noaa.gov/Ferret/documentation/users-guide/commands-reference/SET#_VPINDEXENTRY_SET_REDIRECT"
              rel="noreferrer" target="_blank" moz-do-not-send="true">https://ferret.pmel.noaa.gov/Ferret/documentation/users-guide/commands-reference/SET#_VPINDEXENTRY_SET_REDIRECT</a><br>
            <a rel="nofollow"
href="https://ferret.pmel.noaa.gov/Ferret/documentation/users-guide/introduction/UNIX-TOOLS#_FshowGO"
              rel="noreferrer" target="_blank" moz-do-not-send="true">https://ferret.pmel.noaa.gov/Ferret/documentation/users-guide/introduction/UNIX-TOOLS#_FshowGO</a><br>
            <br>
            And one more thing:&#xA0; if your set of&#xA0; calls includes scripts
            that may <br>
            turn off mode verify, but you want to see the commands they
            run, start <br>
            the session with<br>
            <br>
            SET MODE VERIFY:always<br>
            <br>
            which causes any CANCEL MODE VERIFY commands to be ignored.<br>
            <br>
            -Ansley<br>
            <br>
            <br>
            On 1/28/2020 1:09 AM, Marco van Hulten wrote:<br>
            &gt; Ryo&#x2014;<br>
            &gt;<br>
            &gt; On 28 Jan 11:46 Ryo Furue wrote:<br>
            &gt;&gt; On Mon, Jan 27, 2020 at 11:39 PM Marco van Hulten
            &lt;<a rel="nofollow" href="mailto:Marco.Hulten@xxxxxx" target="_blank"
              moz-do-not-send="true">Marco.Hulten@xxxxxx</a>&gt;<br>
            &gt;&gt; wrote:<br>
            &gt;&gt;<br>
            &gt;&gt;&gt; When Ferret returns an error, is it possible to
            print the filename and<br>
            &gt;&gt;&gt; linenumber of the GO script?<br>
            &gt;&gt;&gt; [ . . . ]<br>
            &gt;&gt;&gt; This is especially useful in my case where I am
            using jnl scripts that<br>
            &gt;&gt;&gt; call other jnl scripts and so on.<br>
            &gt;&gt;&gt;&#xA0; &#xA0;<br>
            &gt;&gt; I would certainly appreciate such a feature.&#xA0; But,
            with "set mode verify",<br>
            &gt;&gt; you can usually track down where the error is.<br>
            &gt; Yes, that's true enough.&#xA0; I now initialise a variable
            "verbosity" and<br>
            &gt; then use this line at the start of my scripts:<br>
            &gt;<br>
            &gt;&#xA0; &#xA0; &#xA0; \if `verbosity lt 2` then cancel mode verify else
            set mode verify<br>
            &gt;<br>
            &gt; and cancel at the end of the script.&#xA0; That way VERIFY
            is disabled when<br>
            &gt; back at the prompt.<br>
            &gt;<br>
            &gt; &#x2014;Marco<br>
            &gt;<br>
          </blockquote>
        </div>
      </div>
    </blockquote>
  


<!--X-Body-of-Message-End-->
<!--X-MsgBody-End-->
<!--X-Follow-Ups-->
<hr>
<!--X-Follow-Ups-End-->
<!--X-References-->
<ul><li><strong>References</strong>:
<ul>
<li><strong><a name="00502" href="msg00502.html">[ferret_users] printing filename and line number at error</a></strong>
<ul><li><em>From:</em> Marco van Hulten</li></ul></li>
<li><strong><a name="00503" href="msg00503.html">Re: [ferret_users] printing filename and line number at error</a></strong>
<ul><li><em>From:</em> Ryo Furue</li></ul></li>
<li><strong><a name="00504" href="msg00504.html">Re: [ferret_users] printing filename and line number at error</a></strong>
<ul><li><em>From:</em> Marco van Hulten</li></ul></li>
<li><strong><a name="00506" href="msg00506.html">Re: [ferret_users] printing filename and line number at error</a></strong>
<ul><li><em>From:</em> Ansley C. Manke</li></ul></li>
<li><strong><a name="00507" href="msg00507.html">Re: [ferret_users] printing filename and line number at error</a></strong>
<ul><li><em>From:</em> Andrew Wittenberg - NOAA Federal</li></ul></li>
</ul></li></ul>
<!--X-References-End-->
<!--X-BotPNI-->
<UL>
<li>Previous by thread:
<strong><a href="msg00507.html">Re: [ferret_users] printing filename and line number at error</a></strong>
</li>
<li>Next by thread:
<strong><a href="msg00509.html">Re: [ferret_users] printing filename and line number at error</a></strong>
</li>

</UL>
<center>[<a href="msg00507.html">Thread Prev</a>][<a href="msg00509.html">Thread Next</a>][<A HREF="threads.html#00508">Index</A>]</center>

<!--X-BotPNI-End-->
<!--X-User-Footer-->
<A HREF="http://ferret.pmel.noaa.gov/Ferret/contact-us">Contact Us</A>
<br>
<font size=-1>
<address>
<a href="http://www.doc.gov">Dept of Commerce</a> /
<a href="http://www.noaa.gov">NOAA</a> /
<a href="http://www.oar.noaa.gov">OAR</a> /
<a href="http://www.pmel.noaa.gov">PMEL</a> /
<a href="http://ferret.pmel.noaa.gov">Ferret</a>
</address>

<br>
 <a href="http://www.noaa.gov/privacy.html">Privacy Policy</a> | <a href="http://www.noaa.gov/disclaimer.html">Disclaimer</a> | <a href="accessibility.html">Accessibility Statement</a> 

</font>
<!--X-User-Footer-End-->
</body>
</html>
