<!-- MHonArc v2.6.18 -->
<!--X-Subject: Re: Issue with sortl: [ferret_users] Percentile along time axis for gridded data -->
<!--X-From-R13: "Oafyrl Q. [naxr" <nafyrl.o.znaxrNabnn.tbi> -->
<!--X-Date: Mon, 4 Feb 2019 14:42:11 &#45;0800 -->
<!--X-Message-Id: 22c73b8e&#45;230c&#45;856c&#45;045c&#45;7b25d2cce9f9@noaa.gov -->
<!--X-Content-Type: multipart/alternative -->
<!--X-Reference: CAOs80NxHO=P0JV8V3E3KSsVVZ3ipdLx7f&#45;oTDqqtBjEAp2Y3RQ@mail.gmail.com -->
<!--X-Reference: 56FB2F57.2020603@csiro.au -->
<!--X-Reference: CAOs80Nwqf+8Btc3T5JcyBvxNtA6m_1qjNxfqrN_xwPA3xDsq+A@mail.gmail.com -->
<!--X-Reference: 30711013&#45;c2a7&#45;04b7&#45;52b8&#45;d45f1312101b@noaa.gov -->
<!--X-Head-End-->
<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN"
        "http://www.w3.org/TR/html4/loose.dtd">
<html>
<head>
<title>Re: Issue with sortl: [ferret_users] Percentile along time axis for gridded data</title>
</head>
<body>
<!--X-Body-Begin-->
<!--X-User-Header-->
<!--X-User-Header-End-->
<!--X-TopPNI-->
<HR>
<center>[<a href="msg00019.html">Thread Prev</a>][<a href="msg00021.html">Thread Next</a>][<A HREF="threads.html#00020">Index</A>]</center>

<!--X-TopPNI-End-->
<!--X-MsgBody-->
<!--X-Subject-Header-Begin-->
<h1>Re: Issue with sortl: [ferret_users] Percentile along time axis for gridded data</h1>
<hr>
<!--X-Subject-Header-End-->
<!--X-Head-of-Message-->
<ul>
<li><strong>To</strong>: <strong><a href="mailto:ferret_users@DOMAIN.HIDDEN">ferret_users@xxxxxxxx</a></strong></li>
<li><strong>Subject</strong>: <strong>Re: Issue with sortl: [ferret_users] Percentile along time axis for gridded data</strong></li>
<li><strong>From</strong>: <strong>&quot;Ansley C. Manke&quot; &lt;<a href="mailto:ansley.b.manke@DOMAIN.HIDDEN">ansley.b.manke@xxxxxxxx</a>&gt;</strong></li>
<li>Date: Mon, 4 Feb 2019 14:42:07 -0800</li>
<li>Arc-authentication-results: i=2; mx.google.com;       dkim=pass header.i=@noaa.gov header.s=google header.b=VxA+Z46z;       spf=pass (google.com: domain of <a href="mailto:ansley.b.manke@DOMAIN.HIDDEN">ansley.b.manke@xxxxxxxx</a> designates 209.85.220.41 as permitted sender) smtp.mailfrom=<a href="mailto:ansley.b.manke@DOMAIN.HIDDEN">ansley.b.manke@xxxxxxxx</a>;       dmarc=pass (p=REJECT sp=NONE dis=NONE) header.from=noaa.gov</li>
<li>Arc-authentication-results: i=1; mx.google.com;       dkim=pass header.i=@noaa.gov header.s=google header.b=VxA+Z46z;       spf=pass (google.com: domain of <a href="mailto:ansley.b.manke@DOMAIN.HIDDEN">ansley.b.manke@xxxxxxxx</a> designates 209.85.220.41 as permitted sender) smtp.mailfrom=<a href="mailto:ansley.b.manke@DOMAIN.HIDDEN">ansley.b.manke@xxxxxxxx</a>;       dmarc=pass (p=REJECT sp=NONE dis=NONE) header.from=noaa.gov</li>
<li>Arc-message-signature: i=2; a=rsa-sha256; c=relaxed/relaxed; d=google.com; s=arc-20160816;        h=list-archive:list-help:list-post:list-id:mailing-list:precedence         :content-language:in-reply-to:mime-version:user-agent:date         :message-id:references:to:from:subject:dkim-signature;        bh=W+myxHUaVE1VLqtubcIYOnmEl9ISmOYspVWeDeME2X4=;        b=GFmyCRphDMScnMnwuZeo2ZzFibrPHSLSkzPIp6AJj55puEg94IAonIBIPc3MJG/qAW         LEe1ptkgGzIabhg0lqdAjpKNnM5v3TmaUHoeo3PZW4u3lV/x3C8mqb2H7t14sPTCBlGc         JW7FSwQuBpSx2JKU/dCt7iaClxeuDD48EIHp9w8zyfRX84hoRnPSawTKxxzd4wV9CeIw         cSSC4vRNK2Xtlyu5rygemR46qFXWqvhx1u1f5+9ZUHaw7vrhw57H/f6k5VjjWLPFTa/F         WGFpdD6zqw6vOmiJKFShPgkYlj/w3j+6fnsBqItbYJtxIoCAj5DLsDLwrjsGcM9cD6k8         Srlw==</li>
<li>Arc-message-signature: i=1; a=rsa-sha256; c=relaxed/relaxed; d=google.com; s=arc-20160816;        h=content-language:in-reply-to:mime-version:user-agent:date         :message-id:references:to:from:subject:dkim-signature;        bh=W+myxHUaVE1VLqtubcIYOnmEl9ISmOYspVWeDeME2X4=;        b=M0wyvhu/3MmII3FOis8miS0jE7EZ4NlH8SYdO6Lg9nJi9RLx/KD5T7TkMLine7/m0V         bNCxywDy9PnJeN4De6TC/o9G6YRmktFA9PN9MY7Of/IAnQ1Llpv2v9kMeVMKdz9x++nl         rIK1MeioECnk7JCzf1hdgbvxck4xrh/RZKqmv94/QQN2MHMyY9funDlSpMIZtdZmEF/8         m85oWvhEMCH7FgtUNerCOFSG8aRjI+mLZH8pQIlGeadiwpCw9hYgY4Hjg7Cb59PEbq93         +crzYxOIWIjivhJNXuZs9TysyamLEFtNaZHscJNzv0VIVl1o6iytMM8dWxOVceonAwPa         3geQ==</li>
<li>Arc-seal: i=2; a=rsa-sha256; t=1549320130; cv=pass;        d=google.com; s=arc-20160816;        b=oEJ+SeAcvg4UrNwib8lCGULbppovGHsiUfs1NHgo0VdaseNIJRMs2j48y/Q7cti01r         wMKg/AWKAM2/msOyNhqSi0DBr7JOUjJ9zLRoivw82S8bPbeIMIkxu4E2Y109trnqvIq+         VnCIGmM0/4iPCFLmUN+4myC2kuGrM1bFHI0rnewaXZfy29BOuNfcVh/K+7tJ6cqCrWhA         yjj23BwbJoYrYgb8iq/w1HDbg+MIH2TeVv7q6hn17QZ80DKcS+1b+yHvg4UKDZRhVa4/         EISk+6wUt071RO0AqIZWg/ekkTPDAhcVs5W72WbEBFwXzYpafrHRGqIFDQd2iBJ1hL7s         cChA==</li>
<li>Arc-seal: i=1; a=rsa-sha256; t=1549320129; cv=none;        d=google.com; s=arc-20160816;        b=bI2IuwSXNz2FKVihjzWSY61tNfF4FsHBgY9+uLYqI8FScu6dopeICoK71DIIUPBxrC         ETFLuMEa2A8mEpO3vOVLRbTwCFtwwNEwsCtO9IKJQnsR0D95UwzN+6uKEiJC4ogIY57E         anZoxXLEaJ5eg+Qz2jRGZtfaoyhfD8rHl0egjLrt9V0E7Yu1zlWoByTp8dr4w7NpXp2U         0LZcIqKteSPjDa6rifQnIohlzGS25XYRiEURKz67+TqlYLztFA3ykgelktZaVvMhj4Wm         aHBJCZy7Kyb+uHHHehUXPguIfuDh1Ab8nYqhdWJ3hPp6n7+ZVcj7akT/0sWy3MkZT2av         48+A==</li>
<li>Dkim-signature: v=1; a=rsa-sha256; c=relaxed/relaxed;        d=noaa.gov; s=google;        h=subject:from:to:references:message-id:date:user-agent:mime-version         :in-reply-to:content-language:x-original-sender         :x-original-authentication-results:precedence:mailing-list:list-id         :list-post:list-help:list-archive;        bh=W+myxHUaVE1VLqtubcIYOnmEl9ISmOYspVWeDeME2X4=;        b=jdzITQQH1h4OlvusWyieBD8R6VLBzlJtgC4KGQVMqe/l7RMHR1JR7e/p8sedCobvc5         WDnhXq9Dz5xxkAXo9v1oviNOYJXa3NIDn2t9hH+hJ6ZX8QGn/0vpNUD9uhCs8l5iUulw         KVKmO9VxrwZZe0DTiR+iOk/Cec7kPwBozXN8poStFDDLU+Ux+V4kmXKm/IQfc3VLHkpD         HF7oUsijmYiKvOZMoSKz+F/14Aw9ZR1X6pZ4sZcknXlPAKYER+9sYsHoVxMtA5HyS4nr         KXTTjO7Mh85xiYFYQ9UBosq7h/+22g8AKjgdur1fObsDIKT6ELrJV44z/PI74Nk2U2US         HiSg==</li>
<li>In-reply-to: &lt;<a href="msg00019.html">30711013-c2a7-04b7-52b8-d45f1312101b@noaa.gov</a>&gt;</li>
<li>List-archive: &lt;<a href="https://groups.google.com/a/noaa.gov/group/ferret_users/">https://groups.google.com/a/noaa.gov/group/ferret_users/</a>&gt;</li>
<li>List-help: &lt;<a href="https://support.google.com/a/noaa.gov/bin/topic.py?topic=25838">https://support.google.com/a/noaa.gov/bin/topic.py?topic=25838</a>&gt;, &lt;<a href="mailto:ferret_users+help@noaa.gov">mailto:ferret_users+help@noaa.gov</a>&gt;</li>
<li>List-id: &lt;ferret_users.noaa.gov&gt;</li>
<li>List-post: &lt;<a href="https://groups.google.com/a/noaa.gov/group/ferret_users/post">https://groups.google.com/a/noaa.gov/group/ferret_users/post</a>&gt;, &lt;<a href="mailto:ferret_users@noaa.gov">mailto:ferret_users@noaa.gov</a>&gt;</li>
<li>Mailing-list: list <a href="mailto:ferret_users@DOMAIN.HIDDEN">ferret_users@xxxxxxxx</a>; contact <a href="mailto:ferret_users%2Bowners@DOMAIN.HIDDEN">ferret_users+owners@xxxxxxxx</a></li>
<li>References: &lt;CAOs80NxHO=P0JV8V3E3KSsVVZ3ipdLx7f-oTDqqtBjEAp2Y3RQ@mail.gmail.com&gt; &lt;56FB2F57.2020603@csiro.au&gt; &lt;<a href="msg00018.html">CAOs80Nwqf+8Btc3T5JcyBvxNtA6m_1qjNxfqrN_xwPA3xDsq+A@mail.gmail.com</a>&gt; &lt;<a href="msg00019.html">30711013-c2a7-04b7-52b8-d45f1312101b@noaa.gov</a>&gt;</li>
<li>Sender: <a href="mailto:owner-ferret_users@DOMAIN.HIDDEN">owner-ferret_users@xxxxxxxx</a></li>
<li>User-agent: Mozilla/5.0 (Windows NT 6.1; WOW64; rv:60.0) Gecko/20100101 Thunderbird/60.5.0</li>
</ul>
<!--X-Head-of-Message-End-->
<!--X-Head-Body-Sep-Begin-->
<hr>
<!--X-Head-Body-Sep-End-->
<!--X-Body-of-Message-->
<table width="100%"><tr><td bgcolor="#FFFFFF" style="background-color: #FFFFFF; color: #000000; "><font color="#000000">
  
  
    Hi Peng,<br>
    The results are correct.&#xA0; The SORTL&#xA0; values are telling how to
    sample the original list to get the data into ascending order.&#xA0; So,
    <br>
    <blockquote><tt>yes? list sst[i=90,j=45],sorted_by_time[i=90,j=45]</tt><tt><br>
      </tt><tt>&#xA0;WARNING: Listed variables have ambiguous coordinates on
        axes: T</tt><tt><br>
      </tt><tt>&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0; DATA SET:
        /home/users/tmap/ferret/linux/fer_dsets/data/coads_climatology.cdf</tt><tt><br>
      </tt><tt>&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0; LONGITUDE: 161W</tt><tt><br>
      </tt><tt>&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0; LATITUDE: 1S</tt><tt><br>
      </tt><tt>&#xA0;Column&#xA0; 1: SST[T=01-JAN 00:45:31-DEC 06:34] is SEA
        SURFACE TEMPERATURE (Deg C)</tt><tt><br>
      </tt><tt>&#xA0;Column&#xA0; 2: SORTED_BY_TIME[T=0.5:12.5] is sorted indices</tt><tt><br>
      </tt><tt>&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0; SST&#xA0; SORTED_BY_TIME</tt><tt><br>
      </tt><tt>L /&#xA0; 1:&#xA0; 26.82&#xA0;&#xA0;&#xA0; 1.00</tt><tt><br>
      </tt><tt>L /&#xA0; 2:&#xA0; 26.99&#xA0;&#xA0;&#xA0; 2.00</tt><tt><br>
      </tt><tt>L /&#xA0; 3:&#xA0; 27.47&#xA0;&#xA0; 12.00</tt><tt><br>
      </tt><tt>L /&#xA0; 4:&#xA0; 27.83&#xA0;&#xA0; 11.00</tt><tt><br>
      </tt><tt>L /&#xA0; 5:&#xA0; 27.96&#xA0;&#xA0;&#xA0; 9.00</tt><tt><br>
      </tt><tt>L /&#xA0; 6:&#xA0; 28.22&#xA0;&#xA0;&#xA0; 8.00</tt><tt><br>
      </tt><tt>L /&#xA0; 7:&#xA0; 27.96&#xA0;&#xA0;&#xA0; 3.00</tt><tt><br>
      </tt><tt>L /&#xA0; 8:&#xA0; 27.42&#xA0;&#xA0; 10.00</tt><tt><br>
      </tt><tt>L /&#xA0; 9:&#xA0; 27.33&#xA0;&#xA0;&#xA0; 4.00</tt><tt><br>
      </tt><tt>L / 10:&#xA0; 27.55&#xA0;&#xA0;&#xA0; 5.00</tt><tt><br>
      </tt><tt>L / 11:&#xA0; 27.22&#xA0;&#xA0;&#xA0; 7.00</tt><tt><br>
      </tt><tt>L / 12:&#xA0; 27.02&#xA0;&#xA0;&#xA0; 6.00</tt></blockquote>
    <p>says, to sort the data, we will first take element 1, then
      element 2, then element 12, then element 11, and so forth, ending
      with element 7 then element 6 which is the largest.&#xA0; Like you I
      first thought they were a ranking of the sizes, but they're the
      index locations of the sorted data. <br>
    </p>
    By the way, the note, <tt><br>
    </tt><tt>&#xA0;WARNING: Listed variables have ambiguous coordinates on
      axes: T<br>
    </tt>
    <p>is telling us that the SST data is on a formatted-time axis, time
      in hours since the origin, or whatever it is for a given axis, but
      the SORTL function returns a simple list L=1:12 on an abstract
      axis. Ferret is able to reconcile those two time axes, but the
      warning's there in case the user doesn't want it to assume it can
      associate the two variables just index by index.</p>
    <p>Ansley<br>
    </p>
    <div class="moz-cite-prefix">On 2/4/2019 1:44 PM, Ansley C. Manke
      wrote:<br>
    </div>
    <blockquote type="cite"
      cite="">
      
      <p>Hi Peng,</p>
      <p>I want to add my thanks to those of you who conversed among
        yourselves during the time when we were shut down. We're looking
        into possibilities for making the documentation remaining
        available even when the server where it resides is off-line.<br>
      </p>
      <p>I don't see why those indices are showing up as the result of
        the sortl function.&#xA0; It seems to get the right answer when
        they're used to sample the data and sort the values themselves.&#xA0;
        However as I'm sure you noticed, the sampled result is correct!</p>
      <p>I'll look into what's happening here.<br>
      </p>
      <blockquote>
        <p><tt>yes? list sst[i=90,j=45],sorted_by_time[i=90,j=45],
            samplel(sst[i=90,j=45],sorted_by_time[i=90,j=45])</tt><br>
          <tt>&#xA0;WARNING: Listed variables have ambiguous coordinates on
            axes: T,T</tt><br>
          <tt>&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0; DATA SET:
            /home/users/tmap/ferret/linux/fer_dsets/data/coads_climatology.cdf</tt><br>
          <tt>&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0; LONGITUDE: 161W</tt><br>
          <tt>&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0; LATITUDE: 1S</tt><br>
          <tt>&#xA0;Column&#xA0; 1: SST[T=01-JAN 00:45:31-DEC 06:34] is SEA
            SURFACE TEMPERATURE (Deg C)</tt><br>
          <tt>&#xA0;Column&#xA0; 2: SORTED_BY_TIME[T=0.5:12.5] is sorted indices</tt><br>
          <tt>&#xA0;Column&#xA0; 3:
            SAMPLEL(SST[I=90,J=45],SORTED_BY_TIME[I=90,J=45])[T=0.5:12.5]
            is SAMPLEL(SST[I=90,J=45],SORTED_BY_TIME[I=90,J=45])</tt><br>
          <tt>&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0; SST&#xA0; SORTED_ (C001,V008)</tt><br>
          <tt>L /&#xA0; 1:&#xA0; 26.82&#xA0;&#xA0;&#xA0; 1.00&#xA0;&#xA0; 26.82</tt><br>
          <tt>L /&#xA0; 2:&#xA0; 26.99&#xA0;&#xA0;&#xA0; 2.00&#xA0;&#xA0; 26.99</tt><br>
          <tt>L /&#xA0; 3:&#xA0; 27.47&#xA0;&#xA0; 12.00&#xA0;&#xA0; 27.02</tt><br>
          <tt>L /&#xA0; 4:&#xA0; 27.83&#xA0;&#xA0; 11.00&#xA0;&#xA0; 27.22</tt><br>
          <tt>L /&#xA0; 5:&#xA0; 27.96&#xA0;&#xA0;&#xA0; 9.00&#xA0;&#xA0; 27.33</tt><br>
          <tt>L /&#xA0; 6:&#xA0; 28.22&#xA0;&#xA0;&#xA0; 8.00&#xA0;&#xA0; 27.42</tt><br>
          <tt>L /&#xA0; 7:&#xA0; 27.96&#xA0;&#xA0;&#xA0; 3.00&#xA0;&#xA0; 27.47</tt><br>
          <tt>L /&#xA0; 8:&#xA0; 27.42&#xA0;&#xA0; 10.00&#xA0;&#xA0; 27.55</tt><br>
          <tt>L /&#xA0; 9:&#xA0; 27.33&#xA0;&#xA0;&#xA0; 4.00&#xA0;&#xA0; 27.83</tt><br>
          <tt>L / 10:&#xA0; 27.55&#xA0;&#xA0;&#xA0; 5.00&#xA0;&#xA0; 27.96</tt><br>
          <tt>L / 11:&#xA0; 27.22&#xA0;&#xA0;&#xA0; 7.00&#xA0;&#xA0; 27.96</tt><br>
          <tt>L / 12:&#xA0; 27.02&#xA0;&#xA0;&#xA0; 6.00&#xA0;&#xA0; 28.22</tt><br>
        </p>
      </blockquote>
      <br>
      <div class="moz-cite-prefix">On 2/4/2019 11:23 AM, Ge Peng - NOAA
        Affiliate wrote:<br>
      </div>
      <blockquote type="cite"
cite="">
        
        <div dir="ltr">
          <div dir="ltr">
            <div class="gmail_default" style="">
              <p class="MsoNormal" style="font-size:12pt;margin:0in 0in
                0.0001pt;font-family:Calibri,sans-serif"><a rel="nofollow"
                  name="_GoBack" moz-do-not-send="true"></a><br>
              </p>
              <p class="MsoNormal" style="margin:0in 0in 0.0001pt"><font
                  style="font-size:12pt" face="Calibri, sans-serif">&#xA0;</font><font
                  style="" face="arial, helvetica, sans-serif">I am
                  using the method provided by Russ a couple of years
                  ago to compute percentile along time axis for gridded
                  data of sea ice concentrations.</font></p>
              <p class="MsoNormal" style="margin:0in 0in 0.0001pt"><font
                  face="arial, helvetica, sans-serif">&#xA0;</font></p>
              <p class="MsoNormal" style="margin:0in 0in 0.0001pt"><font
                  face="arial, helvetica, sans-serif">The resultant
                  Q-tiles are a bit of too scattered in the seasonal
                  varying ice zone. I have worked with Russ directly
                  during the shutdown &#x2013; Thank you, Russ, for your
                  helpful suggestions. &#xA0;</font></p>
              <p class="MsoNormal" style="margin:0in 0in 0.0001pt"><font
                  face="arial, helvetica, sans-serif">&#xA0;</font></p>
              <p class="MsoNormal" style="margin:0in 0in 0.0001pt"><font
                  face="arial, helvetica, sans-serif">looking into it in
                  more details, I am a bit of confused by the behavior
                  of function sortl which does not seem to sort
                  correctly in ldim at each I,j grid cell in the sense
                  that the largest value should be sorted as the last.
                  It can be demonstrated by the following ferret output.
                  (I was using a much earlier version but have
                  reinstalled the latest per Russ&#x2019;s suggestion. The
                  results are the same.)</font></p>
              <p class="MsoNormal" style="margin:0in 0in 0.0001pt"><font
                  face="arial, helvetica, sans-serif">&#xA0;</font></p>
              <p class="MsoNormal" style="margin:0in 0in 0.0001pt"><font
                  face="arial, helvetica, sans-serif">Is this correct?</font></p>
              <p class="MsoNormal" style="margin:0in 0in 0.0001pt"><font
                  face="arial, helvetica, sans-serif">&#xA0;</font></p>
              <p class="MsoNormal" style="margin:0in 0in 0.0001pt"><font
                  face="arial, helvetica, sans-serif">Thanks,</font></p>
              <p class="MsoNormal" style="margin:0in 0in 0.0001pt"><font
                  face="arial, helvetica, sans-serif">&#xA0;</font></p>
              <p class="MsoNormal" style="margin:0in 0in 0.0001pt"><font
                  style="" face="arial, helvetica, sans-serif">--- Peng</font></p>
              <p class="MsoNormal" style="font-size:12pt;margin:0in 0in
                0.0001pt;font-family:Calibri,sans-serif">&#xA0;</p>
              <p class="MsoNormal" style="font-size:12pt;margin:0in 0in
                0.0001pt;font-family:Calibri,sans-serif">$ ferret</p>
              <p class="MsoNormal" style="font-size:12pt;margin:0in 0in
                0.0001pt;font-family:Calibri,sans-serif">&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;
                NOAA/PMEL TMAP</p>
              <p class="MsoNormal" style="font-size:12pt;margin:0in 0in
                0.0001pt;font-family:Calibri,sans-serif">&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;
                FERRET v7.44 (optimized)</p>
              <p class="MsoNormal" style="font-size:12pt;margin:0in 0in
                0.0001pt;font-family:Calibri,sans-serif">&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;
                Linux 3.10.0-957.1.3.el7.x86_64 64-bit - 12/07/18</p>
              <p class="MsoNormal" style="font-size:12pt;margin:0in 0in
                0.0001pt;font-family:Calibri,sans-serif">&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;
                &#xA0;4-Feb-19 14:01</p>
              <p class="MsoNormal" style="font-size:12pt;margin:0in 0in
                0.0001pt;font-family:Calibri,sans-serif">&#xA0;</p>
              <p class="MsoNormal" style="font-size:12pt;margin:0in 0in
                0.0001pt;font-family:Calibri,sans-serif">yes? use
                coads_climatology</p>
              <p class="MsoNormal" style="font-size:12pt;margin:0in 0in
                0.0001pt;font-family:Calibri,sans-serif">yes? let
                numpoints=`sst,return=lend`</p>
              <p class="MsoNormal" style="font-size:12pt;margin:0in 0in
                0.0001pt;font-family:Calibri,sans-serif">&#xA0;!-&gt; DEFINE
                VARIABLE numpoints=12</p>
              <p class="MsoNormal" style="font-size:12pt;margin:0in 0in
                0.0001pt;font-family:Calibri,sans-serif">yes? let
                numlats=`sst,return=jend]`</p>
              <p class="MsoNormal" style="font-size:12pt;margin:0in 0in
                0.0001pt;font-family:Calibri,sans-serif">&#xA0;!-&gt; DEFINE
                VARIABLE numlats=90</p>
              <p class="MsoNormal" style="font-size:12pt;margin:0in 0in
                0.0001pt;font-family:Calibri,sans-serif">yes?
                let/title="sorted indices"
                sorted_by_time=sortl(sst[l=1:`numpoints`])</p>
              <p class="MsoNormal" style="font-size:12pt;margin:0in 0in
                0.0001pt;font-family:Calibri,sans-serif">&#xA0;!-&gt; DEFINE
                VARIABLE/title="sorted indices"
                sorted_by_time=sortl(sst[l=1:12])</p>
              <p class="MsoNormal" style="font-size:12pt;margin:0in 0in
                0.0001pt;font-family:Calibri,sans-serif">yes? list
                sst[i=90,j=45],sorted_by_time[i=90,j=45]</p>
              <p class="MsoNormal" style="font-size:12pt;margin:0in 0in
                0.0001pt;font-family:Calibri,sans-serif">&#xA0;WARNING:
                Listed variables have ambiguous coordinates on axes: T</p>
              <p class="MsoNormal" style="font-size:12pt;margin:0in 0in
                0.0001pt;font-family:Calibri,sans-serif">&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;
                DATA SET:
/snfs1/users/gpeng/myFerret/fer_dsets/FerretDatasets-7.4/data/coads_climatology.cdf</p>
              <p class="MsoNormal" style="font-size:12pt;margin:0in 0in
                0.0001pt;font-family:Calibri,sans-serif">&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;
                LONGITUDE: 161W</p>
              <p class="MsoNormal" style="font-size:12pt;margin:0in 0in
                0.0001pt;font-family:Calibri,sans-serif">&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;
                LATITUDE: 1S</p>
              <p class="MsoNormal" style="font-size:12pt;margin:0in 0in
                0.0001pt;font-family:Calibri,sans-serif">&#xA0;Column&#xA0; 1:
                SST[T=01-JAN 00:45:31-DEC 06:34] is SEA SURFACE
                TEMPERATURE (Deg C)</p>
              <p class="MsoNormal" style="font-size:12pt;margin:0in 0in
                0.0001pt;font-family:Calibri,sans-serif">&#xA0;Column&#xA0; 2:
                SORTED_BY_TIME[T=0.5:12.5] is sorted indices</p>
              <p class="MsoNormal" style="font-size:12pt;margin:0in 0in
                0.0001pt;font-family:Calibri,sans-serif">&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0; SST&#xA0;
                SORTED_BY_TIME</p>
              <p class="MsoNormal" style="font-size:12pt;margin:0in 0in
                0.0001pt;font-family:Calibri,sans-serif">L /&#xA0; 1:&#xA0;
                26.82&#xA0;&#xA0;&#xA0; 1.00</p>
              <p class="MsoNormal" style="font-size:12pt;margin:0in 0in
                0.0001pt;font-family:Calibri,sans-serif">L /&#xA0; 2:
                &#xA0;26.99&#xA0;&#xA0;&#xA0; 2.00</p>
              <p class="MsoNormal" style="font-size:12pt;margin:0in 0in
                0.0001pt;font-family:Calibri,sans-serif">L /&#xA0; 3:&#xA0;
                27.47&#xA0;&#xA0; 12.00</p>
              <p class="MsoNormal" style="font-size:12pt;margin:0in 0in
                0.0001pt;font-family:Calibri,sans-serif">L /&#xA0; 4:&#xA0;
                27.83&#xA0;&#xA0; 11.00</p>
              <p class="MsoNormal" style="font-size:12pt;margin:0in 0in
                0.0001pt;font-family:Calibri,sans-serif">L /&#xA0; 5:&#xA0;
                27.96&#xA0;&#xA0;&#xA0; 9.00</p>
              <p class="MsoNormal" style="font-size:12pt;margin:0in 0in
                0.0001pt;font-family:Calibri,sans-serif"><b>L /&#xA0; 6:&#xA0;
                  28.22&#xA0;&#xA0;&#xA0; 8.00</b></p>
              <p class="MsoNormal" style="font-size:12pt;margin:0in 0in
                0.0001pt;font-family:Calibri,sans-serif">L /&#xA0; 7:&#xA0;
                27.96&#xA0;&#xA0;&#xA0; 3.00</p>
              <p class="MsoNormal" style="font-size:12pt;margin:0in 0in
                0.0001pt;font-family:Calibri,sans-serif">L /&#xA0; 8:&#xA0;
                27.42&#xA0;&#xA0; 10.00</p>
              <p class="MsoNormal" style="font-size:12pt;margin:0in 0in
                0.0001pt;font-family:Calibri,sans-serif">L /&#xA0; 9:&#xA0;
                27.33&#xA0;&#xA0;&#xA0; 4.00</p>
              <p class="MsoNormal" style="font-size:12pt;margin:0in 0in
                0.0001pt;font-family:Calibri,sans-serif">L / 10:&#xA0;
                27.55&#xA0;&#xA0;&#xA0; 5.00</p>
              <p class="MsoNormal" style="font-size:12pt;margin:0in 0in
                0.0001pt;font-family:Calibri,sans-serif">L / 11:&#xA0;
                27.22&#xA0;&#xA0;&#xA0; 7.00</p>
              <p class="MsoNormal" style="font-size:12pt;margin:0in 0in
                0.0001pt;font-family:Calibri,sans-serif">L / 12:&#xA0;
                27.02&#xA0;&#xA0;&#xA0; 6.00</p>
              <p class="MsoNormal" style="font-size:12pt;margin:0in 0in
                0.0001pt;font-family:Calibri,sans-serif">&#xA0;</p>
            </div>
          </div>
          <br>
          <div class="gmail_quote">
            <div dir="ltr" class="gmail_attr">On Tue, Mar 29, 2016 at
              10:16 PM Russ Fiedler <a rel="nofollow" class="moz-txt-link-rfc2396E"
                href="mailto:russell.fiedler@xxxxxxxx"
                moz-do-not-send="true">&lt;russell.fiedler@xxxxxxxx&gt;</a>
              wrote:<br>
            </div>
            <blockquote class="gmail_quote" style="margin:0px 0px 0px
              0.8ex;border-left:1px solid
              rgb(204,204,204);padding-left:1ex">
              <div bgcolor="#FFFFFF">
                <div class="gmail-m_-3865166786425923335moz-cite-prefix"><br>
                  Hi Peng,<br>
                  <br>
                  I did this in the dim distant past by saving the
                  sorted data to a file and then picked the appropriate
                  values out.<br>
                  <br>
                  use coads_climatology<br>
                  let numpoints=`sst,return=lend`<br>
                  let numlats=`sst,return=jend]`<br>
                  let/title="sorted indices"
                  sorted_by_time=sortl(sst[l=1:`numpoints`])<br>
                  <br>
                  ! I found that I ran out of memory if I tried to sort
                  too much for some GB sized datasets. It depends on the
                  size of your dataset.<br>
                  ! You might be able to make larger windows or even do
                  it in one go.<br>
                  <br>
                  save/j=1/jlimits=1:`numlats`/clob/file=<a rel="nofollow"
                    href="http://sorted.nc" target="_blank"
                    moz-do-not-send="true">sorted.nc</a> sorted_by_time<br>
                  repeat/j=2:`numlats` save/app/file=<a rel="nofollow"
                    href="http://sorted.nc" target="_blank"
                    moz-do-not-send="true">sorted.nc</a> sorted_by_time<br>
                  <br>
                  can var sorted_by_time<br>
                  use sorted<br>
                  <br>
                  ! Make a variable with time indices<br>
                  <br>
                  let index_2d=0*x[g=sorted_by_time] +
                  0*y[g=sorted_by_time] + l[g=sorted_by_time]<br>
                  <br>
                  ! Create an integrating kernel for the percentile
                  wanted 1 for the limit we want and missing elsewhere.
                  <br>
                  <br>
                  !25 percentile say. Make sure at least 1 valid point
                  is used<br>
                  <br>
                  let k25 = if l[g=index_2d] eq
                  max(int(0.25*ignore0(sorted_by_time[l=1:`numpoints`@ngd])),1)
                  then 1<br>
                  <br>
                  ! Show the indices used in the sorted data. Note that
                  missing values are accounted for.<br>
                  <br>
                  <br>
                  shade k25[l=@loc:1]<br>
                  <br>
                  ! Multiply by SST and sum&#xA0; up<br>
                  <br>
                  let sst_k25 =
                  k25[gl=sst[d=coads_climatology]@asn]*sst[d=coads_climatology]<br>
                  <br>
                  let/title="sst at 25 percentile"
                  sst25=sst_k25[l=1:`numpoints`@sum]<br>
                  <br>
                  shade sst25<br>
                  <br>
                  <br>
                  Cheers,<br>
                  Russ<br>
                  <br>
                  <br>
                  On 30/03/16 05:32, Ge Peng - NOAA Affiliate wrote:<br>
                </div>
                <blockquote type="cite">
                  <div dir="ltr">
                    <div>
                      <p class="MsoNormal">Found this message showing
                        how to find percentiles for 2-dimensional
                        gridded data:</p>
                      <p class="MsoNormal"><span
                          style="line-height:115%"><a rel="nofollow"
                            class="gmail-m_-3865166786425923335moz-txt-link-freetext"
href="http://ferret.pmel.noaa.gov/Ferret/Mail_Archives/fu_2004/msg00632.html"
                            target="_blank" moz-do-not-send="true">http://ferret.pmel.noaa.gov/Ferret/Mail_Archives/fu_2004/msg00632.html</a></span></p>
                      <p class="MsoNormal"><br>
                      </p>
                      <p class="MsoNormal">However, I would like to
                        compute quantiles/percentiles along my time axis
                        at each grid cell of the 2-dimensional gridded
                        data. I.e., for each x and y, the percentiles
                        are done along the time axis with valid data
                        points. (We can ignore the z dimension for now.)</p>
                      <p class="MsoNormal"><br>
                      </p>
                      <p class="MsoNormal">I could take the time series
                        at each grid cell using nested repeat loop in x
                        and y dimensions, following the above example to
                        sort the data and place the ordered data onto
                        the tiled axis. </p>
                      <p class="MsoNormal"><br>
                      </p>
                      <p class="MsoNormal">It does not sound very
                        efficient to me. Has anyone done something
                        similar in ferret? Is there a better way to do
                        this, perhaps without nested repeat loops in
                        both x and y directions? </p>
                      <p class="MsoNormal"><br>
                      </p>
                      <p class="MsoNormal">Appreciate any help.</p>
                      <span
                        style="line-height:115%;font-family:Calibri,sans-serif">
                        <div><span
                            style="line-height:115%;font-family:Calibri,sans-serif"><br>
                          </span></div>
                        --- Peng</span><br clear="all">
                    </div>
                    <div><br>
                    </div>
                    -- <br>
                    <div
                      class="gmail-m_-3865166786425923335gmail_signature">
                      <div dir="ltr">
                        <div>
                          <div dir="ltr">
                            <div>
                              <div dir="ltr">
                                <div><span
style="color:rgb(51,51,51);font-family:Times;line-height:11.9886px;font-size:11px"><span
style="font-family:arial,helvetica,sans-serif"><b>Ge Peng, Ph.D</b><br>
                                      <b>Research Scholar</b><br>
                                    </span></span>
                                  <p style="margin-bottom:0.0001pt"><font
                                      size="2" face="arial, helvetica,
                                      sans-serif">Cooperative Institute
                                      for Climate and Satellites,&#xA0;NC
                                      (CICS-NC)</font></p>
                                  <p style="margin-bottom:0.0001pt"><font
                                      size="2" face="arial, helvetica,
                                      sans-serif">North Carolina State
                                      University (NCSU) and</font></p>
                                  <p style="margin-bottom:0.0001pt"><font
                                      size="2" face="arial, helvetica,
                                      sans-serif">NOAA&#x2019;s National
                                      Centers for Environmental
                                      Information (NCEI)</font></p>
                                  <p style="margin-bottom:0.0001pt"><font
                                      size="2" face="arial, helvetica,
                                      sans-serif">Center for Weather and
                                      Climate (CWC)</font></p>
                                  <p style="margin-bottom:0.0001pt"><font
                                      size="2" face="arial, helvetica,
                                      sans-serif"><br>
                                    </font></p>
                                  <span
                                    style="color:rgb(51,51,51);line-height:11.9886px"><font
                                      size="2" face="arial, helvetica,
                                      sans-serif">151 Patton Ave,
                                      Asheville, NC 28801<br>
                                      <a rel="nofollow" href="mailto:ge.peng@xxxxxxxx"
                                        target="_blank"
                                        moz-do-not-send="true">ge.peng@xxxxxxxx</a><br>
                                      o: +1 828 257 3009<br>
                                      f: &#xA0;+1 828 257 3002</font><br>
                                  </span>
                                  <p
style="color:rgb(51,51,51);font-family:Times;font-size:13.6364px;margin-bottom:0.0001pt;background-color:white"><span
style="font-family:arial,helvetica,sans-serif;font-size:10.9091px;line-height:11.9886px;text-align:-webkit-center">Following
                                      CICS-NC on&#xA0;</span><a rel="nofollow"
                                      href="http://www.facebook.com/cicsnc"
style="font-family:arial,helvetica,sans-serif;font-size:10.9091px;line-height:11.9886px;text-align:-webkit-center;color:rgb(38,58,143);text-decoration:none;font-weight:bold"
                                      target="_blank"
                                      moz-do-not-send="true">Facebook</a></p>
                                  <table
style="max-width:100%;border-collapse:collapse;border-spacing:0px;color:rgb(51,51,51);font-size:14px;font-family:Times;line-height:12px"
                                    width="500" cellspacing="2"
                                    cellpadding="2" border="0">
                                    <tbody>
                                      <tr>
                                        <td width="71" height="71"
                                          align="center"><br>
                                        </td>
                                        <td valign="top"><br>
                                        </td>
                                      </tr>
                                    </tbody>
                                  </table>
                                </div>
                              </div>
                            </div>
                          </div>
                        </div>
                      </div>
                    </div>
                  </div>
                </blockquote>
                <br>
              </div>
            </blockquote>
          </div>
          <br clear="all">
          <div><br>
          </div>
          -- <br>
          <div dir="ltr" class="gmail_signature">
            <div dir="ltr">
              <div>
                <div dir="ltr">
                  <div>
                    <div dir="ltr">
                      <div>
                        <div dir="ltr">
                          <div dir="ltr">
                            <div dir="ltr">
                              <p><b><span
style="font-size:9pt;font-family:Arial;color:rgb(51,51,51);background:white">Ge
                                    Peng, PhD</span></b><span
style="font-size:9pt;font-family:Arial;color:rgb(51,51,51);background:white"><br>
                                  <b>Research Scholar</b><br>
                                </span><span
                                  style="font-size:9pt;font-family:Arial;color:rgb(34,34,34)">Cooperative
                                  Institute for Climate and Satellites -
                                  NC (CICS-NC)/NCSU at</span><span
                                  style="font-size:9pt;font-family:Times"></span></p>
                              <p><span
                                  style="font-size:9pt;font-family:Arial;color:rgb(34,34,34)">NOAA&#x2019;s
                                  National Centers for Environmental
                                  Information (NCEI)</span><span
                                  style="font-size:9pt;font-family:Times"></span></p>
                              <p><span
                                  style="font-size:9pt;font-family:Arial;color:rgb(34,34,34)">Center
                                  for Weather and Climate (CWC)</span><span
style="font-size:9pt;font-family:Times"></span></p>
                              <p><span
style="font-size:9pt;font-family:Arial;color:rgb(51,51,51);background:white">151
                                  Patton Ave, Asheville, NC 28801<br>
                                  <a rel="nofollow" moz-do-not-send="true"><span
                                      style="color:rgb(17,85,204)">+1
                                      828 257 3009</span></a>; <span
                                    style="color:rgb(17,85,204)"><a rel="nofollow"
                                      href="mailto:ge.peng@xxxxxxxx"
                                      target="_blank"
                                      moz-do-not-send="true">ge.peng@xxxxxxxx</a></span></span></p>
                              <p><span
                                  style="font-size:9pt;font-family:Arial">ORCID:
                                  http://</span><span
style="font-size:9pt;font-family:Arial;color:rgb(73,74,76);background-image:initial;background-position:initial;background-repeat:initial"><a rel="nofollow"
href="http://orcid.org/0000-0002-1986-9115" target="_blank"
                                    moz-do-not-send="true">orcid.org/0000-0002-1986-9115</a></span></p>
                              <p
style="color:rgb(51,51,51);font-family:Times;font-size:13.6364px;margin-bottom:0.0001pt;background-color:white"><span
style="font-family:arial,helvetica,sans-serif;font-size:10.9091px;line-height:11.9886px;text-align:-webkit-center">Following
                                  CICS-NC on&#xA0;</span><a rel="nofollow"
                                  href="http://www.facebook.com/cicsnc"
style="font-family:arial,helvetica,sans-serif;font-size:10.9091px;line-height:11.9886px;text-align:-webkit-center;color:rgb(38,58,143);text-decoration:none;font-weight:bold"
                                  target="_blank" moz-do-not-send="true">Facebook</a></p>
                              <table
style="max-width:100%;border-collapse:collapse;border-spacing:0px;color:rgb(51,51,51);font-size:14px;font-family:Times;line-height:12px"
                                width="500" cellspacing="2"
                                cellpadding="2" border="0">
                                <tbody>
                                  <tr>
                                    <td width="71" height="71"
                                      align="center"><br>
                                    </td>
                                    <td valign="top"><br>
                                    </td>
                                  </tr>
                                </tbody>
                              </table>
                            </div>
                          </div>
                        </div>
                      </div>
                    </div>
                  </div>
                </div>
              </div>
            </div>
          </div>
        </div>
      </blockquote>
    </blockquote>
  

</font></td></tr></table>
<!--X-Body-of-Message-End-->
<!--X-MsgBody-End-->
<!--X-Follow-Ups-->
<hr>
<ul><li><strong>Follow-Ups</strong>:
<ul>
<li><strong><a name="00021" href="msg00021.html">Re: Issue with sortl: [ferret_users] Percentile along time axis for gridded data</a></strong>
<ul><li><em>From:</em> Ge Peng - NOAA Affiliate</li></ul></li>
</ul></li></ul>
<!--X-Follow-Ups-End-->
<!--X-References-->
<ul><li><strong>References</strong>:
<ul>
<li><strong><a name="00018" href="msg00018.html">Issue with sortl: [ferret_users] Percentile along time axis for gridded data</a></strong>
<ul><li><em>From:</em> Ge Peng - NOAA Affiliate</li></ul></li>
<li><strong><a name="00019" href="msg00019.html">Re: Issue with sortl: [ferret_users] Percentile along time axis for gridded data</a></strong>
<ul><li><em>From:</em> Ansley C. Manke</li></ul></li>
</ul></li></ul>
<!--X-References-End-->
<!--X-BotPNI-->
<UL>
<li>Previous by thread:
<strong><a href="msg00019.html">Re: Issue with sortl: [ferret_users] Percentile along time axis for gridded data</a></strong>
</li>
<li>Next by thread:
<strong><a href="msg00021.html">Re: Issue with sortl: [ferret_users] Percentile along time axis for gridded data</a></strong>
</li>

</UL>
<center>[<a href="msg00019.html">Thread Prev</a>][<a href="msg00021.html">Thread Next</a>][<A HREF="threads.html#00020">Index</A>]</center>

<!--X-BotPNI-End-->
<!--X-User-Footer-->
<A HREF="http://ferret.pmel.noaa.gov/Ferret/contact-us">Contact Us</A>
<br>
<font size=-1>
<address>
<a href="http://www.doc.gov">Dept of Commerce</a> /
<a href="http://www.noaa.gov">NOAA</a> /
<a href="http://www.oar.noaa.gov">OAR</a> /
<a href="http://www.pmel.noaa.gov">PMEL</a> /
<a href="http://ferret.pmel.noaa.gov">Ferret</a>
</address>

<br>
 <a href="http://www.noaa.gov/privacy.html">Privacy Policy</a> | <a href="http://www.noaa.gov/disclaimer.html">Disclaimer</a> | <a href="accessibility.html">Accessibility Statement</a> 

</font>
<!--X-User-Footer-End-->
</body>
</html>
