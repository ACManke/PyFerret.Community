<!-- MHonArc v2.6.18 -->
<!--X-Subject: Re: [ferret_users] Edges and @AVG -->
<!--X-From-R13: Oyrknaqre Ohqrg <nyrknaqre.p.nhqrgNznvar.rqh> -->
<!--X-Date: Tue, 25 Feb 2020 12:26:34 &#45;0800 -->
<!--X-Message-Id: CAP06G6QuNKn59BwAS7udR3i5Ef37dhEo74ku5xy95f_LxeSb5Q@mail.gmail.com -->
<!--X-Content-Type: multipart/related -->
<!--X-Reference: CAP06G6Qt&#45;GLxUqLY0AA+aHEEVq_3wTKhB6cLC3yFeMVtUjOVcg@mail.gmail.com -->
<!--X-Reference: CAEwQpa+SgCVR19G5bx2KXzNOKOKV52N7068YiTcU&#45;rbEHrDQTA@mail.gmail.com -->
<!--X-Derived: pngZKAs31eh2P.png -->
<!--X-Derived: pngV28OUtKz4o.png -->
<!--X-Derived: pngELtZVBE_rW.png -->
<!--X-Derived: png6dLCrUXsOE.png -->
<!--X-Derived: pngY2oSIz3mW_.png -->
<!--X-Head-End-->
<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN"
        "http://www.w3.org/TR/html4/loose.dtd">
<html>
<head>
<title>Re: [ferret_users] Edges and @AVG</title>
</head>
<body>
<!--X-Body-Begin-->
<!--X-User-Header-->
<!--X-User-Header-End-->
<!--X-TopPNI-->
<HR>
<center>[<a href="msg00541.html">Thread Prev</a>][<a href="msg00543.html">Thread Next</a>][<A HREF="threads.html#00542">Index</A>]</center>

<!--X-TopPNI-End-->
<!--X-MsgBody-->
<!--X-Subject-Header-Begin-->
<h1>Re: [ferret_users] Edges and @AVG</h1>
<hr>
<!--X-Subject-Header-End-->
<!--X-Head-of-Message-->
<ul>
<li><strong>To</strong>: <strong>Ryo Furue &lt;<a href="mailto:furue@DOMAIN.HIDDEN">furue@xxxxxxxxxx</a>&gt;</strong></li>
<li><strong>Subject</strong>: <strong>Re: [ferret_users] Edges and @AVG</strong></li>
<li><strong>From</strong>: <strong>Alexander Audet &lt;<a href="mailto:alexander.c.audet@DOMAIN.HIDDEN">alexander.c.audet@xxxxxxxxx</a>&gt;</strong></li>
<li>Date: Tue, 25 Feb 2020 15:26:11 -0500</li>
<li>Arc-authentication-results: i=4; mx.google.com;       dkim=pass header.i=@maine.edu header.s=google header.b=aw+bURn2;       arc=pass (i=2 dkim=pass dkdomain=maine.edu);       spf=pass (google.com: domain of <a href="mailto:alexander.c.audet@DOMAIN.HIDDEN">alexander.c.audet@xxxxxxxxx</a> designates 209.85.160.197 as permitted sender) smtp.mailfrom=<a href="mailto:alexander.c.audet@DOMAIN.HIDDEN">alexander.c.audet@xxxxxxxxx</a></li>
<li>Arc-authentication-results: i=3; mx.google.com;       dkim=pass header.i=@maine.edu header.s=google header.b=aw+bURn2;       arc=pass (i=2 dkim=pass dkdomain=maine.edu);       spf=pass (google.com: domain of <a href="mailto:alexander.c.audet@DOMAIN.HIDDEN">alexander.c.audet@xxxxxxxxx</a> designates 209.85.160.197 as permitted sender) smtp.mailfrom=<a href="mailto:alexander.c.audet@DOMAIN.HIDDEN">alexander.c.audet@xxxxxxxxx</a></li>
<li>Arc-authentication-results: i=2; mx.google.com;       dkim=pass header.i=@maine.edu header.s=google header.b=aw+bURn2;       arc=pass (i=1 spf=pass spfdomain=maine.edu dkim=pass dkdomain=maine.edu);       spf=softfail (google.com: domain of transitioning <a href="mailto:alexander.c.audet@DOMAIN.HIDDEN">alexander.c.audet@xxxxxxxxx</a> does not designate 65.153.203.175 as permitted sender) smtp.mailfrom=<a href="mailto:alexander.c.audet@DOMAIN.HIDDEN">alexander.c.audet@xxxxxxxxx</a></li>
<li>Arc-authentication-results: i=1; mx.google.com;       dkim=pass header.i=@maine.edu header.s=google header.b=aw+bURn2;       spf=pass (google.com: domain of <a href="mailto:alexander.c.audet@DOMAIN.HIDDEN">alexander.c.audet@xxxxxxxxx</a> designates 209.85.220.41 as permitted sender) smtp.mailfrom=<a href="mailto:alexander.c.audet@DOMAIN.HIDDEN">alexander.c.audet@xxxxxxxxx</a></li>
<li>Arc-message-signature: i=4; a=rsa-sha256; c=relaxed/relaxed; d=google.com; s=arc-20160816;        h=list-archive:list-help:list-post:list-id:mailing-list:precedence         :message-id:cc:to:subject:date:from:in-reply-to:references         :mime-version:sender:dkim-signature;        bh=gW15RObXWC/s3NvI8RPFAk3qAapw4XZyrD/CDwJ678w=;        b=yhra/fzM5whMY/skwehcq+ZSgib2rkHXU8URWDdb74aOvrnZMo9gObJjbzFd0SZzmo         Hk3TWPOBYr2kL+ltiddydruX840Qw609+nYfNbNXVUg5C72kIruNSEsPb3cb46kvMUPh         YH6ghicOx1LEOCVmmaO88tNzXibrqQv5UY8OovpNYlWf+SqkyYpMoq1FkI1ucOOprsJ0         +/aDT8H9MNmuQVtboiIcO8CWEJNiAU9qrfzGQ2w2FJNsYFMoQm5GxlZ9YI55EcvpdAKE         BXzNPZ2L6KGkHwc0ML41Gy+go73YzXKzSvo3m/ZWcwOqkyvqNhfctBHVHeITSGg6/o7O         0XAg==</li>
<li>Arc-message-signature: i=3; a=rsa-sha256; c=relaxed/relaxed; d=google.com; s=arc-20160816;        h=message-id:cc:to:subject:date:from:in-reply-to:references         :mime-version:dkim-signature;        bh=gW15RObXWC/s3NvI8RPFAk3qAapw4XZyrD/CDwJ678w=;        b=YhUK4kr7/rbnS/dg5IGExshDewc2VCF/0hXRmMGGHStTbhajkRee4RoHbjUN7En19x         EYSP6GAlgAZOWdjO9oTzLzMarlQGu4jni3U/Bz5QCbMG77MXipyH5MT7YXG+B4alECfP         CYb2FWFNFc3/8tF7XvQKBQoqfH+2HmZM1nAEzLreBo2AFCbjsYzON4kP3L4tnXim9qzX         LM+q2Ai6+lopSS0A/l1O9jsJVjDu5D3NhgdnFoscMARiX0/Lw+dRPGAf/IljJH6iwRsf         82eRzvIQ8TPmLIspjUorWqZS6CcFFuokZFczaEHpf3d0Y0lcBuA68IKa+AHHgjVW0011         69Bg==</li>
<li>Arc-message-signature: i=2; a=rsa-sha256; c=relaxed/relaxed; d=google.com; s=arc-20160816;        h=cc:to:subject:message-id:date:from:in-reply-to:references         :mime-version:dkim-signature;        bh=gW15RObXWC/s3NvI8RPFAk3qAapw4XZyrD/CDwJ678w=;        b=UgqEkLtejlVCUdYXG+LwDT3NK61rT089l2qec/AxjJgHo4T45RlsheZ96zSxB6JbXZ         q3Ww07sgrskTLmRH+WIqkI0jz2lXLtzv2yqm1zhZFb50SqsxRCviIC+deVPTmHF+Bnt5         QZpExWvHz1sLrhezvTR6SldApbKRo1+j6IYbE+2GQgMXd1dyQ3j4OSEExDAouN7QdXoa         0+WmYElj1Sy6BcVD7nX8d7zyZkP8Zt9tbL4UV0/e0uzK60TT/faB1M8RPe5zztmL3rWg         dfc7fYRg4H67i+AsNh0ws1WbpiM4U5InP71VQ3UMWmq1pGyh0yZXtLl69aJiU8TCW47f         mt0A==</li>
<li>Arc-message-signature: i=1; a=rsa-sha256; c=relaxed/relaxed; d=google.com; s=arc-20160816;        h=cc:to:subject:message-id:date:from:in-reply-to:references         :mime-version:dkim-signature;        bh=gW15RObXWC/s3NvI8RPFAk3qAapw4XZyrD/CDwJ678w=;        b=zGsyszAhP6p8bNz5FTP+foQRxfT9ADv9+FIV2VmrSaOjOxu9jIPJXSoEY4tqf24S01         VMbQaHMYaUhzMx8UeUFPYkWRToepdIqZuwNuqbwj+4urzFWtkGRDC/7Kcg6qdkvSxevj         C1rmEJTg9LqlgNxba/TVJETIqkr38A+eTJUV2cwXcjGKhJ77FcQX/4TaU5WQGztDjzfO         0XZh/3Qm2S8kJF51ssosoHWaQ3NkHycmg1cp4YnBVnfcY43+slq7woVIUJVULHzUXOmt         nTKmXcYeNo6YQ0orJp0z20hMSfw7s9EnBlfHIS54eX0Gl/1c4+U53Hn3+4agVeqCrKdw         fKbA==</li>
<li>Arc-seal: i=4; a=rsa-sha256; t=1582662393; cv=pass;        d=google.com; s=arc-20160816;        b=DeLtNuWJfvebfTSqNEJ8+ZBYiR7SivBEMnHm3F9LKgbkYqQZJQYeyIN8MjuPua899W         HCIgdq6Bos+IVl2aqW5tskTqoL0gOxPVhdd5zXsNTUfgNcUxaX2RyjQPF7KyI9Tcsqf8         2nWl1EChhEA0LHSS9VBZqolDV/slzBdRDhK8BP4J93APEoS7ATZ3CQZrM3zPiIz8bSwd         D19khtKsx8fv2yyJijCHF0NkOt7cMxj9X6CPOW9UJys6kMg5QdPfzfr2pUIxUKZRsz5X         EhXm2I3Hrj4Hr+3XGS077KlC/7+s93OlL1hAsX7XXnS99Q6iOE0zgzBMR3SMylsMV4oH         ZVPA==</li>
<li>Arc-seal: i=3; a=rsa-sha256; t=1582662392; cv=pass;        d=google.com; s=arc-20160816;        b=ufVdK7u9qGyGFLTfKs9pZPkLxrmTNcZ0uEd9l/IAaoHBm98eOofYebTljKpfX7oqBG         84VTr/4hEy7kQqgOJpiw3qP0QNFtwQFXexuO+j9ckYFtEphLVA0mkIqIu0Cmr7EDo2PT         0ZPuUZhK31Qi2Mk4UBR9Jakou99X/gVYvdtXi4CsPTUQEIv067NBFpoxNkBsgvOorebf         kBIIjrTEyQMhk1rqzAMfOwYtuwD02N0bfK2kCp/SSWxc3ZQThsK/rg2x6K77hYMKOb9R         PIbFy+JhFblZGaZ4ifKNeLlb+cgpkQybOJfemagb5v36dB6A2map5AGe1ZLisbjyzHaa         f+ZA==</li>
<li>Arc-seal: i=2; a=rsa-sha256; t=1582662386; cv=pass;        d=google.com; s=arc-20160816;        b=EdPufRZs+x+kFYXco6nGtyKjSBMwC9lZDjS/EHV7xWobiPxP5oKG9yPh4UqbWb4c4v         9WqvG3LqDX9Wb3qIkCHna28FwegBdxOTHmGMel9jKP7Lz660Q7KdLMN48o9Ky9ZvmpWb         L2fkSrNnMNfAimCFl5ewlhL3lBLwCgs3s0qV9fyL5ut5IIEIb7zhv94If6SLuSHq8BRl         7h+iWWQl2Ey67e+MVEhF6mFqro3rG1FXKuwiM0LnaOxfcD9VRYvzS+YxqyQAs1Q4y8Zw         NHfoxVU4EwTVYUeMSREYJviKveuUnggkZN95A269CiJn+IJb4BKENdcYZ8gYLYsbfKBX         KOng==</li>
<li>Arc-seal: i=1; a=rsa-sha256; t=1582662383; cv=none;        d=google.com; s=arc-20160816;        b=d3iW0ODbhVyr1HrPcXf67LW/xdhmCXoqLwwztBblPRqn5odIfUBTVx0IndJOYXwE/F         Q7ANn1E3P1ldkf0qevBNwC7ad0gwZR3/Q8rng7IxSxjBdwjl3HlbhvZdIn/LMOQwPxZF         L/mAg+JS/I5K3ZIas+gQ/oFUgB2YO6zMclFlcxFiJUx5urpDhnmIJMNF3SsTmxieZ7n3         FMdrZcsKtYhDRVEfnIkF1qXNn4pf2NWkYpRuiwWBK2qBUlQOK2mMrpzACzkZXDbIKocz         WInyH752c1dgv3fVjCxHcrT1dTh6B5b+Dd6CajP7ihbyzIz41QIHAb85vSKSWil3pf00         bL5w==</li>
<li>Cc: ferret users &lt;<a href="mailto:ferret_users@DOMAIN.HIDDEN">ferret_users@xxxxxxxx</a>&gt;</li>
<li>Dkim-signature: v=1; a=rsa-sha256; c=relaxed/relaxed;        d=noaa.gov; s=google;        h=sender:mime-version:references:in-reply-to:from:date:subject:to:cc         :message-id:x-original-sender:x-original-authentication-results         :precedence:mailing-list:list-id:list-post:list-help:list-archive;        bh=gW15RObXWC/s3NvI8RPFAk3qAapw4XZyrD/CDwJ678w=;        b=Y45brBN2N3Agkp3jt+R3DpUnoG/Uh/zF0MvoWX0ofypvWc97BH70PJx0jzQ8slsuLo         71p9CSBXW80ASbIhXPCsurc/DfcpCkr0iwO1qvZEUnRlSZVfXx/0XUKyfoods3VuN3o6         kfSSOekM+1zqMhUujuKWmyOvZozUc8b2SEKs/q+hb3AykgfjKJNXX7MwMl6m8nr1k2Ze         pRJt9GvSAfOtv/9wkmPSboWF479dr8dfwb5wUrx6bylJ3QS/nwLUSByTRmUFfBAHtRPO         Rqb71/LCABYPJANrRWKXe6UX13EWi+XJ/X3qa45EoduNV/oQetFhlq8xkhQO2xstmnZS         wSnA==</li>
<li>In-reply-to: &lt;<a href="msg00541.html">CAEwQpa+SgCVR19G5bx2KXzNOKOKV52N7068YiTcU-rbEHrDQTA@mail.gmail.com</a>&gt;</li>
<li>List-archive: &lt;<a href="https://groups.google.com/a/noaa.gov/group/ferret_users/">https://groups.google.com/a/noaa.gov/group/ferret_users/</a>&gt;</li>
<li>List-help: &lt;<a href="https://support.google.com/a/noaa.gov/bin/topic.py?topic=25838">https://support.google.com/a/noaa.gov/bin/topic.py?topic=25838</a>&gt;, &lt;<a href="mailto:ferret_users+help@noaa.gov">mailto:ferret_users+help@noaa.gov</a>&gt;</li>
<li>List-id: &lt;ferret_users.noaa.gov&gt;</li>
<li>List-post: &lt;<a href="https://groups.google.com/a/noaa.gov/group/ferret_users/post">https://groups.google.com/a/noaa.gov/group/ferret_users/post</a>&gt;, &lt;<a href="mailto:ferret_users@noaa.gov">mailto:ferret_users@noaa.gov</a>&gt;</li>
<li>Mailing-list: list <a href="mailto:ferret_users@DOMAIN.HIDDEN">ferret_users@xxxxxxxx</a>; contact <a href="mailto:ferret_users%2Bowners@DOMAIN.HIDDEN">ferret_users+owners@xxxxxxxx</a></li>
<li>References: &lt;<a href="msg00540.html">CAP06G6Qt-GLxUqLY0AA+aHEEVq_3wTKhB6cLC3yFeMVtUjOVcg@mail.gmail.com</a>&gt; &lt;<a href="msg00541.html">CAEwQpa+SgCVR19G5bx2KXzNOKOKV52N7068YiTcU-rbEHrDQTA@mail.gmail.com</a>&gt;</li>
<li>Sender: <a href="mailto:owner-ferret_users@DOMAIN.HIDDEN">owner-ferret_users@xxxxxxxx</a></li>
</ul>
<!--X-Head-of-Message-End-->
<!--X-Head-Body-Sep-Begin-->
<hr>
<!--X-Head-Body-Sep-End-->
<!--X-Body-of-Message-->
<div dir="ltr">Hello Ryo,<div>&#xA0; &#xA0; &#xA0; &#xA0; &#xA0; &#xA0; &#xA0; &#xA0; &#xA0; That is an excellent point, and it led me inadvertently&#xA0;to find the problem (which was different, and associated with the setup of the ERA5 NetCDF). When I performed that weighted average calculation&#xA0;in excel, I again got a value different from the&#xA0;@AVG regridding value. This included accounting for the leap years 1984.&#xA0;</div><div><br></div><div><div><div><img src="pngZKAs31eh2P.png" alt="image.png" width="237" height="104"><br></div></div></div><div><br></div><div>However, rereading this piece of the user&#39;s manual:&#xA0;<a rel="nofollow" href="https://ferret.pmel.noaa.gov/Ferret/faq/regridding-a-time-series-with-ave">regridding with @AVE</a>, and then looking at the length of the months in my original ERA5 data I realized that the original data came in strange T-boxes. For example, the measurement for January was centered on January 1st and extended from mid-December to mid-January. As defined then, when I regridded into December-February time boxes, I was getting 1/2December, January, February, and 1/2 of March. (It also defines February and March as 29.5 days each). I honestly&#xA0;don&#39;t know what calendar ERA5 comes on!!</div><div><br></div><div><div><img src="pngV28OUtKz4o.png" alt="image.png" width="464" height="149"><br></div></div><div><br></div><div>The full fix would probably be to first regrid it into proper 1-month time slots using the&#xA0;@ASN transformation as described in the above link, then regrid it a second time into the seasonal 3 months using the&#xA0;@AVG. However, as a rough check, I just redefined the seasonal axis to start November 15 and end February 15th in order to mostly catch the three months of interest (again November 15-December 15th would add &gt;95% December values to my three month average as apposed to November or January values). The results were very close to my excel weighted averages, and were more correct than either of my first two sets of averages.</div><div><br></div><div><div><img src="pngELtZVBE_rW.png" alt="image.png" width="334" height="326"><br></div></div><div><br></div><div>I also realized that my screenshots in my first post were confusing because using method 1 (regridding using&#xA0;@AVG into 3 month timeslots) the years were listed according to the January time, while using method 2 (manually averaging the values, it listed the years as the previous year as it started with the December month. Although not consistent with the above screenshot since the seasonal axis is there centered on December 31st, I have corrected that below for the reader&#39;s convenience.&#xA0;</div><div><br></div><div>Method 1:&#xA0;</div><div><br></div><div><div><div><img src="png6dLCrUXsOE.png" alt="image.png" width="329" height="304"><br></div></div></div><div>Method 2:</div><div>&#xA0;</div><div><img src="pngY2oSIz3mW_.png" alt="image.png" width="375" height="305"><br></div><div><br></div><div><div>Alexander Audet</div></div></div><br><div class="gmail_quote"><div dir="ltr" class="gmail_attr">On Sun, Feb 23, 2020 at 5:08 AM Ryo Furue &lt;<a rel="nofollow" href="mailto:furue@xxxxxxxxxx" target="_blank">furue@xxxxxxxxxx</a>&gt; wrote:<br></div><blockquote class="gmail_quote" style="margin:0px 0px 0px 0.8ex;border-left:1px solid rgb(204,204,204);padding-left:1ex"><div dir="ltr"><div>Hi Alexander,</div><br><div class="gmail_quote"><div dir="ltr" class="gmail_attr">On Fri, Feb 21, 2020 at 4:59 AM Alexander Audet &lt;<a rel="nofollow" href="mailto:alexander.c.audet@xxxxxxxxx" target="_blank">alexander.c.audet@xxxxxxxxx</a>&gt; wrote:<br></div><blockquote class="gmail_quote" style="margin:0px 0px 0px 0.8ex;border-left:1px solid rgb(204,204,204);padding-left:1ex"><div dir="ltr"><div dir="ltr"><div dir="ltr"><div>&#xA0; &#xA0; &#xA0; &#xA0; &#xA0; &#xA0; &#xA0; &#xA0; &#xA0; &#xA0; &#xA0; &#xA0; &#xA0; &#xA0; &#xA0; &#xA0; &#xA0; &#xA0; &#xA0; &#xA0; I have noticed a difference when I (1) average seasonal data by creating a climatological axis with 3 month-long cells then @AVG regridding, verses (2) when I separate each month into its own variable and then average them together using expressions. It appears that the latter method is doing what I expect,</div></div></div></div></blockquote><div><br></div><div>But, the length of the month varies and therefore (1) should&#xA0;be the correct average: For example,</div><div><br></div></div><blockquote style="margin:0px 0px 0px 40px;border:none;padding:0px"><div class="gmail_quote"><div>JFM = (31J + 28F&#xA0;+ 31M) / (31&#xA0;+ 28&#xA0;+ 31),</div></div></blockquote><div class="gmail_quote"><div><br></div><div>where J, F, M are the monthly means of Jan, Feb, and March, respectively.&#xA0; The&#xA0;@AVG averaging takes the monthly variable lengths into account.&#xA0; This principle applies to other axes with uneven grid-spacing, too.</div><div><br></div><div>Hope this helps,</div><div>Ryo</div><div><br></div></div></div>
</blockquote></div>

<!--X-Body-of-Message-End-->
<!--X-MsgBody-End-->
<!--X-Follow-Ups-->
<hr>
<ul><li><strong>Follow-Ups</strong>:
<ul>
<li><strong><a name="00543" href="msg00543.html">Re: [ferret_users] Edges and @AVG</a></strong>
<ul><li><em>From:</em> William S. Kessler</li></ul></li>
</ul></li></ul>
<!--X-Follow-Ups-End-->
<!--X-References-->
<ul><li><strong>References</strong>:
<ul>
<li><strong><a name="00540" href="msg00540.html">[ferret_users] Edges and @AVG</a></strong>
<ul><li><em>From:</em> Alexander Audet</li></ul></li>
<li><strong><a name="00541" href="msg00541.html">Re: [ferret_users] Edges and @AVG</a></strong>
<ul><li><em>From:</em> Ryo Furue</li></ul></li>
</ul></li></ul>
<!--X-References-End-->
<!--X-BotPNI-->
<UL>
<li>Previous by thread:
<strong><a href="msg00541.html">Re: [ferret_users] Edges and @AVG</a></strong>
</li>
<li>Next by thread:
<strong><a href="msg00543.html">Re: [ferret_users] Edges and @AVG</a></strong>
</li>

</UL>
<center>[<a href="msg00541.html">Thread Prev</a>][<a href="msg00543.html">Thread Next</a>][<A HREF="threads.html#00542">Index</A>]</center>

<!--X-BotPNI-End-->
<!--X-User-Footer-->
<A HREF="http://ferret.pmel.noaa.gov/Ferret/contact-us">Contact Us</A>
<br>
<font size=-1>
<address>
<a href="http://www.doc.gov">Dept of Commerce</a> /
<a href="http://www.noaa.gov">NOAA</a> /
<a href="http://www.oar.noaa.gov">OAR</a> /
<a href="http://www.pmel.noaa.gov">PMEL</a> /
<a href="http://ferret.pmel.noaa.gov">Ferret</a>
</address>

<br>
 <a href="http://www.noaa.gov/privacy.html">Privacy Policy</a> | <a href="http://www.noaa.gov/disclaimer.html">Disclaimer</a> | <a href="accessibility.html">Accessibility Statement</a> 

</font>
<!--X-User-Footer-End-->
</body>
</html>
