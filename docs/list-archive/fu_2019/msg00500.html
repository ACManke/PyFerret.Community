<!-- MHonArc v2.6.18 -->
<!--X-Subject: Re: [ferret_users] grid compressed after subtract area average -->
<!--X-From-R13: "Oafyrl Q. [naxr" <nafyrl.o.znaxrNabnn.tbi> -->
<!--X-Date: Thu, 23 Jan 2020 14:40:02 &#45;0800 -->
<!--X-Message-Id: fe95a058&#45;f637&#45;7fa2&#45;fba5&#45;87af86a82dda@noaa.gov -->
<!--X-Content-Type: multipart/alternative -->
<!--X-Reference: 4e862735&#45;7edd&#45;466a&#45;c1b1&#45;547c0a6827e4@noaa.gov -->
<!--X-Reference: DF00EFF9&#45;40AE&#45;4368&#45;8419&#45;7299A222714B@uncc.edu -->
<!--X-Reference: d459827d&#45;359a&#45;f276&#45;38e3&#45;26e02c20e58c@noaa.gov -->
<!--X-Reference: CAKE4FWoTc2wJ=h2U0s7vM_P20GynaMh=XeU70VvYpycOzKM_PA@mail.gmail.com -->
<!--X-Reference: f76ab44a&#45;0d51&#45;b3f4&#45;3550&#45;b9e641b31362@noaa.gov -->
<!--X-Reference: CAKE4FWpG&#45;hdmWd_vTpO3XQL&#45;azxJuyeqsbRS_=srAQcyZidQhw@mail.gmail.com -->
<!--X-Reference: c85cebae&#45;82eb&#45;55c0&#45;0adb&#45;0db1b246425f@noaa.gov -->
<!--X-Head-End-->
<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN"
        "http://www.w3.org/TR/html4/loose.dtd">
<html>
<head>
<title>Re: [ferret_users] grid compressed after subtract area average</title>
</head>
<body>
<!--X-Body-Begin-->
<!--X-User-Header-->
<!--X-User-Header-End-->
<!--X-TopPNI-->
<HR>
<center>[<a href="msg00495.html">Thread Prev</a>][<a href="msg00501.html">Thread Next</a>][<A HREF="threads.html#00500">Index</A>]</center>

<!--X-TopPNI-End-->
<!--X-MsgBody-->
<!--X-Subject-Header-Begin-->
<h1>Re: [ferret_users] grid compressed after subtract area average</h1>
<hr>
<!--X-Subject-Header-End-->
<!--X-Head-of-Message-->
<ul>
<li><strong>To</strong>: <strong>Xiaoyu Bai &lt;<a href="mailto:xbai1@DOMAIN.HIDDEN">xbai1@xxxxxxxx</a>&gt;</strong></li>
<li><strong>Subject</strong>: <strong>Re: [ferret_users] grid compressed after subtract area average</strong></li>
<li><strong>From</strong>: <strong>&quot;Ansley C. Manke&quot; &lt;<a href="mailto:ansley.b.manke@DOMAIN.HIDDEN">ansley.b.manke@xxxxxxxx</a>&gt;</strong></li>
<li>Date: Thu, 23 Jan 2020 14:39:58 -0800</li>
<li>Arc-authentication-results: i=2; mx.google.com;       dkim=pass header.i=@noaa.gov header.s=google header.b=&quot;jD/ILsyC&quot;;       spf=pass (google.com: domain of <a href="mailto:ansley.b.manke@DOMAIN.HIDDEN">ansley.b.manke@xxxxxxxx</a> designates 209.85.220.41 as permitted sender) smtp.mailfrom=<a href="mailto:ansley.b.manke@DOMAIN.HIDDEN">ansley.b.manke@xxxxxxxx</a>;       dmarc=pass (p=REJECT sp=NONE dis=NONE) header.from=noaa.gov</li>
<li>Arc-authentication-results: i=1; mx.google.com;       dkim=pass header.i=@noaa.gov header.s=google header.b=&quot;jD/ILsyC&quot;;       spf=pass (google.com: domain of <a href="mailto:ansley.b.manke@DOMAIN.HIDDEN">ansley.b.manke@xxxxxxxx</a> designates 209.85.220.41 as permitted sender) smtp.mailfrom=<a href="mailto:ansley.b.manke@DOMAIN.HIDDEN">ansley.b.manke@xxxxxxxx</a>;       dmarc=pass (p=REJECT sp=NONE dis=NONE) header.from=noaa.gov</li>
<li>Arc-message-signature: i=2; a=rsa-sha256; c=relaxed/relaxed; d=google.com; s=arc-20160816;        h=list-archive:list-help:list-post:list-id:mailing-list:precedence         :content-language:in-reply-to:mime-version:user-agent:date         :message-id:references:cc:to:from:subject:dkim-signature;        bh=5R0J/WgJUqx85SaLZxIls2C7HOpp0TGgHilrLTOl2g8=;        b=VdkNxgH1k5xMxCv8PrBbHD4ycj0UtgHBvwAsAD5tQd3hhzCpLv8RQky7KTERF8bCTq         nZG6+8Gh/XL7fmw/gaGr4mhpN2Xa9Kzqb3iWLP4fywPiQ/mhz6vB35cjAS9vtIG4KrNN         RzcuTlJfDZTuYy10AHzc/useWYbnOybiO7C2wQ6zxP4JEu4PA9o1DlGDWawpBhMR9UxD         qcgqUHAeXatJ9ksrxtD1EEIj2cXJb6X7/Vt4s9ko5aZZ1bAnjRwVj0EvaqAWMPdXgL7M         wtp69jyLGoenFRbxXfpj82e2og3BB5qJmdjJ5sQt/7zmQ4Jlg+/p2g70dAIpEkP9Lk6I         iblA==</li>
<li>Arc-message-signature: i=1; a=rsa-sha256; c=relaxed/relaxed; d=google.com; s=arc-20160816;        h=content-language:in-reply-to:mime-version:user-agent:date         :message-id:references:cc:to:from:subject:dkim-signature;        bh=5R0J/WgJUqx85SaLZxIls2C7HOpp0TGgHilrLTOl2g8=;        b=rxquoEz9n5RuIhC3x1HCfANQ8VUe03KQn8hiYfS+u0+qXq3VlODCqgKExrwSEmAFwW         Mnkhv1ugSIaEN41xRboN3Gk4lyyVev0jqVOmfnY664xKMcm8+igHM4a3zPimJR0Jmjvh         qSvhf5f3bYoO9Nrx/E63zpk01+d9XZzx77wHKIHtSzZ8IXmzc643U4SxE+Ivom+s1hwY         cGbcb3uDBEPLUhPv6xbGaxJF+jxGsdpEsm5jkwxilcEk6S/lOx/xRIC4f3XkN7AcI5bZ         d9KqRv49WgRonM1M+rByBP6BBTj2IXMvkkf01yGbaqOjrmmqOAHTD85RPpSf2fPYVei5         otZQ==</li>
<li>Arc-seal: i=2; a=rsa-sha256; t=1579819202; cv=pass;        d=google.com; s=arc-20160816;        b=nMC2CDQDQ8zr14/Ynyz3QZEuaVFOJTGj4AZ0W5WNiiQuHTy0XquuEv5Ni+UCx2qeL1         v4HX6YZOg0NPP769Q3W5/FGIvTwVlNjZ5FoQMQ1N3Uh8K+YaWZ+potsxq0Vujh+owhPQ         Q00pWN6sqhEdud7Pj2/ViAc85EiMdfb+kle7wJy69mI82e7a5gf9OluT3KavKdyIf9Xj         iWdv8WnI1dRO3LKMJovTc8VUoAgZmG/MidVWpcXarTcBrBoVKQdPsrPupAa7GXK5bW3Z         KHVIg4gxA3AdMhAY+jghV+IzLJ4updF9ghquF+aY+87laJzVrxWYPTa+ubmCbXaSl8RS         o9dQ==</li>
<li>Arc-seal: i=1; a=rsa-sha256; t=1579819201; cv=none;        d=google.com; s=arc-20160816;        b=DVN3uKEdnGXQ3efBs9DfvKMtdd4Gu+TkHT8tguAFE20AxkOLFOO1jNpU1m2j99vfty         xbz2sjekcR6nqEIC8BikiejYgozZTQwhkbAxfoResYZwkaQLTQzrfDXTknreomIDWdpB         2/SyTHrszR/YfK5pW4hDGxMrnP2QF03jVGDxZxKFB4u1Klkpmc51RJs+k+8Nvy7Kwe/Z         9lmyeDPJ4IULnFQAYWuZhHYe9tUefXSV3cWCPvI/fiVQlTZNRyhBMgGad/ajqcc7O4wr         RNys9rmIaoMK7MnB0fIWm8WX4y0CQp7UaarA+cgdfpsfqz1FeP4Xrerm6fluJQUsr1v/         COQw==</li>
<li>Cc: ferret &lt;<a href="mailto:ferret_users@DOMAIN.HIDDEN">ferret_users@xxxxxxxx</a>&gt;</li>
<li>Dkim-signature: v=1; a=rsa-sha256; c=relaxed/relaxed;        d=noaa.gov; s=google;        h=subject:from:to:cc:references:message-id:date:user-agent         :mime-version:in-reply-to:content-language:x-original-sender         :x-original-authentication-results:precedence:mailing-list:list-id         :list-post:list-help:list-archive;        bh=5R0J/WgJUqx85SaLZxIls2C7HOpp0TGgHilrLTOl2g8=;        b=IvMrq/tK+2WucNz03PAb1zvGGw4qCIHlPu77AZrTVAqgkZRFYDWSkoNZRALeeK3W5z         OHbPM/Mdwll6+0V/5tl54aYMN7teyy1NaVlDF34D0ZjZiZZPgqRSWccQYvWVCcm5K7+h         0495/ITrR+PZN9kQ6sFFdIjgDY514+8wAY3G8lkB/BGJEgX3vHHbLNOpxGlOfqQqNNEl         lfpk/RH158BZodGUPU4nRE0yA1uAN9bi/a/l+jsm5in+Tv31BFkx9yH6x95swvbwltvH         JTuNg9pM448/vQRpIauITMhG3TqJufQk2B7EfnrXE2rD3Kjv3KKNok1zYlbS56jtyWC8         fn7Q==</li>
<li>In-reply-to: &lt;<a href="msg00495.html">c85cebae-82eb-55c0-0adb-0db1b246425f@noaa.gov</a>&gt;</li>
<li>List-archive: &lt;<a href="https://groups.google.com/a/noaa.gov/group/ferret_users/">https://groups.google.com/a/noaa.gov/group/ferret_users/</a>&gt;</li>
<li>List-help: &lt;<a href="https://support.google.com/a/noaa.gov/bin/topic.py?topic=25838">https://support.google.com/a/noaa.gov/bin/topic.py?topic=25838</a>&gt;, &lt;<a href="mailto:ferret_users+help@noaa.gov">mailto:ferret_users+help@noaa.gov</a>&gt;</li>
<li>List-id: &lt;ferret_users.noaa.gov&gt;</li>
<li>List-post: &lt;<a href="https://groups.google.com/a/noaa.gov/group/ferret_users/post">https://groups.google.com/a/noaa.gov/group/ferret_users/post</a>&gt;, &lt;<a href="mailto:ferret_users@noaa.gov">mailto:ferret_users@noaa.gov</a>&gt;</li>
<li>Mailing-list: list <a href="mailto:ferret_users@DOMAIN.HIDDEN">ferret_users@xxxxxxxx</a>; contact <a href="mailto:ferret_users%2Bowners@DOMAIN.HIDDEN">ferret_users+owners@xxxxxxxx</a></li>
<li>References: &lt;<a href="msg00453.html">4e862735-7edd-466a-c1b1-547c0a6827e4@noaa.gov</a>&gt; &lt;<a href="msg00454.html">DF00EFF9-40AE-4368-8419-7299A222714B@uncc.edu</a>&gt; &lt;<a href="msg00455.html">d459827d-359a-f276-38e3-26e02c20e58c@noaa.gov</a>&gt; &lt;CAKE4FWoTc2wJ=h2U0s7vM_P20GynaMh=XeU70VvYpycOzKM_PA@mail.gmail.com&gt; &lt;<a href="msg00493.html">f76ab44a-0d51-b3f4-3550-b9e641b31362@noaa.gov</a>&gt; &lt;CAKE4FWpG-hdmWd_vTpO3XQL-azxJuyeqsbRS_=srAQcyZidQhw@mail.gmail.com&gt; &lt;<a href="msg00495.html">c85cebae-82eb-55c0-0adb-0db1b246425f@noaa.gov</a>&gt;</li>
<li>Sender: <a href="mailto:owner-ferret_users@DOMAIN.HIDDEN">owner-ferret_users@xxxxxxxx</a></li>
<li>User-agent: Mozilla/5.0 (Windows NT 10.0; WOW64; rv:68.0) Gecko/20100101 Thunderbird/68.3.1</li>
</ul>
<!--X-Head-of-Message-End-->
<!--X-Head-Body-Sep-Begin-->
<hr>
<!--X-Head-Body-Sep-End-->
<!--X-Body-of-Message-->

  
  
    <p>Hello again,</p>
    <p>The latitude correction is being done.&#xA0; It's just that
      subtracting a global average and the computing the definite
      integral over the entire earth are essentially repeating the same
      computation.<br>
    </p>
    <p>The operations sst[x=@AVE,Y=@AVE] and sst[x=@DIN,Y=@DIN] differ
      only in that the averaging computation is weighted by the surface
      area of the grid cells as it's computed, and the definite integral
      is not.&#xA0; This means that once we have&#xA0; subtracted the global
      average from the data, then integrating that difference again over
      the entire globe the result is essentially zero.</p>
    <p>Try this:&#xA0; Define a variable with value 1 everywhere, compute the
      definite integral over the earth:<br>
    </p>
    <p><tt>yes? let _one_ = 1+0*missing(sst,0)</tt></p>
    <p><tt>yes? list one[x=@din,y=@din]</tt><tt><br>
      </tt><tt>&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0; VARIABLE : 1+0*MISSING(SST,0)</tt><tt><br>
      </tt><tt>&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0; FILENAME : coads_climatology.cdf</tt><tt><br>
      </tt><tt>&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0; FILEPATH :
        /home/users/tmap/ferret/linux/fer_dsets/data/</tt><tt><br>
      </tt><tt>&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0; SUBSET&#xA0;&#xA0; : 12 points (TIME)</tt><tt><br>
      </tt><tt>&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0; LONGITUDE: 20E to 20E(380) (XY integ.)</tt><tt><br>
      </tt><tt>&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0; LATITUDE : 90S to 90N (XY integ.)</tt><tt><br>
      </tt><tt>&#xA0;16-JAN&#xA0;&#xA0;&#xA0;&#xA0;&#xA0; /&#xA0; 1:&#xA0; 5.101E+14</tt><tt><br>
      </tt><tt>&#xA0;15-FEB&#xA0;&#xA0;&#xA0;&#xA0;&#xA0; /&#xA0; 2:&#xA0; 5.101E+14</tt><tt><br>
      </tt><tt>&#xA0;17-MAR&#xA0;&#xA0;&#xA0;&#xA0;&#xA0; /&#xA0; 3:&#xA0; 5.101E+14</tt><tt><br>
      </tt><tt>&#xA0;16-APR&#xA0;&#xA0;&#xA0;&#xA0;&#xA0; /&#xA0; 4:&#xA0; 5.101E+14</tt><tt><br>
      </tt><tt>&#xA0;16-MAY&#xA0;&#xA0;&#xA0;&#xA0;&#xA0; /&#xA0; 5:&#xA0; 5.101E+14</tt><tt><br>
      </tt><tt>&#xA0;16-JUN&#xA0;&#xA0;&#xA0;&#xA0;&#xA0; /&#xA0; 6:&#xA0; 5.101E+14</tt><tt><br>
      </tt><tt>&#xA0;16-JUL&#xA0;&#xA0;&#xA0;&#xA0;&#xA0; /&#xA0; 7:&#xA0; 5.101E+14</tt><tt><br>
      </tt><tt>&#xA0;16-AUG&#xA0;&#xA0;&#xA0;&#xA0;&#xA0; /&#xA0; 8:&#xA0; 5.101E+14</tt><tt><br>
      </tt><tt>&#xA0;15-SEP&#xA0;&#xA0;&#xA0;&#xA0;&#xA0; /&#xA0; 9:&#xA0; 5.101E+14</tt><tt><br>
      </tt><tt>&#xA0;16-OCT&#xA0;&#xA0;&#xA0;&#xA0;&#xA0; / 10:&#xA0; 5.101E+14</tt><tt><br>
      </tt><tt>&#xA0;15-NOV&#xA0;&#xA0;&#xA0;&#xA0;&#xA0; / 11:&#xA0; 5.101E+14</tt><tt><br>
      </tt><tt>&#xA0;16-DEC&#xA0;&#xA0;&#xA0;&#xA0;&#xA0; / 12:&#xA0; 5.101E+14</tt><tt><br>
      </tt></p>
    <p><tt>! Compute the earth from the earth radius in meters:</tt><tt><br>
      </tt></p>
    <p><tt>yes? let m_radius = 6371e3</tt><tt><br>
      </tt><tt>yes? let pi = 3.141592653</tt><tt><br>
      </tt><tt>yes? let earth_area = 4*pi*m_radius^2</tt><tt><br>
      </tt><tt>yes? list earth_area </tt><tt><br>
      </tt><tt>&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0; VARIABLE : 4*PI*M_RADIUS^2</tt><tt><br>
      </tt><tt>&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0; 5.101E+14</tt><tt><br>
      </tt><br>
    </p>
    <div class="moz-cite-prefix">On 1/22/2020 5:20 PM, Ansley C. Manke
      wrote:<br>
    </div>
    <blockquote type="cite"
      cite="">
      
      <p>Hi,</p>
      <p>The listing in SHOW GRID is incorrect, but the variable does in
        fact have a 3-D grid.&#xA0; In fact this is a bug which has been
        found and fixed, so the next release will have the correct SHOW
        GRID listing:&#xA0; <a rel="nofollow" class="moz-txt-link-freetext"
          href="https://github.com/NOAA-PMEL/Ferret/issues/1961"
          moz-do-not-send="true">https://github.com/NOAA-PMEL/Ferret/issues/1961</a></p>
      <p>Another way to really check what's happening is to use the
        "stat" command to load data and show its shape<tt>:</tt><tt><br>
        </tt><tt><br>
        </tt><tt><br>
          yes? use coads_climatology<br>
        </tt></p>
      <p><tt>yes? let sstave=sst[x=@AVE,Y=@AVE]</tt></p>
      <p><tt>! This grid is indeed compressed in X and Y<br>
          yes? stat/brief sstave<br>
          &#xA0;<br>
          &#xA0;Total # of data points: 12 (1*1*1*12*1*1)<br>
          &#xA0;# flagged as bad&#xA0; data: 0<br>
          &#xA0;Minimum value: 19.037<br>
          &#xA0;Maximum value: 21.322<br>
          &#xA0;Mean&#xA0;&#xA0;&#xA0; value: 20.264 (unweighted average)</tt> </p>
      <p><tt>! This grid is not compressed, it gets its X-Y axes from
          sst</tt></p>
      <p><tt>yes? let test=sst-sstave<br>
          yes? stat/br test<br>
          &#xA0;<br>
          &#xA0;Total # of data points: 194400 (180*90*1*12*1*1)<br>
          &#xA0;# flagged as bad&#xA0; data: 89622<br>
          &#xA0;Minimum value: -23.622<br>
          &#xA0;Maximum value: 12.722<br>
          &#xA0;Mean&#xA0;&#xA0;&#xA0; value: -2.1127 (unweighted average)<br>
          <br>
        </tt></p>
      <p>Now, I do think that I see the behavior that you were asking
        about.&#xA0; I don't think it is because of the cosine correction but
        I don't yet see what is happening.&#xA0; The definite integral in XY
        of SST is expressed in degrees_C* m^2.&#xA0; So is thesecond listing,
        the integral of sst minus its overall average.&#xA0; But the integral
        of the variable "test" seems wrong.&#xA0; <br>
      </p>
      <p><tt>yes? list sst[x=@din,y=@din]</tt><tt><br>
        </tt><tt>&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0; VARIABLE : SEA SURFACE TEMPERATURE (Deg C)</tt><tt><br>
        </tt><tt>&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0; FILENAME : coads_climatology.cdf</tt><tt><br>
        </tt><tt>&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0; FILEPATH :
          /home/users/tmap/ferret/linux/fer_dsets/data/</tt><tt><br>
        </tt><tt>&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0; SUBSET&#xA0;&#xA0; : 12 points (TIME)</tt><tt><br>
        </tt><tt>&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0; LONGITUDE: 20E to 20E(380) (XY integ.)</tt><tt><br>
        </tt><tt>&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0; LATITUDE : 90S to 90N (XY integ.)</tt><tt><br>
        </tt><tt>&#xA0;16-JAN&#xA0;&#xA0;&#xA0;&#xA0;&#xA0; /&#xA0; 1:&#xA0; 6.963E+15</tt><tt><br>
        </tt><tt>&#xA0;15-FEB&#xA0;&#xA0;&#xA0;&#xA0;&#xA0; /&#xA0; 2:&#xA0; 7.009E+15</tt><tt><br>
        </tt><tt>&#xA0;17-MAR&#xA0;&#xA0;&#xA0;&#xA0;&#xA0; /&#xA0; 3:&#xA0; 7.035E+15</tt><tt><br>
        </tt><tt>&#xA0;16-APR&#xA0;&#xA0;&#xA0;&#xA0;&#xA0; /&#xA0; 4:&#xA0; 6.999E+15 </tt><tt><br>
        </tt><tt>...</tt></p>
      <p><tt>yes? let sst_m_ave = sst - `sst[x=@ave,y=@ave,t=@ave]`<br>
          &#xA0;!-&gt; DEFINE VARIABLE sst_m_ave = sst - 20.22408770542379<br>
          yes? list sst_m_ave[x=@din,y=@din]<br>
          &#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0; VARIABLE : SST - 20.22408770542379<br>
          &#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0; FILENAME : coads_climatology.cdf<br>
          &#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0; FILEPATH :
          /home/users/tmap/ferret/linux/fer_dsets/data/<br>
          &#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0; SUBSET&#xA0;&#xA0; : 12 points (TIME)<br>
          &#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0; LONGITUDE: 20E to 20E(380) (XY integ.)<br>
          &#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0; LATITUDE : 90S to 90N (XY integ.)<br>
          &#xA0;16-JAN&#xA0;&#xA0;&#xA0;&#xA0;&#xA0; /&#xA0; 1: -4.341E+14<br>
          &#xA0;15-FEB&#xA0;&#xA0;&#xA0;&#xA0;&#xA0; /&#xA0; 2: -4.144E+14<br>
          &#xA0;17-MAR&#xA0;&#xA0;&#xA0;&#xA0;&#xA0; /&#xA0; 3: -3.452E+14<br>
          &#xA0;16-APR&#xA0;&#xA0;&#xA0;&#xA0;&#xA0; /&#xA0; 4:&#xA0; 8.673E+13<br>
        </tt><tt><br>
        </tt><tt>...</tt><tt><br>
        </tt><tt><br>
        </tt><tt><br>
        </tt><tt>yes? list test[x=@din,y=@din]</tt><tt><br>
        </tt><tt>&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0; VARIABLE : SST-SSTAVE</tt><tt><br>
        </tt><tt>&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0; FILENAME : coads_climatology.cdf</tt><tt><br>
        </tt><tt>&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0; FILEPATH :
          /home/users/tmap/ferret/linux/fer_dsets/data/</tt><tt><br>
        </tt><tt>&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0; SUBSET&#xA0;&#xA0; : 12 points (TIME)</tt><tt><br>
        </tt><tt>&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0; LONGITUDE: 20E to 20E(380) (XY integ.)</tt><tt><br>
        </tt><tt>&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0; LATITUDE : 90S to 90N (XY integ.)</tt><tt><br>
        </tt><tt>&#xA0;16-JAN&#xA0;&#xA0;&#xA0;&#xA0;&#xA0; /&#xA0; 1: -142.2</tt><tt><br>
        </tt><tt>&#xA0;15-FEB&#xA0;&#xA0;&#xA0;&#xA0;&#xA0; /&#xA0; 2: -125.0</tt><tt><br>
        </tt><tt>&#xA0;17-MAR&#xA0;&#xA0;&#xA0;&#xA0;&#xA0; /&#xA0; 3:&#xA0; -93.7</tt><tt><br>
        </tt><tt>&#xA0;16-APR&#xA0;&#xA0;&#xA0;&#xA0;&#xA0; /&#xA0; 4: -137.5</tt><tt><br>
        </tt><tt>...</tt></p>
      <p><tt><br>
        </tt></p>
      <p><br>
      </p>
      <div class="moz-cite-prefix">On 1/22/2020 1:33 PM, Xiaoyu Bai
        wrote:<br>
      </div>
      <blockquote type="cite"
cite="">
        
        <div dir="ltr">Hi Ansley,
          <div><br>
          </div>
          <div>I am subtracting&#xA0;averaged value from a full subset
            variable. Like the variable test here:</div>
          <div><br>
          </div>
          <div>use coads_climatology<br>
            yes? let sstave=sst[x=@AVE,Y=@AVE]<br>
            yes? sh grid sstave<br>
            &#xA0; &#xA0; GRID GSQ1<br>
            &#xA0;name &#xA0; &#xA0; &#xA0; axis &#xA0; &#xA0; &#xA0; &#xA0; &#xA0; &#xA0; &#xA0;# pts &#xA0; start &#xA0; &#xA0; &#xA0; &#xA0; &#xA0; &#xA0; &#xA0;
            &#xA0;end &#xA0; &#xA0; &#xA0; &#xA0; &#xA0; &#xA0; &#xA0; &#xA0; subset<br>
            &#xA0;COADSX &#xA0; &#xA0;LONGITUDE &#xA0; &#xA0; &#xA0; &#xA0; &#xA0;180mr &#xA0; 21E &#xA0; &#xA0; &#xA0; &#xA0; &#xA0; &#xA0; &#xA0; &#xA0;
            &#xA0;19E(379) &#xA0; &#xA0; &#xA0; &#xA0; &#xA0; &#xA0;compressed<br>
            &#xA0;COADSY &#xA0; &#xA0;LATITUDE &#xA0; &#xA0; &#xA0; &#xA0; &#xA0; &#xA0;90 r &#xA0; 89S &#xA0; &#xA0; &#xA0; &#xA0; &#xA0; &#xA0; &#xA0; &#xA0;
            &#xA0;89N &#xA0; &#xA0; &#xA0; &#xA0; &#xA0; &#xA0; &#xA0; &#xA0; compressed<br>
            &#xA0;normal &#xA0; &#xA0;Z<br>
            &#xA0;TIME &#xA0; &#xA0; &#xA0;TIME &#xA0; &#xA0; &#xA0; &#xA0; &#xA0; &#xA0; &#xA0; &#xA0;12mr &#xA0; 16-JAN 06:00 &#xA0; &#xA0; &#xA0; &#xA0;
            16-DEC 01:20 &#xA0; &#xA0; &#xA0; &#xA0;full<br>
            yes? let test=sst-sstave<br>
            yes? sh grid test<br>
            &#xA0; &#xA0; GRID GSQ1<br>
            &#xA0;name &#xA0; &#xA0; &#xA0; axis &#xA0; &#xA0; &#xA0; &#xA0; &#xA0; &#xA0; &#xA0;# pts &#xA0; start &#xA0; &#xA0; &#xA0; &#xA0; &#xA0; &#xA0; &#xA0;
            &#xA0;end &#xA0; &#xA0; &#xA0; &#xA0; &#xA0; &#xA0; &#xA0; &#xA0; subset<br>
            &#xA0;COADSX &#xA0; &#xA0;LONGITUDE &#xA0; &#xA0; &#xA0; &#xA0; &#xA0;180mr &#xA0; 21E &#xA0; &#xA0; &#xA0; &#xA0; &#xA0; &#xA0; &#xA0; &#xA0;
            &#xA0;19E(379) &#xA0; &#xA0; &#xA0; &#xA0; &#xA0; &#xA0;compressed<br>
            &#xA0;COADSY &#xA0; &#xA0;LATITUDE &#xA0; &#xA0; &#xA0; &#xA0; &#xA0; &#xA0;90 r &#xA0; 89S &#xA0; &#xA0; &#xA0; &#xA0; &#xA0; &#xA0; &#xA0; &#xA0;
            &#xA0;89N &#xA0; &#xA0; &#xA0; &#xA0; &#xA0; &#xA0; &#xA0; &#xA0; compressed<br>
            &#xA0;normal &#xA0; &#xA0;Z<br>
            &#xA0;TIME &#xA0; &#xA0; &#xA0;TIME &#xA0; &#xA0; &#xA0; &#xA0; &#xA0; &#xA0; &#xA0; &#xA0;12mr &#xA0; 16-JAN 06:00 &#xA0; &#xA0; &#xA0; &#xA0;
            16-DEC 01:20 &#xA0; &#xA0; &#xA0; &#xA0;full<br>
          </div>
          <div>yes? sh grid sst<br>
            &#xA0; &#xA0; GRID GSQ1<br>
            &#xA0;name &#xA0; &#xA0; &#xA0; axis &#xA0; &#xA0; &#xA0; &#xA0; &#xA0; &#xA0; &#xA0;# pts &#xA0; start &#xA0; &#xA0; &#xA0; &#xA0; &#xA0; &#xA0; &#xA0;
            &#xA0;end &#xA0; &#xA0; &#xA0; &#xA0; &#xA0; &#xA0; &#xA0; &#xA0; subset<br>
            &#xA0;COADSX &#xA0; &#xA0;LONGITUDE &#xA0; &#xA0; &#xA0; &#xA0; &#xA0;180mr &#xA0; 21E &#xA0; &#xA0; &#xA0; &#xA0; &#xA0; &#xA0; &#xA0; &#xA0;
            &#xA0;19E(379) &#xA0; &#xA0; &#xA0; &#xA0; &#xA0; &#xA0;full<br>
            &#xA0;COADSY &#xA0; &#xA0;LATITUDE &#xA0; &#xA0; &#xA0; &#xA0; &#xA0; &#xA0;90 r &#xA0; 89S &#xA0; &#xA0; &#xA0; &#xA0; &#xA0; &#xA0; &#xA0; &#xA0;
            &#xA0;89N &#xA0; &#xA0; &#xA0; &#xA0; &#xA0; &#xA0; &#xA0; &#xA0; full<br>
            &#xA0;normal &#xA0; &#xA0;Z<br>
            &#xA0;TIME &#xA0; &#xA0; &#xA0;TIME &#xA0; &#xA0; &#xA0; &#xA0; &#xA0; &#xA0; &#xA0; &#xA0;12mr &#xA0; 16-JAN 06:00 &#xA0; &#xA0; &#xA0; &#xA0;
            16-DEC 01:20 &#xA0; &#xA0; &#xA0; &#xA0;full<br>
          </div>
          <div><br>
          </div>
          <div>What I am expecting to see is, after sst minus sstave,
            the result still have a full subset like sst. But ferret
            tends to give&#xA0;sstave's grid to the new variable. This
            behavior is blocking me from applying&#xA0;@DIN because the
            cosine correction was no longer applying.
            adj_EB_land_CNRM_AM5 in my analysis is like the variable
            TEST here, it is defined as the result of a 3D (x,y,t)
            variable minus a 1D (X=@AVE,Y=@AVE,t) variable. The 1D value
            will be subtracted from each grid of the 3D variable.
            Although this calculation may be weird&#xA0;to ferret, the result
            should be a 3D variable since the grids are still there.</div>
          <div><br>
          </div>
          <div>I hope I made things clearer this time.</div>
          <div><br>
          </div>
          <div>Thank you so much for your time.</div>
          <div><br>
          </div>
          <div>Xiaoyu&#xA0; &#xA0;</div>
        </div>
        <br>
        <div class="gmail_quote">
          <div dir="ltr" class="gmail_attr">On Wed, Jan 22, 2020 at 2:15
            PM Ansley C. Manke &lt;<a rel="nofollow"
              href="mailto:ansley.b.manke@xxxxxxxx"
              moz-do-not-send="true">ansley.b.manke@xxxxxxxx</a>&gt;
            wrote:<br>
          </div>
          <blockquote class="gmail_quote" style="margin:0px 0px 0px
            0.8ex;border-left:1px solid
            rgb(204,204,204);padding-left:1ex">
            <div>
              <p>Hi,</p>
              <p>Once the data has been averaged, applying @DIN in the
                same directions does not make sense, as there is nothing
                to integrate. I'm not sure how adj_EB_land_CNRM_AM5 is
                computed but if its grid in the X and Y directions shows
                as compressed, then there is no dependence on those
                directions and pyferret should refuse to even compute a
                @DIN transformation.&#xA0; To show a simple example,<br>
              </p>
              <p><br>
                <tt>yes? use coads_climatology</tt><tt><br>
                </tt><tt>yes? let sstave = sst[x=@ave,y=@ave]</tt></p>
              <p><tt>yes? show grid sstave</tt><tt><br>
                </tt><tt>&#xA0;&#xA0;&#xA0; GRID GSQ1</tt><tt><br>
                </tt><tt>&#xA0;name&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0; axis&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0; # pts&#xA0;&#xA0;
                  start&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0; end&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0; subset</tt><tt><br>
                </tt><tt>&#xA0;COADSX&#xA0;&#xA0;&#xA0; LONGITUDE&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0; 180mr&#xA0;&#xA0;
                  21E&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0; 19E(379)&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0; compressed</tt><tt><br>
                </tt><tt>&#xA0;COADSY&#xA0;&#xA0;&#xA0; LATITUDE&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0; 90 r&#xA0;&#xA0;
                  89S&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0; 89N&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0; compressed</tt><tt><br>
                </tt><tt>&#xA0;normal&#xA0;&#xA0;&#xA0; Z</tt><tt><br>
                </tt><tt>&#xA0;TIME&#xA0;&#xA0;&#xA0;&#xA0;&#xA0; TIME&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0; 12mr&#xA0;&#xA0; 16-JAN
                  06:00&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0; 16-DEC 01:20&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0; full</tt><tt><br>
                </tt></p>
              <p><tt>yes? list sstave[x=@din,y=@din]<br>
                  **ERROR: illegal use of transformation:
                  SSTAVE[X=20E:20E(380)@IN4,D=1] applied to point<br>
                </tt></p>
              <p><tt><br>
                </tt></p>
              <p>So, I am not sure I understand what you are doing.&#xA0; How
                is adj_EB_land_CNRM_AM5&#xA0; defined?</p>
              <p>Sometimes if the order of operations that PyFerret uses
                is not what you need, a method can be to write
                intermediate results to a file and then read that back
                in to, say, subtract from another _expression_.</p>
              <p><br>
              </p>
              <p>-Ansley<br>
              </p>
              <p><br>
              </p>
              <div>On 1/21/2020 12:05 PM, Xiaoyu Bai wrote:<br>
              </div>
              <blockquote type="cite">
                <div dir="ltr">
                  <div dir="ltr">Hi Ansley,
                    <div><br>
                    </div>
                    <div>What I am trying to do is to subtract global
                      average (@AVE, which is only ONE value for the
                      whole globe) from model output (which has value at
                      every grid). This calculation may be weird to
                      pyferret but I have to use this method to adjust
                      the model's energy budget.&#xA0; &#xA0;&#xA0;</div>
                    <div>yes? sh grid adj_EB_land_CNRM_AM5 (adjusted
                      value), AHT_land_CNRM_AM5 (energy budget)<br>
                      &#xA0; &#xA0; GRID (G033)<br>
                      &#xA0;name &#xA0; &#xA0; &#xA0; axis &#xA0; &#xA0; &#xA0; &#xA0; &#xA0; &#xA0; &#xA0;# pts &#xA0; start &#xA0; &#xA0; &#xA0;
                      &#xA0; &#xA0; &#xA0; &#xA0; &#xA0;end &#xA0; &#xA0; &#xA0; &#xA0; &#xA0; &#xA0; &#xA0; &#xA0; subset<br>
                      &#xA0;LON &#xA0; &#xA0; &#xA0; LONGITUDE &#xA0; &#xA0; &#xA0; &#xA0; &#xA0;256mr &#xA0; 0E &#xA0; &#xA0; &#xA0; &#xA0; &#xA0;
                      &#xA0; &#xA0; &#xA0; &#xA0; 1.406W(358.59) &#xA0; &#xA0; &#xA0;compressed<br>
                      &#xA0;LAT &#xA0; &#xA0; &#xA0; LATITUDE &#xA0; &#xA0; &#xA0; &#xA0; &#xA0; 128 i &#xA0; 88.928S &#xA0; &#xA0;
                      &#xA0; &#xA0; &#xA0; &#xA0; &#xA0;88.928N &#xA0; &#xA0; &#xA0; &#xA0; &#xA0; &#xA0; compressed<br>
                      &#xA0;PLEV &#xA0; &#xA0; &#xA0;Z (Pa) &#xA0; &#xA0; &#xA0; &#xA0; &#xA0; &#xA0; &#xA0;17 i- &#xA0;1000 &#xA0; &#xA0; &#xA0; &#xA0;
                      &#xA0; &#xA0; &#xA0; &#xA0; 100000 &#xA0; &#xA0; &#xA0; &#xA0; &#xA0; &#xA0; &#xA0;compressed<br>
                      &#xA0;MONTH_GREGORIAN TIME &#xA0; &#xA0; &#xA0; &#xA0; &#xA0;12mi &#xA0; 16-JAN 12:00
                      &#xA0; &#xA0; &#xA0; &#xA0; 15-DEC 17:49 &#xA0; &#xA0; &#xA0; &#xA0;full<br>
                      &#xA0; &#xA0; GRID (G033)<br>
                      &#xA0;name &#xA0; &#xA0; &#xA0; axis &#xA0; &#xA0; &#xA0; &#xA0; &#xA0; &#xA0; &#xA0;# pts &#xA0; start &#xA0; &#xA0; &#xA0;
                      &#xA0; &#xA0; &#xA0; &#xA0; &#xA0;end &#xA0; &#xA0; &#xA0; &#xA0; &#xA0; &#xA0; &#xA0; &#xA0; subset<br>
                      &#xA0;LON &#xA0; &#xA0; &#xA0; LONGITUDE &#xA0; &#xA0; &#xA0; &#xA0; &#xA0;256mr &#xA0; 0E &#xA0; &#xA0; &#xA0; &#xA0; &#xA0;
                      &#xA0; &#xA0; &#xA0; &#xA0; 1.406W(358.59) &#xA0; &#xA0; &#xA0;full<br>
                      &#xA0;LAT &#xA0; &#xA0; &#xA0; LATITUDE &#xA0; &#xA0; &#xA0; &#xA0; &#xA0; 128 i &#xA0; 88.928S &#xA0; &#xA0;
                      &#xA0; &#xA0; &#xA0; &#xA0; &#xA0;88.928N &#xA0; &#xA0; &#xA0; &#xA0; &#xA0; &#xA0; full<br>
                      &#xA0;PLEV &#xA0; &#xA0; &#xA0;Z (Pa) &#xA0; &#xA0; &#xA0; &#xA0; &#xA0; &#xA0; &#xA0;17 i- &#xA0;1000 &#xA0; &#xA0; &#xA0; &#xA0;
                      &#xA0; &#xA0; &#xA0; &#xA0; 100000 &#xA0; &#xA0; &#xA0; &#xA0; &#xA0; &#xA0; &#xA0;compressed<br>
                      &#xA0;MONTH_GREGORIAN TIME &#xA0; &#xA0; &#xA0; &#xA0; &#xA0;12mi &#xA0; 16-JAN 12:00
                      &#xA0; &#xA0; &#xA0; &#xA0; 15-DEC 17:49 &#xA0; &#xA0; &#xA0; &#xA0;full<br>
                    </div>
                    <div><br>
                    </div>
                    <div>The incorrect grid affects my further
                      calculation. I need to apply&#xA0;@DIN to
                      my&#xA0;adj_EB_land_CNRM_AM5. Since the grid is
                      compressed, pyferret doesn't apply cosine
                      correction anymore. My proof for this is the value
                      for AHT_land_CNRM_AM5 is around -100 to 50.
                      The&#xA0;@AVE value is 4.021. So the
                      adj_EB_land_CNRM_AM5 value is roughly around -104
                      to 46. If I apply&#xA0;@DIN for both latitude and
                      longitude to AHT_land_CNRM_AM5, the outcome is
                      2.051E+15 W/m2 which makes sense. If I apply&#xA0;@DIN
                      to&#xA0;adj_EB_land_CNRM_AM5, the outcome is -61.33
                      W/m2 which doesn't make sense.&#xA0;</div>
                    <div><br>
                    </div>
                    <div>list/L=7 AHT_land_CNRM_AM5[X=@DIN,Y=@DIN],
                      adj_EB_land_CNRM_AM5[X=@DIN,Y=@Din]<br>
                      &#xA0; &#xA0; &#xA0; &#xA0; &#xA0; &#xA0; &#xA0;LONGITUDE: 0.7W(-0.7) to 0.7W(359.3)
                      (XY integ.)<br>
                      &#xA0; &#xA0; &#xA0; &#xA0; &#xA0; &#xA0; &#xA0;LATITUDE: 90S to 90N (XY integ.)<br>
                      &#xA0; &#xA0; &#xA0; &#xA0; &#xA0; &#xA0; &#xA0;TIME: 15-JUL 17:49<br>
                      &#xA0;Column &#xA0;1: AHT_LAND_CNRM_AM5 is
SWABS_LAND_CNRM_AM5-OLR_LAND_CNRM_AM5+SHF_LAND_CNRM_AM5-STORAGE_LAND_CNRM_AM5<br>
                      &#xA0;Column &#xA0;2: ADJ_EB_LAND_CNRM_AM5 is
                      AHT_LAND_CNRM_AM5-EB_LAND_CNRM_AM5<br>
                      &#xA0; &#xA0; &#xA0; &#xA0; &#xA0; AHT_LAND_ &#xA0;ADJ_EB_LAND_CNRM_AM5<br>
                      I / *: &#xA0; &#xA0; 2.051E+15 &#xA0;-61.33<br>
                    </div>
                    <div><br>
                    </div>
                    <div>So I tried with a single month to
                      use&#xA0;AHT_land_CNRM_AM5 just minus the ave value
                      which is 4.021.</div>
                    <div>&#xA0; &#xA0;</div>
                    <div>yes? let test=AHT_land_CNRM_AM5-4.021<br>
                      yes? list/L=7 AHT_land_CNRM_AM5[X=@DIN,Y=@DIN],
                      adj_EB_land_CNRM_AM5[X=@DIN,Y=@DIN],
                      test[X=@DIN,Y=@DIN] <br>
                      &#xA0; &#xA0; &#xA0; &#xA0; &#xA0; &#xA0; &#xA0;LONGITUDE: 0.7W(-0.7) to 0.7W(359.3)
                      (XY integ.)<br>
                      &#xA0; &#xA0; &#xA0; &#xA0; &#xA0; &#xA0; &#xA0;LATITUDE: 90S to 90N (XY integ.)<br>
                      &#xA0; &#xA0; &#xA0; &#xA0; &#xA0; &#xA0; &#xA0;TIME: 15-JUL 17:49<br>
                      &#xA0;Column &#xA0;1: AHT_LAND_CNRM_AM5 is
SWABS_LAND_CNRM_AM5-OLR_LAND_CNRM_AM5+SHF_LAND_CNRM_AM5-STORAGE_LAND_CNRM_AM5<br>
                      &#xA0;Column &#xA0;2: ADJ_EB_LAND_CNRM_AM5 is
                      AHT_LAND_CNRM_AM5-EB_LAND_CNRM_AM5<br>
                      &#xA0;Column &#xA0;3: TEST is AHT_LAND_CNRM_AM5-4.021<br>
                      &#xA0; &#xA0; &#xA0; &#xA0; &#xA0; AHT_LAND_ &#xA0;ADJ_EB_ &#xA0; &#xA0;TEST<br>
                      I / *: &#xA0; &#xA0; 2.051E+15 &#xA0;-61.33 &#xA0;1.507E+11<br>
                    </div>
                    <div><br>
                    </div>
                    <div>These results are indicating that pyferret was
                      not applying cosine correction to compressed
                      latitude and longitude (which makes sense to
                      ferret since it's compressed). But I have 10
                      models with 12 months' data, it's hard for me to
                      subtract the value one by one. I am wondering
                      whether there are some methods that I can transfer
                      the&#xA0;@AVE value into a numeric or I can
                      regrid&#xA0;adj_EB_land_CNRM_AM5 to be
                      like&#xA0;AHT_land_CNRM_AM5 (I already tried with
                      let/like=AHT_land_CNRM_AM5
                      adj_EB_land_CNRM_AM5=AHT_land_CNRM_AM5-EB_land_CNRM_AM5(this
                      the @AVE variable) and set variable/name=tt
                      adj_EB_land_CNRM_AM5 \&#xA0; let
                      adj_EB_land_CNRM_AM5=tt[g=AHT_land_CNRM_AM5,gt=@ASN]
                      but neither of them worked). I tend to use
                      transfering @AVE to a numeric method now. Any
                      suggestions?</div>
                    <div><br>
                    </div>
                    <div>Thank you very much.</div>
                    <div><br>
                    </div>
                    <div>Xiaoyu</div>
                    <div><br>
                    </div>
                    <div>&#xA0;</div>
                  </div>
                  <br>
                  <div class="gmail_quote">
                    <div dir="ltr" class="gmail_attr">On Wed, Dec 4,
                      2019 at 1:04 PM Ansley C. Manke &lt;<a rel="nofollow"
                        href="mailto:ansley.b.manke@xxxxxxxx"
                        target="_blank" moz-do-not-send="true">ansley.b.manke@xxxxxxxx</a>&gt;
                      wrote:<br>
                    </div>
                    <blockquote class="gmail_quote" style="margin:0px
                      0px 0px 0.8ex;border-left:1px solid
                      rgb(204,204,204);padding-left:1ex">
                      <div>
                        <p>Hi,</p>
                        <p>Maybe this is just some detail in the
                          syntax.&#xA0; The coordinate axes for the variable
                          "temp" are not actually compressed, it's just
                          that SHOW GRID is incorrectly saying they
                          are.&#xA0; Are you seeing an error message?&#xA0; If
                          this doesn't resolve things, please send more
                          about the commands you are using and the
                          results.</p>
                        <p>Your original example was with
                          levitus_climatology, so let's go back to that.
                          <br>
                        </p>
                        <p><tt>yes? use levitus_climatology</tt><br>
                          <tt>yes? let test=TEMP-TEMP[X=@AVE,Y=@AVE]</tt><br>
                          <br>
                          <tt>yes? list test[x=@din,y=@din]</tt><br>
                          <tt>&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0; VARIABLE :
                            TEMP-TEMP[X=@AVE,Y=@AVE]</tt><br>
                          <tt>&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0; FILENAME :
                            levitus_climatology.cdf</tt><br>
                          <tt>&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0; FILEPATH :
                            /home/users/tmap/ferret/linux/fer_dsets/data/</tt><br>
                          <tt>&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0; SUBSET&#xA0;&#xA0; : 20 points (DEPTH
                            (m))</tt><br>
                          <tt>&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0; LONGITUDE: 20E to 20E(380)
                            (XY integ.)</tt><br>
                          <tt>&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0; LATITUDE : 90S to 90N (XY
                            integ.)</tt><br>
                          <tt>&#xA0;0&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0; /&#xA0; 1: -538.5</tt><br>
                          <tt>&#xA0;10&#xA0;&#xA0;&#xA0;&#xA0;&#xA0; /&#xA0; 2: -633.9</tt><br>
                          <tt>&#xA0;20&#xA0;&#xA0;&#xA0;&#xA0;&#xA0; /&#xA0; 3: -530.8</tt><br>
                          <tt>&#xA0;30&#xA0;&#xA0;&#xA0;&#xA0;&#xA0; /&#xA0; 4: -575.1</tt><br>
                          <tt>&#xA0;50&#xA0;&#xA0;&#xA0;&#xA0;&#xA0; /&#xA0; 5: -335.4</tt><br>
                          <tt>&#xA0;75&#xA0;&#xA0;&#xA0;&#xA0;&#xA0; /&#xA0; 6: -440.2</tt><br>
                          <tt>&#xA0;100&#xA0;&#xA0;&#xA0;&#xA0; /&#xA0; 7: -459.0</tt><br>
                          <tt>&#xA0;150&#xA0;&#xA0;&#xA0;&#xA0; /&#xA0; 8: -405.4</tt><br>
                          <tt>&#xA0;200&#xA0;&#xA0;&#xA0;&#xA0; /&#xA0; 9: -287.2</tt><br>
                          <tt>&#xA0;300&#xA0;&#xA0;&#xA0;&#xA0; / 10: -305.7</tt><br>
                          <tt>&#xA0;400&#xA0;&#xA0;&#xA0;&#xA0; / 11: -234.4</tt><br>
                          <tt>&#xA0;600&#xA0;&#xA0;&#xA0;&#xA0; / 12: -118.7</tt><br>
                          <tt>&#xA0;800&#xA0;&#xA0;&#xA0;&#xA0; / 13: -113.0</tt><br>
                          <tt>&#xA0;1000&#xA0;&#xA0;&#xA0; / 14:&#xA0; -73.9</tt><br>
                          <tt>&#xA0;1200&#xA0;&#xA0;&#xA0; / 15:&#xA0; -52.0</tt><br>
                          <tt>&#xA0;1500&#xA0;&#xA0;&#xA0; / 16:&#xA0; -35.0</tt><br>
                          <tt>&#xA0;2000&#xA0;&#xA0;&#xA0; / 17:&#xA0;&#xA0; -6.6</tt><br>
                          <tt>&#xA0;3000&#xA0;&#xA0;&#xA0; / 18:&#xA0; -13.9</tt><br>
                          <tt>&#xA0;4000&#xA0;&#xA0;&#xA0; / 19:&#xA0;&#xA0;&#xA0; 7.7</tt><br>
                          <tt>&#xA0;5000&#xA0;&#xA0;&#xA0; / 20:&#xA0;&#xA0;&#xA0; 0.5</tt><br>
                        </p>
                        <div>On 12/3/2019 6:02 PM, Xiaoyu Bai wrote:<br>
                        </div>
                        <blockquote type="cite"> I picked the wrong
                          word. I do want to remove the mean over lat
                          and Lon. After that I want to apply @DIN. The
                          compressed coordinates blocked @DIN to work. I
                          tried with TEMP-Temp[x=@ave, y=@ave] and
                          TEMP-number. They gave me very different
                          results.
                          <div><br>
                          </div>
                          <div>Thank you &#x1F60A;&#xA0;<br>
                            <br>
                            <div dir="ltr">Xiaoyu</div>
                            <div dir="ltr"><br>
                              <blockquote type="cite">&#x5728;
                                2019&#x5E74;12&#x6708;3&#x65E5;&#xFF0C;&#x4E0B;&#x5348;8:13&#xFF0C;Ansley C. Manke <a rel="nofollow"
                                  href="mailto:ansley.b.manke@xxxxxxxx"
                                  target="_blank" moz-do-not-send="true">&lt;ansley.b.manke@xxxxxxxx&gt;</a>
                                &#x5199;&#x9053;&#xFF1A;<br>
                                <br>
                              </blockquote>
                            </div>
                            <blockquote type="cite">
                              <div dir="ltr">&#xFEFF;
                                <p>Hi Xiaoyu,</p>
                                <p>First, what you have done with
                                  TEMP-TEMP[X=@AVE,Y=@AVE] is to remove
                                  the mean over longitude and latitude.&#xA0;
                                  That will not be less noisy.&#xA0; If you
                                  want to work with a less-noisy version
                                  of TEMP, you might use one of the
                                  smoothing transformations such as the
                                  boxcar smoother, @SBX.&#xA0; Here is a list
                                  of all the transformations: <br>
                                </p>
                                <p><a rel="nofollow"
href="https://ferret.pmel.noaa.gov/Ferret/documentation/users-guide/variables-xpressions/XPRESSIONS#Chapter3-Transformations"
                                    target="_blank"
                                    moz-do-not-send="true">https://ferret.pmel.noaa.gov/Ferret/documentation/users-guide/variables-xpressions/XPRESSIONS#Chapter3-Transformations</a>,
                                  and further down that page are
                                  detailed descriptions of the different
                                  transformations.<br>
                                </p>
                                <p><br>
                                </p>
                                <p>Now, it looks as if you've discovered
                                  an error in the SHOW GRID output.&#xA0; It
                                  should not be listing the x and y axes
                                  as "compressed".&#xA0; So we'll look into
                                  that.<br>
                                </p>
                                <tt>yes? use coads_climatology<br>
                                  yes? let sst_demean =&#xA0; sst -
                                  sst[x=@ave,y=@ave]<br>
                                  <br>
                                  yes? show grid sst_demean<br>
                                  &#xA0;&#xA0;&#xA0; GRID GSQ1<br>
                                  &#xA0;name&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0; axis&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0; # pts&#xA0;&#xA0;
                                  start&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;
                                  end&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0; subset<br>
                                  &#xA0;COADSX&#xA0;&#xA0;&#xA0; LONGITUDE&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0; 180mr&#xA0;&#xA0;
                                  21E&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;
                                  19E(379)&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0; compressed<br>
                                  &#xA0;COADSY&#xA0;&#xA0;&#xA0; LATITUDE&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0; 90 r&#xA0;&#xA0;
                                  89S&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;
                                  89N&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0; compressed<br>
                                  &#xA0;normal&#xA0;&#xA0;&#xA0; Z<br>
                                  &#xA0;TIME&#xA0;&#xA0;&#xA0;&#xA0;&#xA0; TIME&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0; 12mr&#xA0;&#xA0;
                                  16-JAN 06:00&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0; 16-DEC
                                  01:20&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0; full<br>
                                </tt><br>
                                <p>However <tt>sst_demean </tt>does
                                  still vary in longitude and latitude.&#xA0;
                                  See how STAT shows 180 points in X and
                                  90 points in Y, and a plot at one time
                                  and latitude varies in X.<br>
                                </p>
                                <tt>&#xA0;<br>
                                  yes? stat/brief sst_demean<br>
                                  &#xA0;<br>
                                  &#xA0;Total # of data points: 194400
                                  (180*90*1*12*1*1)<br>
                                  &#xA0;# flagged as bad&#xA0; data: 89622<br>
                                  &#xA0;Minimum value: -23.622<br>
                                  &#xA0;Maximum value: 12.722<br>
                                  &#xA0;Mean&#xA0;&#xA0;&#xA0; value: -2.1127 (unweighted
                                  average)<br>
                                </tt><tt><br>
                                </tt><tt>yes? plot/L=1/y=0 sst_demean</tt><br>
                                <p><br>
                                </p>
                                <p>First, what you have done with
                                  TEMP-TEMP[X=@AVE,Y=@AVE] is merely to
                                  remove the mean.&#xA0; If you want a
                                  less-noisy version of TEMP, you might
                                  look at the smoothing transformations.
                                  Here is a list of all the
                                  transformations: <br>
                                </p>
                                <p><a rel="nofollow"
href="https://ferret.pmel.noaa.gov/Ferret/documentation/users-guide/variables-xpressions/XPRESSIONS#Chapter3-Transformations"
                                    target="_blank"
                                    moz-do-not-send="true">https://ferret.pmel.noaa.gov/Ferret/documentation/users-guide/variables-xpressions/XPRESSIONS#Chapter3-Transformations</a><br>
                                </p>
                                <p><br>
                                </p>
                                <p><br>
                                </p>
                                <p><br>
                                </p>
                                <div>On 12/3/2019 4:38 PM, Xiaoyu Bai
                                  wrote:<br>
                                </div>
                                <blockquote type="cite">
                                  <div dir="ltr">Dear ferreters,
                                    <div><br>
                                    </div>
                                    <div>I noticed that when I subtract
                                      area average from a variable, it
                                      will make the variable's Lat and
                                      Lon become&#xA0;compressed instead of
                                      full. For example:</div>
                                    <div><br>
                                    </div>
                                    <div>use levi_climatology</div>
                                    <div>let
                                      test=TEMP-TEMP[X=@AVE,Y=@AVE]<br>
                                    </div>
                                    <div>sh grid TEMP,test<br>
                                      &#xA0; &#xA0; GRID GMS1<br>
                                      &#xA0;name &#xA0; &#xA0; &#xA0; axis &#xA0; &#xA0; &#xA0; &#xA0; &#xA0; &#xA0; &#xA0;#
                                      pts &#xA0; start &#xA0; &#xA0; &#xA0; &#xA0; &#xA0; &#xA0; &#xA0; &#xA0;end &#xA0; &#xA0;
                                      &#xA0; &#xA0; &#xA0; &#xA0; &#xA0; &#xA0; subset<br>
                                      &#xA0;XAXLEVITR LONGITUDE &#xA0; &#xA0; &#xA0; &#xA0;
                                      &#xA0;360mr &#xA0; 20.5E &#xA0; &#xA0; &#xA0; &#xA0; &#xA0; &#xA0; &#xA0;
                                      &#xA0;19.5E(379.5) &#xA0; &#xA0; &#xA0; &#xA0;full<br>
                                      &#xA0;YAXLEVITR LATITUDE &#xA0; &#xA0; &#xA0; &#xA0; &#xA0; 180
                                      r &#xA0; 89.5S &#xA0; &#xA0; &#xA0; &#xA0; &#xA0; &#xA0; &#xA0; &#xA0;89.5N &#xA0; &#xA0;
                                      &#xA0; &#xA0; &#xA0; &#xA0; &#xA0; full<br>
                                      &#xA0;ZAXLEVITR DEPTH (m) &#xA0; &#xA0; &#xA0; &#xA0; &#xA0; 20
                                      i- &#xA0;0 &#xA0; &#xA0; &#xA0; &#xA0; &#xA0; &#xA0; &#xA0; &#xA0; &#xA0; &#xA0;5000 &#xA0; &#xA0;
                                      &#xA0; &#xA0; &#xA0; &#xA0; &#xA0; &#xA0;full<br>
                                      &#xA0;normal &#xA0; &#xA0;T<br>
                                      &#xA0; &#xA0; GRID GMS1<br>
                                      &#xA0;name &#xA0; &#xA0; &#xA0; axis &#xA0; &#xA0; &#xA0; &#xA0; &#xA0; &#xA0; &#xA0;#
                                      pts &#xA0; start &#xA0; &#xA0; &#xA0; &#xA0; &#xA0; &#xA0; &#xA0; &#xA0;end &#xA0; &#xA0;
                                      &#xA0; &#xA0; &#xA0; &#xA0; &#xA0; &#xA0; subset<br>
                                      &#xA0;XAXLEVITR LONGITUDE &#xA0; &#xA0; &#xA0; &#xA0;
                                      &#xA0;360mr &#xA0; 20.5E &#xA0; &#xA0; &#xA0; &#xA0; &#xA0; &#xA0; &#xA0;
                                      &#xA0;19.5E(379.5) &#xA0; &#xA0; &#xA0; &#xA0;compressed<br>
                                      &#xA0;YAXLEVITR LATITUDE &#xA0; &#xA0; &#xA0; &#xA0; &#xA0; 180
                                      r &#xA0; 89.5S &#xA0; &#xA0; &#xA0; &#xA0; &#xA0; &#xA0; &#xA0; &#xA0;89.5N &#xA0; &#xA0;
                                      &#xA0; &#xA0; &#xA0; &#xA0; &#xA0; compressed<br>
                                      &#xA0;ZAXLEVITR DEPTH (m) &#xA0; &#xA0; &#xA0; &#xA0; &#xA0; 20
                                      i- &#xA0;0 &#xA0; &#xA0; &#xA0; &#xA0; &#xA0; &#xA0; &#xA0; &#xA0; &#xA0; &#xA0;5000 &#xA0; &#xA0;
                                      &#xA0; &#xA0; &#xA0; &#xA0; &#xA0; &#xA0;full<br>
                                      &#xA0;normal &#xA0; &#xA0;T<br>
                                    </div>
                                    <div><br>
                                    </div>
                                    <div>What I want is to get a less
                                      noisy variable, then apply&#xA0;@DIN to
                                      it. But this compressed grid was
                                      blocking me to use @DIN.</div>
                                    <div><br>
                                    </div>
                                    <div>So I am wondering how to get my
                                      coordinate to full again.</div>
                                    <div><br>
                                    </div>
                                    <div>Thank you in advance.</div>
                                    <div>&#xA0;</div>
                                    <div>-- <br>
                                      <div dir="ltr">
                                        <div dir="ltr">Xiaoyu</div>
                                      </div>
                                    </div>
                                  </div>
                                </blockquote>
                              </div>
                            </blockquote>
                          </div>
                        </blockquote>
                      </div>
                    </blockquote>
                  </div>
                  <br clear="all">
                  <div><br>
                  </div>
                  -- <br>
                  <div dir="ltr">
                    <div dir="ltr">Xiaoyu</div>
                  </div>
                </div>
              </blockquote>
            </div>
          </blockquote>
        </div>
        <br clear="all">
        <div><br>
        </div>
        -- <br>
        <div dir="ltr" class="gmail_signature">
          <div dir="ltr">Xiaoyu</div>
        </div>
      </blockquote>
    </blockquote>
  


<!--X-Body-of-Message-End-->
<!--X-MsgBody-End-->
<!--X-Follow-Ups-->
<hr>
<ul><li><strong>Follow-Ups</strong>:
<ul>
<li><strong><a name="00501" href="msg00501.html">Re: [ferret_users] grid compressed after subtract area average</a></strong>
<ul><li><em>From:</em> Xiaoyu Bai</li></ul></li>
</ul></li></ul>
<!--X-Follow-Ups-End-->
<!--X-References-->
<ul><li><strong>References</strong>:
<ul>
<li><strong><a name="00453" href="msg00453.html">Re: [ferret_users] grid compressed after subtract area average</a></strong>
<ul><li><em>From:</em> Ansley C. Manke</li></ul></li>
<li><strong><a name="00454" href="msg00454.html">Re: [ferret_users] grid compressed after subtract area average</a></strong>
<ul><li><em>From:</em> Xiaoyu Bai</li></ul></li>
<li><strong><a name="00455" href="msg00455.html">Re: [ferret_users] grid compressed after subtract area average</a></strong>
<ul><li><em>From:</em> Ansley C. Manke</li></ul></li>
<li><strong><a name="00490" href="msg00490.html">Re: [ferret_users] grid compressed after subtract area average</a></strong>
<ul><li><em>From:</em> Xiaoyu Bai</li></ul></li>
<li><strong><a name="00493" href="msg00493.html">Re: [ferret_users] grid compressed after subtract area average</a></strong>
<ul><li><em>From:</em> Ansley C. Manke</li></ul></li>
<li><strong><a name="00494" href="msg00494.html">Re: [ferret_users] grid compressed after subtract area average</a></strong>
<ul><li><em>From:</em> Xiaoyu Bai</li></ul></li>
<li><strong><a name="00495" href="msg00495.html">Re: [ferret_users] grid compressed after subtract area average</a></strong>
<ul><li><em>From:</em> Ansley C. Manke</li></ul></li>
</ul></li></ul>
<!--X-References-End-->
<!--X-BotPNI-->
<UL>
<li>Previous by thread:
<strong><a href="msg00495.html">Re: [ferret_users] grid compressed after subtract area average</a></strong>
</li>
<li>Next by thread:
<strong><a href="msg00501.html">Re: [ferret_users] grid compressed after subtract area average</a></strong>
</li>

</UL>
<center>[<a href="msg00495.html">Thread Prev</a>][<a href="msg00501.html">Thread Next</a>][<A HREF="threads.html#00500">Index</A>]</center>

<!--X-BotPNI-End-->
<!--X-User-Footer-->
<A HREF="http://ferret.pmel.noaa.gov/Ferret/contact-us">Contact Us</A>
<br>
<font size=-1>
<address>
<a href="http://www.doc.gov">Dept of Commerce</a> /
<a href="http://www.noaa.gov">NOAA</a> /
<a href="http://www.oar.noaa.gov">OAR</a> /
<a href="http://www.pmel.noaa.gov">PMEL</a> /
<a href="http://ferret.pmel.noaa.gov">Ferret</a>
</address>

<br>
 <a href="http://www.noaa.gov/privacy.html">Privacy Policy</a> | <a href="http://www.noaa.gov/disclaimer.html">Disclaimer</a> | <a href="accessibility.html">Accessibility Statement</a> 

</font>
<!--X-User-Footer-End-->
</body>
</html>
