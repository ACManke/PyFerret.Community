<!-- MHonArc v2.6.18 -->
<!--X-Subject: Re: [ferret_users] Adding non&#45;consecutive levels containing missing values -->
<!--X-From-R13: "Oafyrl Q. [naxr" <nafyrl.o.znaxrNabnn.tbi> -->
<!--X-Date: Thu, 27 Feb 2020 10:07:45 &#45;0800 -->
<!--X-Message-Id: d4089ba4&#45;5594&#45;36e6&#45;92da&#45;c1448ff21a6b@noaa.gov -->
<!--X-Content-Type: multipart/alternative -->
<!--X-Reference: d95d2f78&#45;5a1d&#45;2e10&#45;3008&#45;e7698b694f8f.ref@yahoo.it -->
<!--X-Reference: d95d2f78&#45;5a1d&#45;2e10&#45;3008&#45;e7698b694f8f@yahoo.it -->
<!--X-Reference: CAEwQpaKfdcb+Be2pS+ENm2W5OfXgQvFLBSHxXNb+6USZZo2Y6g@mail.gmail.com -->
<!--X-Head-End-->
<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN"
        "http://www.w3.org/TR/html4/loose.dtd">
<html>
<head>
<title>Re: [ferret_users] Adding non-consecutive levels containing missing values</title>
</head>
<body>
<!--X-Body-Begin-->
<!--X-User-Header-->
<!--X-User-Header-End-->
<!--X-TopPNI-->
<HR>
<center>[<a href="msg00550.html">Thread Prev</a>][<a href="msg00552.html">Thread Next</a>][<A HREF="threads.html#00551">Index</A>]</center>

<!--X-TopPNI-End-->
<!--X-MsgBody-->
<!--X-Subject-Header-Begin-->
<h1>Re: [ferret_users] Adding non-consecutive levels containing missing values</h1>
<hr>
<!--X-Subject-Header-End-->
<!--X-Head-of-Message-->
<ul>
<li><strong>To</strong>: <strong><a href="mailto:ferret_users@DOMAIN.HIDDEN">ferret_users@xxxxxxxx</a></strong></li>
<li><strong>Subject</strong>: <strong>Re: [ferret_users] Adding non-consecutive levels containing missing values</strong></li>
<li><strong>From</strong>: <strong>&quot;Ansley C. Manke&quot; &lt;<a href="mailto:ansley.b.manke@DOMAIN.HIDDEN">ansley.b.manke@xxxxxxxx</a>&gt;</strong></li>
<li>Date: Thu, 27 Feb 2020 10:07:40 -0800</li>
<li>Arc-authentication-results: i=2; mx.google.com;       dkim=pass header.i=@noaa.gov header.s=google header.b=&quot;CpKde/Z9&quot;;       spf=pass (google.com: domain of <a href="mailto:ansley.b.manke@DOMAIN.HIDDEN">ansley.b.manke@xxxxxxxx</a> designates 209.85.220.41 as permitted sender) smtp.mailfrom=<a href="mailto:ansley.b.manke@DOMAIN.HIDDEN">ansley.b.manke@xxxxxxxx</a>;       dmarc=pass (p=REJECT sp=NONE dis=NONE) header.from=noaa.gov</li>
<li>Arc-authentication-results: i=1; mx.google.com;       dkim=pass header.i=@noaa.gov header.s=google header.b=&quot;CpKde/Z9&quot;;       spf=pass (google.com: domain of <a href="mailto:ansley.b.manke@DOMAIN.HIDDEN">ansley.b.manke@xxxxxxxx</a> designates 209.85.220.41 as permitted sender) smtp.mailfrom=<a href="mailto:ansley.b.manke@DOMAIN.HIDDEN">ansley.b.manke@xxxxxxxx</a>;       dmarc=pass (p=REJECT sp=NONE dis=NONE) header.from=noaa.gov</li>
<li>Arc-message-signature: i=2; a=rsa-sha256; c=relaxed/relaxed; d=google.com; s=arc-20160816;        h=list-archive:list-help:list-post:list-id:mailing-list:precedence         :content-language:in-reply-to:mime-version:user-agent:date         :message-id:from:references:to:subject:dkim-signature;        bh=GMB1w+Nly3iZ8MMVWl4m7u0526jUuFnrDzaItxCkJ9s=;        b=cDAtyvlc7kjYMm6kvsCe5WSg2tybdWcR4Zo45ovE7/qg+rRIDtqIW4x0h8RhBQTgbQ         1sKXeT+VC5xlUEi3A7bA9YqXMi9iaKIVxGH93X6nOWKcnymgMvSORjz98e+HFm6QnQkL         JrgTIxp2TG5StQq2TQoNfTLvCuaxnxZe69/W/kuJCjXGQNmIrU/fh6ZkaXalUHqtT6FX         JTLeDFvfUKS3vctor671aU4PMTvDVXQWhclG8UXS7BQUzZvWnI3vwndKYuYfAHLTuqEv         tG0C7OGvK6aduuYxp7g2eoSRYrOLEHQugaCVzAH9jo9jY2cs5/Cu3WnVjDr+gBtm6gmT         lnkw==</li>
<li>Arc-message-signature: i=1; a=rsa-sha256; c=relaxed/relaxed; d=google.com; s=arc-20160816;        h=content-language:in-reply-to:mime-version:user-agent:date         :message-id:from:references:to:subject:dkim-signature;        bh=GMB1w+Nly3iZ8MMVWl4m7u0526jUuFnrDzaItxCkJ9s=;        b=Tsp6SI+rfq9XFk9kcrDFxU96SaXkozj3vb1ExDyD2ORYNx3MnX1rs8qXazSvXuhqcc         GMAXHSFvWgHtMSNl5eCiBPrVV0e664kQgl2N2sRNJQVJ9TB4XsKqKrpqSpiQfwcPN6vD         3DmvIJRpa4QMJTxrz2K21yCPRAcp7Lmsk9MrqSZEjuhJy567rq+gyH4Hbwuyqh8LRj0f         Jz8osZvOhpL8fxEjEPcv73MNSt6pqaXeNKrCAfXk82oZiJzw0ZiXnhF4HwbjC/0U3vq+         vSsllJ6lHsZXpwilO/5QcIRTGbtsnYMkoOKryhcrLxOySVWzF9TYA/D+ZYnTHMYrsQJG         hUnA==</li>
<li>Arc-seal: i=2; a=rsa-sha256; t=1582826864; cv=pass;        d=google.com; s=arc-20160816;        b=fCgRjzdT/B1HmfFl6R0CUz6I4m34KrpqVgLys67AuvApAecUvLVu2xbg31usav4378         /BPZHAMXxiYL6qV2N44723wOe3vgXSFDny/FU1AnQPJ8yC9dU17KsJomRU4KOUP3IgLD         ndljL8fn3zY1uRrDmbfn5T5wdzUYvUy554bM4V+gAQseTPPmCoEbsBxclwX7WJijqqw+         ad6i7fKFwzr3Qc585PoZMORiBlpTQa3Kpv6h8Oxb8AKSMK/iYPJpBsulkA5zxAaNo7On         k5kjg8mj7v3rgyjM17fp/9FlSaoFowhiV2NxNdwX4thpYuw3y4KMyKcV6F902vteSpgw         7hSg==</li>
<li>Arc-seal: i=1; a=rsa-sha256; t=1582826863; cv=none;        d=google.com; s=arc-20160816;        b=paMLHdAScWVwKqHnGsOUKGg7HHybPKKZ2IsJq9k7/u+O6woyPjPorB1dMJ4eSAwWMr         ljgOJt8Q+KG9esnf6Pjd31Qm8m6iYu1AEHLjYsXn8XwQ5mn0Ky0VmUetmrOjY0bW/vVd         Fp5tYRu3dFC1tMs6zddh9pve+7SEjCHU5YbKIwMUcjalpjjN6Xs3YqH2oME4zVKmP0C/         yDIKLaUu73jIv/zqe7W73PB1IWGGBC3TvrnHQ2EGvqxMjUu3g7ujpyiQ3TxaUb0Z8l3j         R4jG7vu/sPWtDpH6kRJ9pyLLPSaCtom1p7MYu2ujf1szKticMf3GDoVtMbLmOnCKifB3         MQwg==</li>
<li>Dkim-signature: v=1; a=rsa-sha256; c=relaxed/relaxed;        d=noaa.gov; s=google;        h=subject:to:references:from:message-id:date:user-agent:mime-version         :in-reply-to:content-language:x-original-sender         :x-original-authentication-results:precedence:mailing-list:list-id         :list-post:list-help:list-archive;        bh=GMB1w+Nly3iZ8MMVWl4m7u0526jUuFnrDzaItxCkJ9s=;        b=BUvckmwBnYKtpL8d6QvZXsQ21fliToILgZ4jVfGwE0qetQY0IeDUX+Mv4sQFj0ziLd         jVpYqyYBeRvqv32tDgrsnSmOD3/DSvp496aoJ5D8GJf84k8Uwmho7ei1I6ukeFFT7WJ7         GZZ2MceFh9+epQgfB4E3KwZqDLiueSF4suEOPKzhFidx1ZANCy/Kpix5PquaxVsY81EQ         dobGPbHUdEJC3b2eb3BqFFxetIyk49vbrLUobO+sNozlzSceD+d67FauuAtVGK5O0f01         fbWDCIFR/m+Oz+LykDMzsStWlPvVu7of8McNycqGk1EL7go4fe5gr78jy+FcvLIVeYDL         RmDQ==</li>
<li>In-reply-to: &lt;<a href="msg00550.html">CAEwQpaKfdcb+Be2pS+ENm2W5OfXgQvFLBSHxXNb+6USZZo2Y6g@mail.gmail.com</a>&gt;</li>
<li>List-archive: &lt;<a href="https://groups.google.com/a/noaa.gov/group/ferret_users/">https://groups.google.com/a/noaa.gov/group/ferret_users/</a>&gt;</li>
<li>List-help: &lt;<a href="https://support.google.com/a/noaa.gov/bin/topic.py?topic=25838">https://support.google.com/a/noaa.gov/bin/topic.py?topic=25838</a>&gt;, &lt;<a href="mailto:ferret_users+help@noaa.gov">mailto:ferret_users+help@noaa.gov</a>&gt;</li>
<li>List-id: &lt;ferret_users.noaa.gov&gt;</li>
<li>List-post: &lt;<a href="https://groups.google.com/a/noaa.gov/group/ferret_users/post">https://groups.google.com/a/noaa.gov/group/ferret_users/post</a>&gt;, &lt;<a href="mailto:ferret_users@noaa.gov">mailto:ferret_users@noaa.gov</a>&gt;</li>
<li>Mailing-list: list <a href="mailto:ferret_users@DOMAIN.HIDDEN">ferret_users@xxxxxxxx</a>; contact <a href="mailto:ferret_users%2Bowners@DOMAIN.HIDDEN">ferret_users+owners@xxxxxxxx</a></li>
<li>References: &lt;d95d2f78-5a1d-2e10-3008-e7698b694f8f.ref@yahoo.it&gt; &lt;<a href="msg00548.html">d95d2f78-5a1d-2e10-3008-e7698b694f8f@yahoo.it</a>&gt; &lt;<a href="msg00550.html">CAEwQpaKfdcb+Be2pS+ENm2W5OfXgQvFLBSHxXNb+6USZZo2Y6g@mail.gmail.com</a>&gt;</li>
<li>Sender: <a href="mailto:owner-ferret_users@DOMAIN.HIDDEN">owner-ferret_users@xxxxxxxx</a></li>
<li>User-agent: Mozilla/5.0 (Windows NT 10.0; WOW64; rv:68.0) Gecko/20100101 Thunderbird/68.5.0</li>
</ul>
<!--X-Head-of-Message-End-->
<!--X-Head-Body-Sep-Begin-->
<hr>
<!--X-Head-Body-Sep-End-->
<!--X-Body-of-Message-->

  
  
    <p>Good ideas, Ryo.&#xA0; <br>
    </p>
    <p>There's a useful discussion about how transformations are done,
      here: "<a rel="nofollow" moz-do-not-send="true"
href="https://ferret.pmel.noaa.gov/Ferret/documentation/users-guide/variables-xpressions/XPRESSIONS#_VPINDEXENTRY_421">General
        Infrormation about Transformations</a>"<br>
    </p>
    <p>And here's another way to define a mask,<br>
    </p>
    <p>! Define a list having the same number of values as the axis, and<br>
      ! reshape it to the direction<br>
    </p>
    <p>let maskvals = { , 1, , 1 , , 1 , , , , 1 , 1} <br>
      let mask = reshape(maskvals, k[gz=myvar])</p>
    <p>let myvar_masked = myvar* mask</p>
    <p><br>
    </p>
    <p><br>
    </p>
    <p><br>
    </p>
    <div class="moz-cite-prefix">On 2/26/2020 6:13 PM, Ryo Furue wrote:<br>
    </div>
    <blockquote type="cite"
cite="">
      
      <div dir="ltr">
        <div>Dear Fabio,</div>
        <br>
        <div class="gmail_quote">
          <div dir="ltr" class="gmail_attr">On Thu, Feb 27, 2020 at 6:32
            AM 'Fabio B.' via _OAR PMEL Ferret Users &lt;<a rel="nofollow"
              href="mailto:ferret_users@xxxxxxxx" moz-do-not-send="true">ferret_users@xxxxxxxx</a>&gt;
            wrote:<br>
          </div>
          <blockquote class="gmail_quote" style="margin:0px 0px 0px
            0.8ex;border-left:1px solid
            rgb(204,204,204);padding-left:1ex"><br>
            The first part of the question is how to add non-consecutive
            levels, for <br>
            example I know I can use myvar[k=3:6@sum] for consecutive
            ones, but how, <br>
            for example, to add levels 2,5, and 7?</blockquote>
          <div><br>
          </div>
          <div><br>
          </div>
          <div>One idea is to mask out the other levels:</div>
          <div><br>
          </div>
          <div>let myvar_masked = IF (k eq 2) or&#xA0; (k eq 5) or . . . THEN
            myvar</div>
          <div><br>
          </div>
          <div>This new variable has valid values only at levels k = 2,
            5, . . . so that the sum you want is
            myvar_masked[k=1:kmax@SUM].</div>
          <div>&#xA0;</div>
          <blockquote class="gmail_quote" style="margin:0px 0px 0px
            0.8ex;border-left:1px solid
            rgb(204,204,204);padding-left:1ex">
            The second part, my data contains missing values, when I use
            @sum NaN <br>
            are ignored and I get the desired result, for example if I
            have <br>
            3,NaN,2,0 the result is 5. But if instead I use the notation
            <br>
            myvar[k=2]+myvar[k=5]+etc. then I get NaN in every cell
            where there is <br>
            at least one NaN. It seems an inconsistent behavior.<br>
          </blockquote>
          <div><br>
          </div>
          <div><br>
          </div>
          <div>For arithmetic operations (plus, minus, . . .) and
            functions (sin, exp, . . . ), the entire _expression_ results
            in a "missing" ("undefined") value if one value is missing.&#xA0;
            On the other hand, the "@" operations <b>skip</b>&#xA0;missing
            values.&#xA0; The latter property is crucial when you, for
            example, want to ignore land points for your ocean
            temperature average.</div>
          <div><br>
          </div>
          <div>In other words,&#xA0;@SUM is NOT</div>
          <div><br>
          </div>
        </div>
        <blockquote style="margin:0 0 0 40px;border:none;padding:0px">
          <div class="gmail_quote">
            <div>&#xA0;<font face="monospace">a(1)&#xA0;+ a(2)&#xA0;+ a(3)&#xA0;+ . . .&#xA0;</font></div>
          </div>
        </blockquote>
        <div class="gmail_quote">
          <div><br>
          </div>
          <div>BUT</div>
          <div><br>
          </div>
        </div>
        <blockquote style="margin:0 0 0 40px;border:none;padding:0px">
          <div class="gmail_quote">
            <div><font face="monospace">sum = 0</font></div>
          </div>
          <div class="gmail_quote">
            <div><font face="monospace">for i = 1 to N</font></div>
          </div>
          <div class="gmail_quote">
            <div><font face="monospace">&#xA0; &#xA0;if (a(i) is not missing) then</font></div>
          </div>
          <div class="gmail_quote">
            <div><font face="monospace">&#xA0; &#xA0; &#xA0; sum = sum&#xA0;+ a(i)</font></div>
          </div>
          <div class="gmail_quote">
            <div><font face="monospace">&#xA0; &#xA0;endif</font></div>
          </div>
          <div class="gmail_quote">
            <div><font face="monospace">endfor</font></div>
          </div>
        </blockquote>
        <div class="gmail_quote">
          <div><br>
          </div>
          <div>Hope this helps.</div>
          <div><br>
          </div>
          <div>Ryo</div>
          <div><br>
          </div>
        </div>
      </div>
    </blockquote>
  


<!--X-Body-of-Message-End-->
<!--X-MsgBody-End-->
<!--X-Follow-Ups-->
<hr>
<!--X-Follow-Ups-End-->
<!--X-References-->
<ul><li><strong>References</strong>:
<ul>
<li><strong><a name="00548" href="msg00548.html">[ferret_users] Adding non-consecutive levels containing missing values</a></strong>
<ul><li><em>From:</em> 'Fabio B.' via _OAR PMEL Ferret Users</li></ul></li>
<li><strong><a name="00550" href="msg00550.html">Re: [ferret_users] Adding non-consecutive levels containing missing values</a></strong>
<ul><li><em>From:</em> Ryo Furue</li></ul></li>
</ul></li></ul>
<!--X-References-End-->
<!--X-BotPNI-->
<UL>
<li>Previous by thread:
<strong><a href="msg00550.html">Re: [ferret_users] Adding non-consecutive levels containing missing values</a></strong>
</li>
<li>Next by thread:
<strong><a href="msg00552.html">[ferret_users] inverting cmocean color bar</a></strong>
</li>

</UL>
<center>[<a href="msg00550.html">Thread Prev</a>][<a href="msg00552.html">Thread Next</a>][<A HREF="threads.html#00551">Index</A>]</center>

<!--X-BotPNI-End-->
<!--X-User-Footer-->
<A HREF="http://ferret.pmel.noaa.gov/Ferret/contact-us">Contact Us</A>
<br>
<font size=-1>
<address>
<a href="http://www.doc.gov">Dept of Commerce</a> /
<a href="http://www.noaa.gov">NOAA</a> /
<a href="http://www.oar.noaa.gov">OAR</a> /
<a href="http://www.pmel.noaa.gov">PMEL</a> /
<a href="http://ferret.pmel.noaa.gov">Ferret</a>
</address>

<br>
 <a href="http://www.noaa.gov/privacy.html">Privacy Policy</a> | <a href="http://www.noaa.gov/disclaimer.html">Disclaimer</a> | <a href="accessibility.html">Accessibility Statement</a> 

</font>
<!--X-User-Footer-End-->
</body>
</html>
