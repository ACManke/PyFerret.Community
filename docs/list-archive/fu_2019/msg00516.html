<!-- MHonArc v2.6.18 -->
<!--X-Subject: Re: [ferret_users] Appending output data to a netCDF file in i&#45;dimension -->
<!--X-From-R13: "Tvrqyre, Dhffryy (A&#38;O, Vboneg)" <Dhffryy.TvrqyreNpfveb.nh> -->
<!--X-Date: Wed, 5 Feb 2020 16:27:48 &#45;0800 -->
<!--X-Message-Id: ME2PR01MB3220BD4D97D2C9D2FA7B5BBD9D1D0@ME2PR01MB3220.ausprd01.prod.outlook.com -->
<!--X-Content-Type: multipart/alternative -->
<!--X-Reference: CAOs80NwKVkoHqgj7rLwKDi2dEKxQei64sRFmnNPqvXAR2L_ehg@mail.gmail.com -->
<!--X-Reference: 3d868537&#45;f24b&#45;fc6a&#45;06e2&#45;3445fa107bb1@noaa.gov -->
<!--X-Head-End-->
<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN"
        "http://www.w3.org/TR/html4/loose.dtd">
<html>
<head>
<title>Re: [ferret_users] Appending output data to a netCDF file in i-dimension</title>
</head>
<body>
<!--X-Body-Begin-->
<!--X-User-Header-->
<!--X-User-Header-End-->
<!--X-TopPNI-->
<HR>
<center>[<a href="msg00515.html">Thread Prev</a>][<a href="msg00517.html">Thread Next</a>][<A HREF="threads.html#00516">Index</A>]</center>

<!--X-TopPNI-End-->
<!--X-MsgBody-->
<!--X-Subject-Header-Begin-->
<h1>Re: [ferret_users] Appending output data to a netCDF file in i-dimension</h1>
<hr>
<!--X-Subject-Header-End-->
<!--X-Head-of-Message-->
<ul>
<li><strong>To</strong>: <strong>&quot;<a href="mailto:ferret_users@DOMAIN.HIDDEN">ferret_users@xxxxxxxx</a>&quot; &lt;<a href="mailto:ferret_users@DOMAIN.HIDDEN">ferret_users@xxxxxxxx</a>&gt;</strong></li>
<li><strong>Subject</strong>: <strong>Re: [ferret_users] Appending output data to a netCDF file in i-dimension</strong></li>
<li><strong>From</strong>: <strong>&quot;Fiedler, Russell (O&amp;A, Hobart)&quot; &lt;<a href="mailto:Russell.Fiedler@DOMAIN.HIDDEN">Russell.Fiedler@xxxxxxxx</a>&gt;</strong></li>
<li>Date: Thu, 6 Feb 2020 00:27:30 +0000</li>
<li>Accept-language: en-AU, en-US</li>
<li>Arc-authentication-results: i=5; mx.google.com;       dkim=pass header.i=@csiro.au header.s=dkim header.b=H1Zjamdb;       dkim=pass header.i=@CSIROAU.onmicrosoft.com header.s=selector1-CSIROAU-onmicrosoft-com header.b=W5IywLZj;       arc=pass (i=3 dkim=pass dkdomain=csiro.au dkim=pass dkdomain=csiroau.onmicrosoft.com);       spf=fail (google.com: domain of prvs=298e6fe67=<a href="mailto:russell.fiedler@DOMAIN.HIDDEN">russell.fiedler@xxxxxxxx</a> does not designate 209.85.160.198 as permitted sender) smtp.mailfrom=&quot;prvs=298e6fe67=<a href="mailto:russell.fiedler@DOMAIN.HIDDEN">russell.fiedler@xxxxxxxx</a>&quot;</li>
<li>Arc-authentication-results: i=4; mx.google.com;       dkim=pass header.i=@csiro.au header.s=dkim header.b=H1Zjamdb;       dkim=pass header.i=@CSIROAU.onmicrosoft.com header.s=selector1-CSIROAU-onmicrosoft-com header.b=W5IywLZj;       arc=pass (i=3 dkim=pass dkdomain=csiro.au dkim=pass dkdomain=csiroau.onmicrosoft.com);       spf=fail (google.com: domain of prvs=298e6fe67=<a href="mailto:russell.fiedler@DOMAIN.HIDDEN">russell.fiedler@xxxxxxxx</a> does not designate 209.85.160.198 as permitted sender) smtp.mailfrom=&quot;prvs=298e6fe67=<a href="mailto:russell.fiedler@DOMAIN.HIDDEN">russell.fiedler@xxxxxxxx</a>&quot;</li>
<li>Arc-authentication-results: i=3; mx.google.com;       dkim=pass header.i=@csiro.au header.s=dkim header.b=H1Zjamdb;       dkim=pass header.i=@CSIROAU.onmicrosoft.com header.s=selector1-CSIROAU-onmicrosoft-com header.b=W5IywLZj;       arc=pass (i=2 spf=pass spfdomain=csiro.au dkim=pass dkdomain=csiro.au dkim=pass dkdomain=csiroau.onmicrosoft.com);       spf=fail (google.com: domain of prvs=298e6fe67=<a href="mailto:russell.fiedler@DOMAIN.HIDDEN">russell.fiedler@xxxxxxxx</a> does not designate 65.153.203.174 as permitted sender) smtp.mailfrom=&quot;prvs=298e6fe67=<a href="mailto:Russell.Fiedler@DOMAIN.HIDDEN">Russell.Fiedler@xxxxxxxx</a>&quot;</li>
<li>Arc-authentication-results: i=2; mx.google.com;       dkim=pass header.i=@csiro.au header.s=dkim header.b=H1Zjamdb;       dkim=pass header.i=@CSIROAU.onmicrosoft.com header.s=selector1-CSIROAU-onmicrosoft-com header.b=W5IywLZj;       arc=pass (i=1 spf=pass spfdomain=csiro.au dkim=pass dkdomain=csiro.au dmarc=pass fromdomain=csiro.au);       spf=pass (google.com: domain of prvs=298e6fe67=<a href="mailto:russell.fiedler@DOMAIN.HIDDEN">russell.fiedler@xxxxxxxx</a> designates 2405:b000:b00:220::64:39 as permitted sender) smtp.mailfrom=&quot;prvs=298e6fe67=<a href="mailto:Russell.Fiedler@DOMAIN.HIDDEN">Russell.Fiedler@xxxxxxxx</a>&quot;</li>
<li>Arc-authentication-results: i=1; mx.microsoft.com 1; spf=pass smtp.mailfrom=csiro.au; dmarc=pass action=none header.from=csiro.au; dkim=pass header.d=csiro.au; arc=none</li>
<li>Arc-message-signature: i=5; a=rsa-sha256; c=relaxed/relaxed; d=google.com; s=arc-20160816;        h=list-archive:list-help:list-post:list-id:mailing-list:precedence         :message-id:mime-version:content-language:accept-language         :in-reply-to:references:date:thread-index:thread-topic:subject:to         :from:ironport-phdr:ironport-sdr:sender:dkim-signature;        bh=fqylPg0YQoQbpmYJ59RSvgB2KVyrUwTP8JblVkm4PME=;        b=NevnyMQOJ9lpDIjrdPJ0VUl4tj2tNhvqVS8/uTcyQNwk5zOEdFkdcuUJD/2lDA/LNA         cq9OF6YTIoZJ6nOtn87dVDbVZWarVlXSoLuvHCZoK8cEsIKR5Ubow7obPRLX5awAUQ5E         CPtSjb+gkeNSpLP3L4MJZQBTQ5wWcmleqgHtcKCx1s4xK1ijW4fFCH93srt1rUZ8QiZm         oaVCoX9dNAT+Ha1AeQCkCKXVI+4PLxVMKi9l2QC4zE1SbIDGgvc10Xz3BoG4U/snO+Ui         +Fx+RXsKYRNpE/0BvaEVF7Tg1p6O1fzb2q2qbkSA/io29ekwPiVFbCsboU71VkRgHujp         CHnQ==</li>
<li>Arc-message-signature: i=4; a=rsa-sha256; c=relaxed/relaxed; d=google.com; s=arc-20160816;        h=message-id:mime-version:content-language:accept-language         :in-reply-to:references:date:thread-index:thread-topic:subject:to         :from:dkim-signature:ironport-phdr:ironport-sdr:dkim-signature;        bh=fqylPg0YQoQbpmYJ59RSvgB2KVyrUwTP8JblVkm4PME=;        b=beKCHAuwPNOe4AFeI+gzSSJbA+dVd/YEtXwIM7oKgjJ6KldLzQHFUJIiUDRgtdiUWd         8EC/AAlWQhLHuhUnU8f9VKMvP0uUgfTGyA3ZRn3djk2XHxoW+HKShKXlSOhXO+cD9M3M         jjxNanHkhf5FIhl5IgYGP4RClzePpd80KrH0GDcRYqcVJMCfxAv+FPgEBXa/V5l9X2R4         1Fc5qHLgQt24458D0dUJ73bKckXH/xp7dvD6ORpeWpwJdIaP16i6sEZHpr5hqhPdQo+l         BhqeVstbeukQaCWWwEzCjWzOej48eV3b0DTGEAaVua8waAgGFrP1QIuFGhvMzdmCvTGD         TAkA==</li>
<li>Arc-message-signature: i=3; a=rsa-sha256; c=relaxed/relaxed; d=google.com; s=arc-20160816;        h=mime-version:content-language:accept-language:in-reply-to         :references:message-id:date:thread-index:thread-topic:subject:to         :from:dkim-signature:ironport-phdr:ironport-sdr:dkim-signature;        bh=fqylPg0YQoQbpmYJ59RSvgB2KVyrUwTP8JblVkm4PME=;        b=IEY2KfaOJij4eRqOwActR2WsrYLhvCnUH8X7JM3OVghc0oIIEvAAuVpyqKyblsce71         eJbS5QiKbfft1ZxYjZSzPn6eF32agGxvO6P53pc6bpYYKWAJyIRetlNQ0dBwb5PEwwnf         MfiTOvtViSKR5QzG/ckUhlfyQP5MKLIv8wFqz3F2RY3R1zI71fQSFfSRD+8/lYikPFF6         PiQSKme6M+A172B092Y89KcBvLlkXNHxr+a9fgpG/XVi6ptjK0ieq2l3E887WlcuLW9/         AH2EkSrEZC1nwgTOIL3U9lrGbAzEEymZJz+n/jBdYhBaYqfl4Pu4A6Fc+ahjpOnaGkiC         rcsQ==</li>
<li>Arc-message-signature: i=2; a=rsa-sha256; c=relaxed/relaxed; d=google.com; s=arc-20160816;        h=mime-version:content-language:accept-language:in-reply-to         :references:message-id:date:thread-index:thread-topic:subject:to         :from:dkim-signature:ironport-phdr:ironport-sdr:dkim-signature;        bh=fqylPg0YQoQbpmYJ59RSvgB2KVyrUwTP8JblVkm4PME=;        b=RSXl41ipiqe+zWWphinXSuRjSjOTDEBqn9T8nfiOG0ctEvqsd/iv+hW0LTzeLW6iha         +m0jLlJxs6JqvrdpIxIRAQP0ZqsXvJSIamxSMB8qFMkXDRT0oY1uk1JLsV0W/f2h054C         LCECsXk9IcY0it1A05zPDjMJ4v7NwIllBjQ0RZEkLs3Eu4QEUXCiBnF8RYhyBEKw+Bi1         Cb2dToah/NbBetpBEJgzu+gWApTqPGHE6hkLoNTsWtNH9tY4Sxqspdv8X9Gvf9ySNJjp         oh9EnzCqYB3frESQSTtyP04/OhpmGadKwYcnnWV+tBndJxBlFQVzoxzptslvreLtHLeR         +ZsQ==</li>
<li>Arc-message-signature: i=1; a=rsa-sha256; c=relaxed/relaxed; d=microsoft.com; s=arcselector9901; h=From:Date:Subject:Message-ID:Content-Type:MIME-Version:X-MS-Exchange-SenderADCheck; bh=fqylPg0YQoQbpmYJ59RSvgB2KVyrUwTP8JblVkm4PME=; b=DyYFU4wHHxbz+/EMLrURYiFFF1cxvRr3s5pokhEllTVEFvALuiX97ERW8HCV+qKEigff8K4f5EQvyTxiUZYQ1Jn7x/lYcy3jcRE5qLOZuP4ybO7EbacY0Fm3qHFlcfWgWrzRncDhKPOwRe2E47SxqBgXixrxMcEUTM2d1x+yZS+hOlDB5UVwNR7bLdE5MDmKJ1Nq7GWmnSATz8fgvuwKnQYILuOjUWeqWxQThDHCMWrGqAAgAnwiPyPtLyOSeLsj8zYYeEUpV9T+knV6gasA7nSEVnSoSNFhU1bMm7PtbFVh3e5Gk4ZBWohJ1e6BKehqtmyJ/gtVS07smkd8dZ6VkQ==</li>
<li>Arc-seal: i=5; a=rsa-sha256; t=1580948867; cv=pass;        d=google.com; s=arc-20160816;        b=YBymqHQu07XmJ++rV9QJYgKC7zhVFrjdKSaDbQArXdpZGbMLJ/TrOjqXZk8qUGpuam         hOstqidOFNxkMzG3C/1MvsGaFXWfdlKX43D1Wm3nIWCL4C/kxgpyV632plBxe2MiLTV7         tDDLh/ogDzYdUtpbWI8hOyE3/7Ydw5JK6baLe2OsWh2LSLcB/FfodyJyybJ9f43KaVNR         EWjZx6xI/kumwUHh6R8DhcGvNsA6eOVrokv2SkJTQB3Bqco9+5M9Djv9OTzqDaeWIzY1         twMDWFSK2DEkyvuI19LEQA1eEucJIKK1xP0C0IEf7wm8b4gXQtSPaR+4ExRlv2FYKVRx         yW0g==</li>
<li>Arc-seal: i=4; a=rsa-sha256; t=1580948866; cv=pass;        d=google.com; s=arc-20160816;        b=znqSDdu+9Q1DK/PPkmdQtfgPN0j0/fFRCrfySxLR3N/opiD3E4QaEXNMXYFV2biUyM         QjmaOS6CdpTTusBe3MC+10XTIujpnmWjI5M7KMaGpLRc2QXR69V87AscWqkI15Jof8eD         Hzr4cjHszkl2XC5qlYd8lFd5pQqfpC/Uga8BFoFgW/pjtxT5Z7gXdt6jchKoHAgDl+aR         aRNr+gwt1V5JpcqAD55ma7IEF3qI6KfvM3Qim5yWXVjeQTXRQSteU1UQDOjgGdoTGFd1         EltMndmyBSl/TjeWzrmwqJEUriag6d6Lq/y2LJv5RFEC3RPVvMVw8YFFk3YlxtwKYKZa         HJqQ==</li>
<li>Arc-seal: i=3; a=rsa-sha256; t=1580948857; cv=pass;        d=google.com; s=arc-20160816;        b=EqUtpOhN++3B3z4IK6zOFkWF6P+Opc/s5mXQcEU6bVGzFVKW1OhoEmMyNN75UERM+o         haMuArc+tW3sbgeXHIWQ0NakjpDalYzoFDu0i5sMFm/slCbbApscXGdIJ2EJJSLqw4Ng         gjBfddyuaPmTuwQTzNFrbHdL+MtFX/UXv+KTqXwh+CxTmxREp62JU2C4i0zYyO+iM81C         i58xMpsBGJV6iLJFgOgg65Yf1WpXmMqMiLQXMu39MtDtvzxTsG4cd9BCr8VnhLlO7tdJ         b8ofVmCQfnVGEs/3PDxcReAfIwQY5BJUVbuajKCcUj7EecM+q/PPA5xktIRyQox2mVzJ         t3Eg==</li>
<li>Arc-seal: i=2; a=rsa-sha256; t=1580948855; cv=pass;        d=google.com; s=arc-20160816;        b=c3RY6YJzxgyhzXxOjj79YEcHhj6AQZdPIxe1yQqx7ElW0Vn2O4VNX3vweBw532OXXJ         yZPhZeg7mbsHBcjUol5ZirLdM8ldgXPAVN/MnQe54vrQfGe6H8zR91TIBfiu7g6+8ABy         siQ4T3MiOK5G12noHkiW2j3wPuIt56XIo6L3CIDdLY6GQd69MlZPNxOmw8XBdL5CwdlZ         BRfJbmRvZ1cnV3OHx1E5dwF4Ti4C2QNnCdMEnmz2WNB1uJ1JvfThauZtxDVjVnwJ77XM         DhJTH+QzpecSj+JnyrRUxz1eBvItLNxk1rNb3B+Q3Sa6aTWvKUnb82wXGwknaL3RqB/a         qPXQ==</li>
<li>Arc-seal: i=1; a=rsa-sha256; s=arcselector9901; d=microsoft.com; cv=none; b=dBpagZ6P7LKIfUc4eS4HIlAV3rzDIlyk6dATtdkx8PyhP8EWAXc5s/mxN3q13VKKOA0UZf0l/3HApbqkqM2GzJn85/wx6ir6Z5HQryhZJ0d7qFD6522IQmV5Fco7qM+yUgKcOSVTIY/cGu41D9g2oDLntvkY7Jd7hvzGTOTx/lTA8ae0995z+1z3TqPC8c1r0E4VXNiaCBrseBk6AwLg0itdbLSOH46FoFCuaQboVf1Wc3oC7bXDRltBncYcr3Sz0OPq622ztldp9CFY+uKhmQA4w03sdHlg7NKP0yuuHpFuYAwd7CJfKybF7fYaDDlj9KdBATyoJxOMgff2zNUSNg==</li>
<li>Dkim-signature: v=1; a=rsa-sha256; c=relaxed/relaxed;        d=noaa.gov; s=google;        h=sender:ironport-sdr:ironport-phdr:from:to:subject:thread-topic         :thread-index:date:references:in-reply-to:accept-language         :content-language:mime-version:message-id:x-original-sender         :x-original-authentication-results:precedence:mailing-list:list-id         :list-post:list-help:list-archive;        bh=fqylPg0YQoQbpmYJ59RSvgB2KVyrUwTP8JblVkm4PME=;        b=Y8hzFGiG9Th3hyJ0XjiiiTlxgSO55NEQ2tQLNYfW1SBzh8qP7wWC1iqtWXcp2F6bl7         xwUFZ5vZfBQSdM+W1FXwrAiWk1XAYTOPfWyoRo7tfZo1H8fAk26ByxmGHmvtWSh1VlMA         Y/KBZDoPc7gy5XGl2ItX6meJ3UXE7QFMtTdmOHKZ1vwB3L+lg2xDX0GRKs+KXSg2BPTc         1qZQ7tUf+y1cJFcF+uCVX0AyBvg90/ckVaF7TUgve84KqoLwguTUdFHmelmMbybCUsuN         dGCs0SU8Mg0jyPrj/5oXRo7Lfevwk6JBEy5nkDIdKgtaJ1j2weEhAER8Htp8X27lkumc         rdPQ==</li>
<li>In-reply-to: &lt;<a href="msg00515.html">3d868537-f24b-fc6a-06e2-3445fa107bb1@noaa.gov</a>&gt;</li>
<li>Ironport-phdr: 9a23:iqK5+x2KlcTiGVQdsmDT+zVfbzU7u7jyIg8e44YmjLQLaKm44pD+JxKAt+51ggrPWoPWo7JfhuzavrqoeFRI4I3J8RVgOIdJSwdDjMwXmwI6B8vQM1DgN/Pua2oUHclOUFJ/13qgMFJSXs/jNBXf</li>
<li>Ironport-sdr: jQrnTT34VMkWa2ckR5O68+emb6+BwkA6Xy3w/ETV+i57OcX+V31+mkiAwDAKM4kml/fNXUmDSu GoyYFCMOuAkA==</li>
<li>List-archive: &lt;<a href="https://groups.google.com/a/noaa.gov/group/ferret_users/">https://groups.google.com/a/noaa.gov/group/ferret_users/</a>&gt;</li>
<li>List-help: &lt;<a href="https://support.google.com/a/noaa.gov/bin/topic.py?topic=25838">https://support.google.com/a/noaa.gov/bin/topic.py?topic=25838</a>&gt;, &lt;<a href="mailto:ferret_users+help@noaa.gov">mailto:ferret_users+help@noaa.gov</a>&gt;</li>
<li>List-id: &lt;ferret_users.noaa.gov&gt;</li>
<li>List-post: &lt;<a href="https://groups.google.com/a/noaa.gov/group/ferret_users/post">https://groups.google.com/a/noaa.gov/group/ferret_users/post</a>&gt;, &lt;<a href="mailto:ferret_users@noaa.gov">mailto:ferret_users@noaa.gov</a>&gt;</li>
<li>Mailing-list: list <a href="mailto:ferret_users@DOMAIN.HIDDEN">ferret_users@xxxxxxxx</a>; contact <a href="mailto:ferret_users%2Bowners@DOMAIN.HIDDEN">ferret_users+owners@xxxxxxxx</a></li>
<li>References: &lt;<a href="msg00513.html">CAOs80NwKVkoHqgj7rLwKDi2dEKxQei64sRFmnNPqvXAR2L_ehg@mail.gmail.com</a>&gt;,&lt;<a href="msg00515.html">3d868537-f24b-fc6a-06e2-3445fa107bb1@noaa.gov</a>&gt;</li>
<li>Sender: <a href="mailto:owner-ferret_users@DOMAIN.HIDDEN">owner-ferret_users@xxxxxxxx</a></li>
<li>Thread-index: AQHV3GWqlnSa8ESb6k2IJ5po2d/DHKgNQ3IAgAAFp4o=</li>
<li>Thread-topic: [ferret_users] Appending output data to a netCDF file in i-dimension</li>
</ul>
<!--X-Head-of-Message-End-->
<!--X-Head-Body-Sep-Begin-->
<hr>
<!--X-Head-Body-Sep-End-->
<!--X-Body-of-Message-->
<table width="100%"><tr><td style="">


<div style="font-family: Calibri, Arial, Helvetica, sans-serif; font-size: 12pt; color: rgb(0, 0, 0);">
<br>
</div>
<div style="font-family: Calibri, Arial, Helvetica, sans-serif; font-size: 12pt; color: rgb(0, 0, 0);">
Hi,</div>
<div style="font-family: Calibri, Arial, Helvetica, sans-serif; font-size: 12pt; color: rgb(0, 0, 0);">
<br>
</div>
<div style="font-family: Calibri, Arial, Helvetica, sans-serif; font-size: 12pt; color: rgb(0, 0, 0);">
I'd also note that striding through the file this way is extremely inefficient. Unless you've done some rather odd chunking of the input files the read/writes will not</div>
<div style="font-family: Calibri, Arial, Helvetica, sans-serif; font-size: 12pt; color: rgb(0, 0, 0);">
not be contiguous. It would be far better to loop over the j index processing all longitudes at once. If this still requires too mush memory then you may require a double loop. With luck you may be able to use non unit stride in the I direction. Also note that
 you don't need to redifine your variables in the loop.<br>
</div>
<div style="font-family: Calibri, Arial, Helvetica, sans-serif; font-size: 12pt; color: rgb(0, 0, 0);">
<br>
</div>
<div style="font-family: Calibri, Arial, Helvetica, sans-serif; font-size: 12pt; color: rgb(0, 0, 0);">
Something like</div>
<div style="font-family: Calibri, Arial, Helvetica, sans-serif; font-size: 12pt; color: rgb(0, 0, 0);">
<br>
</div>
<div style="font-family: Calibri, Arial, Helvetica, sans-serif; font-size: 12pt; color: rgb(0, 0, 0);">
let v_ij=var_dta</div>
<div style="font-family: Calibri, Arial, Helvetica, sans-serif; font-size: 12pt; color: rgb(0, 0, 0);">
let v_norm=v_ij[GT=tdaily@mod] </div>
<div style="font-family: Calibri, Arial, Helvetica, sans-serif; font-size: 12pt; color: rgb(0, 0, 0);">
<br>
</div>
<div style="font-family: Calibri, Arial, Helvetica, sans-serif; font-size: 12pt; color: rgb(0, 0, 0);">
...</div>
<div style="font-family: Calibri, Arial, Helvetica, sans-serif; font-size: 12pt; color: rgb(0, 0, 0);">
<br>
</div>
<div style="font-family: Calibri, Arial, Helvetica, sans-serif; font-size: 12pt; color: rgb(0, 0, 0);">
save/clob/i=1/j=1/ilimits=../jlimits=../file=.. v_norm...</div>
<div style="font-family: Calibri, Arial, Helvetica, sans-serif; font-size: 12pt; color: rgb(0, 0, 0);">
<br>
</div>
<div style="font-family: Calibri, Arial, Helvetica, sans-serif; font-size: 12pt; color: rgb(0, 0, 0);">
!Save 277 values at once (1385=5*277)</div>
<div style="font-family: Calibri, Arial, Helvetica, sans-serif; font-size: 12pt; color: rgb(0, 0, 0);">
<br>
</div>
<div style="font-family: Calibri, Arial, Helvetica, sans-serif; font-size: 12pt; color: rgb(0, 0, 0);">
repeat/j=1:596 (repeat/range=1:1385:277/name=s save/app/i=`s`:`s&#43;276`/app/file=.. v_norm...)</div>
<div style="font-family: Calibri, Arial, Helvetica, sans-serif; font-size: 12pt; color: rgb(0, 0, 0);">
<br>
</div>
<div style="font-family: Calibri, Arial, Helvetica, sans-serif; font-size: 12pt; color: rgb(0, 0, 0);">
If 277 points requires too much memory You can use smaller strides and replace `s&#43;276` by `min(s&#43;stride-1,1385)` in the above.</div>
<div style="font-family: Calibri, Arial, Helvetica, sans-serif; font-size: 12pt; color: rgb(0, 0, 0);">
<br>
</div>
<div style="font-family: Calibri, Arial, Helvetica, sans-serif; font-size: 12pt; color: rgb(0, 0, 0);">
Cheers,</div>
<div style="font-family: Calibri, Arial, Helvetica, sans-serif; font-size: 12pt; color: rgb(0, 0, 0);">
Russ<br>
</div>
<div style="font-family: Calibri, Arial, Helvetica, sans-serif; font-size: 12pt; color: rgb(0, 0, 0);">
<br>
</div>
<div id="appendonsend"></div>
<hr style="display:inline-block;width:98%" tabindex="-1">
<div id="divRplyFwdMsg" dir="ltr"><font face="Calibri, sans-serif" style="font-size:11pt" color="#000000"><b>From:</b> owner-ferret_users@xxxxxxxx &lt;owner-ferret_users@xxxxxxxx&gt; on behalf of Ansley C. Manke &lt;ansley.b.manke@xxxxxxxx&gt;<br>
<b>Sent:</b> Thursday, 6 February 2020 10:43 AM<br>
<b>To:</b> ferret_users@xxxxxxxx &lt;ferret_users@xxxxxxxx&gt;<br>
<b>Subject:</b> Re: [ferret_users] Appending output data to a netCDF file in i-dimension</font>
<div>&nbsp;</div>
</div>
<div>
<p>The general answer for appending to a file in directions other than time, is to first create the file with the full limits that you want to appear in the file, using /ILIMITS, /JLIMITS, /KLIMITS, in all except the time axis.&nbsp; Then make sure the variable
 is defined on the same grid, so that when you're writing data at i=1, it's i=1 on the axis, with the same axis names so that it can be appended.</p>
<p>The documentattion for /ILIMITS, etc is here,</p>
<p><a rel="nofollow" class="x_moz-txt-link-freetext" href="https://ferret.pmel.noaa.gov/Ferret/documentation/users-guide/commands-reference/LIST#_VPINDEXENTRY_1409">https://ferret.pmel.noaa.gov/Ferret/documentation/users-guide/commands-reference/LIST#_VPINDEXENTRY_1409</a></p>
<p>and follow the links there to examples of appending in I, J, or Z.</p>
<p><br>
</p>
<p>-Ansley<br>
</p>
<p><br>
</p>
<div class="x_moz-cite-prefix">On 2/5/2020 12:46 PM, Ge Peng - NOAA Affiliate wrote:<br>
</div>
<blockquote type="cite">
<div dir="ltr">
<div class="x_gmail_default" style="font-size:small"><br clear="all">
</div>
<div>
<p class="x_MsoNormal" style="margin:0in 0in 0.0001pt"><font face="arial, sans-serif">I need to compute daily climate normals (30-yrs averages) from a daily dataset &nbsp;<span class="x_gmail_default" style="font-size:small">(</span>variable: var_dta<span class="x_gmail_default" style="font-size:small">)</span>,
 with dimensions of I:1385; J:596; L:10957. </font></p>
<p class="x_MsoNormal" style="margin:0in 0in 0.0001pt"><font face="arial, sans-serif">&nbsp;</font></p>
<p class="x_MsoNormal" style="margin:0in 0in 0.0001pt"><font face="arial, sans-serif">As&nbsp;<span class="x_gmail_default" style="font-size:small">the machine memory is not large enough for me</span> to compute the normals for the entire field, I had to do so at
 each data point along the i-dimension (1:1385) and output the results to an intermediate nc file, using the code below.<span class="x_gmail_default" style="font-size:small"> (Potentially, I may have to do so at each of xy data points.&nbsp;</span></font>Printing
 out values at each <span class="x_gmail_default" style="font-size:small">of all </span>
xy data point<span class="x_gmail_default" style="font-size:small">s</span> to an ascii&nbsp;file takes too long!<span style="font-family:arial,sans-serif">)</span></p>
<p class="x_MsoNormal" style="margin:0in 0in 0.0001pt"><font face="arial, sans-serif">&nbsp;</font></p>
<p class="x_MsoNormal" style="margin:0in 0in 0.0001pt"><font face="arial, sans-serif">Unfortunately, I am getting an error message
<span class="x_gmail_default" style="font-size:small">(see below) </span>and would appreciate any help you may provide.<span class="x_gmail_default" style="font-size:small">&nbsp;</span></font></p>
<p class="x_MsoNormal" style="margin:0in 0in 0.0001pt"><font face="arial, sans-serif"><span class="x_gmail_default" style="font-size:small"><br>
</span></font></p>
<p class="x_MsoNormal" style="margin:0in 0in 0.0001pt"><font face="arial, sans-serif"><span class="x_gmail_default" style="font-size:small">If you have a better way for computing daily climate normals with a large dataset, I'd appreciate it if you could share
 your method with me.</span></font></p>
<p class="x_MsoNormal" style="margin:0in 0in 0.0001pt"><font face="arial, sans-serif">&nbsp;</font></p>
<p class="x_MsoNormal" style="margin:0in 0in 0.0001pt"><font face="arial, sans-serif">Thanks,</font></p>
<p class="x_MsoNormal" style="margin:0in 0in 0.0001pt"><font face="arial, sans-serif">&nbsp;</font></p>
<p class="x_MsoNormal" style="margin:0in 0in 0.0001pt"><font face="arial, sans-serif">--- Peng</font></p>
<p class="x_MsoNormal" style="margin:0in 0in 0.0001pt"><font face="arial, sans-serif">&nbsp;</font></p>
<p class="x_MsoNormal" style="margin:0in 0in
            0.0001pt; font-size:12pt; font-family:Calibri,sans-serif">
------</p>
<p class="x_MsoNormal" style="margin:0in 0in
            0.0001pt; font-size:12pt; font-family:Calibri,sans-serif">
! - Define a daily modulo time axis</p>
<p class="x_MsoNormal" style="text-indent:11pt; margin:0in 0in
            0.0001pt; font-size:12pt; font-family:Calibri,sans-serif">
def axis/t=0:365.2425/edges/npoints=365/t0=1-JAN-0001/units=days/modulo tdaily</p>
<p class="x_MsoNormal" style="margin:0in 0in
            0.0001pt; font-size:12pt; font-family:Calibri,sans-serif">
&nbsp;</p>
<p class="x_MsoNormal" style="margin:0in 0in
            0.0001pt; font-size:12pt; font-family:Calibri,sans-serif">
! &#x2013; Compute daily normals along i-dimension</p>
<p class="x_MsoNormal" style="text-indent:11pt; margin:0in 0in
            0.0001pt; font-size:12pt; font-family:Calibri,sans-serif">
&nbsp;&nbsp;&nbsp;&nbsp; sp rm -f <a rel="nofollow" href="http://v_ij.nc">v_ij.nc</a></p>
<p class="x_MsoNormal" style="text-indent:11pt; margin:0in 0in
            0.0001pt; font-size:12pt; font-family:Calibri,sans-serif">
&nbsp;&nbsp;&nbsp;&nbsp; repeat/range=1:`idm`/name=ii (;\</p>
<p class="x_MsoNormal" style="text-indent:11pt; margin:0in 0in
            0.0001pt; font-size:12pt; font-family:Calibri,sans-serif">
&nbsp;&nbsp;&nbsp;&nbsp; let v_ij=var_dta[i=`ii`] ;\</p>
<p class="x_MsoNormal" style="text-indent:11pt; margin:0in 0in
            0.0001pt; font-size:12pt; font-family:Calibri,sans-serif">
&nbsp;&nbsp;&nbsp;&nbsp; let v_norm=v_ij[GT=tdaily@mod] ;\</p>
<p class="x_MsoNormal" style="text-indent:11pt; margin:0in 0in
            0.0001pt; font-size:12pt; font-family:Calibri,sans-serif">
&nbsp;&nbsp;&nbsp;&nbsp; let v_std=(v_ij[GT=tdaily@modvar])^0.5 ;\</p>
<p class="x_MsoNormal" style="text-indent:11pt; margin:0in 0in
            0.0001pt; font-size:12pt; font-family:Calibri,sans-serif">
&nbsp;&nbsp;&nbsp;&nbsp; let v_min=v_ij[GT=tdaily@modmin] ;\</p>
<p class="x_MsoNormal" style="text-indent:11pt; margin:0in 0in
            0.0001pt; font-size:12pt; font-family:Calibri,sans-serif">
&nbsp;&nbsp;&nbsp;&nbsp; let v_max=v_ij[GT=tdaily@modmax] ;\</p>
<p class="x_MsoNormal" style="text-indent:11pt; margin:0in 0in
            0.0001pt; font-size:12pt; font-family:Calibri,sans-serif">
&nbsp;&nbsp;&nbsp;&nbsp; let v_npts=v_ij[GT=tdaily@modngd] ;\</p>
<p class="x_MsoNormal" style="text-indent:11pt; margin:0in 0in
            0.0001pt; font-size:12pt; font-family:Calibri,sans-serif">
&nbsp;&nbsp;&nbsp;&nbsp; save/file=<a rel="nofollow" href="http://v_ij.nc/app
              v_norm,v_std,v_min,v_max,v_npts">v_ij.nc/app v_norm,v_std,v_min,v_max,v_npts</a> ;\</p>
<p class="x_MsoNormal" style="text-indent:11pt; margin:0in 0in
            0.0001pt; font-size:12pt; font-family:Calibri,sans-serif">
&nbsp;&nbsp;&nbsp;&nbsp; can var v_* ;\</p>
<p class="x_MsoNormal" style="text-indent:11pt; margin:0in 0in
            0.0001pt; font-size:12pt; font-family:Calibri,sans-serif">
&nbsp;&nbsp;&nbsp;&nbsp; )</p>
<p class="x_MsoNormal" style="text-indent:11pt; margin:0in 0in
            0.0001pt; font-size:12pt; font-family:Calibri,sans-serif">
&nbsp;</p>
<p class="x_MsoNormal" style="text-indent:11pt; margin:0in 0in
            0.0001pt; font-size:12pt; font-family:Calibri,sans-serif">
**TMAP ERR: Requested data range is outside of data set limits</p>
<p class="x_MsoNormal" style="text-indent:11pt; margin:0in 0in
            0.0001pt; font-size:12pt; font-family:Calibri,sans-serif">
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Expected: V_NORM[I=&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; 2 :&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; 2 ] Found: V_NORM[I=&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; 1 :&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; 1 ]</p>
<p class="x_MsoNormal" style="text-indent:11pt; margin:0in 0in
            0.0001pt; font-size:12pt; font-family:Calibri,sans-serif">
LIST/FORMAT=CDF/file=<a rel="nofollow" href="http://v_ij.nc/app
              v_norm,v_std,v_min,v_max,v_npts">v_ij.nc/app v_norm,v_std,v_min,v_max,v_npts</a></p>
<p class="x_MsoNormal" style="text-indent:11pt; margin:0in 0in
            0.0001pt; font-size:12pt; font-family:Calibri,sans-serif">
&nbsp;</p>
<p class="x_MsoNormal" style="text-indent:11pt; margin:0in 0in
            0.0001pt">
<b style=""><font face="arial, sans-serif">The same error message if I use either one of the following two:</font></b></p>
<p class="x_MsoNormal" style="text-indent:11pt; margin:0in 0in
            0.0001pt">
<font face="arial, sans-serif">save/file=<a rel="nofollow" href="http://v_ij.nc/app/">v_ij.nc/app/</a><span style="color:rgb(192,0,0)">I=1
</span>v_norm,v_std,v_min,v_max,v_npts ;\</font></p>
<p class="x_MsoNormal" style="text-indent:11pt; margin:0in 0in
            0.0001pt">
<font face="arial, sans-serif">save/file=<a rel="nofollow" href="http://v_ij.nc/app/">v_ij.nc/app/</a><span style="color:rgb(192,0,0)">I=`ii`
</span>v_norm,v_std,v_min,v_max,v_npts ;\</font></p>
<p class="x_MsoNormal" style="text-indent:11pt; margin:0in 0in
            0.0001pt; font-size:12pt; font-family:Calibri,sans-serif">
&nbsp;</p>
</div>
-- <br>
<div dir="ltr" class="x_gmail_signature">
<div dir="ltr">
<div>
<div dir="ltr">
<div dir="ltr">
<div dir="ltr">
<div dir="ltr">
<div dir="ltr">
<div dir="ltr">
<div dir="ltr">
<div dir="ltr">
<p><b><span style="font-size:9pt; font-family:Arial; color:rgb(51,51,51); background:white">Ge Peng, PhD</span></b><span style="font-size:9pt; font-family:Arial; color:rgb(51,51,51); background:white"><br>
<b>Research Scholar</b><br>
</span><span style="font-size:9pt; font-family:Arial; color:rgb(34,34,34)">NOAA's Cooperative Institute for Satellite Earth System Studies (CISESS) at</span><span style="font-size:9pt; color:rgb(34,34,34)"><font face="Times">&nbsp;</font></span></p>
<p><span style="font-family:Arial; font-size:9pt">NOAA&#x2019;s National Centers for Environmental Information (NCEI)</span></p>
<p><span style="font-size:9pt; font-family:Times"></span></p>
<p><span style="font-size:9pt; font-family:Arial; color:rgb(34,34,34)">Center for Weather and Climate (CWC)</span><span style="font-size:9pt; font-family:Times"></span></p>
<p><span style="font-size:9pt; font-family:Arial; color:rgb(51,51,51); background:white">151 Patton Ave, Asheville, NC 28801 USA<br>
<a rel="nofollow"><span style="color:rgb(17,85,204)">&#43;1 828 257 3009</span></a>; <span style="color:rgb(17,85,204)">
<a rel="nofollow" href="mailto:ge.peng@xxxxxxxx" target="_blank">ge.peng@xxxxxxxx</a></span></span></p>
<p><span style="font-size:9pt; font-family:Arial">ORCID: http://</span><span style="font-size:9pt; font-family:Arial; color:rgb(73,74,76); background-image:initial; background-position:initial; background-repeat:initial"><a rel="nofollow" href="http://orcid.org/0000-0002-1986-9115" target="_blank">orcid.org/0000-0002-1986-9115</a></span></p>
<p style="color:rgb(51,51,51); font-family:Times; font-size:13.6364px; margin-bottom:0.0001pt; background-color:white">
<span style="font-family:arial,helvetica,sans-serif; font-size:10.9091px; line-height:11.9886px; text-align:-webkit-center">Following CICS-NC on&nbsp;</span><a rel="nofollow" href="http://www.facebook.com/cicsnc" target="_blank" style="font-family:arial,helvetica,sans-serif; font-size:10.9091px; line-height:11.9886px; color:rgb(38,58,143); text-decoration:none; font-weight:bold">Facebook</a></p>
<table width="500" cellspacing="2" cellpadding="2" border="0" style="max-width:100%; border-collapse:collapse; border-spacing:0px; color:rgb(51,51,51); font-size:14px; font-family:Times; line-height:12px">
<tbody>
<tr>
<td width="71" height="71" align="center"><br>
</td>
<td valign="top"><br>
</td>
</tr>
</tbody>
</table>
<br>
</div>
</div>
</div>
</div>
</div>
</div>
</div>
</div>
</div>
</div>
</div>
</div>
</blockquote>
</div>


</td></tr></table>
<!--X-Body-of-Message-End-->
<!--X-MsgBody-End-->
<!--X-Follow-Ups-->
<hr>
<ul><li><strong>Follow-Ups</strong>:
<ul>
<li><strong><a name="00517" href="msg00517.html">Re: [ferret_users] Appending output data to a netCDF file in i-dimension</a></strong>
<ul><li><em>From:</em> Ge Peng - NOAA Affiliate</li></ul></li>
</ul></li></ul>
<!--X-Follow-Ups-End-->
<!--X-References-->
<ul><li><strong>References</strong>:
<ul>
<li><strong><a name="00513" href="msg00513.html">[ferret_users] Appending output data to a netCDF file in i-dimension</a></strong>
<ul><li><em>From:</em> Ge Peng - NOAA Affiliate</li></ul></li>
<li><strong><a name="00515" href="msg00515.html">Re: [ferret_users] Appending output data to a netCDF file in i-dimension</a></strong>
<ul><li><em>From:</em> Ansley C. Manke</li></ul></li>
</ul></li></ul>
<!--X-References-End-->
<!--X-BotPNI-->
<UL>
<li>Previous by thread:
<strong><a href="msg00515.html">Re: [ferret_users] Appending output data to a netCDF file in i-dimension</a></strong>
</li>
<li>Next by thread:
<strong><a href="msg00517.html">Re: [ferret_users] Appending output data to a netCDF file in i-dimension</a></strong>
</li>

</UL>
<center>[<a href="msg00515.html">Thread Prev</a>][<a href="msg00517.html">Thread Next</a>][<A HREF="threads.html#00516">Index</A>]</center>

<!--X-BotPNI-End-->
<!--X-User-Footer-->
<A HREF="http://ferret.pmel.noaa.gov/Ferret/contact-us">Contact Us</A>
<br>
<font size=-1>
<address>
<a href="http://www.doc.gov">Dept of Commerce</a> /
<a href="http://www.noaa.gov">NOAA</a> /
<a href="http://www.oar.noaa.gov">OAR</a> /
<a href="http://www.pmel.noaa.gov">PMEL</a> /
<a href="http://ferret.pmel.noaa.gov">Ferret</a>
</address>

<br>
 <a href="http://www.noaa.gov/privacy.html">Privacy Policy</a> | <a href="http://www.noaa.gov/disclaimer.html">Disclaimer</a> | <a href="accessibility.html">Accessibility Statement</a> 

</font>
<!--X-User-Footer-End-->
</body>
</html>
