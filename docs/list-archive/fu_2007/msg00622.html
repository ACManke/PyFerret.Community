<!-- MHonArc v2.6.16 -->
<!--X-Subject: [ferret_users] regridding problem &#45; axis not compatable with itself? -->
<!--X-From-R13: Evz Znexva <fvzNfvzynexva.pbz> -->
<!--X-Date: Wed, 31 Oct 2007 12:15:40 &#45;0700 -->
<!--X-Message-Id: b23fdd1b0710311215g7425eff2i1577453f81e866ae@mail.gmail.com -->
<!--X-Content-Type: multipart/alternative -->
<!--X-Head-End-->
<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN"
        "http://www.w3.org/TR/html4/loose.dtd">
<html>
<head>
<title>[ferret_users] regridding problem - axis not compatable with itself?</title>
</head>
<body>
<!--X-Body-Begin-->
<!--X-User-Header-->
<!--X-User-Header-End-->
<!--X-TopPNI-->
<HR>
<center>[<a href="msg00618.html">Thread Prev</a>][<a href="msg00624.html">Thread Next</a>][<A HREF="threads.html#00622">Index</A>]</center>

<!--X-TopPNI-End-->
<!--X-MsgBody-->
<!--X-Subject-Header-Begin-->
<h1>[ferret_users] regridding problem - axis not compatable with itself?</h1>
<hr>
<!--X-Subject-Header-End-->
<!--X-Head-of-Message-->
<ul>
<li><strong>To</strong>: <strong><a href="mailto:ferret_users@DOMAIN.HIDDEN">ferret_users@xxxxxxxx</a></strong></li>
<li><strong>Subject</strong>: <strong>[ferret_users] regridding problem - axis not compatable with itself?</strong></li>
<li><strong>From</strong>: <strong>Sim Larkin &lt;<a href="mailto:sim@DOMAIN.HIDDEN">sim@xxxxxxxxxxxxx</a>&gt;</strong></li>
<li>Date: Wed, 31 Oct 2007 12:15:37 -0700</li>
<li>Cc: <a href="mailto:aguilasa@DOMAIN.HIDDEN">aguilasa@xxxxxxxxxxx</a>, <a href="mailto:steven.c.hankin@DOMAIN.HIDDEN">steven.c.hankin@xxxxxxxx</a></li>
<li>Dkim-signature: v=1; a=rsa-sha256; c=relaxed/relaxed;        d=gmail.com; s=beta; h=domainkey-signature:received:received:message-id:date:from:sender:to:subject:cc:mime-version:content-type:x-google-sender-auth; bh=quvxpjjOBjG6LG1DksCfuiEHiBNV6kaoLonGVlBd3bI=; b=fXsDwhLoePd/M7RoV/4mqBHcL4m8WCNLEiDKfB370EVtFR2ybpa+KhdMmmpBgq/k2tZI5CCXXWaU0kwzUBSBsnuoGqFZURxioT7Q6Ojg20s/KC1XSsyCyBMk/X63xe5K11jsX4t31OanBZDMhFC0KpML1Q6+FhbL1H7QxyNkgjQ=</li>
<li>Domainkey-signature: a=rsa-sha1; c=nofws;        d=gmail.com; s=beta; h=received:message-id:date:from:sender:to:subject:cc:mime-version:content-type:x-google-sender-auth; b=NgvSI3auyPidxedhq2Tih3u947+PHPui/qDD8xdrHPTMNvIDVmuQidPOS6p6NlqwiefS0abKe0RCVgrkmPTeRu1eJq4hYhEbafrVZNg1tDMBvCqrP4qkWIfC2adCzqHtGia+AG+oHNru3/wRUBWLSaOEjrf8oiFTxVZSQrtpVoI=</li>
<li>Sender: <a href="mailto:owner-ferret_users@DOMAIN.HIDDEN">owner-ferret_users@xxxxxxxx</a></li>
</ul>
<!--X-Head-of-Message-End-->
<!--X-Head-Body-Sep-Begin-->
<hr>
<!--X-Head-Body-Sep-End-->
<!--X-Body-of-Message-->
We&#39;ve run into a weird regridding problem where an axis appears incompatable with itself.<br>
What&#39;s worse (for us) is that distilling the problem down to smaller example datasets (seems to) fix the problem.<br>

So I&#39;m not sure what we are doing wrong.&nbsp; Any suggestions?<br>
<br>
<br>
The error we get is:<br>
<br style="font-family: courier new,monospace;">
<div style="margin-left: 40px;"><span style="font-family: courier new,monospace;">&nbsp;LISTing to file all_stations.cdf</span><br style="font-family: courier new,monospace;">
<span style="font-family: courier new,monospace;">&nbsp;**TMAP ERR: error in line definition</span><br style="font-family: courier new,monospace;">
<span style="font-family: courier new,monospace;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
file coords dont match variable coords on axis ZSTATIONS</span><br style="font-family: courier new,monospace;">
<br>
</div>
We are trying to get AIRT from files that contain single weather
station data into a single file with the average AIRT from all
stations, where the Z axis becomes the &quot;station number&quot;.<br>
<br>
Initial data grid:<br>
<div style="margin-left: 40px;">&nbsp;<span style="font-family: courier new,monospace;">&nbsp; GRID GNS1</span><br style="font-family: courier new,monospace;">
<span style="font-family: courier new,monospace;">&nbsp;name&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
axis&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
# pts&nbsp;&nbsp;
start&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
end</span><br style="font-family: courier new,monospace;">
<span style="font-family: courier new,monospace;">&nbsp;XSTATS&nbsp;&nbsp;&nbsp;
X&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
3 r&nbsp;&nbsp;
1&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
3</span><br style="font-family: courier new,monospace;">
<span style="font-family: courier new,monospace;">&nbsp;YSOURCE&nbsp;&nbsp;
Y&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
4 r&nbsp;&nbsp;
1&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
4</span><br style="font-family: courier new,monospace;">
<span style="font-family: courier new,monospace;">&nbsp;normal&nbsp;&nbsp;&nbsp; Z</span><br style="font-family: courier new,monospace;">
<span style="font-family: courier new,monospace;">&nbsp;TIME&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
TIME&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
40542 r&nbsp;&nbsp; 01-JAN-1900 00:00&nbsp;&nbsp;&nbsp; 31-DEC-2010
00:00</span><br style="font-family: courier new,monospace;">
<br>
<br>
</div>
<br>
Final data grid (note that the &quot;YSOURCE&quot; axis is removed (we want to
average over this before putting in the final dataset) and there is a
new &quot;ZSTATIONS&quot; axis to represent all of the weather stations we have.<br>
<div style="margin-left: 40px;"><span style="font-family: courier new,monospace;">&nbsp; GRID (G006)</span><br style="font-family: courier new,monospace;">
<span style="font-family: courier new,monospace;">&nbsp;name&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
axis&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
# pts&nbsp;&nbsp;
start&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
end</span><br style="font-family: courier new,monospace;">
<span style="font-family: courier new,monospace;">&nbsp;XSTATS&nbsp;&nbsp;&nbsp;
X&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
3 r&nbsp;&nbsp;
1&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
3</span><br style="font-family: courier new,monospace;">
<span style="font-family: courier new,monospace;">&nbsp;normal&nbsp;&nbsp;&nbsp; Y<br>
&nbsp;</span><span style="font-family: courier new,monospace;">ZSTATIONS
Z&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
727 r&nbsp;&nbsp;
1&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
727</span><br style="font-family: courier new,monospace;">
<span style="font-family: courier new,monospace;">&nbsp;TIME&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
TIME&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
40542 r&nbsp;&nbsp; 01-JAN-1900 00:00&nbsp;&nbsp;&nbsp; 31-DEC-2010
00:00</span><br>
</div>
<br>
To do this, we use the script (note the input and output datasets both
are already created and the variable name in both cases is &quot;AIRT&quot;):<br>
<br style="font-family: courier new,monospace;">
<br style="font-family: courier new,monospace;">
<div style="margin-left: 40px;"><span style="font-family: courier new,monospace;">use &quot;all_stations.cdf&quot;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; ! the final data set with all the stations</span><br style="font-family: courier new,monospace;">

<span style="font-family: courier new,monospace;">define grid/like=airt[d=1] gnew</span><br style="font-family: courier new,monospace;">
<span style="font-family: courier new,monospace;">let zeroz = k[g=gnew]*0&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; ! a variable with all zeros in the Z axis</span><br style="font-family: courier new,monospace;">
<br style="font-family: courier new,monospace;">
<span style="font-family: courier new,monospace;">use
&quot;station14.cdf&quot;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
! the single station input data - in this case we want this data<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
! in the final dataset under &quot;k=14&quot;<br style="font-family: courier new,monospace;">
</span><br style="font-family: courier new,monospace;">
<span style="font-family: courier new,monospace;">use
dummy.cdf&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
! a completely bogus dataset just used to allow us to define &quot;AIRT&quot; on
it</span><br style="font-family: courier new,monospace;">
<span style="font-family: courier new,monospace;">let/d=3 airt = airt[d=2, j=1:4@ave] + zeroz</span><br style="font-family: courier new,monospace;">
<br style="font-family: courier new,monospace;">
<span style="font-family: courier new,monospace;">save/file=&quot;all_stations.cdf&quot;/append/k=14 airt[d=3]</span><br style="font-family: courier new,monospace;">
<br style="font-family: courier new,monospace;">
</div>
<span style="font-family: courier new,monospace;"></span><br>
<span style="font-family: courier new,monospace;"></span>And this gets us the error:<br>
<br style="font-family: courier new,monospace;">
<div style="margin-left: 40px;"><span style="font-family: courier new,monospace;">LISTing to file all_stations.cdf</span><br style="font-family: courier new,monospace;">
<span style="font-family: courier new,monospace;">
&nbsp;**TMAP ERR: error in line definition</span><br style="font-family: courier new,monospace;">
<span style="font-family: courier new,monospace;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
file coords dont match variable coords on axis ZSTATIONS</span><br>
<br>
</div>
Which seems weird because the ZSTATIONS axis is taken directly from the
dataset we are saving into (via the ZEROZ variable and the GNEW grid
definition).&nbsp; Doing &quot;SHOW GRID AIRT[D=3]&quot; reveals no differences
with the dataset&#39;s z axis.<br>
<br>
When we pared this down to an example dataset with only 40 points in
time (instead of 40000+) and only 10 points in z (instead of 727) it
worked fine.&nbsp; So is there a memory issue here?&nbsp; The file size
for &quot;all_stations.cdf&quot; is only ~ 400MB (the pared down files were
tiny), so there is no 2GB limit issue.<br>
<br>
<br>
Any thoughts?<br>
<br>
Thanks for your help!<br>
<br>
<br>
- Sim Larkin<br>
USFS AirFire Team<br>
<a rel="nofollow" href="mailto:larkin@xxxxxxxxx">larkin@xxxxxxxxx</a><br>
<br>

<!--X-Body-of-Message-End-->
<!--X-MsgBody-End-->
<!--X-Follow-Ups-->
<hr>
<!--X-Follow-Ups-End-->
<!--X-References-->
<!--X-References-End-->
<!--X-BotPNI-->
<UL>
<li>Previous by thread:
<strong><a href="msg00618.html">[ferret_users] vectors thicker?</a></strong>
</li>
<li>Next by thread:
<strong><a href="msg00624.html">[ferret_users] creating movies from POP movie output</a></strong>
</li>

</UL>
<center>[<a href="msg00618.html">Thread Prev</a>][<a href="msg00624.html">Thread Next</a>][<A HREF="threads.html#00622">Index</A>]</center>

<!--X-BotPNI-End-->
<!--X-User-Footer-->
<hr>
<A HREF="ferret_contact_us.html">Contact Us</A>
<br>
<font size=-1>
<address>
<a href="http://www.doc.gov">Dept of Commerce</a> / 
<a href="http://www.noaa.gov">NOAA</a> /
<a href="http://www.oar.noaa.gov">OAR</a> /
<a href="http://www.pmel.noaa.gov">PMEL</a> /
<a href="http://tmap.pmel.noaa.gov">TMAP</a>
</address>
<br>
 <a href="http://www.noaa.gov/privacy.html">Privacy Policy</a> | <a href="http://www.noaa.gov/disclaimer.html">Disclaimer</a> | <a href="accessibility.html">Accessibility Statement</a> 
</font>
<!--X-User-Footer-End-->
</body>
</html>
