<!-- MHonArc v2.6.16 -->
<!--X-Subject: [ferret_users] Complex demodulation in Ferret -->
<!--X-From-R13: "Ivyyvnz E. Yrffyre" <Ivyyvnz.E.YrffyreNabnn.tbi> -->
<!--X-Date: Sun, 25 Mar 2007 22:03:39 &#45;0700 -->
<!--X-Message-Id: 332DD0FE&#45;B105&#45;42E9&#45;8FF2&#45;D809E6EEE5D1@noaa.gov -->
<!--X-Content-Type: multipart/mixed -->
<!--X-Derived: pdfHMANlJLqCE.pdf -->
<!--X-Derived: binAci2IAyORJ.bin -->
<!--X-Derived: binVsOhICO7rf.bin -->
<!--X-Derived: binQ6uNC8NgR4.bin -->
<!--X-Derived: binYf7F9RBrxZ.bin -->
<!--X-Head-End-->
<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN"
        "http://www.w3.org/TR/html4/loose.dtd">
<html>
<head>
<title>[ferret_users] Complex demodulation in Ferret</title>
</head>
<body>
<!--X-Body-Begin-->
<!--X-User-Header-->
<!--X-User-Header-End-->
<!--X-TopPNI-->
<HR>
<center>[<a href="msg00179.html">Thread Prev</a>][<a href="msg00183.html">Thread Next</a>][<A HREF="threads.html#00180">Index</A>]</center>

<!--X-TopPNI-End-->
<!--X-MsgBody-->
<!--X-Subject-Header-Begin-->
<h1>[ferret_users] Complex demodulation in Ferret</h1>
<hr>
<!--X-Subject-Header-End-->
<!--X-Head-of-Message-->
<ul>
<li><strong>To</strong>: <strong>Ferret users &lt;<a href="mailto:oar.pmel.ferret_users@DOMAIN.HIDDEN">oar.pmel.ferret_users@xxxxxxxx</a>&gt;</strong></li>
<li><strong>Subject</strong>: <strong>[ferret_users] Complex demodulation in Ferret</strong></li>
<li><strong>From</strong>: <strong>&quot;William S. Kessler&quot; &lt;<a href="mailto:William.S.Kessler@DOMAIN.HIDDEN">William.S.Kessler@xxxxxxxx</a>&gt;</strong></li>
<li>Date: Sun, 25 Mar 2007 22:03:31 -0700</li>
<li>Cc: &quot;William S. Kessler&quot; &lt;<a href="mailto:William.S.Kessler@DOMAIN.HIDDEN">William.S.Kessler@xxxxxxxx</a>&gt;</li>
<li>Sender: <a href="mailto:owner-ferret_users@DOMAIN.HIDDEN">owner-ferret_users@xxxxxxxxxxxxx</a></li>
</ul>
<!--X-Head-of-Message-End-->
<!--X-Head-Body-Sep-Begin-->
<hr>
<!--X-Head-Body-Sep-End-->
<!--X-Body-of-Message-->
<pre style="margin: 0em;">
Hi Ferreters -

</pre><tt>Here's a set of scripts to do complex demodulation. Complex  
</tt><tt>demodulation is a type of bandpass filter that gives the (slow) time  
</tt><tt>variation of amplitude and phase of the signal of interest in a  
</tt><tt>specified frequency band. That is, if you have a time series X(t)  
</tt><tt>that contains a signal of interest near a frequency omega, you can  
</tt><tt>represent that signal as a bandpassed time series Y(t)=Amp(t)cos 
</tt><tt>(omega*t+Phi(t)). Amp(t) and Phi(t) are the outputs of the script,  
</tt><tt>which show how the amplitude and phase of the bandpassed signal vary  
</tt><tt>with time. The reconstruction Y(t) can be checked to be the same as  
</tt><tt>an ordinary triangle bandpass filter with the specified half-power  
</tt><tt>limits, and can be used as an ordinary bandpass. For example, try  
</tt><tt>plotting the reconstruction Y(t) over the original data.
</tt><pre style="margin: 0em;">

</pre><tt>The attached pdf file gives the math that is implemented in the  
</tt><tt>scripts. Except for step 5 it is simple to understand and to  
</tt><tt>implement in Ferret.
</tt><pre style="margin: 0em;">

Four Ferret scripts are attached:

</pre><tt>cdmod_1.go   Simple script to produce the amplitude, phase and  
</tt><tt>reconstruction (steps 1-4 of the attached writeup). Inputs are the  
</tt><tt>variable to demodulate and the central frequency of interest.
</tt><pre style="margin: 0em;">

</pre><tt>cdmod_2.go   Script to also do step 5 of the writeup: fit a line to  
</tt><tt>the phase to make an estimate of the time-varying period of the  
</tt><tt>bandpassed signal. This is much more involved because it requires  
</tt><tt>dealing with phase jumps that occur at Phi=+-pi. (A real pain in the  
</tt><tt>butt to implement, and my solution is highly inelegant, but seems to  
</tt><tt>work, I think. See the ugly repeat loops in this script.)
</tt><pre style="margin: 0em;">

</pre><tt>cdmod_2.go requires 2 additional short scripts: advancephase.go and  
</tt><tt>retardphase.go, also attached.
</tt><pre style="margin: 0em;">

</pre><tt>Complex demodulation is not used as much as it could be in  
</tt><tt>oceanography/meteorology, but for one example of its use, see Fig.10  
</tt><tt>of Kessler et al (1995, JGR 100, 10,613-10,631. &quot;Forcing of  
</tt><tt>intraseasonal Kelvin waves ....&quot;). Available on my website under  
</tt><tt>publications.
</tt><pre style="margin: 0em;">

</pre><tt>If anyone has a better way to deal with 2pi phase jumps I'd like to  
</tt><tt>hear about it.
</tt><pre style="margin: 0em;">

Billy K
~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
William S. Kessler
NOAA / Pacific Marine Environmental Laboratory
7600 Sand Point Way NE
Seattle WA 98115 USA

william.s.kessler@xxxxxxxx
Tel: 206-526-6221
Fax: 206-526-6744
Home page: <a  rel="nofollow" href="http://www.pmel.noaa.gov/people/kessler/">http://www.pmel.noaa.gov/people/kessler/</a>


</pre><p><strong>Attachment:
<a href="pdfHMANlJLqCE.pdf" ><tt>Complex_Demodulation2.pdf</tt></a></strong><br>
<em>Description:</em> Adobe PDF document</p>
<pre style="margin: 0em;">

</pre><p><strong>Attachment:
<a href="binAci2IAyORJ.bin" ><tt>cdmod_1.go</tt></a></strong><br>
<em>Description:</em> Binary data</p>
<p><strong>Attachment:
<a href="binVsOhICO7rf.bin" ><tt>cdmod_2.go</tt></a></strong><br>
<em>Description:</em> Binary data</p>
<p><strong>Attachment:
<a href="binQ6uNC8NgR4.bin" ><tt>retardphase.go</tt></a></strong><br>
<em>Description:</em> Binary data</p>
<p><strong>Attachment:
<a href="binYf7F9RBrxZ.bin" ><tt>advancephase.go</tt></a></strong><br>
<em>Description:</em> Binary data</p>

<!--X-Body-of-Message-End-->
<!--X-MsgBody-End-->
<!--X-Follow-Ups-->
<hr>
<!--X-Follow-Ups-End-->
<!--X-References-->
<!--X-References-End-->
<!--X-BotPNI-->
<UL>
<li>Previous by thread:
<strong><a href="msg00179.html">[ferret_users] OPeNDAP/netCDF Error code 27</a></strong>
</li>
<li>Next by thread:
<strong><a href="msg00183.html">[ferret_users] converting into monthly averages</a></strong>
</li>

</UL>
<center>[<a href="msg00179.html">Thread Prev</a>][<a href="msg00183.html">Thread Next</a>][<A HREF="threads.html#00180">Index</A>]</center>

<!--X-BotPNI-End-->
<!--X-User-Footer-->
<hr>
<A HREF="ferret_contact_us.html">Contact Us</A>
<br>
<font size=-1>
<address>
<a href="http://www.doc.gov">Dept of Commerce</a> / 
<a href="http://www.noaa.gov">NOAA</a> /
<a href="http://www.oar.noaa.gov">OAR</a> /
<a href="http://www.pmel.noaa.gov">PMEL</a> /
<a href="http://tmap.pmel.noaa.gov">TMAP</a>
</address>
<br>
 <a href="http://www.noaa.gov/privacy.html">Privacy Policy</a> | <a href="http://www.noaa.gov/disclaimer.html">Disclaimer</a> | <a href="accessibility.html">Accessibility Statement</a> 
</font>
<!--X-User-Footer-End-->
</body>
</html>
