<!-- MHonArc v2.5.13 -->
<!--X-Subject: integrals on depth from sigma coordinates -->
<!--X-From-R13: Pvyyl Yrffyre <xrffyreNczry.abnn.tbi> -->
<!--X-Date: Sun, 15 Dec 2002 23:11:03 &#45;0800 (PST) -->
<!--X-Message-Id: 200212160710.gBG7Axf29062@pontus.pmel.noaa.gov -->
<!--X-Content-Type: text/plain -->
<!--X-Head-End-->
<!doctype html public "-//W3C//DTD HTML//EN">
<html>
<head>
<title>integrals on depth from sigma coordinates</title>
</head>
<body>
<!--X-Body-Begin-->
<!--X-User-Header-->
<!--X-User-Header-End-->
<!--X-TopPNI-->
<HR>
<center>[<a href="msg00635.html">Thread Prev</a>][<a href="msg00639.html">Thread Next</a>][<A HREF="threads.html#00638">Index</A>]</center>

<!--X-TopPNI-End-->
<!--X-MsgBody-->
<!--X-Subject-Header-Begin-->
<h1>integrals on depth from sigma coordinates</h1>
<hr>
<!--X-Subject-Header-End-->
<!--X-Head-of-Message-->
<ul>
<li><strong>To</strong>: <strong><a href="mailto:ferret_users@DOMAIN.HIDDEN">ferret_users@xxxxxxxxxxxxxxxxxxx</a></strong></li>
<li><strong>Subject</strong>: <strong>integrals on depth from sigma coordinates</strong></li>
<li><strong>From</strong>: <strong>Billy Kessler &lt;<a href="mailto:kessler@DOMAIN.HIDDEN">kessler@xxxxxxxxxxxxx</a>&gt;</strong></li>
<li>Date: Sun, 15 Dec 2002 23:10:59 -0800 (PST)</li>
<li>Cc: <a href="mailto:kessler@DOMAIN.HIDDEN">kessler@xxxxxxxxxxxxxxxxxxxx</a></li>
<li>Sender: <a href="mailto:owner-ferret_users@DOMAIN.HIDDEN">owner-ferret_users@xxxxxxxxxxxxxxxxxxx</a></li>
</ul>
<!--X-Head-of-Message-End-->
<!--X-Head-Body-Sep-Begin-->
<hr>
<!--X-Head-Body-Sep-End-->
<!--X-Body-of-Message-->
<pre>
I have model output on a sigma vertical coordinate.
I want to find the vertical integral of one of these
quantities (v) as a function of z, not sigma. The
thickness (h) of the sigma layers is a function of 
(x,y,t).

For z values within layer 1, the integral is just v1*z.

Within layer 2 the integral is: v1*h1 + v2*(z-h1).

Within layer 3 it is: v1*h1 + v2*h2 + v3*(z-(h1+h2)).

And so on. I have a reasonably small number of layers
(9), so it is feasible to write 9 statements. However,
I can't figure out how to do this:

define axis/z=0:400:10/depth zdep       ! depth axis in 10m intervals
let zz = z[gz=zdep]			! values of z-axis

let htot = h[z=@rsum]			! depth of sigma interfaces

! build up the integral layer by layer
let vonz1 = if zz le htot[k=1] then v[k=1]*zz else 0	    ! layer 1
let vonz2 = if zz gt htot[k=1] and zz le htot[k=2] then 
            v[k=1]*h[k=1] + v[k=2]*(zz-h[k=1]) else vonz1   ! layer 2
let vonz3 = if zz gt htot[k=2] and zz le htot[k=3] then 
            v[k=1]*h[k=1] + v[k=2]*h[k=2] + 
            v[k=3]*(zz-htot[k=2]) else vonz2	            ! layer 3
 ... etc ....

This does not work. The first definition produces correct
results, but all the rest are blank. It seems conceptually
simple but I'm not getting anywhere. Any ideas appreciated.

Thanks ..... Billy K

</pre>

<!--X-Body-of-Message-End-->
<!--X-MsgBody-End-->
<!--X-Follow-Ups-->
<hr>
<!--X-Follow-Ups-End-->
<!--X-References-->
<!--X-References-End-->
<!--X-BotPNI-->
<UL>
<li>Previous by thread:
<strong><a href="msg00635.html">gif graphic</a></strong>
</li>
<li>Next by thread:
<strong><a href="msg00639.html">Interrupted Goode Homolosine Proj</a></strong>
</li>

</UL>
<center>[<a href="msg00635.html">Thread Prev</a>][<a href="msg00639.html">Thread Next</a>][<A HREF="threads.html#00638">Index</A>]</center>

<!--X-BotPNI-End-->
<!--X-User-Footer-->
<hr>
<font size=-1>
<address>
<a href="http://www.doc.gov">Dept of Commerce</a> / 
<a href="http://www.noaa.gov">NOAA</a> /
<a href="http://www.oar.noaa.gov">OAR</a> /
<a href="http://www.pmel.noaa.gov">PMEL</a> /
<a href="http://tmap.pmel.noaa.gov">TMAP</a>
</address> <br> <a href="http://ferret.pmel.noaa.gov/Ferret/ferret_contact_us.html">Contact Us</a> | <a href="http://www.noaa.gov/privacy.html">Privacy Policy</a> | <a href="http://www.noaa.gov/disclaimer.html">Disclaimer</a> | <a href="accessibility.html">Accessibility Statement</a> 
</font>
<!--X-User-Footer-End-->
</body>
</html>
